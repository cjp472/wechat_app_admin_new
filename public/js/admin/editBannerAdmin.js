var isEditPicture=false;var params={};var allParams={};var cos=new InitCosCloud;$(document).ready(function(){bindElement();datetimepickerconfig("#stop_time")});function bindElement(){$("#stop_time").on("change",function(){setMsgDim("#stop_time")});$("#type_selector").on("change",function(){var e=$(this).find("option:selected").val();if(e=="h5"){$("#sub_selector").empty();$("#sub_selector").addClass("hide");$("#sub_input").removeClass("hide");return}else if(e=="no_jump"){$("#sub_selector").empty();$("#sub_selector").removeClass("hide");$("#sub_input").addClass("hide");return}else{$("#sub_selector").empty();$("#sub_selector").removeClass("hide");$("#sub_input").addClass("hide")}$.get("/banner/getResourceList?type="+e,function(e){$("#sub_selector").empty();e=JSON.parse(e);var s=e.length;var a="";for(var i=0;i<s;i++){a+="<option value='"+e[i].id+"'>"+e[i].title+"</option>"}$("#sub_selector").append(a)})});var e=$("#type_selector").find("option:selected").val();if(e=="h5"){$("#sub_selector").empty();$("#sub_selector").addClass("hide");$("#sub_input").removeClass("hide")}}function uploadBanner(){showLoading();if(!checkBannerForm()){hideLoading();return}sliceUpload(".pic_input",get_cos_image_path(),pic_successCallBack,pic_errorCallBack)}function saveBanner(){showLoading();if(!checkBannerForm()){hideLoading();return}if(isEditPicture){sliceUpload(".pic_input",get_cos_image_path(),pic_successCallBack,pic_errorCallBack)}else{doUpLoad()}}function checkBannerForm(){params={};allParams={};var e=$(".pic_input").val();if(e.length!=0){isEditPicture=true}var s=$("#resource_title").val().trim();if(s.length!=0){params["title"]=s}else{baseUtils.show.blueTip("图片名称不能为空！");$("#resouce_title").focus()}var a=$("#start_time").val().trim();if(a.length!=0){params["start_at"]=a}var i=$("#stop_time").val().trim();if(i.length!=0){if(a>i){baseUtils.show.blueTip("上架时间不能晚于下架时间！");return false}params["stop_at"]=i}params["skip_target"]=$("#sub_selector").find("option:selected").val();params["skip_title"]=$("#sub_selector").find("option:selected").text();var t=$("#type_selector").find("option:selected").val();if(t=="audio"){t=2}else if(t=="video"){t=3}else if(t=="image_text"){t=1}else if(t=="alive"){t=4}else if(t=="package"){t=6}else if(t=="h5"){t=5;params["skip_target"]=$("#sub_input").val().trim()}else{t=0}params["skip_type"]=t;if(t==2||t==3||t==1||t==4||t==6){if(params["skip_title"]==""){baseUtils.show.blueTip("请选择跳转资源链接!");return false}}var r=$("#view_order").find("option:selected").val();if(r=="first"){r=10}else if(r=="second"){r=9}else if(r=="third"){r=8}else{r=0}params["weight"]=r;allParams["params"]=params;allParams["id"]=$("#data").data("id");return true}function sliceUpload(e,s,a,i){var t=$(e).prop("files");if(t&&t.length==1){browserMD5File(t[0],function(e,r){console.log("MD5:"+r);var o=t[0]["name"];var l=o.split(".");var n=l[l.length-1];console.log("suffix:"+n);s=s+r+"."+n;console.log("remotePath:"+s);cos.uploadFileWithoutPro(a,i,s,t[0],0)})}else{baseUtils.show.redTip("请选择一个文件")}}var pic_successCallBack=function(e){console.log("图片上传成功!");var s=e.data.access_url;console.log("图片链接!"+s);params["image_url"]=s;allParams["params"]=params;doUpLoad()};var pic_errorCallBack=function(e){hideLoading();baseUtils.show.redTip("配图上传失败!请重新上传!");uploadErrorShow(e.responseText)};function doUpLoad(){$.post("/save_edit_banner",allParams,function(e){hideLoading();var s=e.code;var a=e.msg;if(s==0){baseUtils.show.blueTip("更新成功!",function(){var e=GetQueryString("reurl");if(e){window.location.href=e}else{window.location.href="/getBannerList"}})}else{baseUtils.show.redTip("更新失败!");if(s==1){window.wxc.xcConfirm(a+",请重新选择！","error",{btn:parseInt("0001",2),onOk:function(){}})}}})}
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFkbWluL2VkaXRCYW5uZXJBZG1pbi5qcyJdLCJuYW1lcyI6WyJpc0VkaXRQaWN0dXJlIiwicGFyYW1zIiwiYWxsUGFyYW1zIiwiY29zIiwiSW5pdENvc0Nsb3VkIiwiJCIsImRvY3VtZW50IiwicmVhZHkiLCJiaW5kRWxlbWVudCIsImRhdGV0aW1lcGlja2VyY29uZmlnIiwib24iLCJzZXRNc2dEaW0iLCJ0eXBlIiwidGhpcyIsImZpbmQiLCJ2YWwiLCJlbXB0eSIsImFkZENsYXNzIiwicmVtb3ZlQ2xhc3MiLCJnZXQiLCJyZXN1bHQiLCJKU09OIiwicGFyc2UiLCJjb3VudCIsImxlbmd0aCIsImh0bWxTdHIiLCJpIiwiaWQiLCJ0aXRsZSIsImFwcGVuZCIsInVwbG9hZEJhbm5lciIsInNob3dMb2FkaW5nIiwiY2hlY2tCYW5uZXJGb3JtIiwiaGlkZUxvYWRpbmciLCJzbGljZVVwbG9hZCIsImdldF9jb3NfaW1hZ2VfcGF0aCIsInBpY19zdWNjZXNzQ2FsbEJhY2siLCJwaWNfZXJyb3JDYWxsQmFjayIsInNhdmVCYW5uZXIiLCJkb1VwTG9hZCIsInBpY19pbnB1dCIsInJlc291cmNlX3RpdGxlIiwidHJpbSIsImJhc2VVdGlscyIsInNob3ciLCJibHVlVGlwIiwiZm9jdXMiLCJzdGFydF90aW1lIiwic3RvcF90aW1lIiwidGV4dCIsInNraXBfdHlwZSIsInZpZXdfb3JkZXIiLCJkYXRhIiwiaWRlbnRpdHkiLCJyZW1vdGVQYXRoIiwic3VjY2Vzc0NhbGxCYWNrIiwiZXJyb3JDYWxsQmFjayIsImZpbGVzIiwicHJvcCIsImJyb3dzZXJNRDVGaWxlIiwiZXJyIiwibWQ1IiwiY29uc29sZSIsImxvZyIsImZpbGVfbmFtZSIsIm5hbWVzIiwic3BsaXQiLCJzdWZmaXgiLCJ1cGxvYWRGaWxlV2l0aG91dFBybyIsInJlZFRpcCIsInBpY191cmwiLCJhY2Nlc3NfdXJsIiwidXBsb2FkRXJyb3JTaG93IiwicmVzcG9uc2VUZXh0IiwicG9zdCIsImNvZGUiLCJtc2ciLCJyZV91cmwiLCJHZXRRdWVyeVN0cmluZyIsIndpbmRvdyIsImxvY2F0aW9uIiwiaHJlZiIsInd4YyIsInhjQ29uZmlybSIsImJ0biIsInBhcnNlSW50Iiwib25PayJdLCJtYXBwaW5ncyI6IkFBSUEsR0FBSUEsZUFBZ0IsS0FFcEIsSUFBSUMsVUFDSixJQUFJQyxhQUtKLElBQUlDLEtBQU0sR0FBSUMsYUFFZEMsR0FBRUMsVUFBVUMsTUFBTSxXQUNkQyxhQUdBQyxzQkFBcUIsZUFJekIsU0FBU0QsZUFFTEgsRUFBRSxjQUFjSyxHQUFHLFNBQVUsV0FDekJDLFVBQVUsZUFHZE4sR0FBRSxrQkFBa0JLLEdBQUcsU0FBVSxXQUM3QixHQUFJRSxHQUFPUCxFQUFFUSxNQUFNQyxLQUFLLG1CQUFtQkMsS0FFM0MsSUFBSUgsR0FBUSxLQUFNLENBQ2RQLEVBQUUsaUJBQWlCVyxPQUNuQlgsR0FBRSxpQkFBaUJZLFNBQVMsT0FDNUJaLEdBQUUsY0FBY2EsWUFBWSxPQUM1QixZQUNHLElBQUlOLEdBQVEsVUFBVyxDQUMxQlAsRUFBRSxpQkFBaUJXLE9BQ25CWCxHQUFFLGlCQUFpQmEsWUFBWSxPQUMvQmIsR0FBRSxjQUFjWSxTQUFTLE9BQ3pCLFlBQ0csQ0FDSFosRUFBRSxpQkFBaUJXLE9BQ25CWCxHQUFFLGlCQUFpQmEsWUFBWSxPQUMvQmIsR0FBRSxjQUFjWSxTQUFTLFFBRzdCWixFQUFFYyxJQUFJLGdDQUFrQ1AsRUFBTyxTQUFVUSxHQUNyRGYsRUFBRSxpQkFBaUJXLE9BQ25CSSxHQUFTQyxLQUFLQyxNQUFNRixFQUVwQixJQUFJRyxHQUFRSCxFQUFPSSxNQUVuQixJQUFJQyxHQUFVLEVBRWQsS0FBSyxHQUFJQyxHQUFJLEVBQUdBLEVBQUlILEVBQU9HLElBQUssQ0FDNUJELEdBQVMsa0JBQWtCTCxFQUFPTSxHQUFHQyxHQUFHLEtBQUtQLEVBQU9NLEdBQUdFLE1BQU0sWUFFakV2QixFQUFFLGlCQUFpQndCLE9BQU9KLE1BSWxDLElBQUliLEdBQU9QLEVBQUUsa0JBQWtCUyxLQUFLLG1CQUFtQkMsS0FF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LEVBQ2xDc0MsU0FBUUMsSUFBSSxVQUFZSSxFQUN4QmIsR0FBYUEsRUFBYU8sRUFBTSxJQUFNTSxDQUN0Q0wsU0FBUUMsSUFBSSxjQUFnQlQsRUFFNUJuRCxLQUFJaUUscUJBQXFCYixFQUFpQkMsRUFBZUYsRUFBWUcsRUFBTSxHQUFJLFNBSWxGLENBQ0RkLFVBQVVDLEtBQUt5QixPQUFPLFlBTTlCLEdBQUlqQyxxQkFBc0IsU0FBVWhCLEdBR2hDMEMsUUFBUUMsSUFBSSxVQUdaLElBQUlPLEdBQVVsRCxFQUFPZ0MsS0FBS21CLFVBQzFCVCxTQUFRQyxJQUFJLFFBQVVPLEVBRXRCckUsUUFBTyxhQUFlcUUsQ0FFdEJwRSxXQUFVLFVBQVlELE1BRXRCc0MsWUFJSixJQUFJRixtQkFBb0IsU0FBVWpCLEdBRTlCYSxhQUNBVSxXQUFVQyxLQUFLeUIsT0FBTyxnQkFDdEJHLGlCQUFnQnBELEVBQU9xRCxjQUkzQixTQUFTbEMsWUFHTGxDLEVBQUVxRSxLQUFLLG9CQUFxQnhFLFVBQVcsU0FBVWtCLEdBQzdDYSxhQUNBLElBQUkwQyxHQUFPdkQsRUFBT3VELElBQ2xCLElBQUlDLEdBQU14RCxFQUFPd0QsR0FDakIsSUFBSUQsR0FBUSxFQUFHLENBQ1hoQyxVQUFVQyxLQUFLQyxRQUFRLFFBQVMsV0FDNUIsR0FBSWdDLEdBQVNDLGVBQWUsUUFDNUIsSUFBR0QsRUFBTyxDQUNORSxPQUFPQyxTQUFTQyxLQUFPSixNQUV2QixDQUNBRSxPQUFPQyxTQUFTQyxLQUFPLHdCQUc1QixDQUNIdEMsVUFBVUMsS0FBS3lCLE9BQU8sUUFDdEIsSUFBR00sR0FBTyxFQUFFLENBQ1JJLE9BQU9HLElBQUlDLFVBQVVQLEVBQUksVUFBVyxTQUFVUSxJQUFLQyxTQUFTLE9BQU8sR0FBR0MsS0FBSyIsImZpbGUiOiJhZG1pbi9lZGl0QmFubmVyQWRtaW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIENyZWF0ZWQgYnkgYnJlZXplIG9uIDkvMjkvMTYuXG4gKi9cblxudmFyIGlzRWRpdFBpY3R1cmUgPSBmYWxzZTtcblxudmFyIHBhcmFtcyA9IHt9O1xudmFyIGFsbFBhcmFtcyA9IHt9O1xuXG4vL+iFvuiur+S6kei1hOa6kFxuLy92YXIgYnVja2V0TmFtZSA9IHdpbmRvdy5jb3NfYnVja2V0X25hbWU7XG4vL3ZhciBjb3MgPSBuZXcgQ29zQ2xvdWQod2luZG93LmNvc19hcHBfaWQpO1xudmFyIGNvcyA9IG5ldyBJbml0Q29zQ2xvdWQoKTtcblxuJChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24gKCkge1xuICAgIGJpbmRFbGVtZW50KCk7XG5cbiAgICAvL+WIneWni+WMluaXtumXtOmAieaLqeWZqFxuICAgIGRhdGV0aW1lcGlja2VyY29uZmlnKCcjc3RvcF90aW1lJyk7XG5cbn0pO1xuXG5mdW5jdGlvbiBiaW5kRWxlbWVudCgpIHtcblxuICAgICQoJyNzdG9wX3RpbWUnKS5vbignY2hhbmdlJywgZnVuY3Rpb24oKXtcbiAgICAgICAgc2V0TXNnRGltKCcjc3RvcF90aW1lJyk7XG4gICAgfSk7XG5cbiAgICAkKFwiI3R5cGVfc2VsZWN0b3JcIikub24oJ2NoYW5nZScsIGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgdHlwZSA9ICQodGhpcykuZmluZCgnb3B0aW9uOnNlbGVjdGVkJykudmFsKCk7XG5cbiAgICAgICAgaWYgKHR5cGUgPT0gJ2g1Jykge1xuICAgICAgICAgICAgJCgnI3N1Yl9zZWxlY3RvcicpLmVtcHR5KCk7XG4gICAgICAgICAgICAkKCcjc3ViX3NlbGVjdG9yJykuYWRkQ2xhc3MoJ2hpZGUnKTtcbiAgICAgICAgICAgICQoJyNzdWJfaW5wdXQnKS5yZW1vdmVDbGFzcygnaGlkZScpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9IGVsc2UgaWYgKHR5cGUgPT0gJ25vX2p1bXAnKSB7XG4gICAgICAgICAgICAkKCcjc3ViX3NlbGVjdG9yJykuZW1wdHkoKTtcbiAgICAgICAgICAgICQoJyNzdWJfc2VsZWN0b3InKS5yZW1vdmVDbGFzcygnaGlkZScpO1xuICAgICAgICAgICAgJCgnI3N1Yl9pbnB1dCcpLmFkZENsYXNzKCdoaWRlJyk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAkKCcjc3ViX3NlbGVjdG9yJykuZW1wdHkoKTtcbiAgICAgICAgICAgICQoJyNzdWJfc2VsZWN0b3InKS5yZW1vdmVDbGFzcygnaGlkZScpO1xuICAgICAgICAgICAgJCgnI3N1Yl9pbnB1dCcpLmFkZENsYXNzKCdoaWRlJyk7XG4gICAgICAgIH1cblxuICAgICAgICAkLmdldCgnL2Jhbm5lci9nZXRSZXNvdXJjZUxpc3Q/dHlwZT0nICsgdHlwZSAsIGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICAgICAgICAgICQoJyNzdWJfc2VsZWN0b3InKS5lbXB0eSgpO1xuICAgICAgICAgICAgcmVzdWx0ID0gSlNPTi5wYXJzZShyZXN1bHQpO1xuXG4gICAgICAgICAgICB2YXIgY291bnQgPSByZXN1bHQubGVuZ3RoO1xuXG4gICAgICAgICAgICB2YXIgaHRtbFN0ciA9IFwiXCI7XG5cbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY291bnQ7IGkrKykge1xuICAgICAgICAgICAgICAgIGh0bWxTdHIrPVwiPG9wdGlvbiB2YWx1ZT0nXCIrcmVzdWx0W2ldLmlkK1wiJz5cIityZXN1bHRbaV0udGl0bGUrXCI8L29wdGlvbj5cIjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgICQoJyNzdWJfc2VsZWN0b3InKS5hcHBlbmQoaHRtbFN0cik7XG4gICAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgdmFyIHR5cGUgPSAkKFwiI3R5cGVfc2VsZWN0b3JcIikuZmluZCgnb3B0aW9uOnNlbGVjdGVkJykudmFsKCk7XG5cbiAgICBpZiAodHlwZSA9PSBcImg1XCIpIHtcbiAgICAgICAgJCgnI3N1Yl9zZWxlY3RvcicpLmVtcHR5KCk7XG4gICAgICAgICQoJyNzdWJfc2VsZWN0b3InKS5hZGRDbGFzcygnaGlkZScpO1xuICAgICAgICAkKCcjc3ViX2lucHV0JykucmVtb3ZlQ2xhc3MoJ2hpZGUnKTtcbiAgICB9XG59XG5cblxuZnVuY3Rpb24gdXBsb2FkQmFubmVyKCkge1xuICAgIHNob3dMb2FkaW5nKCk7XG4gICAgaWYgKCFjaGVja0Jhbm5lckZvcm0oKSkge1xuICAgICAgICBoaWRlTG9hZGluZygpO1xuICAgICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLy/mjqXnnYDkuIrkvKDlm77niYdcbiAgICBzbGljZVVwbG9hZCgnLnBpY19pbnB1dCcsIGdldF9jb3NfaW1hZ2VfcGF0aCgpLCBwaWNfc3VjY2Vzc0NhbGxCYWNrLCBwaWNfZXJyb3JDYWxsQmFjayk7XG59XG5cbmZ1bmN0aW9uIHNhdmVCYW5uZXIoKSB7XG4gICAgc2hvd0xvYWRpbmcoKTtcbiAgICBpZiAoIWNoZWNrQmFubmVyRm9ybSgpKSB7XG4gICAgICAgIGhpZGVMb2FkaW5nKCk7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAoaXNFZGl0UGljdHVyZSkge1xuICAgICAgICAvL+aOpeedgOS4iuS8oOWbvueJh1xuICAgICAgICBzbGljZVVwbG9hZCgnLnBpY19pbnB1dCcsIGdldF9jb3NfaW1hZ2VfcGF0aCgpLCBwaWNfc3VjY2Vzc0NhbGxCYWNrLCBwaWNfZXJyb3JDYWxsQmFjayk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgZG9VcExvYWQoKTtcbiAgICB9XG59XG5cbi8v5qC45a+56KGo5Y2VXG5mdW5jdGlvbiBjaGVja0Jhbm5lckZvcm0oKSB7XG5cbiAgICBwYXJhbXMgPSB7fTsgLy/muIXnqbrkuYvliY3nmoTmlbDmja5cbiAgICBhbGxQYXJhbXMgPSB7fTtcblxuICAgIC8v6L2u5pKt5Zu+XG4gICAgdmFyIHBpY19pbnB1dCA9ICQoJy5waWNfaW5wdXQnKS52YWwoKTtcbiAgICBpZiAocGljX2lucHV0Lmxlbmd0aCAhPSAwKSB7XG4gICAgICAgIGlzRWRpdFBpY3R1cmUgPSB0cnVlO1xuICAgIH1cblxuICAgIC8v5Zu+54mH5ZCN56ewXG4gICAgdmFyIHJlc291cmNlX3RpdGxlID0gJCgnI3Jlc291cmNlX3RpdGxlJykudmFsKCkudHJpbSgpO1xuICAgIGlmIChyZXNvdXJjZV90aXRsZS5sZW5ndGggIT0gMCkge1xuICAgICAgICBwYXJhbXNbJ3RpdGxlJ10gPSByZXNvdXJjZV90aXRsZTtcbiAgICB9ZWxzZXtcbiAgICAgICAgYmFzZVV0aWxzLnNob3cuYmx1ZVRpcCgn5Zu+54mH5ZCN56ew5LiN6IO95Li656m677yBJyk7XG4gICAgICAgICQoJyNyZXNvdWNlX3RpdGxlJykuZm9jdXMoKTtcbiAgICB9XG5cbiAgICAvL+S4iuaetuaXtumXtFxuICAgIHZhciBzdGFydF90aW1lID0gJCgnI3N0YXJ0X3RpbWUnKS52YWwoKS50cmltKCk7XG4gICAgaWYgKHN0YXJ0X3RpbWUubGVuZ3RoICE9IDApIHtcbiAgICAgICAgcGFyYW1zWydzdGFydF9hdCddID0gc3RhcnRfdGltZTtcbiAgICB9XG4gICAgLy/kuIvmnrbml7bpl7RcbiAgICB2YXIgc3RvcF90aW1lID0gJCgnI3N0b3BfdGltZScpLnZhbCgpLnRyaW0oKTtcbiAgICBpZiAoc3RvcF90aW1lLmxlbmd0aCAhPSAwKSB7XG4gICAgICAgIGlmKHN0YXJ0X3RpbWU+c3RvcF90aW1lKXtcbiAgICAgICAgICAgIGJhc2VVdGlscy5zaG93LmJsdWVUaXAoJ+S4iuaetuaXtumXtOS4jeiDveaZmuS6juS4i+aetuaXtumXtO+8gScpO1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHBhcmFtc1snc3RvcF9hdCddID0gc3RvcF90aW1lO1xuICAgIH1cblxuICAgIC8v6Lez6L2s6ZO+5o6lXG4gICAgcGFyYW1zWydza2lwX3RhcmdldCddID0gJCgnI3N1Yl9zZWxlY3RvcicpLmZpbmQoJ29wdGlvbjpzZWxlY3RlZCcpLnZhbCgpO1xuICAgIHBhcmFtc1snc2tpcF90aXRsZSddID0gJCgnI3N1Yl9zZWxlY3RvcicpLmZpbmQoJ29wdGlvbjpzZWxlY3RlZCcpLnRleHQoKTtcbiAgICB2YXIgc2tpcF90eXBlID0gJCgnI3R5cGVfc2VsZWN0b3InKS5maW5kKCdvcHRpb246c2VsZWN0ZWQnKS52YWwoKTtcbiAgICBpZiAoc2tpcF90eXBlID09IFwiYXVkaW9cIikge1xuICAgICAgICBza2lwX3R5cGUgPSAyO1xuICAgIH0gZWxzZSBpZiAoc2tpcF90eXBlID09IFwidmlkZW9cIikge1xuICAgICAgICBza2lwX3R5cGUgPSAzO1xuICAgIH0gZWxzZSBpZiAoc2tpcF90eXBlID09IFwiaW1hZ2VfdGV4dFwiKSB7XG4gICAgICAgIHNraXBfdHlwZSA9IDE7XG4gICAgfSBlbHNlIGlmIChza2lwX3R5cGUgPT0gXCJhbGl2ZVwiKSB7XG4gICAgICAgIHNraXBfdHlwZSA9IDQ7XG4gICAgfSBlbHNlIGlmIChza2lwX3R5cGUgPT0gXCJwYWNrYWdlXCIpIHtcbiAgICAgICAgc2tpcF90eXBlID0gNjtcbiAgICB9IGVsc2UgaWYgKHNraXBfdHlwZSA9PSBcImg1XCIpIHtcbiAgICAgICAgc2tpcF90eXBlID0gNTtcbiAgICAgICAgcGFyYW1zWydza2lwX3RhcmdldCddID0gJCgnI3N1Yl9pbnB1dCcpLnZhbCgpLnRyaW0oKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBza2lwX3R5cGUgPSAwO1xuICAgIH1cbiAgICBwYXJhbXNbJ3NraXBfdHlwZSddID0gc2tpcF90eXBlO1xuXG4gICAgaWYgKHNraXBfdHlwZSA9PSAyIHx8IHNraXBfdHlwZSA9PSAzIHx8IHNraXBfdHlwZSA9PSAxIHx8IHNraXBfdHlwZSA9PSA0IHx8IHNraXBfdHlwZSA9PSA2KSB7XG4gICAgICAgIGlmIChwYXJhbXNbJ3NraXBfdGl0bGUnXSA9PSBcIlwiKSB7XG4gICAgICAgICAgICBiYXNlVXRpbHMuc2hvdy5ibHVlVGlwKFwi6K+36YCJ5oup6Lez6L2s6LWE5rqQ6ZO+5o6lIVwiKTtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8v5pi+56S66aG65bqPXG4gICAgdmFyIHZpZXdfb3JkZXIgPSAkKCcjdmlld19vcmRlcicpLmZpbmQoJ29wdGlvbjpzZWxlY3RlZCcpLnZhbCgpO1xuICAgIGlmICh2aWV3X29yZGVyID09IFwiZmlyc3RcIikge1xuICAgICAgICB2aWV3X29yZGVyID0gMTA7XG4gICAgfSBlbHNlIGlmICh2aWV3X29yZGVyID09IFwic2Vjb25kXCIpIHtcbiAgICAgICAgdmlld19vcmRlciA9IDk7XG4gICAgfSBlbHNlIGlmICh2aWV3X29yZGVyID09IFwidGhpcmRcIikge1xuICAgICAgICB2aWV3X29yZGVyID0gODtcbiAgICB9IGVsc2Uge1xuICAgICAgICB2aWV3X29yZGVyID0gMDtcbiAgICB9XG4gICAgcGFyYW1zWyd3ZWlnaHQnXSA9IHZpZXdfb3JkZXI7XG5cbiAgICBhbGxQYXJhbXNbJ3BhcmFtcyddID0gcGFyYW1zO1xuXG4gICAgLy/otYTmupBpZFxuICAgIGFsbFBhcmFtc1snaWQnXT0gJCgnI2RhdGEnKS5kYXRhKCdpZCcpO1xuXG4gICAgcmV0dXJuIHRydWU7XG5cbn1cblxuZnVuY3Rpb24gc2xpY2VVcGxvYWQoaWRlbnRpdHksIHJlbW90ZVBhdGgsIHN1Y2Nlc3NDYWxsQmFjaywgZXJyb3JDYWxsQmFjaykge1xuXG4gICAgLy/kuIrkvKAo55u05o6l6YCa6L+HanPkuIrkvKBjZG4pXG4gICAgdmFyIGZpbGVzID0gJChpZGVudGl0eSkucHJvcCgnZmlsZXMnKTtcbiAgICBpZiAoZmlsZXMgJiYgZmlsZXMubGVuZ3RoID09IDEpIHtcblxuICAgICAgICAvL+iOt+WPluaWh+S7tueahE1ENeWAvFxuICAgICAgICBicm93c2VyTUQ1RmlsZShmaWxlc1swXSwgZnVuY3Rpb24gKGVyciwgbWQ1KSB7XG4gICAgICAgICAgICAvL+iOt+WPluaWh+S7tuWGheWuueeahE1ENVxuICAgICAgICAgICAgY29uc29sZS5sb2coJ01ENTonICsgbWQ1KTtcbiAgICAgICAgICAgIC8v5Y+W5paH5Lu25ZCN5ZCO57yAXG4gICAgICAgICAgICB2YXIgZmlsZV9uYW1lID0gZmlsZXNbMF1bJ25hbWUnXTtcbiAgICAgICAgICAgIHZhciBuYW1lcyA9IGZpbGVfbmFtZS5zcGxpdCgnLicpO1xuICAgICAgICAgICAgdmFyIHN1ZmZpeCA9IG5hbWVzW25hbWVzLmxlbmd0aCAtIDFdO1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ3N1ZmZpeDonICsgc3VmZml4KTtcbiAgICAgICAgICAgIHJlbW90ZVBhdGggPSByZW1vdGVQYXRoICsgbWQ1ICsgXCIuXCIgKyBzdWZmaXg7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygncmVtb3RlUGF0aDonICsgcmVtb3RlUGF0aCk7XG4gICAgICAgICAgICAvL2Nvcy5vdXRfdXBsb2FkRmlsZShzdWNjZXNzQ2FsbEJhY2ssIGVycm9yQ2FsbEJhY2ssIGJ1Y2tldE5hbWUsIHJlbW90ZVBhdGgsIGZpbGVzWzBdLCAwKTtcbiAgICAgICAgICAgIGNvcy51cGxvYWRGaWxlV2l0aG91dFBybyhzdWNjZXNzQ2FsbEJhY2ssIGVycm9yQ2FsbEJhY2ssIHJlbW90ZVBhdGgsIGZpbGVzWzBdLCAwKTtcbiAgICAgICAgfSk7XG5cbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIGJhc2VVdGlscy5zaG93LnJlZFRpcChcIuivt+mAieaLqeS4gOS4quaWh+S7tlwiKTtcbiAgICB9XG5cbn1cblxuLy/phY3lm77miJDlip/kuIrkvKDlm57osINcbnZhciBwaWNfc3VjY2Vzc0NhbGxCYWNrID0gZnVuY3Rpb24gKHJlc3VsdCkge1xuXG4gICAgLy92YXIganNvblJlc3VsdCA9ICQucGFyc2VKU09OKHJlc3VsdCk7XG4gICAgY29uc29sZS5sb2coJ+WbvueJh+S4iuS8oOaIkOWKnyEnKTtcblxuICAgIC8v6I635Y+W5Yiw6LWE5rqQY2Ru6K6/6Zeu6L+e5o6lXG4gICAgdmFyIHBpY191cmwgPSByZXN1bHQuZGF0YS5hY2Nlc3NfdXJsO1xuICAgIGNvbnNvbGUubG9nKCflm77niYfpk77mjqUhJyArIHBpY191cmwpO1xuXG4gICAgcGFyYW1zWydpbWFnZV91cmwnXSA9IHBpY191cmw7XG5cbiAgICBhbGxQYXJhbXNbJ3BhcmFtcyddID0gcGFyYW1zO1xuXG4gICAgZG9VcExvYWQoKTtcbn07XG5cbi8v6LWE5rqQ6YWN5Zu+5aSx6LSl5LiK5Lyg5Zue6LCDXG52YXIgcGljX2Vycm9yQ2FsbEJhY2sgPSBmdW5jdGlvbiAocmVzdWx0KSB7XG4gICAgLy92YXIganNvblJlc3VsdCA9ICQucGFyc2VKU09OKHJlc3VsdCk7XG4gICAgaGlkZUxvYWRpbmcoKTtcbiAgICBiYXNlVXRpbHMuc2hvdy5yZWRUaXAoJ+mFjeWbvuS4iuS8oOWksei0pSHor7fph43mlrDkuIrkvKAhJyk7XG4gICAgdXBsb2FkRXJyb3JTaG93KHJlc3VsdC5yZXNwb25zZVRleHQpO1xufTtcblxuLy/kuIrkvKDmlbDmja7liLDoh6rlt7HlkI7lj7BcbmZ1bmN0aW9uIGRvVXBMb2FkKCl7XG4vL3dyaXRlT2JqKGFsbFBhcmFtcy5wYXJhbXMpO1xuICAgIC8v5LiK5Lyg6Iez5pyN5Yqh5ZmoXG4gICAgJC5wb3N0KCcvc2F2ZV9lZGl0X2Jhbm5lcicsIGFsbFBhcmFtcywgZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgICBoaWRlTG9hZGluZygpO1xuICAgICAgICB2YXIgY29kZSA9IHJlc3VsdC5jb2RlO1xuICAgICAgICB2YXIgbXNnID0gcmVzdWx0Lm1zZztcbiAgICAgICAgaWYgKGNvZGUgPT0gMCkge1xuICAgICAgICAgICAgYmFzZVV0aWxzLnNob3cuYmx1ZVRpcChcIuabtOaWsOaIkOWKnyFcIiwgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgdmFyIHJlX3VybCA9IEdldFF1ZXJ5U3RyaW5nKCdyZXVybCcpO1xuICAgICAgICAgICAgICAgIGlmKHJlX3VybCl7XG4gICAgICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gcmVfdXJsO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNle1xuICAgICAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9ICcvZ2V0QmFubmVyTGlzdCc7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBiYXNlVXRpbHMuc2hvdy5yZWRUaXAoXCLmm7TmlrDlpLHotKUhXCIpO1xuICAgICAgICAgICAgaWYoY29kZSA9PTEpe1xuICAgICAgICAgICAgICAgIHdpbmRvdy53eGMueGNDb25maXJtKG1zZysnLOivt+mHjeaWsOmAieaLqe+8gScsICdlcnJvcicsIHtidG46IHBhcnNlSW50KFwiMDAwMVwiLDIpLG9uT2s6ZnVuY3Rpb24oKXt9fSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9KTtcbn1cbiJdfQ==
