var $is_address_right=true;$(document).ready(function(){$.cookie("content_create")?setTopUrlInfo("content_create"):setTopUrlInfo("message_listop");bindElement();$("#sub_input.form-control").bind("input propertychange",function(){var e=document.getElementById("sub_input").value;if(e==""||!e.indexOf("http://")||!e.indexOf("https://")){$(".http_error_tip").addClass("hide");$is_address_right=true}else{$(".http_error_tip").removeClass("hide");$is_address_right=false}});$("#type_selector").change(function(){var e=$(this).children(":selected").val();if(e!=="h5"){$(".http_error_tip").addClass("hide");$(".modal-footer").css({margin:"45px 15px 0"}).css({padding:"30px 0px"});$is_address_right=true}else{$("#sub_input").val("")}});datetimepickerconfig("input[name='send_at']");function e(){var e=new Date;var t="-";var s=":";var i=e.getMonth()+1;var r=e.getDate();var n=e.getHours();var a=e.getMinutes();var o=e.getSeconds();if(i>=1&&i<=9){i="0"+i}if(r>=0&&r<=9){r="0"+r}if(n>=0&&n<=9){n="0"+n}if(a>=0&&a<=9){a="0"+a}if(o>=0&&o<=9){o="0"+o}var l=e.getFullYear()+t+i+t+r+" "+n+s+a+s+o;return l}var t=e();$("input[name='send_at']").val(t);$(".addButton").click(function(){var e=$("input[name='send_at']").val();var t=$("input[name='send_nick_name']").val();var s=$("textarea[name='content']").val();if(e.length==0){window.wxc.xcConfirm("请输入推送时间","error");return false}if(t.length==0){window.wxc.xcConfirm("请输入发送人昵称","error");return false}if(s.length==0){window.wxc.xcConfirm("请输入推送内容","error");return false}if(!$is_address_right){window.wxc.xcConfirm("外部链接输入有问题","error");return false}var i={};i["skip_target"]=$("#sub_selector").find("option:selected").val();i["skip_title"]=$("#sub_selector").find("option:selected").text();var r=$("#type_selector").find("option:selected").val();if($("#message_selector").length>0){i["message_audio"]=$("#message_selector").find("option:selected").val()}else{i["message_audio"]=""}if(r=="audio"){r=2}else if(r=="video"){r=3}else if(r=="alive"){r=7}else if(r=="image_text"){r=1}else if(r=="package"){r=6}else if(r=="h5"){r=5;i["skip_target"]=$("#sub_input").val().trim()}else{r=0;i["skip_target"]=""}i["skip_type"]=r;if(r==2||r==3||r==7||r==1||r==6){if(i["skip_title"]==""){baseUtils.show.blueTip("请选择跳转资源链接!");return false}}i["skip_title"]=$("#url_title").val();$.post("/messagesave",{sendAt:e,sendNickName:t,content:s,params:i},function(e){if(e.ret==0){window.wxc.xcConfirm("推送成功","success");setTimeout(function(){window.location.href="/message"},2e3)}else{window.wxc.xcConfirm("系统繁忙，请稍后再试","error")}})})});function bindElement(){$("#type_selector").on("change",function(){var e=$(this).find("option:selected").val();if(e=="h5"){$("#sub_selector").empty();$("#sub_selector").addClass("hide");$("#sub_input").removeClass("hide");return}else if(e=="no_jump"){$("#sub_selector").empty();$("#sub_selector").removeClass("hide");$("#sub_input").addClass("hide");return}else{$("#sub_selector").empty();$("#sub_selector").removeClass("hide");$("#sub_input").addClass("hide")}$.get("/banner/getResourceList?type="+e,function(e){$("#sub_selector").empty();e=JSON.parse(e);var t=e.length;var s="";for(var i=0;i<t;i++){s+="<option value='"+e[i].id+"'>"+e[i].title+"</option>"}$("#sub_selector").append(s)})})}
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFkbWluL21lc3NhZ2VBZGQuanMiXSwibmFtZXMiOlsiJGlzX2FkZHJlc3NfcmlnaHQiLCIkIiwiZG9jdW1lbnQiLCJyZWFkeSIsImNvb2tpZSIsInNldFRvcFVybEluZm8iLCJiaW5kRWxlbWVudCIsImJpbmQiLCJpbnB1dF9hZGRyZXNzIiwiZ2V0RWxlbWVudEJ5SWQiLCJ2YWx1ZSIsImluZGV4T2YiLCJhZGRDbGFzcyIsInJlbW92ZUNsYXNzIiwiY2hhbmdlIiwic2tpcF90eXBlIiwidGhpcyIsImNoaWxkcmVuIiwidmFsIiwiY3NzIiwibWFyZ2luIiwicGFkZGluZyIsImRhdGV0aW1lcGlja2VyY29uZmlnIiwiZ2V0Tm93Rm9ybWF0RGF0ZSIsImRhdGUiLCJEYXRlIiwic2VwZXJhdG9yMSIsInNlcGVyYXRvcjIiLCJtb250aCIsImdldE1vbnRoIiwiZGF5IiwiZ2V0RGF0ZSIsImhvdXIiLCJnZXRIb3VycyIsIm1pbnV0ZSIsImdldE1pbnV0ZXMiLCJzZWNvbmQiLCJnZXRTZWNvbmRzIiwiY3VycmVudGRhdGUiLCJnZXRGdWxsWWVhciIsIm5vdyIsImNsaWNrIiwic2VuZEF0Iiwic2VuZE5pY2tOYW1lIiwiY29udGVudCIsImxlbmd0aCIsIndpbmRvdyIsInd4YyIsInhjQ29uZmlybSIsInBhcmFtcyIsImZpbmQiLCJ0ZXh0IiwidHJpbSIsImJhc2VVdGlscyIsInNob3ciLCJibHVlVGlwIiwicG9zdCIsImRhdGEiLCJyZXQiLCJzZXRUaW1lb3V0IiwibG9jYXRpb24iLCJocmVmIiwib24iLCJ0eXBlIiwiZW1wdHkiLCJnZXQiLCJyZXN1bHQiLCJKU09OIiwicGFyc2UiLCJjb3VudCIsImh0bWxTdHIiLCJpIiwiaWQiLCJ0aXRsZSIsImFwcGVuZCJdLCJtYXBwaW5ncyI6IkFBS0EsR0FBSUEsbUJBQW9CLElBRXhCQyxHQUFFQyxVQUFVQyxNQUFNLFdBR2RGLEVBQUVHLE9BQU8sa0JBQW1CQyxjQUFjLGtCQUFvQkEsY0FBYyxpQkFVNUVDLGNBR0FMLEdB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RWdFLElBQUksZ0NBQWtDRixFQUFPLFNBQVVHLEdBQ3JEakUsRUFBRSxpQkFBaUIrRCxPQUNuQkUsR0FBU0MsS0FBS0MsTUFBTUYsRUFFcEIsSUFBSUcsR0FBUUgsRUFBT3JCLE1BRW5CLElBQUl5QixHQUFVLEVBRWQsS0FBSyxHQUFJQyxHQUFJLEVBQUdBLEVBQUlGLEVBQU9FLElBQUssQ0FDNUJELEdBQVMsa0JBQWtCSixFQUFPSyxHQUFHQyxHQUFHLEtBQUtOLEVBQU9LLEdBQUdFLE1BQU0sWUFFakV4RSxFQUFFLGlCQUFpQnlFLE9BQU9KIiwiZmlsZSI6ImFkbWluL21lc3NhZ2VBZGQuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICogQ3JlYXRlZCBieSBTdHVwaGluIG9uIDIwMTYvOS8zMC5cclxuICovXHJcblxyXG4vLyDovpPlhaXnvZHlnYDmmK/lkKbmraPnoa5cclxudmFyICRpc19hZGRyZXNzX3JpZ2h0ID0gdHJ1ZTtcclxuXHJcbiQoZG9jdW1lbnQpLnJlYWR5KGZ1bmN0aW9uKClcclxue1xyXG5cclxuICAgICQuY29va2llKCdjb250ZW50X2NyZWF0ZScpPyBzZXRUb3BVcmxJbmZvKCdjb250ZW50X2NyZWF0ZScpIDogc2V0VG9wVXJsSW5mbygnbWVzc2FnZV9saXN0b3AnKTtcclxuICAgIC8vLy/liJ3lp4vljJbml7bpl7TpgInmi6nlmahcclxuICAgIC8vJChcImlucHV0W25hbWU9J3NlbmRfYXQnXVwiKS5kYXRldGltZXBpY2tlcih7XHJcbiAgICAvLyAgICAvL+WIneWni+WMluaXtumXtOmAieaLqeWZqFxyXG4gICAgLy8gICAgc3RhcnREYXRlOm5ldyBEYXRlKCksXHJcbiAgICAvLyAgICB3ZWVrU3RhcnQ6IDEsXHJcbiAgICAvLyAgICBtaW5WaWV3OiBcImRheVwiLFxyXG4gICAgLy8gICAgYXV0b2Nsb3NlOiB0cnVlLy/pgInmi6nml6XmnJ/lkI7oh6rliqjlhbPpl61cclxuICAgIC8vfSk7XHJcblxyXG4gICAgYmluZEVsZW1lbnQoKTtcclxuXHJcbiAgICAvKuajgOa1i+WklumTvue9keWdgOeahOi+k+WFpemUmeivr+aXtu+8jOa3u+WKoOaWh+Wtl+aPkOmGkiovXHJcbiAgICAkKCcjc3ViX2lucHV0LmZvcm0tY29udHJvbCcpLmJpbmQoJ2lucHV0IHByb3BlcnR5Y2hhbmdlJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdmFyIGlucHV0X2FkZHJlc3MgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInN1Yl9pbnB1dFwiKS52YWx1ZTtcclxuICAgICAgICBpZiAoaW5wdXRfYWRkcmVzcyA9PSAnJyB8fCAhaW5wdXRfYWRkcmVzcy5pbmRleE9mKFwiaHR0cDovL1wiKSB8fCAhaW5wdXRfYWRkcmVzcy5pbmRleE9mKFwiaHR0cHM6Ly9cIikpIHtcclxuICAgICAgICAgICAgLy8g572R5Z2A5q2j56GuXHJcbiAgICAgICAgICAgICQoJy5odHRwX2Vycm9yX3RpcCcpLmFkZENsYXNzKFwiaGlkZVwiKTtcclxuICAgICAgICAgICAgJGlzX2FkZHJlc3NfcmlnaHQgPSB0cnVlO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIC8vIOe9keWdgOmUmeivr1xyXG4gICAgICAgICAgICAkKCcuaHR0cF9lcnJvcl90aXAnKS5yZW1vdmVDbGFzcyhcImhpZGVcIik7XHJcbiAgICAgICAgICAgICRpc19hZGRyZXNzX3JpZ2h0ID0gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcbiAgICAkKFwiI3R5cGVfc2VsZWN0b3JcIikuY2hhbmdlKGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgdmFyIHNraXBfdHlwZSA9ICQodGhpcykuY2hpbGRyZW4oXCI6c2VsZWN0ZWRcIikudmFsKCk7XHJcbiAgICAgICAgaWYgKHNraXBfdHlwZSAhPT0gJ2g1Jyl7XHJcbiAgICAgICAgICAgIC8vIOe9keWdgOato+ehrlxyXG4gICAgICAgICAgICAkKCcuaHR0cF9lcnJvcl90aXAnKS5hZGRDbGFzcyhcImhpZGVcIik7XHJcbiAgICAgICAgICAgICQoXCIubW9kYWwtZm9vdGVyXCIpLmNzcyh7XCJtYXJnaW5cIjpcIjQ1cHggMTVweCAwXCJ9KS5jc3Moe1wicGFkZGluZ1wiOlwiMzBweCAwcHhcIn0pO1xyXG4gICAgICAgICAgICAkaXNfYWRkcmVzc19yaWdodCA9IHRydWU7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgJChcIiNzdWJfaW5wdXRcIikudmFsKFwiXCIpO1xyXG4gICAgICAgIH1cclxuICAgIH0pXHJcblxyXG4gICAgZGF0ZXRpbWVwaWNrZXJjb25maWcoXCJpbnB1dFtuYW1lPSdzZW5kX2F0J11cIik7XHJcblxyXG4gICAgLy/ojrflj5blvZPliY3ml7bpl7RcclxuICAgIGZ1bmN0aW9uIGdldE5vd0Zvcm1hdERhdGUoKSB7XHJcbiAgICAgICAgdmFyIGRhdGUgPSBuZXcgRGF0ZSgpO1xyXG4gICAgICAgIHZhciBzZXBlcmF0b3IxID0gXCItXCI7XHJcbiAgICAgICAgdmFyIHNlcGVyYXRvcjIgPSBcIjpcIjtcclxuICAgICAgICB2YXIgbW9udGggPSBkYXRlLmdldE1vbnRoKCkgKyAxO1xyXG4gICAgICAgIHZhciBkYXkgPSBkYXRlLmdldERhdGUoKTtcclxuICAgICAgICB2YXIgaG91cj1kYXRlLmdldEhvdXJzKCk7XHJcbiAgICAgICAgdmFyIG1pbnV0ZT1kYXRlLmdldE1pbnV0ZXMoKTtcclxuICAgICAgICB2YXIgc2Vjb25kPWRhdGUuZ2V0U2Vjb25kcygpO1xyXG4gICAgICAgIGlmIChtb250aCA+PSAxICYmIG1vbnRoIDw9IDkpIHtcclxuICAgICAgICAgICAgbW9udGggPSBcIjBcIiArIG1vbnRoO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoZGF5ID49IDAgJiYgZGF5IDw9IDkpIHtcclxuICAgICAgICAgICAgZGF5ID0gXCIwXCIgKyBkYXk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChob3VyID49IDAgJiYgaG91ciA8PSA5KSB7XHJcbiAgICAgICAgICAgIGhvdXIgPSBcIjBcIiArIGhvdXI7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChtaW51dGUgPj0gMCAmJiBtaW51dGUgPD0gOSkge1xyXG4gICAgICAgICAgICBtaW51dGUgPSBcIjBcIiArIG1pbnV0ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHNlY29uZCA+PSAwICYmIHNlY29uZCA8PSA5KSB7XHJcbiAgICAgICAgICAgIHNlY29uZCA9IFwiMFwiICsgc2Vjb25kO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgY3VycmVudGRhdGUgPSBkYXRlLmdldEZ1bGxZZWFyKCkgKyBzZXBlcmF0b3IxICsgbW9udGggKyBzZXBlcmF0b3IxICsgZGF5XHJcbiAgICAgICAgICAgICsgXCIgXCIgKyBob3VyICsgc2VwZXJhdG9yMiArIG1pbnV0ZSArIHNlcGVyYXRvcjIgKyBzZWNvbmQ7XHJcbiAgICAgICAgcmV0dXJuIGN1cnJlbnRkYXRlO1xyXG4gICAgfVxyXG4gICAgdmFyIG5vdz1nZXROb3dGb3JtYXREYXRlKCk7XHJcbiAgICAkKFwiaW5wdXRbbmFtZT0nc2VuZF9hdCddXCIpLnZhbChub3cpO1xyXG5cclxuICAgIC8v5o6o6YCB5oyJ6ZKuXHJcbiAgICAkKFwiLmFkZEJ1dHRvblwiKS5jbGljayhmdW5jdGlvbigpXHJcbiAgICB7XHJcblxyXG5cclxuICAgICAgICB2YXIgc2VuZEF0PSQoXCJpbnB1dFtuYW1lPSdzZW5kX2F0J11cIikudmFsKCk7XHJcbiAgICAgICAgdmFyIHNlbmROaWNrTmFtZT0kKFwiaW5wdXRbbmFtZT0nc2VuZF9uaWNrX25hbWUnXVwiKS52YWwoKTtcclxuICAgICAgICB2YXIgY29udGVudD0kKFwidGV4dGFyZWFbbmFtZT0nY29udGVudCddXCIpLnZhbCgpO1xyXG4gICAgICAgIC8v5qCh6aqMXHJcbiAgICAgICAgaWYoc2VuZEF0Lmxlbmd0aCA9PSAwKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgd2luZG93Lnd4Yy54Y0NvbmZpcm0oXCLor7fovpPlhaXmjqjpgIHml7bpl7RcIixcImVycm9yXCIpO1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmKHNlbmROaWNrTmFtZS5sZW5ndGggPT0gMClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHdpbmRvdy53eGMueGNDb25maXJtKFwi6K+36L6T5YWl5Y+R6YCB5Lq65pi156ewXCIsXCJlcnJvclwiKTtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZihjb250ZW50Lmxlbmd0aCA9PSAwKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgd2luZG93Lnd4Yy54Y0NvbmZpcm0oXCLor7fovpPlhaXmjqjpgIHlhoXlrrlcIixcImVycm9yXCIpO1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICghJGlzX2FkZHJlc3NfcmlnaHQpIHtcclxuICAgICAgICAgICAgd2luZG93Lnd4Yy54Y0NvbmZpcm0oJ+WklumDqOmTvuaOpei+k+WFpeaciemXrumimCcsJ2Vycm9yJyk7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8v6Lez6L2s6ZO+5o6lXHJcbiAgICAgICAgdmFyIHBhcmFtcyA9IHt9O1xyXG4gICAgICAgIHBhcmFtc1snc2tpcF90YXJnZXQnXSA9ICQoJyNzdWJfc2VsZWN0b3InKS5maW5kKCdvcHRpb246c2VsZWN0ZWQnKS52YWwoKTtcclxuICAgICAgICBwYXJhbXNbJ3NraXBfdGl0bGUnXSA9ICQoJyNzdWJfc2VsZWN0b3InKS5maW5kKCdvcHRpb246c2VsZWN0ZWQnKS50ZXh0KCk7XHJcbiAgICAgICAgdmFyIHNraXBfdHlwZSA9ICQoJyN0eXBlX3NlbGVjdG9yJykuZmluZCgnb3B0aW9uOnNlbGVjdGVkJykudmFsKCk7XHJcblxyXG4gICAgICAgIGlmKCQoJyNtZXNzYWdlX3NlbGVjdG9yJykubGVuZ3RoPjApe1xyXG4gICAgICAgICAgICBwYXJhbXNbJ21lc3NhZ2VfYXVkaW8nXSA9ICQoJyNtZXNzYWdlX3NlbGVjdG9yJykuZmluZCgnb3B0aW9uOnNlbGVjdGVkJykudmFsKCk7XHJcbiAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgIHBhcmFtc1snbWVzc2FnZV9hdWRpbyddID0gJyc7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoc2tpcF90eXBlID09IFwiYXVkaW9cIikge1xyXG4gICAgICAgICAgICBza2lwX3R5cGUgPSAyO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoc2tpcF90eXBlID09IFwidmlkZW9cIikge1xyXG4gICAgICAgICAgICBza2lwX3R5cGUgPSAzO1xyXG4gICAgICAgIH0gZWxzZSBpZihza2lwX3R5cGUgPT0gXCJhbGl2ZVwiKXtcclxuICAgICAgICAgICAgc2tpcF90eXBlID0gNztcclxuICAgICAgICB9IGVsc2UgaWYgKHNraXBfdHlwZSA9PSBcImltYWdlX3RleHRcIikge1xyXG4gICAgICAgICAgICBza2lwX3R5cGUgPSAxO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoc2tpcF90eXBlID09IFwicGFja2FnZVwiKSB7XHJcbiAgICAgICAgICAgIHNraXBfdHlwZSA9IDY7XHJcbiAgICAgICAgfWVsc2UgaWYgKHNraXBfdHlwZSA9PSBcImg1XCIpIHtcclxuICAgICAgICAgICAgc2tpcF90eXBlID0gNTtcclxuICAgICAgICAgICAgcGFyYW1zWydza2lwX3RhcmdldCddID0gJCgnI3N1Yl9pbnB1dCcpLnZhbCgpLnRyaW0oKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBza2lwX3R5cGUgPSAwO1xyXG4gICAgICAgICAgICBwYXJhbXNbJ3NraXBfdGFyZ2V0J10gPSAnJztcclxuICAgICAgICB9XHJcbiAgICAgICAgcGFyYW1zWydza2lwX3R5cGUnXSA9IHNraXBfdHlwZTtcclxuXHJcbiAgICAgICAgaWYgKHNraXBfdHlwZSA9PSAyIHx8IHNraXBfdHlwZSA9PSAzIHx8IHNraXBfdHlwZSA9PSA3IHx8IHNraXBfdHlwZSA9PSAxIHx8IHNraXBfdHlwZSA9PTYpIHtcclxuICAgICAgICAgICAgaWYgKHBhcmFtc1snc2tpcF90aXRsZSddID09IFwiXCIpIHtcclxuICAgICAgICAgICAgICAgIGJhc2VVdGlscy5zaG93LmJsdWVUaXAoXCLor7fpgInmi6not7PovazotYTmupDpk77mjqUhXCIpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHBhcmFtc1snc2tpcF90aXRsZSddID0gJCgnI3VybF90aXRsZScpLnZhbCgpO1xyXG4gICAgICAgIC8vIGNvbnNvbGUubG9nKHBhcmFtcyk7XHJcbiAgICAgICAgLy8gcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICQucG9zdCgnL21lc3NhZ2VzYXZlJyx7XCJzZW5kQXRcIjpzZW5kQXQsXCJzZW5kTmlja05hbWVcIjpzZW5kTmlja05hbWUsXCJjb250ZW50XCI6Y29udGVudCwncGFyYW1zJzpwYXJhbXN9LGZ1bmN0aW9uKGRhdGEpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBpZihkYXRhLnJldCA9PSAwKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICB3aW5kb3cud3hjLnhjQ29uZmlybShcIuaOqOmAgeaIkOWKn1wiLFwic3VjY2Vzc1wiKTtcclxuICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmPVwiL21lc3NhZ2VcIjtcclxuICAgICAgICAgICAgICAgIH0sMjAwMCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICB3aW5kb3cud3hjLnhjQ29uZmlybShcIuezu+e7n+e5geW/me+8jOivt+eojeWQjuWGjeivlVwiLFwiZXJyb3JcIik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxufSk7XHJcblxyXG5mdW5jdGlvbiBiaW5kRWxlbWVudCgpIHtcclxuICAgICQoXCIjdHlwZV9zZWxlY3RvclwiKS5vbignY2hhbmdlJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdmFyIHR5cGUgPSAkKHRoaXMpLmZpbmQoJ29wdGlvbjpzZWxlY3RlZCcpLnZhbCgpO1xyXG5cclxuICAgICAgICBpZiAodHlwZSA9PSAnaDUnKSB7XHJcbiAgICAgICAgICAgICQoJyNzdWJfc2VsZWN0b3InKS5lbXB0eSgpO1xyXG4gICAgICAgICAgICAkKCcjc3ViX3NlbGVjdG9yJykuYWRkQ2xhc3MoJ2hpZGUnKTtcclxuICAgICAgICAgICAgJCgnI3N1Yl9pbnB1dCcpLnJlbW92ZUNsYXNzKCdoaWRlJyk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9IGVsc2UgaWYgKHR5cGUgPT0gJ25vX2p1bXAnKSB7XHJcbiAgICAgICAgICAgICQoJyNzdWJfc2VsZWN0b3InKS5lbXB0eSgpO1xyXG4gICAgICAgICAgICAkKCcjc3ViX3NlbGVjdG9yJykucmVtb3ZlQ2xhc3MoJ2hpZGUnKTtcclxuICAgICAgICAgICAgJCgnI3N1Yl9pbnB1dCcpLmFkZENsYXNzKCdoaWRlJyk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAkKCcjc3ViX3NlbGVjdG9yJykuZW1wdHkoKTtcclxuICAgICAgICAgICAgJCgnI3N1Yl9zZWxlY3RvcicpLnJlbW92ZUNsYXNzKCdoaWRlJyk7XHJcbiAgICAgICAgICAgICQoJyNzdWJfaW5wdXQnKS5hZGRDbGFzcygnaGlkZScpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgJC5nZXQoJy9iYW5uZXIvZ2V0UmVzb3VyY2VMaXN0P3R5cGU9JyArIHR5cGUgLCBmdW5jdGlvbiAocmVzdWx0KSB7XHJcbiAgICAgICAgICAgICQoJyNzdWJfc2VsZWN0b3InKS5lbXB0eSgpO1xyXG4gICAgICAgICAgICByZXN1bHQgPSBKU09OLnBhcnNlKHJlc3VsdCk7XHJcblxyXG4gICAgICAgICAgICB2YXIgY291bnQgPSByZXN1bHQubGVuZ3RoO1xyXG5cclxuICAgICAgICAgICAgdmFyIGh0bWxTdHIgPSBcIlwiO1xyXG5cclxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjb3VudDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICBodG1sU3RyKz1cIjxvcHRpb24gdmFsdWU9J1wiK3Jlc3VsdFtpXS5pZCtcIic+XCIrcmVzdWx0W2ldLnRpdGxlK1wiPC9vcHRpb24+XCI7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgJCgnI3N1Yl9zZWxlY3RvcicpLmFwcGVuZChodG1sU3RyKTtcclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG59Il19
