var sms_name;var sms_content;var model_id;var needRefresh=false;var $is_address_right=true;$(document).ready(function(){refresh();initMsgModel();bindElement();$("#searchUser").click(function(){showLoading();var e=$("select[name='is_pay']").val();var t=$("select[name='ruler']").val();var s=$.trim($("#searchContent").val());window.location.href="/customer?is_pay="+e+"&ruler="+t+"&search="+s});$("#searchContent").keypress(function(e){if(e.which==13){$("#searchUser").click()}});$("select[name='is_pay']").on("change",function(){$("#searchUser").click()});checkUrl()});function jumpDetail(e){var e=e;var t=e.split("|")[0];var s=e.split("|")[1];window.location.href="/customerdetail?appId="+t+"&userId="+s}function jumpMsg(e){var e=e;var t=e.split("|")[0];var s=e.split("|")[1];$("#SmsModal").modal("show");document.getElementById("link_type_selector")[0].selected=true;$("#skip_target_selector").empty();$("#skip_target_selector").addClass("hide");$("#skip_target_input").removeClass("hide");$(".modal-footer").children("button").eq(0).unbind("click").bind("click",function(){var e=$("#sms_nickname").val();var i=$("#sms_content").val();if(e.length==0){$.alert("亲，还未输入发送人昵称哦~","error",{btn:2});return false}if(i.length==0){$.alert("亲，还未输入消息内容哦~","error",{btn:2});return false}if(!$is_address_right){$.alert("亲，外部链接输入有问题哦~","error",{btn:2});return false}$("#SmsModal").modal("hide");showLoading();var r={};var a=$("#link_type_selector").find("option:selected").val();if(a=="audio"){a=2}else if(a=="video"){a=3}else if(a=="image_text"){a=1}else if(a=="alive"){a=7}else if(a=="package"){a=6}else if(a=="h5"){a=5}else{a=0}r["skip_type"]=a;if(a==5){r["skip_target"]=$("#skip_target_input").val().trim()}else if(a==0){r["skip_target"]=""}else{r["skip_target"]=$("#skip_target_selector").find("option:selected").val()}if(a==2||a==3||a==1||a==6){if(r["skip_target"]==""){baseUtils.show.blueTip("请选择跳转资源链接!");return false}}if(a!=0){r["skip_title"]=$("#link_name").val()}else{r["skip_title"]=""}$.post("/customermsg",{appId:t,userId:s,nickname:e,content:i,params:r},function(e){hideLoading();if(e.ret==0){baseUtils.show.blueTip("发送成功!",function(){window.location.reload()})}else{window.wxc.xcConfirm("系统繁忙，请稍后再试!","error")}})})}function initMsgModel(){$(".model_type").on("click",function(){$(".model_type").removeClass("border_blue");$(this).addClass("border_blue");$("#sms_nickname").val($(this).attr("data-name"));$("#sms_content").val($(this).attr("data-content"));if($("#cancel_model").hasClass("border_blue")){$(".edit_model").addClass("hide");$(".model_type").removeClass("border_blue")}model_id=$(this).attr("data-id");sms_name=$(this).attr("data-name");sms_content=$(this).attr("data-content")});$("#sms_content").keyup(function(){if($(".border_blue").length>0){$(".edit_model").removeClass("hide")}});$("#sms_nickname").keyup(function(){if($(".border_blue").length>0){$(".edit_model").removeClass("hide")}});$(".edit_model").on("click",function(){model_id=$(".border_blue").attr("data-id");var e=$("#sms_nickname").val();var t=$("#sms_content").val();if(model_id==""){model_id=0;if(e!=""&&t!=""){console.log("新增模板："+model_id+">>"+e+">>"+t)}else{baseUtils.show.redTip("您的发送人昵称/内容为空");return}}else{if(e!=""&&t!=""){console.log("更新模板："+model_id+">>"+e+">>"+t)}else{baseUtils.show.redTip("您的发送人昵称/内容为空");return}}if(e==sms_name&&t==sms_content){baseUtils.show.redTip("您没有做任何模板修改")}else{showLoading();var s="/modelchange";$.post(s,{model_id:model_id,send_nick_name:e,content:t},function(s){hideLoading();console.log(s);var i=s.code;var r=s.msg;baseUtils.show.blueTip(r);if(i==0){$(".border_blue").attr("data-id",s.id);$(".border_blue").attr("data-name",e);$(".border_blue").attr("data-content",t);needRefresh=true}else if(i==1){console.log(s.errorMsg)}else if(i==2){$(".border_blue").attr("data-name",e);$(".border_blue").attr("data-content",t);needRefresh=true}})}})}function refresh(){$("#SmsModal").on("hide.bs.modal",function(){if(needRefresh){location.reload()}})}function bindElement(){$("#link_type_selector").on("change",function(){var e=$(this).find("option:selected").val();if(e=="h5"){$("#skip_target_selector").empty();$("#skip_target_selector").addClass("hide");$("#skip_target_input").removeClass("hide");return}else if(e=="no_jump"){$("#skip_target_selector").empty();$("#skip_target_selector").removeClass("hide");$("#skip_target_input").addClass("hide");return}else{$("#skip_target_selector").empty();$("#skip_target_selector").removeClass("hide");$("#skip_target_input").addClass("hide")}$.get("/banner/getResourceList?type="+e,function(e){$("#skip_target_selector").empty();e=JSON.parse(e);var t=e.length;var s="";for(var i=0;i<t;i++){s+="<option value='"+e[i].id+"'>"+e[i].title+"</option>"}$("#skip_target_selector").append(s)})})}function checkUrl(){$("#skip_target_input.form-control").bind("input propertychange",function(){var e=document.getElementById("skip_target_input").value;if(e==""||!e.indexOf("http://")||!e.indexOf("https://")){$(".http_error_tip").addClass("hide");$(".modal-footer").css({margin:"45px 15px 0"}).css({padding:"30px 0px"});$is_address_right=true}else{$(".http_error_tip").removeClass("hide");$(".modal-footer").css({margin:"0 15px 0"}).css({padding:"15px 0 0 30px"});$is_address_right=false}});$("#link_type_selector").change(function(){var e=$(this).children(":selected").val();if(e!=="h5"){$(".http_error_tip").addClass("hide");$(".modal-footer").css({margin:"45px 15px 0"}).css({padding:"30px 0px"});$is_address_right=true}else{$("#skip_target_input").val("")}})}
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFkbWluL2N1c3RvbWVyLmpzIl0sIm5hbWVzIjpbInNtc19uYW1lIiwic21zX2NvbnRlbnQiLCJtb2RlbF9pZCIsIm5lZWRSZWZyZXNoIiwiJGlzX2FkZHJlc3NfcmlnaHQiLCIkIiwiZG9jdW1lbnQiLCJyZWFkeSIsInJlZnJlc2giLCJpbml0TXNnTW9kZWwiLCJiaW5kRWxlbWVudCIsImNsaWNrIiwic2hvd0xvYWRpbmciLCJpc19wYXkiLCJ2YWwiLCJydWxlciIsInNlYXJjaCIsInRyaW0iLCJ3aW5kb3ciLCJsb2NhdGlvbiIsImhyZWYiLCJrZXlwcmVzcyIsImUiLCJ3aGljaCIsIm9uIiwiY2hlY2tVcmwiLCJqdW1wRGV0YWlsIiwiaW5mbyIsImFwcElkIiwic3BsaXQiLCJ1c2VySWQiLCJqdW1wTXNnIiwibW9kYWwiLCJnZXRFbGVtZW50QnlJZCIsInNlbGVjdGVkIiwiZW1wdHkiLCJhZGRDbGFzcyIsInJlbW92ZUNsYXNzIiwiY2hpbGRyZW4iLCJlcSIsInVuYmluZCIsImJpbmQiLCJuaWNrbmFtZSIsImNvbnRlbnQiLCJsZW5ndGgiLCJhbGVydCIsImJ0biIsInBhcmFtcyIsInNraXBfdHlwZSIsImZpbmQiLCJiYXNlVXRpbHMiLCJzaG93IiwiYmx1ZVRpcCIsInBvc3QiLCJkYXRhIiwiaGlkZUxvYWRpbmciLCJyZXQiLCJyZWxvYWQiLCJ3eGMiLCJ4Y0NvbmZpcm0iLCJ0aGlzIiwiYXR0ciIsImhhc0NsYXNzIiwia2V5dXAiLCJuYW1lIiwiY29uc29sZSIsImxvZyIsInJlZFRpcCIsInVybCIsInNlbmRfbmlja19uYW1lIiwicmVzdWx0IiwiUmVDb2RlIiwiY29kZSIsIm1zZyIsImlkIiwiZXJyb3JNc2ciLCJ0eXBlIiwiZ2V0IiwiSlNPTiIsInBhcnNlIiwiY291bnQiLCJodG1sU3RyIiwiaSIsInRpdGxlIiwiYXBwZW5kIiwiaW5wdXRfYWRkcmVzcyIsInZhbHVlIiwiaW5kZXhPZiIsImNzcyIsIm1hcmdpbiIsInBhZGRpbmciLCJjaGFuZ2Ui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Z0JELEtBQUtFLFFBQVcsWUFDbEV0RixtQkFBb0IsU0FDakIsQ0FFSEMsRUFBRSxtQkFBbUJnQyxZQUFZLE9BQ2pDaEMsR0FBRSxpQkFBaUJtRixLQUFLQyxPQUFVLGFBQWFELEtBQUtFLFFBQVcsaUJBQy9EdEYsbUJBQW9CLFFBRzVCQyxHQUFFLHVCQUF1QnNGLE9BQU8sV0FDNUIsR0FBSTNDLEdBQVkzQyxFQUFFdUQsTUFBTXRCLFNBQVMsYUFBYXhCLEtBQzlDLElBQUlrQyxJQUFjLEtBQU0sQ0FFcEIzQyxFQUFFLG1CQUFtQitCLFNBQVMsT0FDOUIvQixHQUFFLGlCQUFpQm1GLEtBQUtDLE9BQVUsZ0JBQWdCRCxLQUFLRSxRQUFXLFlBQ2xFdEYsbUJBQW9CLFNBQ2pCLENBQ0hDLEVBQUUsc0JBQXNCUyxJQUFJIiwiZmlsZSI6ImFkbWluL2N1c3RvbWVyLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIENyZWF0ZWQgYnkgU3R1cGhpbiBvbiAyMDE2LzkvMjguXHJcbiAqL1xyXG5cclxudmFyIHNtc19uYW1lO1xyXG52YXIgc21zX2NvbnRlbnQ7XHJcbnZhciBtb2RlbF9pZDtcclxudmFyIG5lZWRSZWZyZXNoID0gZmFsc2U7XHJcbi8vIOi+k+WFpee9keWdgOaYr+WQpuato+ehrlxyXG52YXIgJGlzX2FkZHJlc3NfcmlnaHQgPSB0cnVlO1xyXG5cclxuJChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24oKSB7XHJcblxyXG4gICAgcmVmcmVzaCgpO1xyXG5cclxuICAgIGluaXRNc2dNb2RlbCgpO1xyXG5cclxuICAgIGJpbmRFbGVtZW50KCk7XHJcblxyXG4gICAgLy/mkJzntKJcclxuICAgICQoXCIjc2VhcmNoVXNlclwiKS5jbGljayhmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgc2hvd0xvYWRpbmcoKTtcclxuICAgICAgICB2YXIgaXNfcGF5ID0gJChcInNlbGVjdFtuYW1lPSdpc19wYXknXVwiKS52YWwoKTtcclxuICAgICAgICB2YXIgcnVsZXIgPSAkKFwic2VsZWN0W25hbWU9J3J1bGVyJ11cIikudmFsKCk7XHJcbiAgICAgICAgdmFyIHNlYXJjaCA9ICQudHJpbSgkKFwiI3NlYXJjaENvbnRlbnRcIikudmFsKCkpO1xyXG4gICAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmPVwiL2N1c3RvbWVyP2lzX3BheT1cIitpc19wYXkrXCImcnVsZXI9XCIrcnVsZXIrXCImc2VhcmNoPVwiK3NlYXJjaDtcclxuICAgIH0pO1xyXG5cclxuICAgIC8v5Zue6L2m5pCc57SiXHJcbiAgICAkKFwiI3NlYXJjaENvbnRlbnRcIikua2V5cHJlc3MoZnVuY3Rpb24oZSkge1xyXG4gICAgICAgIGlmKGUud2hpY2ggPT0gMTMpIHtcclxuICAgICAgICAgICAgJCgnI3NlYXJjaFVzZXInKS5jbGljaygpO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgICQoXCJzZWxlY3RbbmFtZT0naXNfcGF5J11cIikub24oXCJjaGFuZ2VcIiwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICQoJyNzZWFyY2hVc2VyJykuY2xpY2soKTtcclxuICAgIH0pO1xyXG5cclxuICAgIC8vICDmo4DmtYvlpJbpk75cclxuICAgIGNoZWNrVXJsKCk7XHJcblxyXG59KTtcclxuLy/osIPliLDor6bmg4XpobVcclxuZnVuY3Rpb24ganVtcERldGFpbChpbmZvKVxyXG57XHJcbiAgICB2YXIgaW5mbz1pbmZvO1xyXG4gICAgdmFyIGFwcElkPWluZm8uc3BsaXQoXCJ8XCIpWzBdO1xyXG4gICAgdmFyIHVzZXJJZD1pbmZvLnNwbGl0KFwifFwiKVsxXTtcclxuICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmPScvY3VzdG9tZXJkZXRhaWw/YXBwSWQ9JythcHBJZCsnJnVzZXJJZD0nK3VzZXJJZDtcclxufVxyXG5cclxuLy/lj5Hmtojmga8s5YWI6LWw6L+Z5LiqanPlho3otbDlvLnmoYZcclxuZnVuY3Rpb24ganVtcE1zZyhpbmZvKVxyXG57XHJcbiAgICB2YXIgaW5mbz1pbmZvO1xyXG4gICAgdmFyIGFwcElkPWluZm8uc3BsaXQoXCJ8XCIpWzBdO1xyXG4gICAgdmFyIHVzZXJJZD1pbmZvLnNwbGl0KFwifFwiKVsxXTtcclxuICAgICQoXCIjU21zTW9kYWxcIikubW9kYWwoJ3Nob3cnKTtcclxuXHJcbiAgICAvLyAg5bCG6ZO+5o6l57G75Z6L6K6+572u5Li6IOWklumDqOmTvuaOpVxyXG4gICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJsaW5rX3R5cGVfc2VsZWN0b3JcIilbMF0uc2VsZWN0ZWQ9dHJ1ZTtcclxuICAgIC8vICDlsIblj7Pkvqforr7nva7kuLrovpPlhaXmoYZcclxuICAgICQoJyNza2lwX3RhcmdldF9zZWxlY3RvcicpLmVtcHR5KCk7XHJcbiAgICAkKCcjc2tpcF90YXJnZXRfc2VsZWN0b3InKS5hZGRDbGFzcygnaGlkZScpO1xyXG4gICAgJCgnI3NraXBfdGFyZ2V0X2lucHV0JykucmVtb3ZlQ2xhc3MoJ2hpZGUnKTtcclxuXHJcbiAgICAvL+ehruiupOaMiemSrueCueWHu1xyXG4gICAgJChcIi5tb2RhbC1mb290ZXJcIikuY2hpbGRyZW4oXCJidXR0b25cIikuZXEoMCkudW5iaW5kKFwiY2xpY2tcIikuYmluZChcImNsaWNrXCIgLCBmdW5jdGlvbiAoKVxyXG4gICAge1xyXG4gICAgICAgIHZhciBuaWNrbmFtZT0kKFwiI3Ntc19uaWNrbmFtZVwiKS52YWwoKTtcclxuICAgICAgICB2YXIgY29udGVudD0kKFwiI3Ntc19jb250ZW50XCIpLnZhbCgpO1xyXG4gICAgICAgIGlmKG5pY2tuYW1lLmxlbmd0aCA9PSAwKSB7XHJcbiAgICAgICAgICAgICQuYWxlcnQoXCLkurLvvIzov5jmnKrovpPlhaXlj5HpgIHkurrmmLXnp7Dlk6Z+XCIsIFwiZXJyb3JcIiwge2J0bjogMn0pO1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmKGNvbnRlbnQubGVuZ3RoID09IDApIHtcclxuICAgICAgICAgICAgJC5hbGVydChcIuS6su+8jOi/mOacqui+k+WFpea2iOaBr+WGheWuueWTpn5cIiwgXCJlcnJvclwiLCB7YnRuOiAyfSk7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKCEkaXNfYWRkcmVzc19yaWdodCkge1xyXG4gICAgICAgICAgICAkLmFsZXJ0KFwi5Lqy77yM5aSW6YOo6ZO+5o6l6L6T5YWl5pyJ6Zeu6aKY5ZOmflwiLCBcImVycm9yXCIsIHtidG46IDJ9KTtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgJChcIiNTbXNNb2RhbFwiKS5tb2RhbCgnaGlkZScpO1xyXG4gICAgICAgIHNob3dMb2FkaW5nKCk7XHJcblxyXG4gICAgICAgIC8vICDojrflj5bpk77mjqXlkI3np7Ar6ZO+5o6l5Zyw5Z2AKOagueaNruexu+Wei+ehruWumilcclxuICAgICAgICB2YXIgcGFyYW1zID0ge307XHJcbiAgICAgICAgdmFyIHNraXBfdHlwZSA9ICQoJyNsaW5rX3R5cGVfc2VsZWN0b3InKS5maW5kKCdvcHRpb246c2VsZWN0ZWQnKS52YWwoKTtcclxuXHJcbiAgICAgICAgaWYgKHNraXBfdHlwZSA9PSBcImF1ZGlvXCIpIHtcclxuICAgICAgICAgICAgc2tpcF90eXBlID0gMjtcclxuICAgICAgICB9IGVsc2UgaWYgKHNraXBfdHlwZSA9PSBcInZpZGVvXCIpIHtcclxuICAgICAgICAgICAgc2tpcF90eXBlID0gMztcclxuICAgICAgICB9IGVsc2UgaWYgKHNraXBfdHlwZSA9PSBcImltYWdlX3RleHRcIikge1xyXG4gICAgICAgICAgICBza2lwX3R5cGUgPSAxO1xyXG4gICAgICAgIH0gZWxzZSBpZihza2lwX3R5cGUgPT0gXCJhbGl2ZVwiKXtcclxuICAgICAgICAgICAgc2tpcF90eXBlID0gNztcclxuICAgICAgICB9IGVsc2UgaWYgKHNraXBfdHlwZSA9PSBcInBhY2thZ2VcIikge1xyXG4gICAgICAgICAgICBza2lwX3R5cGUgPSA2O1xyXG4gICAgICAgIH1lbHNlIGlmIChza2lwX3R5cGUgPT0gXCJoNVwiKSB7XHJcbiAgICAgICAgICAgIHNraXBfdHlwZSA9IDU7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgc2tpcF90eXBlID0gMDtcclxuICAgICAgICB9XHJcbiAgICAgICAgcGFyYW1zWydza2lwX3R5cGUnXSA9IHNraXBfdHlwZTtcclxuXHJcbiAgICAgICAgaWYgKHNraXBfdHlwZSA9PSA1KSB7XHJcbiAgICAgICAgICAgIHBhcmFtc1snc2tpcF90YXJnZXQnXSA9ICQoJyNza2lwX3RhcmdldF9pbnB1dCcpLnZhbCgpLnRyaW0oKTtcclxuICAgICAgICB9IGVsc2UgaWYgKHNraXBfdHlwZSA9PSAwKSB7XHJcbiAgICAgICAgICAgIHBhcmFtc1snc2tpcF90YXJnZXQnXSA9ICcnO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHBhcmFtc1snc2tpcF90YXJnZXQnXSA9ICQoJyNza2lwX3RhcmdldF9zZWxlY3RvcicpLmZpbmQoJ29wdGlvbjpzZWxlY3RlZCcpLnZhbCgpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKHNraXBfdHlwZSA9PSAyIHx8IHNraXBfdHlwZSA9PSAzIHx8IHNraXBfdHlwZSA9PSAxIHx8IHNraXBfdHlwZSA9PTYpIHtcclxuICAgICAgICAgICAgaWYgKHBhcmFtc1snc2tpcF90YXJnZXQnXSA9PSBcIlwiKSB7XHJcbiAgICAgICAgICAgICAgICBiYXNlVXRpbHMuc2hvdy5ibHVlVGlwKFwi6K+36YCJ5oup6Lez6L2s6LWE5rqQ6ZO+5o6lIVwiKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoc2tpcF90eXBlICE9IDApIHtcclxuICAgICAgICAgICAgcGFyYW1zWydza2lwX3RpdGxlJ10gPSAkKCcjbGlua19uYW1lJykudmFsKCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgcGFyYW1zWydza2lwX3RpdGxlJ10gPSAnJztcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgICQucG9zdChcIi9jdXN0b21lcm1zZ1wiLHtcImFwcElkXCI6YXBwSWQsXCJ1c2VySWRcIjp1c2VySWQsXCJuaWNrbmFtZVwiOm5pY2tuYW1lLFwiY29udGVudFwiOmNvbnRlbnQsXCJwYXJhbXNcIjpwYXJhbXN9LGZ1bmN0aW9uKGRhdGEpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBoaWRlTG9hZGluZygpO1xyXG4gICAgICAgICAgICBpZihkYXRhLnJldD09MClcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgLy93aW5kb3cud3hjLnhjQ29uZmlybShcIuWPkemAgeaIkOWKn1wiLFwic3VjY2Vzc1wiLHtvbk9rOmZ1bmN0aW9uICgpXHJcbiAgICAgICAgICAgICAgICAvL3tcclxuICAgICAgICAgICAgICAgIC8vICAgIHdpbmRvdy5sb2NhdGlvbi5yZWxvYWQoKTtcclxuICAgICAgICAgICAgICAgIC8vfX0pO1xyXG4gICAgICAgICAgICAgICAgYmFzZVV0aWxzLnNob3cuYmx1ZVRpcChcIuWPkemAgeaIkOWKnyFcIiwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5yZWxvYWQoKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgd2luZG93Lnd4Yy54Y0NvbmZpcm0oXCLns7vnu5/nuYHlv5nvvIzor7fnqI3lkI7lho3or5UhXCIsXCJlcnJvclwiKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGluaXRNc2dNb2RlbCgpIHtcclxuXHJcbiAgICAkKCcubW9kZWxfdHlwZScpLm9uKFwiY2xpY2tcIixmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgJCgnLm1vZGVsX3R5cGUnKS5yZW1vdmVDbGFzcygnYm9yZGVyX2JsdWUnKTtcclxuICAgICAgICAkKHRoaXMpLmFkZENsYXNzKCdib3JkZXJfYmx1ZScpO1xyXG4gICAgICAgICQoJyNzbXNfbmlja25hbWUnKS52YWwoJCh0aGlzKS5hdHRyKCdkYXRhLW5hbWUnKSk7XHJcbiAgICAgICAgJCgnI3Ntc19jb250ZW50JykudmFsKCQodGhpcykuYXR0cignZGF0YS1jb250ZW50JykpO1xyXG4gICAgICAgIGlmKCQoJyNjYW5jZWxfbW9kZWwnKS5oYXNDbGFzcygnYm9yZGVyX2JsdWUnKSl7XHJcbiAgICAgICAgICAgICQoJy5lZGl0X21vZGVsJykuYWRkQ2xhc3MoJ2hpZGUnKTtcclxuICAgICAgICAgICAgJCgnLm1vZGVsX3R5cGUnKS5yZW1vdmVDbGFzcygnYm9yZGVyX2JsdWUnKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgbW9kZWxfaWQgPSAkKHRoaXMpLmF0dHIoJ2RhdGEtaWQnKTtcclxuICAgICAgICBzbXNfbmFtZSA9ICQodGhpcykuYXR0cignZGF0YS1uYW1lJyk7XHJcbiAgICAgICAgc21zX2NvbnRlbnQgPSAkKHRoaXMpLmF0dHIoJ2RhdGEtY29udGVudCcpO1xyXG4gICAgfSlcclxuXHJcbiAgICAkKCcjc21zX2NvbnRlbnQnKS5rZXl1cChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYoJCgnLmJvcmRlcl9ibHVlJykubGVuZ3RoID4wKXtcclxuICAgICAgICAgICAgJCgnLmVkaXRfbW9kZWwnKS5yZW1vdmVDbGFzcygnaGlkZScpO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgICQoJyNzbXNfbmlja25hbWUnKS5rZXl1cChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYoJCgnLmJvcmRlcl9ibHVlJykubGVuZ3RoID4wKXtcclxuICAgICAgICAgICAgJCgnLmVkaXRfbW9kZWwnKS5yZW1vdmVDbGFzcygnaGlkZScpO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgICQoJy5lZGl0X21vZGVsJykub24oXCJjbGlja1wiLGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAvL+aVsOaNruW6k+S4jeWtmOWcqOebuOWFs+aooeadv1xyXG4gICAgICAgIG1vZGVsX2lkID0gJCgnLmJvcmRlcl9ibHVlJykuYXR0cignZGF0YS1pZCcpO1xyXG4gICAgICAgIHZhciBuYW1lID0gJCgnI3Ntc19uaWNrbmFtZScpLnZhbCgpO1xyXG4gICAgICAgIHZhciBjb250ZW50PSAkKCcjc21zX2NvbnRlbnQnKS52YWwoKTtcclxuICAgICAgICBpZihtb2RlbF9pZD09XCJcIil7XHJcbiAgICAgICAgICAgIC8v5ZCR5ZCO5Y+w5o+S5YWl5qih5p2/XHJcbiAgICAgICAgICAgIG1vZGVsX2lkID0gMDtcclxuICAgICAgICAgICAgaWYobmFtZSE9XCJcIiAmJiBjb250ZW50IT1cIlwiKXtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwi5paw5aKe5qih5p2/77yaXCIrbW9kZWxfaWQrXCI+PlwiK25hbWUrXCI+PlwiK2NvbnRlbnQpO1xyXG4gICAgICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgICAgIGJhc2VVdGlscy5zaG93LnJlZFRpcCgn5oKo55qE5Y+R6YCB5Lq65pi156ewL+WGheWuueS4uuepuicpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgIC8v5pu05paw5Y6f5pyJ5qih5p2/XHJcbiAgICAgICAgICAgIGlmKG5hbWUhPVwiXCIgJiYgY29udGVudCE9XCJcIil7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIuabtOaWsOaooeadv++8mlwiK21vZGVsX2lkK1wiPj5cIituYW1lK1wiPj5cIitjb250ZW50KTtcclxuICAgICAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgICAgICBiYXNlVXRpbHMuc2hvdy5yZWRUaXAoJ+aCqOeahOWPkemAgeS6uuaYteensC/lhoXlrrnkuLrnqbonKTtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBpZihuYW1lID09IHNtc19uYW1lICYmIGNvbnRlbnQgPT0gc21zX2NvbnRlbnQpe1xyXG4gICAgICAgICAgICBiYXNlVXRpbHMuc2hvdy5yZWRUaXAoJ+aCqOayoeacieWBmuS7u+S9leaooeadv+S/ruaUuScpO1xyXG4gICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICBzaG93TG9hZGluZygpO1xyXG4gICAgICAgICAgICB2YXIgdXJsID0gXCIvbW9kZWxjaGFuZ2VcIjtcclxuICAgICAgICAgICAgJC5wb3N0KHVybCwgeydtb2RlbF9pZCc6IG1vZGVsX2lkLCdzZW5kX25pY2tfbmFtZSc6bmFtZSwnY29udGVudCc6Y29udGVudH0sZnVuY3Rpb24gKHJlc3VsdCkge1xyXG4gICAgICAgICAgICAgICAgaGlkZUxvYWRpbmcoKTtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlc3VsdCk7XHJcbiAgICAgICAgICAgICAgICB2YXIgUmVDb2RlID0gcmVzdWx0LmNvZGU7XHJcbiAgICAgICAgICAgICAgICB2YXIgaW5mbyA9IHJlc3VsdC5tc2c7XHJcbiAgICAgICAgICAgICAgICBiYXNlVXRpbHMuc2hvdy5ibHVlVGlwKGluZm8pO1xyXG4gICAgICAgICAgICAgICAgaWYoUmVDb2RlPT0wKXsgLy/mlrDlu7rmqKHmnb/miJDlip8g5bm26K6+572u5b2T5YmN5pyA5paw5o+S5YWl55qE5rig6YGTaWRcclxuICAgICAgICAgICAgICAgICAgICAkKCcuYm9yZGVyX2JsdWUnKS5hdHRyKCdkYXRhLWlkJyxyZXN1bHQuaWQpO1xyXG4gICAgICAgICAgICAgICAgICAgICQoJy5ib3JkZXJfYmx1ZScpLmF0dHIoJ2RhdGEtbmFtZScsbmFtZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgJCgnLmJvcmRlcl9ibHVlJykuYXR0cignZGF0YS1jb250ZW50Jyxjb250ZW50KTtcclxuICAgICAgICAgICAgICAgICAgICBuZWVkUmVmcmVzaCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICB9ZWxzZSBpZihSZUNvZGU9PTEpeyAvL+mUmeivr1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlc3VsdC5lcnJvck1zZyk7XHJcbiAgICAgICAgICAgICAgICB9ZWxzZSBpZihSZUNvZGU9PTIpeyAvL+abtOaWsOaooeadv+aIkOWKn1xyXG4gICAgICAgICAgICAgICAgICAgICQoJy5ib3JkZXJfYmx1ZScpLmF0dHIoJ2RhdGEtbmFtZScsbmFtZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgJCgnLmJvcmRlcl9ibHVlJykuYXR0cignZGF0YS1jb250ZW50Jyxjb250ZW50KTtcclxuICAgICAgICAgICAgICAgICAgICBuZWVkUmVmcmVzaCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG59XHJcbi8v5Yik5pat5piv5ZCm6ZyA6KaB5Yi35pawXHJcbmZ1bmN0aW9uIHJlZnJlc2goKSB7XHJcbiAgICAkKFwiI1Ntc01vZGFsXCIpLm9uKCdoaWRlLmJzLm1vZGFsJywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIC8v5Yik5pat5piv5ZCm6ZyA6KaB5Yi35paw55WM6Z2iXHJcbiAgICAgICAgaWYgKG5lZWRSZWZyZXNoKSB7XHJcbiAgICAgICAgICAgIGxvY2F0aW9uLnJlbG9hZCgpOyAvL+mHjeaWsOWKoOi9vemhtemdolxyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG59XHJcblxyXG4vLyAg5bCG6ZO+5o6l57G75Z6LIOWSjCDovpPlhaXmoYblhbPogZRcclxuZnVuY3Rpb24gYmluZEVsZW1lbnQoKSB7XHJcbiAgICAkKFwiI2xpbmtfdHlwZV9zZWxlY3RvclwiKS5vbignY2hhbmdlJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdmFyIHR5cGUgPSAkKHRoaXMpLmZpbmQoJ29wdGlvbjpzZWxlY3RlZCcpLnZhbCgpO1xyXG5cclxuICAgICAgICBpZiAodHlwZSA9PSAnaDUnKSB7XHJcbiAgICAgICAgICAgICQoJyNza2lwX3RhcmdldF9zZWxlY3RvcicpLmVtcHR5KCk7XHJcbiAgICAgICAgICAgICQoJyNza2lwX3RhcmdldF9zZWxlY3RvcicpLmFkZENsYXNzKCdoaWRlJyk7XHJcbiAgICAgICAgICAgICQoJyNza2lwX3RhcmdldF9pbnB1dCcpLnJlbW92ZUNsYXNzKCdoaWRlJyk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9IGVsc2UgaWYgKHR5cGUgPT0gJ25vX2p1bXAnKSB7XHJcbiAgICAgICAgICAgICQoJyNza2lwX3RhcmdldF9zZWxlY3RvcicpLmVtcHR5KCk7XHJcbiAgICAgICAgICAgICQoJyNza2lwX3RhcmdldF9zZWxlY3RvcicpLnJlbW92ZUNsYXNzKCdoaWRlJyk7XHJcbiAgICAgICAgICAgICQoJyNza2lwX3RhcmdldF9pbnB1dCcpLmFkZENsYXNzKCdoaWRlJyk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAkKCcjc2tpcF90YXJnZXRfc2VsZWN0b3InKS5lbXB0eSgpO1xyXG4gICAgICAgICAgICAkKCcjc2tpcF90YXJnZXRfc2VsZWN0b3InKS5yZW1vdmVDbGFzcygnaGlkZScpO1xyXG4gICAgICAgICAgICAkKCcjc2tpcF90YXJnZXRfaW5wdXQnKS5hZGRDbGFzcygnaGlkZScpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgJC5nZXQoJy9iYW5uZXIvZ2V0UmVzb3VyY2VMaXN0P3R5cGU9JyArIHR5cGUgLCBmdW5jdGlvbiAocmVzdWx0KSB7XHJcbiAgICAgICAgICAgICQoJyNza2lwX3RhcmdldF9zZWxlY3RvcicpLmVtcHR5KCk7XHJcbiAgICAgICAgICAgIHJlc3VsdCA9IEpTT04ucGFyc2UocmVzdWx0KTtcclxuXHJcbiAgICAgICAgICAgIHZhciBjb3VudCA9IHJlc3VsdC5sZW5ndGg7XHJcblxyXG4gICAgICAgICAgICB2YXIgaHRtbFN0ciA9IFwiXCI7XHJcblxyXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNvdW50OyBpKyspIHtcclxuICAgICAgICAgICAgICAgIGh0bWxTdHIrPVwiPG9wdGlvbiB2YWx1ZT0nXCIrcmVzdWx0W2ldLmlkK1wiJz5cIityZXN1bHRbaV0udGl0bGUrXCI8L29wdGlvbj5cIjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAkKCcjc2tpcF90YXJnZXRfc2VsZWN0b3InKS5hcHBlbmQoaHRtbFN0cik7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxufVxyXG5cclxuZnVuY3Rpb24gY2hlY2tVcmwoKSB7XHJcbiAgICAvKuajgOa1i+e9keWdgOeahOi+k+WFpemUmeivr+aXtu+8jOa3u+WKoOaWh+Wtl+aPkOmGkiovXHJcbiAgICAkKCcjc2tpcF90YXJnZXRfaW5wdXQuZm9ybS1jb250cm9sJykuYmluZCgnaW5wdXQgcHJvcGVydHljaGFuZ2UnLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIGlucHV0X2FkZHJlc3MgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInNraXBfdGFyZ2V0X2lucHV0XCIpLnZhbHVlO1xyXG4gICAgICAgIGlmIChpbnB1dF9hZGRyZXNzID09ICcnIHx8ICFpbnB1dF9hZGRyZXNzLmluZGV4T2YoXCJodHRwOi8vXCIpIHx8ICFpbnB1dF9hZGRyZXNzLmluZGV4T2YoXCJodHRwczovL1wiKSkge1xyXG4gICAgICAgICAgICAvLyDnvZHlnYDmraPnoa5cclxuICAgICAgICAgICAgJCgnLmh0dHBfZXJyb3JfdGlwJykuYWRkQ2xhc3MoXCJoaWRlXCIpO1xyXG4gICAgICAgICAgICAkKFwiLm1vZGFsLWZvb3RlclwiKS5jc3Moe1wibWFyZ2luXCI6IFwiNDVweCAxNXB4IDBcIn0pLmNzcyh7XCJwYWRkaW5nXCI6IFwiMzBweCAwcHhcIn0pO1xyXG4gICAgICAgICAgICAkaXNfYWRkcmVzc19yaWdodCA9IHRydWU7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgLy8g572R5Z2A6ZSZ6K+vXHJcbiAgICAgICAgICAgICQoJy5odHRwX2Vycm9yX3RpcCcpLnJlbW92ZUNsYXNzKFwiaGlkZVwiKTtcclxuICAgICAgICAgICAgJChcIi5tb2RhbC1mb290ZXJcIikuY3NzKHtcIm1hcmdpblwiOiBcIjAgMTVweCAwXCJ9KS5jc3Moe1wicGFkZGluZ1wiOiBcIjE1cHggMCAwIDMwcHhcIn0pO1xyXG4gICAgICAgICAgICAkaXNfYWRkcmVzc19yaWdodCA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG4gICAgJChcIiNsaW5rX3R5cGVfc2VsZWN0b3JcIikuY2hhbmdlKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgc2tpcF90eXBlID0gJCh0aGlzKS5jaGlsZHJlbihcIjpzZWxlY3RlZFwiKS52YWwoKTtcclxuICAgICAgICBpZiAoc2tpcF90eXBlICE9PSAnaDUnKSB7XHJcbiAgICAgICAgICAgIC8vIOe9keWdgOato+ehrlxyXG4gICAgICAgICAgICAkKCcuaHR0cF9lcnJvcl90aXAnKS5hZGRDbGFzcyhcImhpZGVcIik7XHJcbiAgICAgICAgICAgICQoXCIubW9kYWwtZm9vdGVyXCIpLmNzcyh7XCJtYXJnaW5cIjogXCI0NXB4IDE1cHggMFwifSkuY3NzKHtcInBhZGRpbmdcIjogXCIzMHB4IDBweFwifSk7XHJcbiAgICAgICAgICAgICRpc19hZGRyZXNzX3JpZ2h0ID0gdHJ1ZTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAkKFwiI3NraXBfdGFyZ2V0X2lucHV0XCIpLnZhbChcIlwiKTtcclxuICAgICAgICB9XHJcbiAgICB9KVxyXG59Il19
