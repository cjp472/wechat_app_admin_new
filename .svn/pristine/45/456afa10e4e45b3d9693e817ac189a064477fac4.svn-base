$(document).ready(function(){$manageExercise.init()});$manageExercise=function(){var e={};var i={submitLimit:false,pageType:$("#admin_data").data("page_type")};e.init=function(){changeSaveFlag(true);if(i.pageType==1){i.resType=$("#admin_data").data("resource_type");i.resId=$("#admin_data").data("resource_id");i.resName=$("#admin_data").data("resource_name")}$(".characterNumLimit>span").text($("#exerciseBookName").val().length);$("#exerciseBookName").on("input",function(){t()});$("#resTypeSelector").on("change",function(){var e=$(this).val();if(e==-1){$("#resItemSelector").html(' <option value="-1">请选择具体课程</option>')}else{$.ajax("/exercise/get_resource_list",{type:"POST",dataType:"json",data:{resource_type:e},success:function(t){if(t.code==0){var a=t.data.resource_list,r="";if(i.pageType==1&&i.resType==e){r+='<option value="'+i.resId+'" selected>'+i.resName+"</option>"}$.each(a,function(i,t){var a=e==5?t.name:t.title;r+='<option value="'+t.id+'">'+a+"</option>"});if(r.length==0){r='<option value="-1">暂无数据</option>'}$("#resItemSelector").html(r)}else{baseUtils.show.redTip("网络问题，请稍后再试")}},error:function(e,i,t){console.log(t);alert("服务器出小差了，请稍后再试！")}})}});$(".remindRadio").on("click",function(){$(".remindRadio").children(".circleRadio").removeClass("radioActive");$(this).children(".circleRadio").addClass("radioActive")});$("#cancelSaveExercise").click(function(){window.history.back()});$("#confirmSaveExercise").click(function(){var e=$.trim($("#exerciseBookName").val()),t=$("#resItemSelector").val(),a=$("#resTypeSelector").val(),r=$("#resItemSelector > option:selected").text(),o=$("#communitySelector").val(),s=$(".circleRadio.radioActive").data("is_remind"),c="";if(e.length==0){baseUtils.show.redTip("还没有输入作业本名称");return false}if(e.length>14){baseUtils.show.redTip("作业本名称长度不能超过14字");return false}if(t==-1){baseUtils.show.redTip("还没有选择具体课程");return false}var n={title:e,resource_id:t,resource_type:a,resource_name:r,is_enable_notify:s};if(o!=-1&&o!=undefined){n.community_id=o}if(i.pageType==0){c="/exercise/upload_exercise_book"}else if(i.pageType==1){c="/exercise/update_exercise_book";n.exercise_book_id=GetQueryString("exercise_book_id")}else{console.log(" pageType 参数有误。");baseUtils.show.redTip("网络错误，请稍后再试");return false}if(i.submitLimit){baseUtils.show.redTip("正在提交中，请稍后再试");return false}i.submitLimit=true;$.ajax(c,{type:"POST",dataType:"json",data:{params:n},success:function(e){i.submitLimit=false;if(e.code==0){baseUtils.show.blueTip(i.pageType==0?"创建成功":"编辑成功");if(i.pageType==0){var t=e.data.exerciseBookId;sessionStorage.setItem("lastExerciseBookId",t);sessionStorage.setItem("lastResourceType",a)}setTimeout(function(){var e=GetQueryString("page_index")||1;window.location.href="/exercise/exercise_book_list?page="+e},1e3)}else{baseUtils.show.redTip(e.msg)}},error:function(e,t,a){i.submitLimit=false;console.log(a);alert("服务器出小差了，请稍后再试！")}})})};function t(){var e=$("#exerciseBookName"),i=$.trim(e.val());if(i.length>14){$(".characterNumLimit").css({color:"red"});$("#exerciseBookName").css({"border-color":"red"})}else{$(".characterNumLimit").css({color:"#b2b2b2"});$("#exerciseBookName").css({"border-color":"#dcdcdc"})}$(".characterNumLimit>span").text(i.length)}return e}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1hbmFnZUV4ZXJjaXNlQm9vay5qcyJdLCJuYW1lcyI6WyIkIiwiZG9jdW1lbnQiLCJyZWFkeSIsIiRtYW5hZ2VFeGVyY2lzZSIsImluaXQiLCIkcHJpdmF0ZSIsInN1Ym1pdExpbWl0IiwicGFnZVR5cGUiLCJkYXRhIiwiY2hhbmdlU2F2ZUZsYWciLCJyZXNUeXBlIiwicmVzSWQiLCJyZXNOYW1lIiwidGV4dCIsInZhbCIsImxlbmd0aCIsIm9uIiwiY2hlY2tJbnB1dE5hbWUiLCJ0aGlzIiwiaHRtbCIsImFqYXgiLCJ0eXBlIiwiZGF0YVR5cGUiLCJyZXNvdXJjZV90eXBlIiwic3VjY2VzcyIsInJlc3VsdCIsImNvZGUiLCJyZXNvdXJjZUxpc3QiLCJyZXNvdXJjZV9saXN0IiwiaHRtbFN0ciIsImVhY2giLCJrIiwidiIsIm5hbWUiLCJ0aXRsZSIsImlkIiwiYmFzZVV0aWxzIiwic2hvdyIsInJlZFRpcCIsImVycm9yIiwieGhyIiwic3RhdHVzIiwiZXJyIiwiY29uc29sZSIsImxvZyIsImFsZXJ0IiwiY2hpbGRyZW4iLCJyZW1vdmVDbGFzcyIsImFkZENsYXNzIiwiY2xpY2siLCJ3aW5kb3ciLCJoaXN0b3J5IiwiYmFjayIsImV4ZXJjaXNlQm9va05hbWUiLCJ0cmltIiwiY29tbXVuaXR5SWQiLCJpc1JlbWluZCIsInBvc3RVcmwiLCJwYXJhbXMiLCJyZXNvdXJjZV9pZCIsInJlc291cmNlX25hbWUiLCJpc19lbmFibGVfbm90aWZ5IiwidW5kZWZpbmVkIiwiY29tbXVuaXR5X2lkIiwiZXhlcmNpc2VfYm9va19pZCIsIkdldFF1ZXJ5U3RyaW5nIiwiYmx1ZVRpcCIsImV4ZXJjaXNlQm9va0lkIiwic2Vzc2lvblN0b3JhZ2UiLCJzZXRJdGVtIiwic2V0VGltZW91dCIsInBhZ2VJbmRleCIsImxvY2F0aW9uIiwiaHJlZiIsIm1zZyIsIiRzZWxmIiwiZXhlcmNpc2VOYW1lIiwiY3NzIiwiY29sb3IiLCJib3JkZXItY29sb3IiXSwibWFwcGluZ3MiOiJBQUlBQSxFQUFFQyxVQUFVQyxNQUFNLFdBQ2RDLGdCQUFnQkMsUUFHcEJELGlCQUFrQixXQUNkLEdBQUlBLEtBQ0osSUFBSUUsSUFDQUMsWUFBYSxNQUNiQyxTQUFVUCxFQUFFLGVBQWVRLEtBQUssYUFHcENMLEdBQWdCQyxLQUFPLFdBR25CSyxlQUFlLEtBRWYsSUFBSUosRUFBU0UsVUFBWSxFQUFHLENBQ3hCRixFQUFTSyxRQUFVVixFQUFFLGVBQWVRLEtBQUssZ0JBQ3pDSCxHQUFTTSxNQUFRWCxFQUFFLGVBQWVRLEtBQUssY0FDdkNILEdBQVNPLFFBQVVaLEVBQUUsZUFBZVEsS0FBSyxpQkFHN0NSLEVBQUUsMkJBQTJCYSxLQUFLYixFQUFFLHFCQUFxQmMsTUFBTUMsT0FFL0RmLEdBQUUscUJBQXFCZ0IsR0FBRyxRQUFTLFdBQy9CQyxLQUlKakIsR0FBRSxvQkFBb0JnQixHQUFHLFNBQVUsV0FDL0IsR0FBSU4sR0FBVVYsRUFBRWtCLE1BQU1KLEtBQ3RCLElBQUlKLElBQVksRUFBRyxDQUNmVixFQUFFLG9CQUFvQm1CLEtBQ2xCLDRDQUVELENBQ0huQixFQUFFb0IsS0FBSywrQkFDSEMsS0FBTSxPQUNOQyxTQUFVLE9BQ1ZkLE1BQ0llLGNBQWViLEdBRW5CYyxRQUFTLFNBQVVDLEdBQ2YsR0FBSUEsRUFBT0MsTUFBUSxFQUFHLENBQ2xCLEdBQUlDLEdBQWVGLEVBQU9qQixLQUFLb0IsY0FDM0JDLEVBQVUsRUFFZCxJQUFJeEIsRUFBU0UsVUFBWSxHQUFLRixFQUFTSyxTQUFXQSxFQUFTLENBQ3ZEbUIsR0FDSSxrQkFBa0J4QixFQUFTTSxNQUFNLGNBQWNOLEVBQVNPLFFBQVEsWUFFeEVaLEVBQUU4QixLQUFLSCxFQUFjLFNBQVVJLEVBQUdDLEdBQzlCLEdBQUlwQixHQUFXRixHQUFTLEVBQUVzQixFQUFFQyxLQUFLRCxFQUFFRSxLQUNuQ0wsSUFDSSxrQkFBa0JHLEVBQUVHLEdBQUcsS0FBS3ZCLEVBQVEsYUFFNUMsSUFBSWlCLEVBQVFkLFFBQVUsRUFBRyxDQUNyQmMsRUFDSSxtQ0FFUjdCLEVBQUUsb0JBQW9CbUIsS0FBS1UsT0FFeEIsQ0FDSE8sVUFBVUMsS0FBS0MsT0FBTyxnQkFHOUJDLE1BQU8sU0FBVUMsRUFBS0MsRUFBUUMsR0FDMUJDLFFBQVFDLElBQUlGLEVBQ1pHLE9BQU0sdUJBUXRCN0MsR0FBRSxnQkFBZ0JnQixHQUFHLFFBQVMsV0FDMUJoQixFQUFFLGdCQUFnQjhDLFNBQVMsZ0JBQWdCQyxZQUFZLGNBQ3ZEL0MsR0FBRWtCLE1BQU00QixTQUFTLGdCQUFnQkUsU0FBUyxnQkFHOUNoRCxHQUFFLHVCQUF1QmlELE1BQU0sV0FDM0JDLE9BQU9DLFFBQVFDLFFBR25CcEQsR0FBRSx3QkFBd0JpRCxNQUFNLFdBQzVCLEdBQUlJLEdBQW1CckQsRUFBRXNELEtBQUt0RCxFQUFFLHFCQUFxQmMsT0FDakRILEVBQVFYLEVBQUUsb0JBQW9CYyxNQUM5QkosRUFBVVYsRUFBRSxvQkFBb0JjLE1BQ2hDRixFQUFVWixFQUFFLHNDQUFzQ2EsT0FDbEQwQyxFQUFjdkQsRUFBRSxzQkFBc0JjLE1BQ3RDMEMsRUFBV3hELEVBQUUsNEJBQTRCUSxLQUFLLGFBQzlDaUQsRUFBVSxFQUVkLElBQUlKLEVBQWlCdEMsUUFBVSxFQUFHLENBQzlCcUIsVUFBVUMsS0FBS0MsT0FBTyxhQUN0QixPQUFPLE9BRVgsR0FBSWUsRUFBaUJ0QyxPQUFTLEdBQUksQ0FDOUJxQixVQUFVQyxLQUFLQyxPQUFPLGlCQUN0QixPQUFPLE9BRVgsR0FBSTNCLElBQVUsRUFBRyxDQUNieUIsVUFBVUMsS0FBS0MsT0FBTyxZQUN0QixPQUFPLE9BR1gsR0FBSW9CLElBQ0F4QixNQUFPbUIsRUFDUE0sWUFBYWhELEVBQ2JZLGNBQWViLEVBQ2ZrRCxjQUFlaEQsRUFDZmlELGlCQUFrQkwsRUFFdEIsSUFBSUQsSUFBZ0IsR0FBS0EsR0FBZU8sVUFBVyxDQUMvQ0osRUFBT0ssYUFBZVIsRUFFMUIsR0FBSWxELEVBQVNFLFVBQVksRUFBRyxDQUN4QmtELEVBQVUscUNBQ1AsSUFBSXBELEVBQVNFLFVBQVksRUFBRyxDQUMvQmtELEVBQVUsZ0NBQ1ZDLEdBQU9NLGlCQUFtQkMsZUFBZSx3QkFDdEMsQ0FDSHRCLFFBQVFDLElBQUksa0JBQ1pSLFdBQVVDLEtBQUtDLE9BQU8sYUFDdEIsT0FBTyxPQUVYLEdBQUlqQyxFQUFTQyxZQUFhLENBQ3RCOEIsVUFBVUMsS0FBS0MsT0FBTyxjQUN0QixPQUFPLE9BRVhqQyxFQUFTQyxZQUFjLElBQ3ZCTixHQUFFb0IsS0FBS3FDLEdBQ0hwQyxLQUFNLE9BQ05DLFNBQVUsT0FDVmQsTUFDSWtELE9BQVFBLEdBRVpsQyxRQUFTLFNBQVVDLEdBQ2ZwQixFQUFTQyxZQUFjLEtBQ3ZCLElBQUltQixFQUFPQyxNQUFRLEVBQUcsQ0FDbEJVLFVBQVVDLEtBQUs2QixRQUFRN0QsRUFBU0UsVUFBVSxFQUFFLE9BQU8sT0FDbkQsSUFBSUYsRUFBU0UsVUFBWSxFQUFHLENBQ3hCLEdBQUk0RCxHQUFpQjFDLEVBQU9qQixLQUFLMkQsY0FDakNDLGdCQUFlQyxRQUFRLHFCQUFzQkYsRUFDN0NDLGdCQUFlQyxRQUFRLG1CQUFvQjNELEdBRy9DNEQsV0FBVyxXQUNQLEdBQUlDLEdBQVlOLGVBQWUsZUFBaUIsQ0FDaERmLFFBQU9zQixTQUFTQyxLQUFPLHFDQUF1Q0YsR0FDL0QsU0FDQSxDQUNIbkMsVUFBVUMsS0FBS0MsT0FBT2IsRUFBT2lELE9BR3JDbkMsTUFBTyxTQUFVQyxFQUFLQyxFQUFRQyxHQUMxQnJDLEVBQVNDLFlBQWMsS0FDdkJxQyxTQUFRQyxJQUFJRixFQUNaRyxPQUFNLHVCQU90QixTQUFTNUIsS0FDTCxHQUFJMEQsR0FBUTNFLEVBQUUscUJBQ1Y0RSxFQUFlNUUsRUFBRXNELEtBQUtxQixFQUFNN0QsTUFFaEMsSUFBSThELEVBQWE3RCxPQUFTLEdBQUksQ0FHMUJmLEVBQUUsc0JBQXNCNkUsS0FBS0MsTUFBUyxPQUN0QzlFLEdBQUUscUJBQXFCNkUsS0FBS0UsZUFBZ0IsWUFDekMsQ0FDSC9FLEVBQUUsc0JBQXNCNkUsS0FBS0MsTUFBUyxXQUN0QzlFLEdBQUUscUJBQXFCNkUsS0FBS0UsZUFBZ0IsWUFFaEQvRSxFQUFFLDJCQUEyQmEsS0FBSytELEVBQWE3RCxRQUduRCxNQUFPWiIsImZpbGUiOiJtYW5hZ2VFeGVyY2lzZUJvb2suanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICogQ3JlYXRlZCBieSBBZG1pbmlzdHJhdG9yIG9uIDIwMTcvNy8zMS5cclxuICovXHJcblxyXG4kKGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbiAoKSB7XHJcbiAgICAkbWFuYWdlRXhlcmNpc2UuaW5pdCgpO1xyXG59KTtcclxuXHJcbiRtYW5hZ2VFeGVyY2lzZSA9IChmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgJG1hbmFnZUV4ZXJjaXNlID0ge307XHJcbiAgICB2YXIgJHByaXZhdGUgPSB7XHJcbiAgICAgICAgc3VibWl0TGltaXQ6IGZhbHNlLFxyXG4gICAgICAgIHBhZ2VUeXBlOiAkKFwiI2FkbWluX2RhdGFcIikuZGF0YShcInBhZ2VfdHlwZVwiKSwgICAgICAgLy8wLeWIm+W7uu+8mzEt57yW6L6RXHJcbiAgICB9XHJcblxyXG4gICAgJG1hbmFnZUV4ZXJjaXNlLmluaXQgPSBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgICAgIC8v54K55Ye75L6n6L655qCP56a75byA5pe255qE5by55qGGXHJcbiAgICAgICAgY2hhbmdlU2F2ZUZsYWcodHJ1ZSk7XHJcblxyXG4gICAgICAgIGlmICgkcHJpdmF0ZS5wYWdlVHlwZSA9PSAxKSB7XHJcbiAgICAgICAgICAgICRwcml2YXRlLnJlc1R5cGUgPSAkKFwiI2FkbWluX2RhdGFcIikuZGF0YShcInJlc291cmNlX3R5cGVcIik7ICAgIC8v5bey5YWz6IGU6K++56iL55qE57G75Z6LXHJcbiAgICAgICAgICAgICRwcml2YXRlLnJlc0lkID0gJChcIiNhZG1pbl9kYXRhXCIpLmRhdGEoXCJyZXNvdXJjZV9pZFwiKTsgICAgLy/lt7LlhbPogZTor77nqIvnmoRpZFxyXG4gICAgICAgICAgICAkcHJpdmF0ZS5yZXNOYW1lID0gJChcIiNhZG1pbl9kYXRhXCIpLmRhdGEoXCJyZXNvdXJjZV9uYW1lXCIpOyAgICAvL+W3suWFs+iBlOivvueoi+eahGlkXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAkKFwiLmNoYXJhY3Rlck51bUxpbWl0PnNwYW5cIikudGV4dCgkKFwiI2V4ZXJjaXNlQm9va05hbWVcIikudmFsKCkubGVuZ3RoKTtcclxuXHJcbiAgICAgICAgJChcIiNleGVyY2lzZUJvb2tOYW1lXCIpLm9uKFwiaW5wdXRcIiwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBjaGVja0lucHV0TmFtZSgpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICAvL+WFs+iBlOivvueoi1xyXG4gICAgICAgICQoXCIjcmVzVHlwZVNlbGVjdG9yXCIpLm9uKFwiY2hhbmdlXCIsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIHJlc1R5cGUgPSAkKHRoaXMpLnZhbCgpO1xyXG4gICAgICAgICAgICBpZiAocmVzVHlwZSA9PSAtMSkge1xyXG4gICAgICAgICAgICAgICAgJChcIiNyZXNJdGVtU2VsZWN0b3JcIikuaHRtbChcclxuICAgICAgICAgICAgICAgICAgICAnIDxvcHRpb24gdmFsdWU9XCItMVwiPuivt+mAieaLqeWFt+S9k+ivvueoizwvb3B0aW9uPidcclxuICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAkLmFqYXgoXCIvZXhlcmNpc2UvZ2V0X3Jlc291cmNlX2xpc3RcIiwge1xyXG4gICAgICAgICAgICAgICAgICAgIHR5cGU6IFwiUE9TVFwiLFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGFUeXBlOiBcImpzb25cIixcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc291cmNlX3R5cGU6IHJlc1R5cGVcclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChyZXN1bHQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3VsdC5jb2RlID09IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZXNvdXJjZUxpc3QgPSByZXN1bHQuZGF0YS5yZXNvdXJjZV9saXN0LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxTdHIgPSBcIlwiO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkcHJpdmF0ZS5wYWdlVHlwZSA9PSAxICYmICRwcml2YXRlLnJlc1R5cGUgPT0gcmVzVHlwZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxTdHIgKz1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJzxvcHRpb24gdmFsdWU9XCInKyRwcml2YXRlLnJlc0lkKydcIiBzZWxlY3RlZD4nKyRwcml2YXRlLnJlc05hbWUrJzwvb3B0aW9uPic7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkLmVhY2gocmVzb3VyY2VMaXN0LCBmdW5jdGlvbiAoaywgdikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZXNOYW1lID0gKHJlc1R5cGU9PTU/di5uYW1lOnYudGl0bGUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxTdHIgKz1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJzxvcHRpb24gdmFsdWU9XCInK3YuaWQrJ1wiPicrcmVzTmFtZSsnPC9vcHRpb24+JztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGh0bWxTdHIubGVuZ3RoID09IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBodG1sU3RyID1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJzxvcHRpb24gdmFsdWU9XCItMVwiPuaaguaXoOaVsOaNrjwvb3B0aW9uPic7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKFwiI3Jlc0l0ZW1TZWxlY3RvclwiKS5odG1sKGh0bWxTdHIpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhc2VVdGlscy5zaG93LnJlZFRpcChcIue9kee7nOmXrumimO+8jOivt+eojeWQjuWGjeivlVwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6IGZ1bmN0aW9uICh4aHIsIHN0YXR1cywgZXJyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFsZXJ0KFwi5pyN5Yqh5Zmo5Ye65bCP5beu5LqG77yM6K+356iN5ZCO5YaN6K+V77yBXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICAvLyByYWRpbyDmjInpkq7ngrnlh7vliIfmjaLmlYjmnpxcclxuICAgICAgICAkKCcucmVtaW5kUmFkaW8nKS5vbignY2xpY2snLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgJCgnLnJlbWluZFJhZGlvJykuY2hpbGRyZW4oJy5jaXJjbGVSYWRpbycpLnJlbW92ZUNsYXNzKCdyYWRpb0FjdGl2ZScpO1xyXG4gICAgICAgICAgICAkKHRoaXMpLmNoaWxkcmVuKCcuY2lyY2xlUmFkaW8nKS5hZGRDbGFzcygncmFkaW9BY3RpdmUnKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgJChcIiNjYW5jZWxTYXZlRXhlcmNpc2VcIikuY2xpY2soZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB3aW5kb3cuaGlzdG9yeS5iYWNrKCk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICQoXCIjY29uZmlybVNhdmVFeGVyY2lzZVwiKS5jbGljayhmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciBleGVyY2lzZUJvb2tOYW1lID0gJC50cmltKCQoXCIjZXhlcmNpc2VCb29rTmFtZVwiKS52YWwoKSksXHJcbiAgICAgICAgICAgICAgICByZXNJZCA9ICQoXCIjcmVzSXRlbVNlbGVjdG9yXCIpLnZhbCgpLFxyXG4gICAgICAgICAgICAgICAgcmVzVHlwZSA9ICQoXCIjcmVzVHlwZVNlbGVjdG9yXCIpLnZhbCgpLFxyXG4gICAgICAgICAgICAgICAgcmVzTmFtZSA9ICQoXCIjcmVzSXRlbVNlbGVjdG9yID4gb3B0aW9uOnNlbGVjdGVkXCIpLnRleHQoKSxcclxuICAgICAgICAgICAgICAgIGNvbW11bml0eUlkID0gJChcIiNjb21tdW5pdHlTZWxlY3RvclwiKS52YWwoKSxcclxuICAgICAgICAgICAgICAgIGlzUmVtaW5kID0gJChcIi5jaXJjbGVSYWRpby5yYWRpb0FjdGl2ZVwiKS5kYXRhKFwiaXNfcmVtaW5kXCIpLCAvLyAxIC0g5o+Q6YaS77yMIDAgLSDkuI3mj5DphpI86buY6K6k5LiN5o+Q6YaSPlxyXG4gICAgICAgICAgICAgICAgcG9zdFVybCA9IFwiXCI7XHJcblxyXG4gICAgICAgICAgICBpZiAoZXhlcmNpc2VCb29rTmFtZS5sZW5ndGggPT0gMCkge1xyXG4gICAgICAgICAgICAgICAgYmFzZVV0aWxzLnNob3cucmVkVGlwKFwi6L+Y5rKh5pyJ6L6T5YWl5L2c5Lia5pys5ZCN56ewXCIpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChleGVyY2lzZUJvb2tOYW1lLmxlbmd0aCA+IDE0KSB7XHJcbiAgICAgICAgICAgICAgICBiYXNlVXRpbHMuc2hvdy5yZWRUaXAoXCLkvZzkuJrmnKzlkI3np7Dplb/luqbkuI3og73otoXov4cxNOWtl1wiKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAocmVzSWQgPT0gLTEpIHtcclxuICAgICAgICAgICAgICAgIGJhc2VVdGlscy5zaG93LnJlZFRpcChcIui/mOayoeaciemAieaLqeWFt+S9k+ivvueoi1wiKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgdmFyIHBhcmFtcyA9IHtcclxuICAgICAgICAgICAgICAgIHRpdGxlOiBleGVyY2lzZUJvb2tOYW1lLFxyXG4gICAgICAgICAgICAgICAgcmVzb3VyY2VfaWQ6IHJlc0lkLFxyXG4gICAgICAgICAgICAgICAgcmVzb3VyY2VfdHlwZTogcmVzVHlwZSxcclxuICAgICAgICAgICAgICAgIHJlc291cmNlX25hbWU6IHJlc05hbWUsXHJcbiAgICAgICAgICAgICAgICBpc19lbmFibGVfbm90aWZ5OiBpc1JlbWluZFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChjb21tdW5pdHlJZCAhPSAtMSAmJiBjb21tdW5pdHlJZCAhPSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgIHBhcmFtcy5jb21tdW5pdHlfaWQgPSBjb21tdW5pdHlJZDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoJHByaXZhdGUucGFnZVR5cGUgPT0gMCkgeyAgICAgICAgICAgIC8v5Yib5bu6XHJcbiAgICAgICAgICAgICAgICBwb3N0VXJsID0gXCIvZXhlcmNpc2UvdXBsb2FkX2V4ZXJjaXNlX2Jvb2tcIjtcclxuICAgICAgICAgICAgfSBlbHNlIGlmICgkcHJpdmF0ZS5wYWdlVHlwZSA9PSAxKSB7ICAgICAvL+e8lui+kVxyXG4gICAgICAgICAgICAgICAgcG9zdFVybCA9IFwiL2V4ZXJjaXNlL3VwZGF0ZV9leGVyY2lzZV9ib29rXCI7XHJcbiAgICAgICAgICAgICAgICBwYXJhbXMuZXhlcmNpc2VfYm9va19pZCA9IEdldFF1ZXJ5U3RyaW5nKFwiZXhlcmNpc2VfYm9va19pZFwiKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiIHBhZ2VUeXBlIOWPguaVsOacieivr+OAglwiKTtcclxuICAgICAgICAgICAgICAgIGJhc2VVdGlscy5zaG93LnJlZFRpcChcIue9kee7nOmUmeivr++8jOivt+eojeWQjuWGjeivlVwiKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoJHByaXZhdGUuc3VibWl0TGltaXQpIHtcclxuICAgICAgICAgICAgICAgIGJhc2VVdGlscy5zaG93LnJlZFRpcChcIuato+WcqOaPkOS6pOS4re+8jOivt+eojeWQjuWGjeivlVwiKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAkcHJpdmF0ZS5zdWJtaXRMaW1pdCA9IHRydWU7XHJcbiAgICAgICAgICAgICQuYWpheChwb3N0VXJsLCB7XHJcbiAgICAgICAgICAgICAgICB0eXBlOiBcIlBPU1RcIixcclxuICAgICAgICAgICAgICAgIGRhdGFUeXBlOiBcImpzb25cIixcclxuICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICBwYXJhbXM6IHBhcmFtc1xyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChyZXN1bHQpIHtcclxuICAgICAgICAgICAgICAgICAgICAkcHJpdmF0ZS5zdWJtaXRMaW1pdCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChyZXN1bHQuY29kZSA9PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJhc2VVdGlscy5zaG93LmJsdWVUaXAoJHByaXZhdGUucGFnZVR5cGU9PTA/XCLliJvlu7rmiJDlip9cIjpcIue8lui+keaIkOWKn1wiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCRwcml2YXRlLnBhZ2VUeXBlID09IDApIHsgICAvL+WIm+W7ulxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGV4ZXJjaXNlQm9va0lkID0gcmVzdWx0LmRhdGEuZXhlcmNpc2VCb29rSWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXNzaW9uU3RvcmFnZS5zZXRJdGVtKFwibGFzdEV4ZXJjaXNlQm9va0lkXCIsIGV4ZXJjaXNlQm9va0lkKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlc3Npb25TdG9yYWdlLnNldEl0ZW0oXCJsYXN0UmVzb3VyY2VUeXBlXCIsIHJlc1R5cGUpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwYWdlSW5kZXggPSBHZXRRdWVyeVN0cmluZyhcInBhZ2VfaW5kZXhcIikgfHwgMTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gXCIvZXhlcmNpc2UvZXhlcmNpc2VfYm9va19saXN0P3BhZ2U9XCIgKyBwYWdlSW5kZXg7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sIDEwMDApO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJhc2VVdGlscy5zaG93LnJlZFRpcChyZXN1bHQubXNnKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgZXJyb3I6IGZ1bmN0aW9uICh4aHIsIHN0YXR1cywgZXJyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHByaXZhdGUuc3VibWl0TGltaXQgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xyXG4gICAgICAgICAgICAgICAgICAgIGFsZXJ0KFwi5pyN5Yqh5Zmo5Ye65bCP5beu5LqG77yM6K+356iN5ZCO5YaN6K+V77yBXCIpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgfTtcclxuICAgIGZ1bmN0aW9uIGNoZWNrSW5wdXROYW1lKCkge1xyXG4gICAgICAgIHZhciAkc2VsZiA9ICQoXCIjZXhlcmNpc2VCb29rTmFtZVwiKSxcclxuICAgICAgICAgICAgZXhlcmNpc2VOYW1lID0gJC50cmltKCRzZWxmLnZhbCgpKTtcclxuXHJcbiAgICAgICAgaWYgKGV4ZXJjaXNlTmFtZS5sZW5ndGggPiAxNCkge1xyXG4gICAgICAgICAgICAvLyBleGVyY2lzZU5hbWUgPSBleGVyY2lzZU5hbWUuc3Vic3RyKDAsIDE0KTtcclxuICAgICAgICAgICAgLy8gJHNlbGYudmFsKGV4ZXJjaXNlTmFtZSk7XHJcbiAgICAgICAgICAgICQoXCIuY2hhcmFjdGVyTnVtTGltaXRcIikuY3NzKHtcImNvbG9yXCI6IFwicmVkXCJ9KTtcclxuICAgICAgICAgICAgJChcIiNleGVyY2lzZUJvb2tOYW1lXCIpLmNzcyh7XCJib3JkZXItY29sb3JcIjogXCJyZWRcIn0pO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICQoXCIuY2hhcmFjdGVyTnVtTGltaXRcIikuY3NzKHtcImNvbG9yXCI6IFwiI2IyYjJiMlwifSk7XHJcbiAgICAgICAgICAgICQoXCIjZXhlcmNpc2VCb29rTmFtZVwiKS5jc3Moe1wiYm9yZGVyLWNvbG9yXCI6IFwiI2RjZGNkY1wifSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgICQoXCIuY2hhcmFjdGVyTnVtTGltaXQ+c3BhblwiKS50ZXh0KGV4ZXJjaXNlTmFtZS5sZW5ndGgpO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiAkbWFuYWdlRXhlcmNpc2U7XHJcbn0pKCk7XHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuIl19
