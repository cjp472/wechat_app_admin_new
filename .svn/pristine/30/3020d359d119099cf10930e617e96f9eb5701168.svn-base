$(document).ready(function(){Business.init()});var Business=function(){var e={};var i=false;e.submitLimit=false;e.communityId=-1;e.type=-1;e.dynamicId=-1;e.init=function(){changeSaveFlag(true);e.type=$("#admin_data").data("type");e.communityId=$("#admin_data").data("community_id");if(e.type==1){e.dynamicId=GetQueryString("id")}$("#uploadFile").click(function(){$("#selectPdfFile").click()});$("#deleteUploadedPdfFile").click(function(){$("#uploadedFileUrl").data("file_url","");$("#selectPdfFile").val("");$(".uploadBoxPdf").fadeOut(100)});$(".uploadFileBtnWrapper").on("change","#selectPdfFile",function(){if(!i){a(this.files,"pdf","Pdf",20)}else{baseUtils.show.redTip("文件正在上传中，请稍后再试")}});$("#releaseDynamic").click(function(){if(e.submitLimit==true){baseUtils.show.redTip("正在提交中，请稍后再试");return false}if(i){baseUtils.show.redTip("文件正在上传中，请稍后再提交");return false}var l={};var t=$("#dynamicTitle").val();if(t==""||t==undefined){baseUtils.show.redTip("请输入动态标题");return false}l["title"]=t;var a=UE.getEditor("container");var d=a.getContent();var n=a.getPlainTxt();if(d==""||d==undefined){baseUtils.show.redTip("请输入动态内容");return false}l["org_content"]=d;l["content"]=n;l["community_id"]=e.communityId;var o=$("#uploadedFileUrl").data("file_url");var s=$("#uploadedFileUrl").data("file_name");var u=$("#uploadedFileUrl").data("file_size");if(o!=""&&o!=undefined){l["file_url"]=o;l["file_name"]=s;l["file_size"]=u}else{l["file_url"]="";l["file_name"]="";l["file_size"]=""}var f="";if(e.type==1){l["id"]=e.dynamicId;f="/smallCommunity/updateDynamic"}else{f="/smallCommunity/uploadDynamic"}e.submitLimit=true;$.ajax(f,{type:"POST",dataType:"json",data:{params:l},success:function(i){if(i.code==0){if(e.type==1){baseUtils.show.blueTip("保存编辑成功")}else{baseUtils.show.blueTip("发布动态成功")}setTimeout(function(){window.location.href="/smallCommunity/dynamicList?community_id="+e.communityId},700)}else{baseUtils.show.redTip("发布出现问题，请稍后再试");e.submitLimit=false}},error:function(i,l,t){e.submitLimit=false;console.log(t);baseUtils.show.redTip("网络错误，请稍后再试！")}})})};function l(e){var i=null;if(window.createObjectURL!=undefined){i=window.createObjectURL(e)}else if(window.URL!=undefined){i=window.URL.createObjectURL(e)}else if(window.webkitURL!=undefined){i=window.webkitURL.createObjectURL(e)}return i}function t(e){if(window.revokeObjectURL!=undefined){window.revokeObjectURL(e)}else if(window.URL!=undefined){window.URL.revokeObjectURL(e)}else if(window.webkitURL!=undefined){window.webkitURL.revokeObjectURL(e)}}function a(e,l,t,a){if(e&&e.length>0){var n=e[0];var o=n.name;if(!o.toLowerCase().endsWith("pdf")){baseUtils.show.redTip("请选择 pdf 格式的文件");$("#selectPdfFile").remove();$("#uploadedFileUrl").before('<input class="selectPdfFileInput" id="selectPdfFile" type="file" accept="application/pdf"/>');return false}if($uploadFile.checkFileSize(n,a)){var s=(n.size/(1024*1024)).toFixed(2);$("#uploadedFileUrl").data("file_size",s);$("#audioURL"+t).hide();$(".uploadBox"+t).fadeIn(300);d(o,s);$("#uploadedFileUrl").data("file_name",o);i=true;$uploadFile.uploadRes(n,l,function(e){var i=parseInt(e*100);$(".uploadPLineActive"+t).css("width",i+"%");$(".uploadPercent"+t).text(i+"%")},function(e){i=false;console.log(e);baseUtils.show.blueTip("上传成功！");$(".uploadPLine"+t).hide();$(".upload"+t+"Name").show();$(".uploadPercent"+t).text("删除");var l=e.data.access_url;$("#uploadedFileUrl").data("file_url",l)},function(e){i=false;console.error("上传失败!!!");console.log(e);baseUtils.show.redTip("上传失败！")})}else{baseUtils.show.redTip("上传失败，请勿上传超过 "+a+"Mb 的PDF文件");$(".upLoad"+t).val("")}}else{console.log("网络错误，请稍后再试！")}}function d(e,i){$(".uploadPdfName").html(e).hide();$(".uploadPdfSize span").html(i);$(".uploadPLinePdf").show().find(".uploadPLineActivePdf").css("width","0");$(".uploadPercentPdf").html("")}return e}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFkbWluL2NvbW11bml0eU9wZXJhdGUvbWFuYWdlRHluYW1pYy5qcyJdLCJuYW1lcyI6WyIkIiwiZG9jdW1lbnQiLCJyZWFkeSIsIkJ1c2luZXNzIiwiaW5pdCIsImlzUGRmRmlsZVVwbG9hZGluZyIsInN1Ym1pdExpbWl0IiwiY29tbXVuaXR5SWQiLCJ0eXBlIiwiZHluYW1pY0lkIiwiY2hhbmdlU2F2ZUZsYWciLCJkYXRhIiwiR2V0UXVlcnlTdHJpbmciLCJjbGljayIsInZhbCIsImZhZGVPdXQiLCJvbiIsInJlc1VwbG9hZCIsInRoaXMiLCJmaWxlcyIsImJhc2VVdGlscyIsInNob3ciLCJyZWRUaXAiLCJwYXJhbXMiLCJkeW5hbWljVGl0bGUiLCJ1bmRlZmluZWQiLCJ1ZSIsIlVFIiwiZ2V0RWRpdG9yIiwib3JnX2NvbnRlbnQiLCJnZXRDb250ZW50IiwiZGVzY3JiIiwiZ2V0UGxhaW5UeHQiLCJwZGZGaWxlVXJsIiwicGRmRmlsZU5hbWUiLCJwZGZGaWxlU2l6ZSIsInBvc3RVcmwiLCJhamF4IiwiZGF0YVR5cGUiLCJzdWNjZXNzIiwicmVzdWx0IiwiY29kZSIsImJsdWVUaXAiLCJzZXRUaW1lb3V0Iiwid2luZG93IiwibG9jYXRpb24iLCJocmVmIiwiZXJyb3IiLCJ4aHIiLCJzdGF0dXMiLCJlcnIiLCJjb25zb2xlIiwibG9nIiwiZ2V0T2JqZWN0VVJMIiwiZmlsZSIsInVybCIsImNyZWF0ZU9iamVjdFVSTCIsIlVSTCIsIndlYmtpdFVSTCIsInJlbW92ZU9iamVjdFVSTCIsInJldm9rZU9iamVjdFVSTCIsInJlc1R5cGUiLCJyZXNUeXBlQ2xhc3MiLCJyZXNMaW1pdFNpemUiLCJsZW5ndGgiLCJuYW1lIiwidG9Mb3dlckNhc2UiLCJlbmRzV2l0aCIsInJlbW92ZSIsImJlZm9yZSIsIiR1cGxvYWRGaWxlIiwiY2hlY2tGaWxlU2l6ZSIsImZpbGVTaXplIiwic2l6ZSIsInRvRml4ZWQiLCJoaWRlIiwiZmFkZUluIiwiaW5pdEZpbGVBbmRQcm9ncmVzc0JhciIsInVwbG9hZFJlcyIsInByb2dyZXNzIiwicGFyc2VJbnQiLCJjc3MiLCJ0ZXh0IiwicmVzVXJsIiwiYWNjZXNzX3VybCIsImZpbGVOYW1lIiwiaHRtbCIsImZpbmQiXSwibWFwcGluZ3MiOiJBQUlBQSxFQUFFQyxVQUFVQyxNQUFNLFdBRWRDLFNBQVNDLFFBR2IsSUFBSUQsVUFBVyxXQUVYLEdBQUlBLEtBRUosSUFBSUUsR0FBcUIsS0FFekJGLEdBQVNHLFlBQWMsS0FDdkJILEdBQVNJLGFBQWUsQ0FDeEJKLEdBQVNLLE1BQVEsQ0FDakJMLEdBQVNNLFdBQWEsQ0FFdEJOLEdBQVNDLEtBQU8sV0FHWk0sZUFBZSxLQUVmUCxHQUFTSyxLQUFPUixFQUFFLGVBQWVXLEtBQUssT0FDdENSLEdBQVNJLFlBQWNQLEVBQUUsZUFBZVcsS0FBSyxlQUM3QyxJQUFJUixFQUFTSyxNQUFRLEVBQUcsQ0FDcEJMLEVBQVNNLFVBQVlHLGVBQWUsTUFJeENaLEVBQUUsZUFBZWEsTUFBTSxXQUNuQmIsRUFBRSxrQkFBa0JhLFNBSXhCYixHQUFFLDBCQUEwQmEsTUFBTSxXQUM5QmIsRUFBRSxvQkFBb0JXLEtBQUssV0FBWSxHQUN2Q1gsR0FBRSxrQkFBa0JjLElBQUksR0FDeEJkLEdBQUUsaUJBQWlCZSxRQUFRLE1BSS9CZixHQUFFLHlCQUF5QmdCLEdBQUcsU0FBVSxpQkFBa0IsV0FDdEQsSUFBS1gsRUFBb0IsQ0FDckJZLEVBQVVDLEtBQUtDLE1BQU8sTUFBTyxNQUFPLFFBQ2pDLENBQ0hDLFVBQVVDLEtBQUtDLE9BQU8sbUJBSzlCdEIsR0FBRSxtQkFBbUJhLE1BQU0sV0FHdkIsR0FBSVYsRUFBU0csYUFBZSxLQUFNLENBQzlCYyxVQUFVQyxLQUFLQyxPQUFPLGNBQ3RCLE9BQU8sT0FJWCxHQUFJakIsRUFBb0IsQ0FDcEJlLFVBQVVDLEtBQUtDLE9BQU8saUJBQ3RCLE9BQU8sT0FNWCxHQUFJQyxLQUVKLElBQUlDLEdBQWV4QixFQUFFLGlCQUFpQmMsS0FDdEMsSUFBSVUsR0FBZ0IsSUFBTUEsR0FBZ0JDLFVB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OiJhZG1pbi9jb21tdW5pdHlPcGVyYXRlL21hbmFnZUR5bmFtaWMuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICogQ3JlYXRlZCBieSBBZG1pbmlzdHJhdG9yIG9uIDIwMTcvNS8yLlxyXG4gKi9cclxuXHJcbiQoZG9jdW1lbnQpLnJlYWR5KGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICBCdXNpbmVzcy5pbml0KCk7XHJcbn0pXHJcblxyXG52YXIgQnVzaW5lc3MgPSAoZnVuY3Rpb24gKCkge1xyXG5cclxuICAgIHZhciBCdXNpbmVzcyA9IHt9O1xyXG5cclxuICAgIHZhciBpc1BkZkZpbGVVcGxvYWRpbmcgPSBmYWxzZTtcclxuXHJcbiAgICBCdXNpbmVzcy5zdWJtaXRMaW1pdCA9IGZhbHNlOyAgIC8v5o+Q5Lqk6ZmQ5Yi2XHJcbiAgICBCdXNpbmVzcy5jb21tdW5pdHlJZCA9IC0xO1xyXG4gICAgQnVzaW5lc3MudHlwZSA9IC0xOyAgICAgICAgICAgICAvLyAgMSAtIOe8lui+kSDvvJsgMCAtIOaWsOW7ulxyXG4gICAgQnVzaW5lc3MuZHluYW1pY0lkID0gLTE7XHJcblxyXG4gICAgQnVzaW5lc3MuaW5pdCA9IGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICAgICAgLy/ngrnlh7vkvqfovrnmoI/nprvlvIDml7bnmoTlvLnmoYZcclxuICAgICAgICBjaGFuZ2VTYXZlRmxhZyh0cnVlKTtcclxuXHJcbiAgICAgICAgQnVzaW5lc3MudHlwZSA9ICQoXCIjYWRtaW5fZGF0YVwiKS5kYXRhKFwidHlwZVwiKTtcclxuICAgICAgICBCdXNpbmVzcy5jb21tdW5pdHlJZCA9ICQoXCIjYWRtaW5fZGF0YVwiKS5kYXRhKFwiY29tbXVuaXR5X2lkXCIpO1xyXG4gICAgICAgIGlmIChCdXNpbmVzcy50eXBlID09IDEpIHtcclxuICAgICAgICAgICAgQnVzaW5lc3MuZHluYW1pY0lkID0gR2V0UXVlcnlTdHJpbmcoXCJpZFwiKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8v6YCJ5oup6ZyA6KaB5LiK5Lyg55qE5paH5Lu2XHJcbiAgICAgICAgJChcIiN1cGxvYWRGaWxlXCIpLmNsaWNrKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgJChcIiNzZWxlY3RQZGZGaWxlXCIpLmNsaWNrKCk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIC8v5Yig6Zmk5bey57uP5LiK5Lyg55qEcGRm5paH5Lu2XHJcbiAgICAgICAgJChcIiNkZWxldGVVcGxvYWRlZFBkZkZpbGVcIikuY2xpY2soZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAkKFwiI3VwbG9hZGVkRmlsZVVybFwiKS5kYXRhKFwiZmlsZV91cmxcIiwgXCJcIik7XHJcbiAgICAgICAgICAgICQoXCIjc2VsZWN0UGRmRmlsZVwiKS52YWwoXCJcIik7XHJcbiAgICAgICAgICAgICQoXCIudXBsb2FkQm94UGRmXCIpLmZhZGVPdXQoMTAwKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgLy/lpITnkIbpgInmi6nmlofku7blkI7nmoTkuIrkvKBcclxuICAgICAgICAkKFwiLnVwbG9hZEZpbGVCdG5XcmFwcGVyXCIpLm9uKFwiY2hhbmdlXCIsIFwiI3NlbGVjdFBkZkZpbGVcIiwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBpZiAoIWlzUGRmRmlsZVVwbG9hZGluZykge1xyXG4gICAgICAgICAgICAgICAgcmVzVXBsb2FkKHRoaXMuZmlsZXMsIFwicGRmXCIsIFwiUGRmXCIsIDIwKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGJhc2VVdGlscy5zaG93LnJlZFRpcChcIuaWh+S7tuato+WcqOS4iuS8oOS4re+8jOivt+eojeWQjuWGjeivlVwiKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICAvL+WPkeW4g+WKqOaAgVxyXG4gICAgICAgICQoXCIjcmVsZWFzZUR5bmFtaWNcIikuY2xpY2soZnVuY3Rpb24gKCkge1xyXG5cclxuICAgICAgICAgICAgLy8gIOmYsuatoumHjeWkjeaPkOS6pFxyXG4gICAgICAgICAgICBpZiAoQnVzaW5lc3Muc3VibWl0TGltaXQgPT0gdHJ1ZSkge1xyXG4gICAgICAgICAgICAgICAgYmFzZVV0aWxzLnNob3cucmVkVGlwKFwi5q2j5Zyo5o+Q5Lqk5Lit77yM6K+356iN5ZCO5YaN6K+VXCIpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvLyAg5paH5Lu25q2j5Zyo5LiK5Lyg5LitXHJcbiAgICAgICAgICAgIGlmIChpc1BkZkZpbGVVcGxvYWRpbmcpIHtcclxuICAgICAgICAgICAgICAgIGJhc2VVdGlscy5zaG93LnJlZFRpcChcIuaWh+S7tuato+WcqOS4iuS8oOS4re+8jOivt+eojeWQjuWGjeaPkOS6pFwiKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgLyoqXHJcbiAgICAgICAgICAgICAqIOmcgOimgeeahOWPguaVsCDvvJogY29tbXVuaXR5X2lkIC0gdGl0bGUgLSBvcmdfY29udGVudCAtIGNvbnRlbnQgLSBmaWxlX3VybCAtIGZpbGVfbmFtZSAtIGZpbGVfc2l6ZVxyXG4gICAgICAgICAgICAgKi9cclxuICAgICAgICAgICAgdmFyIHBhcmFtcyA9IHt9O1xyXG5cclxuICAgICAgICAgICAgdmFyIGR5bmFtaWNUaXRsZSA9ICQoXCIjZHluYW1pY1RpdGxlXCIpLnZhbCgpO1xyXG4gICAgICAgICAgICBpZiAoZHluYW1pY1RpdGxlID09ICcnIHx8IGR5bmFtaWNUaXRsZSA9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgIGJhc2VVdGlscy5zaG93LnJlZFRpcChcIuivt+i+k+WFpeWKqOaAgeagh+mimFwiKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBwYXJhbXNbJ3RpdGxlJ10gPSBkeW5hbWljVGl0bGU7XHJcblxyXG4gICAgICAgICAgICAvLyAg6I635Y+W5Yqo5oCBIGh0bWzlhoXlrrnvvIzov5Tlm546IDxwPmhlbGxvPC9wPlxyXG4gICAgICAgICAgICB2YXIgdWUgPSBVRS5nZXRFZGl0b3IoJ2NvbnRhaW5lcicpO1xyXG4gICAgICAgICAgICB2YXIgb3JnX2NvbnRlbnQgPSB1ZS5nZXRDb250ZW50KCk7ICAgIC8vICDljp/lp4todG1s5YaF5a65XHJcbiAgICAgICAgICAgIHZhciBkZXNjcmIgPSB1ZS5nZXRQbGFpblR4dCgpOyAgICAgICAgLy8gIOe6r+aWh+acrFxyXG5cclxuICAgICAgICAgICAgaWYgKG9yZ19jb250ZW50ID09ICcnIHx8IG9yZ19jb250ZW50ID09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgYmFzZVV0aWxzLnNob3cucmVkVGlwKFwi6K+36L6T5YWl5Yqo5oCB5YaF5a65XCIpO1xyXG5cclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBwYXJhbXNbJ29yZ19jb250ZW50J10gPSBvcmdfY29udGVudDtcclxuICAgICAgICAgICAgcGFyYW1zWydjb250ZW50J10gPSBkZXNjcmI7XHJcblxyXG4gICAgICAgICAgICBwYXJhbXNbJ2NvbW11bml0eV9pZCddID0gQnVzaW5lc3MuY29tbXVuaXR5SWQ7XHJcblxyXG4gICAgICAgICAgICAvL+aWh+S7tuWxnuaAp1xyXG4gICAgICAgICAgICB2YXIgcGRmRmlsZVVybCA9ICQoXCIjdXBsb2FkZWRGaWxlVXJsXCIpLmRhdGEoXCJmaWxlX3VybFwiKTtcclxuICAgICAgICAgICAgdmFyIHBkZkZpbGVOYW1lID0gJChcIiN1cGxvYWRlZEZpbGVVcmxcIikuZGF0YShcImZpbGVfbmFtZVwiKTtcclxuICAgICAgICAgICAgdmFyIHBkZkZpbGVTaXplID0gJChcIiN1cGxvYWRlZEZpbGVVcmxcIikuZGF0YShcImZpbGVfc2l6ZVwiKTtcclxuXHJcbiAgICAgICAgICAgIGlmIChwZGZGaWxlVXJsICE9IFwiXCIgJiYgcGRmRmlsZVVybCAhPSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgIHBhcmFtc1snZmlsZV91cmwnXSA9IHBkZkZpbGVVcmw7XHJcbiAgICAgICAgICAgICAgICBwYXJhbXNbJ2ZpbGVfbmFtZSddID0gcGRmRmlsZU5hbWU7XHJcbiAgICAgICAgICAgICAgICBwYXJhbXNbJ2ZpbGVfc2l6ZSddID0gcGRmRmlsZVNpemU7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBwYXJhbXNbJ2ZpbGVfdXJsJ10gPSBcIlwiO1xyXG4gICAgICAgICAgICAgICAgcGFyYW1zWydmaWxlX25hbWUnXSA9IFwiXCI7XHJcbiAgICAgICAgICAgICAgICBwYXJhbXNbJ2ZpbGVfc2l6ZSddID0gXCJcIjtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgdmFyIHBvc3RVcmwgPSBcIlwiO1xyXG4gICAgICAgICAgICBpZiAoQnVzaW5lc3MudHlwZSA9PSAxKSB7ICAgLy8gIOe8lui+kVxyXG4gICAgICAgICAgICAgICAgcGFyYW1zWydpZCddID0gQnVzaW5lc3MuZHluYW1pY0lkO1xyXG4gICAgICAgICAgICAgICAgcG9zdFVybCA9IFwiL3NtYWxsQ29tbXVuaXR5L3VwZGF0ZUR5bmFtaWNcIjtcclxuICAgICAgICAgICAgfSBlbHNlIHsgICAgLy8gIOaWsOW7ulxyXG4gICAgICAgICAgICAgICAgcG9zdFVybCA9IFwiL3NtYWxsQ29tbXVuaXR5L3VwbG9hZER5bmFtaWNcIjtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgQnVzaW5lc3Muc3VibWl0TGltaXQgPSB0cnVlO1xyXG5cclxuICAgICAgICAgICAgJC5hamF4KHBvc3RVcmwsIHtcclxuICAgICAgICAgICAgICAgIHR5cGU6IFwiUE9TVFwiLFxyXG4gICAgICAgICAgICAgICAgZGF0YVR5cGU6IFwianNvblwiLFxyXG4gICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgIHBhcmFtczogcGFyYW1zXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24gKHJlc3VsdCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChyZXN1bHQuY29kZSA9PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChCdXNpbmVzcy50eXBlID09IDEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhc2VVdGlscy5zaG93LmJsdWVUaXAoXCLkv53lrZjnvJbovpHmiJDlip9cIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiYXNlVXRpbHMuc2hvdy5ibHVlVGlwKFwi5Y+R5biD5Yqo5oCB5oiQ5YqfXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWY9XCIvc21hbGxDb21tdW5pdHkvZHluYW1pY0xpc3Q/Y29tbXVuaXR5X2lkPVwiICsgQnVzaW5lc3MuY29tbXVuaXR5SWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sIDcwMCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYmFzZVV0aWxzLnNob3cucmVkVGlwKFwi5Y+R5biD5Ye6546w6Zeu6aKY77yM6K+356iN5ZCO5YaN6K+VXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBCdXNpbmVzcy5zdWJtaXRMaW1pdCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICBlcnJvcjogZnVuY3Rpb24gKHhociwgc3RhdHVzLCBlcnIpIHtcclxuICAgICAgICAgICAgICAgICAgICBCdXNpbmVzcy5zdWJtaXRMaW1pdCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycik7XHJcbiAgICAgICAgICAgICAgICAgICAgYmFzZVV0aWxzLnNob3cucmVkVGlwKFwi572R57uc6ZSZ6K+v77yM6K+356iN5ZCO5YaN6K+V77yBXCIpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgfTtcclxuXHJcbiAgICAvL+WPlua2iOS4iuS8oOWIpOaWreWPguaVsFxyXG4gICAgLy8gdmFyIHVwbG9hZENhbmNlbD0wO1xyXG4gICAgZnVuY3Rpb24gZ2V0T2JqZWN0VVJMKGZpbGUpIHtcclxuICAgICAgICB2YXIgdXJsID0gbnVsbDtcclxuICAgICAgICBpZiAod2luZG93LmNyZWF0ZU9iamVjdFVSTCAhPSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgdXJsID0gd2luZG93LmNyZWF0ZU9iamVjdFVSTChmaWxlKTtcclxuICAgICAgICB9IGVsc2UgaWYgKHdpbmRvdy5VUkwgIT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIHVybCA9IHdpbmRvdy5VUkwuY3JlYXRlT2JqZWN0VVJMKGZpbGUpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAod2luZG93LndlYmtpdFVSTCAhPSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgdXJsID0gd2luZG93LndlYmtpdFVSTC5jcmVhdGVPYmplY3RVUkwoZmlsZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB1cmw7XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gcmVtb3ZlT2JqZWN0VVJMKHVybCkgey8v6YeK5pS+6LWE5rqQVVJMXHJcbiAgICAgICAgaWYgKHdpbmRvdy5yZXZva2VPYmplY3RVUkwgIT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIHdpbmRvdy5yZXZva2VPYmplY3RVUkwodXJsKTtcclxuICAgICAgICB9IGVsc2UgaWYgKHdpbmRvdy5VUkwgIT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIHdpbmRvdy5VUkwucmV2b2tlT2JqZWN0VVJMKHVybCk7XHJcbiAgICAgICAgfSBlbHNlIGlmICh3aW5kb3cud2Via2l0VVJMICE9IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICB3aW5kb3cud2Via2l0VVJMLnJldm9rZU9iamVjdFVSTCh1cmwpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcblxyXG4gICAgLy/otYTmupDkuIrkvKDlh73mlbAo5Y+C5pWw77yacmVzVHlwZTrotYTmupDnsbvlnosscmVzVHlwZUNsYXNzOui1hOa6kOexu+Wei+S4ree7huWIhueahOenjeexuyxyZXNMaW1pdFNpemU66LWE5rqQ6ZmQ5Yi25aSn5bCPKVxyXG4gICAgZnVuY3Rpb24gcmVzVXBsb2FkKGZpbGVzLCByZXNUeXBlLCByZXNUeXBlQ2xhc3MsIHJlc0xpbWl0U2l6ZSkge1xyXG4gICAgICAgIGlmIChmaWxlcyAmJiBmaWxlcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIHZhciBmaWxlID0gZmlsZXNbMF07XHJcbiAgICAgICAgICAgIHZhciBwZGZGaWxlTmFtZSA9IGZpbGUubmFtZTtcclxuICAgICAgICAgICAgaWYgKCFwZGZGaWxlTmFtZS50b0xvd2VyQ2FzZSgpLmVuZHNXaXRoKFwicGRmXCIpKSB7XHJcbiAgICAgICAgICAgICAgICBiYXNlVXRpbHMuc2hvdy5yZWRUaXAoXCLor7fpgInmi6kgcGRmIOagvOW8j+eahOaWh+S7tlwiKTtcclxuICAgICAgICAgICAgICAgICQoXCIjc2VsZWN0UGRmRmlsZVwiKS5yZW1vdmUoKTtcclxuICAgICAgICAgICAgICAgICQoXCIjdXBsb2FkZWRGaWxlVXJsXCIpLmJlZm9yZSgnPGlucHV0IGNsYXNzPVwic2VsZWN0UGRmRmlsZUlucHV0XCIgaWQ9XCJzZWxlY3RQZGZGaWxlXCIgdHlwZT1cImZpbGVcIiBhY2NlcHQ9XCJhcHBsaWNhdGlvbi9wZGZcIi8+Jyk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIC8vIOmZkOWItui1hOa6kOWcqCpNQuWGhVxyXG4gICAgICAgICAgICBpZiAoJHVwbG9hZEZpbGUuY2hlY2tGaWxlU2l6ZShmaWxlLCByZXNMaW1pdFNpemUpKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgdmFyIGZpbGVTaXplID0gKGZpbGUuc2l6ZSAvICgxMDI0ICogMTAyNCkpLnRvRml4ZWQoMik7XHJcbiAgICAgICAgICAgICAgICAkKFwiI3VwbG9hZGVkRmlsZVVybFwiKS5kYXRhKFwiZmlsZV9zaXplXCIsIGZpbGVTaXplKTtcclxuICAgICAgICAgICAgICAgICQoJyNhdWRpb1VSTCcrcmVzVHlwZUNsYXNzKS5oaWRlKCk7XHJcbiAgICAgICAgICAgICAgICAkKFwiLnVwbG9hZEJveFwiK3Jlc1R5cGVDbGFzcykuZmFkZUluKDMwMCk7XHJcbiAgICAgICAgICAgICAgICAvLyDliJ3lp4vljJbmlofku7bku6Xlj4rov5vluqbmnaFcclxuICAgICAgICAgICAgICAgIGluaXRGaWxlQW5kUHJvZ3Jlc3NCYXIocGRmRmlsZU5hbWUsIGZpbGVTaXplKTtcclxuXHJcbiAgICAgICAgICAgICAgICAkKFwiI3VwbG9hZGVkRmlsZVVybFwiKS5kYXRhKFwiZmlsZV9uYW1lXCIsIHBkZkZpbGVOYW1lKTtcclxuXHJcbiAgICAgICAgICAgICAgICBpc1BkZkZpbGVVcGxvYWRpbmcgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgJHVwbG9hZEZpbGUudXBsb2FkUmVzKGZpbGUsIHJlc1R5cGUsIGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwcm9ncmVzcyA9IHBhcnNlSW50KGRhdGEgKiAxMDApO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKHByb2dyZXNzKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJChcIi51cGxvYWRQTGluZUFjdGl2ZVwiICsgcmVzVHlwZUNsYXNzKS5jc3MoXCJ3aWR0aFwiLCBwcm9ncmVzcyArICclJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICQoXCIudXBsb2FkUGVyY2VudFwiICsgcmVzVHlwZUNsYXNzKS50ZXh0KHByb2dyZXNzICsgXCIlXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgLy8g5LiK5Lyg5oiQ5Yqf5Zue6LCDXHJcbiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaXNQZGZGaWxlVXBsb2FkaW5nID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBiYXNlVXRpbHMuc2hvdy5ibHVlVGlwKFwi5LiK5Lyg5oiQ5Yqf77yBXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkKFwiLnVwbG9hZFBMaW5lXCIgKyByZXNUeXBlQ2xhc3MpLmhpZGUoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJChcIi51cGxvYWRcIiArIHJlc1R5cGVDbGFzcyArIFwiTmFtZVwiKS5zaG93KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICQoXCIudXBsb2FkUGVyY2VudFwiICsgcmVzVHlwZUNsYXNzKS50ZXh0KFwi5Yig6ZmkXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVzVXJsID0gZGF0YS5kYXRhLmFjY2Vzc191cmw7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICQoXCIjdXBsb2FkZWRGaWxlVXJsXCIpLmRhdGEoXCJmaWxlX3VybFwiLCByZXNVcmwpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIC8vIOS4iuS8oOWksei0peWbnuiwg1xyXG4gICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlzUGRmRmlsZVVwbG9hZGluZyAgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihcIuS4iuS8oOWksei0pSEhIVwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJhc2VVdGlscy5zaG93LnJlZFRpcChcIuS4iuS8oOWksei0pe+8gVwiKTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGJhc2VVdGlscy5zaG93LnJlZFRpcChcIuS4iuS8oOWksei0pe+8jOivt+WLv+S4iuS8oOi2hei/hyBcIiArIHJlc0xpbWl0U2l6ZSArIFwiTWIg55qEUERG5paH5Lu2XCIpO1xyXG4gICAgICAgICAgICAgICAgJChcIi51cExvYWRcIityZXNUeXBlQ2xhc3MpLnZhbChcIlwiKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwi572R57uc6ZSZ6K+v77yM6K+356iN5ZCO5YaN6K+V77yBXCIpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgLy8g5Yid5aeL5YyW5paH5Lu25Lul5Y+K6L+b5bqm5p2hXHJcbiAgICBmdW5jdGlvbiBpbml0RmlsZUFuZFByb2dyZXNzQmFyKGZpbGVOYW1lLCBmaWxlU2l6ZSkge1xyXG5cclxuICAgICAgICAkKFwiLnVwbG9hZFBkZk5hbWVcIikuaHRtbChmaWxlTmFtZSkuaGlkZSgpO1xyXG4gICAgICAgICQoXCIudXBsb2FkUGRmU2l6ZSBzcGFuXCIpLmh0bWwoZmlsZVNpemUpO1xyXG4gICAgICAgICQoXCIudXBsb2FkUExpbmVQZGZcIikuc2hvdygpXHJcbiAgICAgICAgICAgIC5maW5kKFwiLnVwbG9hZFBMaW5lQWN0aXZlUGRmXCIpLmNzcyhcIndpZHRoXCIsICcwJyk7XHJcbiAgICAgICAgJChcIi51cGxvYWRQZXJjZW50UGRmXCIpLmh0bWwoJycpO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gQnVzaW5lc3M7XHJcblxyXG59KSgpO1xyXG5cclxuIl19
