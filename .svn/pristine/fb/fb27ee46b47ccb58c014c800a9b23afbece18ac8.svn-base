var width;var height;var params={};var pay_type=2;var resource_type;var cos=new InitCosCloud;var SID;var Poffset;var files=[];var transcodeNotifyUrl;var secretId;var fileId;var videoGsize;var is_edit=false;$(document).ready(function(){initUpload()});function getParameterByName(e,i){if(!i)i=window.location.href;e=e.replace(/[\[\]]/g,"\\$&");var t=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)"),o=t.exec(i);if(!o)return null;if(!o[2])return"";return decodeURIComponent(o[2].replace(/\+/g," "))}function getObjectURL(e){var i=null;if(window.createObjectURL!=undefined){i=window.createObjectURL(e)}else if(window.URL!=undefined){i=window.URL.createObjectURL(e)}else if(window.webkitURL!=undefined){i=window.webkitURL.createObjectURL(e)}return i}function initUpload(){var e=qcVideo.get("$");var i=qcVideo.get("Version");if(!qcVideo.uploader.supportBrowser()){if(i.IS_MOBILE){baseUtils.show.redTip("当前浏览器不支持上传，请升级系统版本或者下载最新的chrome浏览器")}else{getInternetExplorerVersion()}return}var t=1;var o=0;accountDone("video_file",t,o,"")}var accountDone=function(e,i,t,o){var a=qcVideo.get("$"),d=qcVideo.get("ErrorCode"),s=qcVideo.get("Log"),r=qcVideo.get("JSON"),l=qcVideo.get("util"),n=qcVideo.get("Code"),c=qcVideo.get("Version");qcVideo.uploader.init({web_upload_url:"https://vod.qcloud.com/v2/index.php",secretId:secretId,getSignature:function(e,i){a.ajax({dataType:"json",url:"/getsig?args="+encodeURIComponent(e),success:function(e){i(e["result"])}})},upBtnId:e,isTranscode:i,isWatermark:t,after_sha_start_upload:true,sha1js_path:"/calculator_worker_sha1.js",disable_multi_selection:false,transcodeNotifyUrl:transcodeNotifyUrl,classId:o,filters:{max_file_size:"2gb",mime_types:["MP4"],video_only:true},forceH5Worker:true},{onFileUpdate:function(e){console.log(transcodeNotifyUrl);a("#videoName").hide();a(".videoUploadCancle").data("videoid",e.id);a(".videoUploadBox").fadeIn(300);is_edit=true;var i=e.size;videoGsize=i/(1024*1024);if(videoGsize>1e3){setTimeout(function(){alert("请将视频文件压缩到 1G 以内!")},100);a(".videoUploadCancle").click();return}if(e.code==1){if(files.length==1){if(files[0]!=undefined){var t=files[0].id;qcVideo.uploader.deleteFile(t);deleteFromFile(t);a("#"+t).remove();console.log("删除了一个文件:"+t)}}var o=a("#"+e.id);if(!o.get(0)){a("#progress_show").append("<div class='progress_div' id = '"+e.id+"'><span style='font-size: 12px'>"+e.name+":</span><div class='progress_bar' id = 'progress_bar_"+e.id+"'><div class='bar' id='bar_"+e.id+"'></div></div><span class='upload_finish' id='upload_finish_"+e.id+"'>上传完成</span><span data-act='del' data-type='0' class='delete'>删除</span></div>")}var d={id:e.id,size:e.size,state:0,file_id:"",size_text:e.size_text,type:1};files[files.length]=d;a(".videoBoxTitle").text(e.name);a(".videoSize").text(e.size_text);a(".uploadRatio span:nth-of-type(2)").text(e.size_text);a(".videoPercent").text("视频正在解析中");a(".uploadRatio span").text("");a(".videoUploadLineA").css("width","0%");console.log("添加了一个新的文件:"+"id:"+e.id+"size:"+e.size)}if(e.code==2){files[0]["state"]=2}if(e.code==5&&e.percent>0){var s=parseFloat(e.size_text)*parseFloat(e.percent/100);s=s.toFixed(2);a(".videoUploadLineA").css("width",e.percent+"%");a(".videoPercent").text(e.percent+"%");a(".uploadRatio span:nth-of-type(1)").text(s);a(".uploadRatio span:nth-of-type(2)").text(e.size_text);if(!e.speed){a(".uploadSpeed span").text("");a(".videoTimeLeft span").text("")}else{a(".uploadSpeed span").text(e.speed)}}if(e.code==6){is_edit=false;var s=e.size_text*e.percent;a(".videoUploadLineA").css("width","100%");a(".videoPercent").text("已完成");a(".uploadRatio span:nth-of-type(1)").text(e.size_text);a(".uploadRatio span:nth-of-type(2)").text(e.size_text);fileId=e.serverFileId;VideoName=e.name;for(var r=0;r<files.length;r++){if(e.id==files[r]["id"]){files[r]["state"]=6;files[r]["file_id"]=e.serverFileId;break}}if(isUploadFinish()){var l=generateParams()}}console.log(e)},onFileStatus:function(e){console.log("各状态总数--\x3e"+r.stringify(e))},onFilterError:function(e){var i="message:"+e.message+(e.solution?";solution=="+e.solution:"");if(e.code==-1){baseUtils.show.redTip("请上传正确格式的文件")}}});a(".videoUploadCancle").click(function(){a(".videoUploadBox").fadeOut(300);s.debug("delete",fileId);qcVideo.uploader.deleteFile(fileId);deleteFromFile(fileId);fileId=null})};function deleteFromFile(e){for(var i=0;i<files.length;i++){var t=files[i];if(e==t["id"]){files.splice(i,1);console.log("从files中删除了一个文件:"+e)}}}function isUploadFinish(){var e=true;for(var i=0;i<files.length;i++){if(files[i]["state"]!=6){e=false}}return e}function generateParams(){var e={};if(files.length==1){e={public_video:files[0]["file_id"],public_size_text:files[0]["size"]/(1024*1024)}}return e}var try_count=0;function videoUpload(){if(try_count>=300){hideLoading();baseUtils.show.redTip("视频解析失败,请更新浏览器版本重新上传");return}setTimeout(function(){if(files.length>0&&files[0]["state"]==2){console.log("解析完成");qcVideo.uploader.startUpload()}else{try_count++;console.log("解析还未完成");videoUpload()}},1e3)}
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInZpZGVvVXBsb2FkT2xkLmpzIl0sIm5hbWVzIjpbIndpZHRoIiwiaGVpZ2h0IiwicGFyYW1zIiwicGF5X3R5cGUiLCJyZXNvdXJjZV90eXBlIiwiY29zIiwiSW5pdENvc0Nsb3VkIiwiU0lEIiwiUG9mZnNldCIsImZpbGVzIiwidHJhbnNjb2RlTm90aWZ5VXJsIiwic2VjcmV0SWQiLCJmaWxlSWQiLCJ2aWRlb0dzaXplIiwiaXNfZWRpdCIsIiQiLCJkb2N1bWVudCIsInJlYWR5IiwiaW5pdFVwbG9hZCIsImdldFBhcmFtZXRlckJ5TmFtZSIsIm5hbWUiLCJ1cmwiLCJ3aW5kb3ciLCJsb2NhdGlvbiIsImhyZWYiLCJyZXBsYWNlIiwicmVnZXgiLCJSZWdFeHAiLCJyZXN1bHRzIiwiZXhlYyIsImRlY29kZVVSSUNvbXBvbmVudCIsImdldE9iamVjdFVSTCIsImZpbGUiLCJjcmVhdGVPYmplY3RVUkwiLCJ1bmRlZmluZWQiLCJVUkwiLCJ3ZWJraXRVUkwiLCJxY1ZpZGVvIiwiZ2V0IiwiVmVyc2lvbiIsInVwbG9hZGVyIiwic3VwcG9ydEJyb3dzZXIiLCJJU19NT0JJTEUiLCJiYXNlVXRpbHMiLCJzaG93IiwicmVkVGlwIiwiZ2V0SW50ZXJuZXRFeHBsb3JlclZlcnNpb24iLCJpc1RyYW5zY29kZSIsImlzV2F0ZXJtYXJrIiwiYWNjb3VudERvbmUiLCJ1cEJ0bklkIiwiY2xhc3NJZCIsIkVycm9yQ29kZSIsIkxvZyIsIkpTT04iLCJ1dGlsIiwiQ29kZSIsImluaXQiLCJ3ZWJfdXBsb2FkX3VybCIsImdldFNpZ25hdHVyZSIsImFyZ09iaiIsImRvbmUiLCJhamF4IiwiZGF0YVR5cGUiLCJlbmNvZGVVUklDb21wb25lbnQiLCJzdWNjZXNzIiwiZCIsImFmdGVyX3NoYV9zdGFydF91cGxvYWQiLCJzaGExanNfcGF0aCIsImRpc2FibGVfbXVsdGlfc2VsZWN0aW9uIiwiZmlsdGVycyIsIm1heF9maWxlX3NpemUiLCJtaW1lX3R5cGVzIiwidmlkZW9fb25seSIsImZvcmNlSDVXb3JrZXIiLCJvbkZpbGVVcGRhdGUiLCJhcmdzIiwiY29uc29sZSIsImxvZyIsImhpZGUiLCJkYXRhIiwiaWQiLCJmYWRlSW4iLCJ2aWRlb1NpemVTIiwic2l6ZSIsInNldFRpbWVvdXQiLCJhbGVydCIsImNsaWNrIiwiY29kZSIsImxlbmd0aCIsIm9sZF9pZCIsImRlbGV0ZUZpbGUiLCJkZWxldGVGcm9tRmlsZSIsInJlbW92ZSIsIiRsaW5lIiwiYXBwZW5kIiwiaW5mb19pdGVtIiwic3RhdGUiLCJmaWxlX2lkIiwic2l6ZV90ZXh0IiwidHlwZSIsInRleHQiLCJjc3MiLCJwZXJjZW50IiwidXBsb2FkQ29tcGxldGVTaXplIiwicGFyc2VGbG9hdCIsInRvRml4ZWQiLCJzcGVlZCIsInNlcnZlckZpbGVJZCIsIlZpZGVvTmFtZSIsImkiLCJpc1VwbG9hZEZpbmlzaCIsImV4dGVybmFsUGFyYW1zIiwiZ2VuZXJhdGVQYXJhbXMiLCJvbkZpbGVTdGF0dXMiLCJpbmZvIiwic3RyaW5naWZ5Iiwib25GaWx0ZXJFcnJvciIsIm1zZyIsIm1lc3NhZ2UiLCJzb2x1dGlvbiIsImZhZGVPdXQiLCJkZWJ1ZyIsIml0ZW0iLCJzcGxpY2UiLCJpc0ZpbmlzaCIsImZpbGVfaWRfcGFyYW1zIiwicHVibGljX3ZpZGVvIiwicHVibGljX3NpemVfdGV4dCIsInRyeV9jb3VudCIsInZpZGVvVXBsb2FkIiwiaGlkZUxvYWRpbmciLCJzdGFydFVwbG9hZCJdLCJtYXBwaW5ncyI6IkFBQUEsR0FBSUEsTUFDSixJQUFJQyxPQUVKLElBQUlDLFVBRUosSUFBSUMsVUFBVyxDQUVmLElBQUlDLGNBS0osSUFBSUMsS0FBTSxHQUFJQyxhQUdkLElBQUlDLElBRUosSUFBSUMsUUFFSixJQUFJQyxTQUNKLElBQUlDLG1CQUNKLElBQUlDLFNBQ0osSUFBSUMsT0FDSixJQUFJQyxXQUVKLElBQUlDLFNBQVUsS0FHZEMsR0FBRUMsVUFBVUMsTUFBTSxXQUVkQyxjQVVKLFNBQVNDLG9CQUFtQkMsRUFBTUMsR0FDOUIsSUFBS0EsRUFB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QU9sSCxNQUFNcUcsRUFDakIsSUFBSTdCLEdBQU0wQyxFQUFLLE1BQU8sQ0FFbEJsSCxNQUFNbUgsT0FBT2QsRUFBRyxFQUNoQmpDLFNBQVFDLElBQUksa0JBQW9CRyxLQU01QyxRQUFTOEIsa0JBQ0wsR0FBSWMsR0FBVyxJQUNmLEtBQUssR0FBSWYsR0FBSSxFQUFHQSxFQUFJckcsTUFBTWdGLE9BQVFxQixJQUFLLENBQ25DLEdBQUlyRyxNQUFNcUcsR0FBRyxVQUFZLEVBQUcsQ0FDeEJlLEVBQVcsT0FHbkIsTUFBT0EsR0FHWCxRQUFTWixrQkFDTCxHQUFJYSxLQUNKLElBQUlySCxNQUFNZ0YsUUFBVSxFQUFHLENBRW5CcUMsR0FDSUMsYUFBZ0J0SCxNQUFNLEdBQUcsV0FBWXVILGlCQUFxQnZILE1BQU0sR0FBRyxTQUFTLEtBQUssT0FHekYsTUFBT3FILEdBa0NYLEdBQUlHLFdBQVUsQ0FHZCxTQUFTQyxlQUNMLEdBQUlELFdBQWEsSUFBSyxDQUNsQkUsYUFDQXhGLFdBQVVDLEtBQUtDLE9BQU8sc0JBQ3RCLFFBRUp3QyxXQUNJLFdBQ0ksR0FBRzVFLE1BQU1nRixPQUFPLEdBQUdoRixNQUFNLEdBQUcsVUFBVSxFQUFFLENBQ3BDb0UsUUFBUUMsSUFBSSxPQUNaekMsU0FBUUcsU0FBUzRGLGtCQUNoQixDQUNESCxXQUNBcEQsU0FBUUMsSUFBSSxTQUNab0QsaUJBRU4iLCJmaWxlIjoidmlkZW9VcGxvYWRPbGQuanMiLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgd2lkdGg7XG52YXIgaGVpZ2h0O1xuXG52YXIgcGFyYW1zID0ge307XG5cbnZhciBwYXlfdHlwZSA9IDI7IC8v5LuY6LS557G75Z6LLDHooajnpLrlhY3otLnjgIEy6KGo56S65Y2V5Liq5LuY6LS5LDPooajnpLrkuJPmoI/jgIJcblxudmFyIHJlc291cmNlX3R5cGU7Ly/liJvlu7rnsbvlnotcblxuLy/ohb7orq/kupHotYTmupBcbi8vdmFyIGJ1Y2tldE5hbWUgPSB3aW5kb3cuY29zX2J1Y2tldF9uYW1lO1xuLy92YXIgY29zID0gbmV3IENvc0Nsb3VkKHdpbmRvdy5jb3NfYXBwX2lkKTtcbnZhciBjb3MgPSBuZXcgSW5pdENvc0Nsb3VkKCk7XG5cbi8vU2V0SW50ZXJ2YWzov5Tlm55JRFxudmFyIFNJRDtcbi8v5q276L+b5bqm5p2h5q+P5qyh5Y+Y5YyW6YePXG52YXIgUG9mZnNldDtcblxudmFyIGZpbGVzID0gW107IC8v5a2Y5pS+5paH5Lu2XG52YXIgdHJhbnNjb2RlTm90aWZ5VXJsOy8vIOi9rOeggeaIkOWKn+Wbnuiwg+WcsOWdgFxudmFyIHNlY3JldElkO1xudmFyIGZpbGVJZDtcbnZhciB2aWRlb0dzaXplO1xuXG52YXIgaXNfZWRpdCA9IGZhbHNlO1xuXG5cbiQoZG9jdW1lbnQpLnJlYWR5KGZ1bmN0aW9uICgpIHtcbiAgICAvL+WIneWni+WMluS4iuS8oOepuumXtFxuICAgIGluaXRVcGxvYWQoKTtcbn0pO1xuXG5cbi8qKlxuICog6I635Y+WdXJp5Y+C5pWwXG4gKiBAcGFyYW0gbmFtZVxuICogQHBhcmFtIHVybFxuICogQHJldHVybnMgeyp9XG4gKi9cbmZ1bmN0aW9uIGdldFBhcmFtZXRlckJ5TmFtZShuYW1lLCB1cmwpIHtcbiAgICBpZiAoIXVybCkgdXJsID0gd2luZG93LmxvY2F0aW9uLmhyZWY7XG4gICAgbmFtZSA9IG5hbWUucmVwbGFjZSgvW1xcW1xcXV0vZywgXCJcXFxcJCZcIik7XG4gICAgdmFyIHJlZ2V4ID0gbmV3IFJlZ0V4cChcIls/Jl1cIiArIG5hbWUgKyBcIig9KFteJiNdKil8JnwjfCQpXCIpLFxuICAgICAgICByZXN1bHRzID0gcmVnZXguZXhlYyh1cmwpO1xuICAgIGlmICghcmVzdWx0cykgcmV0dXJuIG51bGw7XG4gICAgaWYgKCFyZXN1bHRzWzJdKSByZXR1cm4gJyc7XG4gICAgcmV0dXJuIGRlY29kZVVSSUNvbXBvbmVudChyZXN1bHRzWzJdLnJlcGxhY2UoL1xcKy9nLCBcIiBcIikpO1xufVxuXG5mdW5jdGlvbiBnZXRPYmplY3RVUkwoZmlsZSkge1xuICAgIHZhciB1cmwgPSBudWxsO1xuICAgIGlmICh3aW5kb3cuY3JlYXRlT2JqZWN0VVJMICE9IHVuZGVmaW5lZCkge1xuICAgICAgICB1cmwgPSB3aW5kb3cuY3JlYXRlT2JqZWN0VVJMKGZpbGUpXG4gICAgfSBlbHNlIGlmICh3aW5kb3cuVVJMICE9IHVuZGVmaW5lZCkge1xuICAgICAgICB1cmwgPSB3aW5kb3cuVVJMLmNyZWF0ZU9iamVjdFVSTChmaWxlKVxuICAgIH0gZWxzZSBpZiAod2luZG93LndlYmtpdFVSTCAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgdXJsID0gd2luZG93LndlYmtpdFVSTC5jcmVhdGVPYmplY3RVUkwoZmlsZSlcbiAgICB9XG4gICAgcmV0dXJuIHVybFxufVxuXG5cbi8vIOS4iuS8oOinhumikeWIneWni+WMllxuZnVuY3Rpb24gaW5pdFVwbG9hZCgpIHtcbiAgICB2YXIgJCA9IHFjVmlkZW8uZ2V0KCckJyk7XG4gICAgdmFyIFZlcnNpb24gPSBxY1ZpZGVvLmdldCgnVmVyc2lvbicpO1xuICAgIGlmICghcWNWaWRlby51cGxvYWRlci5zdXBwb3J0QnJvd3NlcigpKSB7XG4gICAgICAgIGlmIChWZXJzaW9uLklTX01PQklMRSkge1xuICAgICAgICAgICAgYmFzZVV0aWxzLnNob3cucmVkVGlwKCflvZPliY3mtY/op4jlmajkuI3mlK/mjIHkuIrkvKDvvIzor7fljYfnuqfns7vnu5/niYjmnKzmiJbogIXkuIvovb3mnIDmlrDnmoRjaHJvbWXmtY/op4jlmagnKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGdldEludGVybmV0RXhwbG9yZXJWZXJzaW9uKCk7XG4gICAgICAgICAgICAvLyBiYXNlVXRpbHMuc2hvdy5yZWRUaXAoJ+W9k+WJjea1j+iniOWZqOS4jeaUr+aMgeS4iuS8oO+8jOivt+WNh+e6p+a1j+iniOWZqOaIluiAheS4i+i9veacgOaWsOeahGNocm9tZea1j+iniOWZqCcpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgLy/lj5bmtojkuIrkvKDlubbliKDpmaTmlofku7ZcbiAgICB2YXIgaXNUcmFuc2NvZGUgPSAxOyAvL+W8gOWQr+i9rOeggVxuICAgIHZhciBpc1dhdGVybWFyayA9IDA7Ly8g5rC05Y2wXG5cbiAgICBhY2NvdW50RG9uZSgndmlkZW9fZmlsZScsIGlzVHJhbnNjb2RlLCBpc1dhdGVybWFyaywgXCJcIik7XG59XG5cbnZhciBhY2NvdW50RG9uZSA9IGZ1bmN0aW9uICh1cEJ0bklkLCBpc1RyYW5zY29kZSwgaXNXYXRlcm1hcmssIGNsYXNzSWQpIHtcblxuICAgIHZhciAkID0gcWNWaWRlby5nZXQoJyQnKVxuICAgICAgICAsIEVycm9yQ29kZSA9IHFjVmlkZW8uZ2V0KCdFcnJvckNvZGUnKVxuICAgICAgICAsIExvZyA9IHFjVmlkZW8uZ2V0KCdMb2cnKVxuICAgICAgICAsIEpTT04gPSBxY1ZpZGVvLmdldCgnSlNPTicpXG4gICAgICAgICwgdXRpbCA9IHFjVmlkZW8uZ2V0KCd1dGlsJylcbiAgICAgICAgLCBDb2RlID0gcWNWaWRlby5nZXQoJ0NvZGUnKVxuICAgICAgICAsIFZlcnNpb24gPSBxY1ZpZGVvLmdldCgnVmVyc2lvbicpXG4gICAgICAgIDtcbiAgICBxY1ZpZGVvLnVwbG9hZGVyLmluaXQoXG4gICAgICAgIHtcbiAgICAgICAgICAgIHdlYl91cGxvYWRfdXJsOiAnaHR0cHM6Ly92b2QucWNsb3VkLmNvbS92Mi9pbmRleC5waHAnLFxuICAgICAgICAgICAgc2VjcmV0SWQ6IHNlY3JldElkLCAvLyDkupFhcGkgc2VjcmV0SWRcblxuICAgICAgICAgICAgZ2V0U2lnbmF0dXJlOiBmdW5jdGlvbiAoYXJnT2JqLCBkb25lKVxuICAgICAgICAgICAgey8v5rOo5oSP77ya5Ye65LqO5a6J5YWo6ICD6JmR77yMIOacjeWKoeerr+aOpeaUtmFyZ1N0cui/meS4quWPguaVsOWQju+8jOmcgOimgeagoemqjOWFtuS4reeahEFjdGlvbuWPguaVsOaYr+WQpuS4uiBcIk11bHRpcGFydFVwbG9hZFZvZEZpbGVcIiznlKjmnaXor4HmmI7or6Xlj4LmlbDmoIfor4bkuIrkvKDor7fmsYJcbiAgICAgICAgICAgICAgICAkLmFqYXgoe1xuICAgICAgICAgICAgICAgICAgICAnZGF0YVR5cGUnOiAnanNvbicsXG4gICAgICAgICAgICAgICAgICAgICd1cmwnOiAnL2dldHNpZz9hcmdzPScgKyBlbmNvZGVVUklDb21wb25lbnQoYXJnT2JqKSxcbiAgICAgICAgICAgICAgICAgICAgJ3N1Y2Nlc3MnOiBmdW5jdGlvbiAoZClcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgZG9uZShkWydyZXN1bHQnXSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgIHVwQnRuSWQ6IHVwQnRuSWQsIC8v5LiK5Lyg5oyJ6ZKuSUTvvIjku7vmhI/pobXpnaLlhYPntKBJRO+8iVxuICAgICAgICAgICAgaXNUcmFuc2NvZGU6IGlzVHJhbnNjb2RlLC8v5piv5ZCm6L2s56CBXG4gICAgICAgICAgICBpc1dhdGVybWFyazogaXNXYXRlcm1hcmssLy/mmK/lkKborr7nva7msLTljbBcbiAgICAgICAgICAgIGFmdGVyX3NoYV9zdGFydF91cGxvYWQ6IHRydWUsLy9zaGHorqHnrpflrozmiJDlkI7vvIzlvIDlp4vkuIrkvKAgKOm7mOiupOWFs+mXreeri+WNs+S4iuS8oClcbiAgICAgICAgICAgIHNoYTFqc19wYXRoOiAnL2NhbGN1bGF0b3Jfd29ya2VyX3NoYTEuanMnLCAvL+iuoeeul3NoYTHnmoTkvY3nva5cbiAgICAgICAgICAgIGRpc2FibGVfbXVsdGlfc2VsZWN0aW9uOiBmYWxzZSwgLy/npoHnlKjlpJrpgIkg77yM6buY6K6k5Li6ZmFsc2VcbiAgICAgICAgICAgIHRyYW5zY29kZU5vdGlmeVVybDogdHJhbnNjb2RlTm90aWZ5VXJsLC8vKOi9rOeggeaIkOWKn+WQjueahOWbnuiwg+WcsOWdgClpc1RyYW5zY29kZT09dHJ1ZSzml7blvIDlkK/vvJsg5Zue6LCDdXJs55qE6L+U5Zue5pWw5o2u5qC85byP5Y+C6ICDICBodHRwOi8vd3d3LnFjbG91ZC5jb20vd2lraS92Mi9NdWx0aXBhcnRVcGxvYWRWb2RGaWxlXG4gICAgICAgICAgICBjbGFzc0lkOiBjbGFzc0lkLFxuICAgICAgICAgICAgZmlsdGVyczoge21heF9maWxlX3NpemU6ICcyZ2InLCBtaW1lX3R5cGVzOiBbJ01QNCddLCB2aWRlb19vbmx5OiB0cnVlfSxcbiAgICAgICAgICAgIC8vZm9yY2VINVdvcmtlcjogISFwYXJzZUludChnZXRQYXJhbWV0ZXJCeU5hbWUoJ2ZvcmNlSDVXb3JrZXInKSkgfHwgZmFsc2UsXG4gICAgICAgICAgICBmb3JjZUg1V29ya2VyOiB0cnVlXG4gICAgICAgIH1cbiAgICAgICAgLCB7XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICog5pu05paw5paH5Lu254q25oCB5ZKM6L+b5bqmXG4gICAgICAgICAgICAgKiBjb2RlOjHjgIHlh4blpIforqHnrpdTSEEgMuOAgeetieW+heS4iuS8oCAz44CBU0hB6K6h566X5LitIDTjgIHljbPlsIbkuIrkvKAgNeOAgeS4iuS8oOi/m+W6puabtOaWsCA244CB5LiK5Lyg5a6M5oiQXG4gICAgICAgICAgICAgKiBAcGFyYW0gYXJncyB7IGlkOiDmlofku7ZJRCwgc2l6ZTog5paH5Lu25aSn5bCPLCBuYW1lOiDmlofku7blkI3np7AsIHN0YXR1czog54q25oCBLCBwZXJjZW50OiDov5vluqYgc3BlZWQ6IOmAn+W6piwgZXJyb3JDb2RlOiDplJnor6/noIEsc2VydmVyRmlsZUlkOiDlkI7nq6/mlofku7ZJRCB9XG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIG9uRmlsZVVwZGF0ZTogZnVuY3Rpb24gKGFyZ3MpIHtcbiAgICAgICAgICAgICAgICAvL+iOt+WPluS4iuS8oOaWh+S7tmlkXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2codHJhbnNjb2RlTm90aWZ5VXJsKTtcbiAgICAgICAgICAgICAgICAkKCcjdmlkZW9OYW1lJykuaGlkZSgpO1xuICAgICAgICAgICAgICAgICQoXCIudmlkZW9VcGxvYWRDYW5jbGVcIikuZGF0YSgndmlkZW9pZCcsYXJncy5pZCk7XG4gICAgICAgICAgICAgICAgJChcIi52aWRlb1VwbG9hZEJveFwiKS5mYWRlSW4oMzAwKTtcbiAgICAgICAgICAgICAgICAvL2ZpbGVJZD1hcmdzLmlkO1xuICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coZmlsZUlkKTtcbiAgICAgICAgICAgICAgICBpc19lZGl0ID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAvL+WIpOaWreS4iuS8oOinhumikeWkp+Wwj1xuICAgICAgICAgICAgICAgIHZhciB2aWRlb1NpemVTID0gYXJncy5zaXplO1xuICAgICAgICAgICAgICAgIHZpZGVvR3NpemUgPSB2aWRlb1NpemVTLygxMDI0KjEwMjQpO1xuXG4gICAgICAgICAgICAgICAgLy8g5aaC5p6c6KeG6aKR5aSn5bCP5aSn5LqOMUfvvIzliJnlnKjkuIrkvKDmtYHnqIvkuK3liKDpmaTlvZPliY3mlofku7ZcbiAgICAgICAgICAgICAgICBpZih2aWRlb0dzaXplPjEwMDApe1xuICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFsZXJ0KFwi6K+35bCG6KeG6aKR5paH5Lu25Y6L57yp5YiwIDFHIOS7peWGhSFcIilcbiAgICAgICAgICAgICAgICAgICAgfSwxMDApO1xuICAgICAgICAgICAgICAgICAgICAvLyBxY1ZpZGVvLnVwbG9hZGVyLmRlbGV0ZUZpbGUoYXJncy5pZCk7XG4gICAgICAgICAgICAgICAgICAgIC8vIGRlbGV0ZUZyb21GaWxlKGFyZ3MuaWQpOyAvL+S7juaWh+S7tuaVsOe7hOS4reWIoOmZpOivpeaWh+S7tlxuICAgICAgICAgICAgICAgICAgICAvLyAkKCcjJyArIGFyZ3MuaWQpLnJlbW92ZSgpO1xuICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZygn5paH5Lu26LaF6L+HMUcs5o+Q56S66YeN5paw6YCJ5oup6KeG6aKR5paH5Lu2OicgKyBhcmdzLmlkKTtcbiAgICAgICAgICAgICAgICAgICAgLy8gYXJncyA9ICcnO1xuICAgICAgICAgICAgICAgICAgICAkKFwiLnZpZGVvVXBsb2FkQ2FuY2xlXCIpLmNsaWNrKCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiA7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKGFyZ3MuY29kZSA9PSAxKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKGZpbGVzLmxlbmd0aCA9PSAxKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvL+WIoOmZpOS5i+WJjeeahOa3u+WKoOaWsOeahFxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGZpbGVzWzBdICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBvbGRfaWQgPSBmaWxlc1swXS5pZDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBxY1ZpZGVvLnVwbG9hZGVyLmRlbGV0ZUZpbGUob2xkX2lkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxldGVGcm9tRmlsZShvbGRfaWQpOyAvL+S7juaWh+S7tuaVsOe7hOS4reWIoOmZpOivpeaWh+S7tlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICQoJyMnICsgb2xkX2lkKS5yZW1vdmUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygn5Yig6Zmk5LqG5LiA5Liq5paH5Lu2OicgKyBvbGRfaWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyICRsaW5lID0gJChcIiNcIiArIGFyZ3MuaWQpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoISRsaW5lLmdldCgwKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgJCgnI3Byb2dyZXNzX3Nob3cnKS5hcHBlbmQoXCI8ZGl2IGNsYXNzPSdwcm9ncmVzc19kaXYnIGlkID0gJ1wiICsgYXJncy5pZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICsgXCInPjxzcGFuIHN0eWxlPSdmb250LXNpemU6IDEycHgnPlwiICsgYXJncy5uYW1lICsgXCI6PC9zcGFuPjxkaXYgY2xhc3M9J3Byb2dyZXNzX2JhcicgaWQgPSAncHJvZ3Jlc3NfYmFyX1wiICsgYXJncy5pZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICsgXCInPjxkaXYgY2xhc3M9J2JhcicgaWQ9J2Jhcl9cIiArIGFyZ3MuaWRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICArIFwiJz48L2Rpdj48L2Rpdj48c3BhbiBjbGFzcz0ndXBsb2FkX2ZpbmlzaCcgaWQ9J3VwbG9hZF9maW5pc2hfXCIgKyBhcmdzLmlkXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKyBcIic+5LiK5Lyg5a6M5oiQPC9zcGFuPjxzcGFuIGRhdGEtYWN0PSdkZWwnIGRhdGEtdHlwZT0nMCcgY2xhc3M9J2RlbGV0ZSc+5Yig6ZmkPC9zcGFuPjwvZGl2PlwiKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIGluZm9faXRlbSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICdpZCc6IGFyZ3MuaWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAnc2l6ZSc6IGFyZ3Muc2l6ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICdzdGF0ZSc6IDAsXG4gICAgICAgICAgICAgICAgICAgICAgICAnZmlsZV9pZCc6ICcnLFxuICAgICAgICAgICAgICAgICAgICAgICAgJ3NpemVfdGV4dCc6IGFyZ3Muc2l6ZV90ZXh0LFxuICAgICAgICAgICAgICAgICAgICAgICAgJ3R5cGUnOiAxXG4gICAgICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICAgICAgZmlsZXNbZmlsZXMubGVuZ3RoXSA9IGluZm9faXRlbTtcbiAgICAgICAgICAgICAgICAgICAgJChcIi52aWRlb0JveFRpdGxlXCIpLnRleHQoYXJncy5uYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgJChcIi52aWRlb1NpemVcIikudGV4dChhcmdzLnNpemVfdGV4dCk7XG4gICAgICAgICAgICAgICAgICAgICQoXCIudXBsb2FkUmF0aW8gc3BhbjpudGgtb2YtdHlwZSgyKVwiKS50ZXh0KGFyZ3Muc2l6ZV90ZXh0KTtcbiAgICAgICAgICAgICAgICAgICAgLy/ov5vluqbnmb7liIbmr5Tnva7kuLowXG4gICAgICAgICAgICAgICAgICAgICQoXCIudmlkZW9QZXJjZW50XCIpLnRleHQoXCLop4bpopHmraPlnKjop6PmnpDkuK1cIik7XG4gICAgICAgICAgICAgICAgICAgICQoXCIudXBsb2FkUmF0aW8gc3BhblwiKS50ZXh0KFwiXCIpO1xuICAgICAgICAgICAgICAgICAgICAkKFwiLnZpZGVvVXBsb2FkTGluZUFcIikuY3NzKFwid2lkdGhcIixcIjAlXCIpO1xuXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwi5re75Yqg5LqG5LiA5Liq5paw55qE5paH5Lu2OlwiICsgXCJpZDpcIiArIGFyZ3MuaWQgKyBcInNpemU6XCIgKyBhcmdzLnNpemUpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmKGFyZ3MuY29kZT09Mil7XG4gICAgICAgICAgICAgICAgLy9xY1ZpZGVvLnVwbG9hZGVyLnN0YXJ0VXBsb2FkKCk7XG4gICAgICAgICAgICAgICAgICAgIGZpbGVzWzBdWydzdGF0ZSddID0gMjtcbiAgICAgICAgICAgICAgICAgICAgLy92aWRlb1VwbG9hZCgpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmIChhcmdzLmNvZGUgPT0gNSAmJiBhcmdzLnBlcmNlbnQgPiAwKSAvL+S4iuS8oOi/m+W6puWPkeeUn+WPmOWMllxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHVwbG9hZENvbXBsZXRlU2l6ZT1wYXJzZUZsb2F0KGFyZ3Muc2l6ZV90ZXh0KSpwYXJzZUZsb2F0KGFyZ3MucGVyY2VudC8xMDApO1xuICAgICAgICAgICAgICAgICAgICB1cGxvYWRDb21wbGV0ZVNpemU9dXBsb2FkQ29tcGxldGVTaXplLnRvRml4ZWQoMik7XG4gICAgICAgICAgICAgICAgICAgICQoXCIudmlkZW9VcGxvYWRMaW5lQVwiKS5jc3MoXCJ3aWR0aFwiLGFyZ3MucGVyY2VudCtcIiVcIik7XG4gICAgICAgICAgICAgICAgICAgICQoXCIudmlkZW9QZXJjZW50XCIpLnRleHQoYXJncy5wZXJjZW50K1wiJVwiKTtcbiAgICAgICAgICAgICAgICAgICAgJChcIi51cGxvYWRSYXRpbyBzcGFuOm50aC1vZi10eXBlKDEpXCIpLnRleHQodXBsb2FkQ29tcGxldGVTaXplKTtcbiAgICAgICAgICAgICAgICAgICAgJChcIi51cGxvYWRSYXRpbyBzcGFuOm50aC1vZi10eXBlKDIpXCIpLnRleHQoYXJncy5zaXplX3RleHQpO1xuICAgICAgICAgICAgICAgICAgICBpZighYXJncy5zcGVlZCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAkKFwiLnVwbG9hZFNwZWVkIHNwYW5cIikudGV4dChcIlwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICQoXCIudmlkZW9UaW1lTGVmdCBzcGFuXCIpLnRleHQoXCJcIik7XG4gICAgICAgICAgICAgICAgICAgIH1lbHNle1xuICAgICAgICAgICAgICAgICAgICAgICAgJChcIi51cGxvYWRTcGVlZCBzcGFuXCIpLnRleHQoYXJncy5zcGVlZCk7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoYXJncy5jb2RlID09IDYpIC8v5LiK5Lyg5oiQ5YqfXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBpc19lZGl0ID0gZmFsc2U7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIHVwbG9hZENvbXBsZXRlU2l6ZT1hcmdzLnNpemVfdGV4dCphcmdzLnBlcmNlbnQ7XG4gICAgICAgICAgICAgICAgICAgICQoXCIudmlkZW9VcGxvYWRMaW5lQVwiKS5jc3MoJ3dpZHRoJywgXCIxMDAlXCIpO1xuICAgICAgICAgICAgICAgICAgICAkKFwiLnZpZGVvUGVyY2VudFwiKS50ZXh0KFwi5bey5a6M5oiQXCIpO1xuICAgICAgICAgICAgICAgICAgICAkKFwiLnVwbG9hZFJhdGlvIHNwYW46bnRoLW9mLXR5cGUoMSlcIikudGV4dChhcmdzLnNpemVfdGV4dCk7XG4gICAgICAgICAgICAgICAgICAgICQoXCIudXBsb2FkUmF0aW8gc3BhbjpudGgtb2YtdHlwZSgyKVwiKS50ZXh0KGFyZ3Muc2l6ZV90ZXh0KTtcbiAgICAgICAgICAgICAgICAgICAgZmlsZUlkPWFyZ3Muc2VydmVyRmlsZUlkO1xuICAgICAgICAgICAgICAgICAgICBWaWRlb05hbWUgPSBhcmdzLm5hbWU7XG4gICAgICAgICAgICAgICAgICAgIC8v5L+u5pS5ZmlsZXPkuK3mlofku7bnmoTnirbmgIFcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBmaWxlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFyZ3MuaWQgPT0gZmlsZXNbaV1bJ2lkJ10pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWxlc1tpXVsnc3RhdGUnXSA9IDY7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsZXNbaV1bJ2ZpbGVfaWQnXSA9IGFyZ3Muc2VydmVyRmlsZUlkO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKGlzVXBsb2FkRmluaXNoKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8v5o+Q5Lqk5paH5Lu2XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZXh0ZXJuYWxQYXJhbXMgPSBnZW5lcmF0ZVBhcmFtcygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gdXBsb2FkVG9TZXJ2ZXIoZXh0ZXJuYWxQYXJhbXMpO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhhcmdzKTtcbiAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICog5paH5Lu254q25oCB5Y+R55Sf5Y+Y5YyWXG4gICAgICAgICAgICAgKiBAcGFyYW0gaW5mbyAgeyBkb25lOiDlrozmiJDmlbDph48gLCBmYWlsOiDlpLHotKXmlbDph48gLCBzaGE6IOiuoeeul1NIQeaIluiAheetieW+heiuoeeul1NIQeS4reeahOaVsOmHjyAsIHdhaXQ6IOetieW+heS4iuS8oOaVsOmHjyAsIHVwbG9hZGluZzog5LiK5Lyg5Lit55qE5pWw6YePIH1cbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgb25GaWxlU3RhdHVzOiBmdW5jdGlvbiAoaW5mbykge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCflkITnirbmgIHmgLvmlbAtLT4nICsgSlNPTi5zdHJpbmdpZnkoaW5mbykpO1xuICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiAg5LiK5Lyg5pe26ZSZ6K+v5paH5Lu26L+H5ruk5o+Q56S6XG4gICAgICAgICAgICAgKiBAcGFyYW0gYXJncyB7Y29kZTp7LTE6IOaWh+S7tuexu+Wei+W8guW4uCwtMjog5paH5Lu25ZCN5byC5bi4fSAsIG1lc3NhZ2U6IOmUmeivr+WOn+WboCDvvIwgc29sdXRpb246IOino+WGs+aWueazlX1cbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgb25GaWx0ZXJFcnJvcjogZnVuY3Rpb24gKGFyZ3MpIHtcbiAgICAgICAgICAgICAgICB2YXIgbXNnID0gJ21lc3NhZ2U6JyArIGFyZ3MubWVzc2FnZSArIChhcmdzLnNvbHV0aW9uID8gKCc7c29sdXRpb249PScgKyBhcmdzLnNvbHV0aW9uKSA6ICcnKTtcbiAgICAgICAgICAgICAgIGlmKGFyZ3MuY29kZT09LTEpe1xuICAgICAgICAgICAgICAgICAgIGJhc2VVdGlscy5zaG93LnJlZFRpcChcIuivt+S4iuS8oOato+ehruagvOW8j+eahOaWh+S7tlwiKTtcbiAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG5cbiAgICAgICAgfVxuICAgICk7XG5cblxuICAgIC8vICQoJy52aWRlb1VwbG9hZENhbmNsZScpLm9uKCdjbGljaycsICdbZGF0YS1hY3Q9XCJkZWxcIl0nLCBmdW5jdGlvbiAoZSkge1xuICAgIC8vICAgICB2YXIgJGxpbmUgPSAkKHRoaXMpLnBhcmVudCgpO1xuICAgIC8vICAgICB2YXIgZmlsZUlkID0gJGxpbmUuZ2V0KDApLmlkO1xuICAgIC8vICAgICBMb2cuZGVidWcoJ2RlbGV0ZScsIGZpbGVJZCk7XG4gICAgLy8gICAgICRsaW5lLnJlbW92ZSgpO1xuICAgIC8vICAgICAvL0BhcGkg5Yig6Zmk5paH5Lu2XG4gICAgLy8gICAgIHFjVmlkZW8udXBsb2FkZXIuZGVsZXRlRmlsZShmaWxlSWQpO1xuICAgIC8vICAgICBkZWxldGVGcm9tRmlsZShmaWxlSWQpOyAvL+S7juaWh+S7tuaVsOe7hOS4reWIoOmZpOivpeaWh+S7tlxuICAgIC8vIH0pO1xuICAgICQoXCIudmlkZW9VcGxvYWRDYW5jbGVcIikuY2xpY2soZnVuY3Rpb24oKXtcbiAgICAgICAgJChcIi52aWRlb1VwbG9hZEJveFwiKS5mYWRlT3V0KDMwMCk7XG4gICAgICAgIExvZy5kZWJ1ZygnZGVsZXRlJywgZmlsZUlkKTtcbiAgICAgICAgLy8gJGxpbmUucmVtb3ZlKCk7XG4gICAgICAgIC8vQGFwaSDliKDpmaTmlofku7ZcbiAgICAgICAgcWNWaWRlby51cGxvYWRlci5kZWxldGVGaWxlKGZpbGVJZCk7XG4gICAgICAgIGRlbGV0ZUZyb21GaWxlKGZpbGVJZCk7IC8v5LuO5paH5Lu25pWw57uE5Lit5Yig6Zmk6K+l5paH5Lu2XG4gICAgICAgIGZpbGVJZD1udWxsO1xuICAgIH0pO1xufVxuXG4vL+WIoOmZpOafkOS4quWFg+e0oFxuZnVuY3Rpb24gZGVsZXRlRnJvbUZpbGUoaWQpIHtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGZpbGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHZhciBpdGVtID0gZmlsZXNbaV07XG4gICAgICAgIGlmIChpZCA9PSBpdGVtWydpZCddKSB7XG4gICAgICAgICAgICAvL+WIoOmZpOmhueebrlxuICAgICAgICAgICAgZmlsZXMuc3BsaWNlKGksIDEpO1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ+S7jmZpbGVz5Lit5Yig6Zmk5LqG5LiA5Liq5paH5Lu2OicgKyBpZCk7XG4gICAgICAgIH1cbiAgICB9XG59XG5cbi8v5Yik5pat5Lik5Liq6KeG6aKR5piv5ZCm6YO95LiK5Lyg5a6M5oiQ5LqGXG5mdW5jdGlvbiBpc1VwbG9hZEZpbmlzaCgpIHtcbiAgICB2YXIgaXNGaW5pc2ggPSB0cnVlO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZmlsZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgaWYgKGZpbGVzW2ldWydzdGF0ZSddICE9IDYpIHsgLy/mnInkuIDkuKrmsqHlrozmiJDjgIJcbiAgICAgICAgICAgIGlzRmluaXNoID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGlzRmluaXNoO1xufVxuLy/nlJ/miJDlj4LmlbBcbmZ1bmN0aW9uIGdlbmVyYXRlUGFyYW1zKCkge1xuICAgIHZhciBmaWxlX2lkX3BhcmFtcyA9IHt9O1xuICAgIGlmIChmaWxlcy5sZW5ndGggPT0gMSkge1xuXG4gICAgICAgIGZpbGVfaWRfcGFyYW1zID0ge1xuICAgICAgICAgICAgJ3B1YmxpY192aWRlbyc6IGZpbGVzWzBdWydmaWxlX2lkJ10sICdwdWJsaWNfc2l6ZV90ZXh0JzogKGZpbGVzWzBdWydzaXplJ10vKDEwMjQqMTAyNCkpXG4gICAgICAgIH07XG4gICAgfVxuICAgIHJldHVybiBmaWxlX2lkX3BhcmFtcztcbn1cblxuXG4vL+S4iuS8oOiHs+aIkeS7rOacjeWKoeWZqFxuLy8gZnVuY3Rpb24gdXBsb2FkVG9TZXJ2ZXIoZXh0ZXJuYWxQYXJhbXMpIHtcbi8vICAgICB2YXIgYWxsUGFyYW1zID0ge307XG4vLyAgICAgYWxsUGFyYW1zWydyZXNvdXJjZV90eXBlJ10gPSByZXNvdXJjZV90eXBlO1xuLy8gICAgIGFsbFBhcmFtc1sncmVzb3VyY2VfcGFyYW1zJ10gPSBleHRlcm5hbFBhcmFtcztcbi8vICAgICBhbGxQYXJhbXNbJ3BhcmFtcyddID0gcGFyYW1zO1xuLy8gICAgIGFsbFBhcmFtc1snaXNfc2luZ2xlX3NhbGUnXSA9IGlzX3NpbmdsZV9zYWxlO1xuLy8gICAgIC8v5LiK5Lyg6Iez5pyN5Yqh5ZmoXG4vLyAgICAgJC5wb3N0KCcvdXBsb2FkX3ZpZGVvJywgYWxsUGFyYW1zLCBmdW5jdGlvbiAocmVzdWx0KSB7XG4vLyAgICAgICAgIGhpZGVMb2FkaW5nKCk7XG4vLyAgICAgICAgIHZhciBjb2RlID0gcmVzdWx0LmNvZGU7XG4vLyAgICAgICAgIHZhciBtc2cgPSByZXN1bHQubXNnO1xuLy8gICAgICAgICBpZiAoY29kZSA9PSAwKSB7XG4vLyAgICAgICAgICAgICBiYXNlVXRpbHMuc2hvdy5ibHVlVGlwKG1zZywgZnVuY3Rpb24gKCkge1xuLy8gICAgICAgICAgICAgICAgIElzX1NhdmUgPSBmYWxzZTtcbi8vICAgICAgICAgICAgICAgICBpZiAoYWxsUGFyYW1zWydyZXNvdXJjZV90eXBlJ10gPT0gJ2F1ZGlvJykge1xuLy8gICAgICAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9ICcvYXVkaW9fbGlzdCc7XG4vLyAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChhbGxQYXJhbXNbJ3Jlc291cmNlX3R5cGUnXSA9PSAndmlkZW8nKSB7XG4vLyAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gJy92aWRlb19saXN0Jztcbi8vICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuLy8gICAgICAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9ICcvYXVkaW9fbGlzdCc7XG4vLyAgICAgICAgICAgICAgICAgfVxuLy8gICAgICAgICAgICAgfSk7XG4vLyAgICAgICAgIH0gZWxzZSB7XG4vLyAgICAgICAgICAgICBiYXNlVXRpbHMuc2hvdy5yZWRUaXAobXNnKTtcbi8vICAgICAgICAgfVxuLy8gICAgIH0pO1xuXG4vLyB9XG5cbnZhciB0cnlfY291bnQ9MDtcblxuLy/lr7nkuo7lpKfmlofku7Ys6K6h566Xc2hhcjHlgLzmr5TovoPmhaJcbmZ1bmN0aW9uIHZpZGVvVXBsb2FkKCkge1xuICAgIGlmICh0cnlfY291bnQgPj0gMzAwKSB7XG4gICAgICAgIGhpZGVMb2FkaW5nKCk7XG4gICAgICAgIGJhc2VVdGlscy5zaG93LnJlZFRpcChcIuinhumikeino+aekOWksei0pSzor7fmm7TmlrDmtY/op4jlmajniYjmnKzph43mlrDkuIrkvKBcIik7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgc2V0VGltZW91dChcbiAgICAgICAgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYoZmlsZXMubGVuZ3RoPjAmJmZpbGVzWzBdWydzdGF0ZSddPT0yKXsgLy/lpoLmnpzop6PmnpDlrozkuobnmoTor51cbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygn6Kej5p6Q5a6M5oiQJyk7XG4gICAgICAgICAgICAgICAgcWNWaWRlby51cGxvYWRlci5zdGFydFVwbG9hZCgpO1xuICAgICAgICAgICAgfWVsc2V7XG4gICAgICAgICAgICAgICAgdHJ5X2NvdW50Kys7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ+ino+aekOi/mOacquWujOaIkCcpO1xuICAgICAgICAgICAgICAgIHZpZGVvVXBsb2FkKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sMTAwMFxuICAgIClcbn1cblxuXG5cbiJdfQ==
