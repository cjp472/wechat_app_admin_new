$(document).ready(function(){Business.init()});var Business=function(){var i={};i.submitLimit=false;i.communityId=-1;i.type=-1;i.dynamicId=-1;i.init=function(){changeSaveFlag(true);i.type=$("#admin_data").data("type");i.communityId=$("#admin_data").data("community_id");if(i.type==1){i.dynamicId=GetQueryString("id")}$("#releaseDynamic").click(function(){if(i.submitLimit==true){baseUtils.show.redTip("正在提交中，请稍后再试");return false}var t={};var e=$("#dynamicTitle").val();if(e==""||e==undefined){baseUtils.show.redTip("请输入动态标题");return false}t["title"]=e;var n=UE.getEditor("container");var a=n.getContent();var s=n.getPlainTxt();if(a==""||a==undefined){baseUtils.show.redTip("请输入动态内容");return false}t["org_content"]=a;t["content"]=s;t["community_id"]=i.communityId;var m="";if(i.type==1){t["id"]=i.dynamicId;m="/smallCommunity/updateDynamic"}else{m="/smallCommunity/uploadDynamic"}i.submitLimit=true;$.ajax(m,{type:"POST",dataType:"json",data:{params:t},success:function(t){if(t.code==0){if(i.type==1){baseUtils.show.blueTip("保存编辑成功")}else{baseUtils.show.blueTip("发布动态成功")}setTimeout(function(){window.location.href="/smallCommunity/dynamicList?community_id="+i.communityId},700)}else{baseUtils.show.redTip("发布出现问题，请稍后再试");i.submitLimit=false}},error:function(t,e,n){i.submitLimit=false;console.log(n);baseUtils.show.redTip("网络错误，请稍后再试！")}})})};return i}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1hbmFnZUR5bmFtaWMuanMiXSwibmFtZXMiOlsiJCIsImRvY3VtZW50IiwicmVhZHkiLCJCdXNpbmVzcyIsImluaXQiLCJzdWJtaXRMaW1pdCIsImNvbW11bml0eUlkIiwidHlwZSIsImR5bmFtaWNJZCIsImNoYW5nZVNhdmVGbGFnIiwiZGF0YSIsIkdldFF1ZXJ5U3RyaW5nIiwiY2xpY2siLCJiYXNlVXRpbHMiLCJzaG93IiwicmVkVGlwIiwicGFyYW1zIiwiZHluYW1pY1RpdGxlIiwidmFsIiwidW5kZWZpbmVkIiwidWUiLCJVRSIsImdldEVkaXRvciIsIm9yZ19jb250ZW50IiwiZ2V0Q29udGVudCIsImRlc2NyYiIsImdldFBsYWluVHh0IiwicG9zdFVybCIsImFqYXgiLCJkYXRhVHlwZSIsInN1Y2Nlc3MiLCJyZXN1bHQiLCJjb2RlIiwiYmx1ZVRpcCIsInNldFRpbWVvdXQiLCJ3aW5kb3ciLCJsb2NhdGlvbiIsImhyZWYiLCJlcnJvciIsInhociIsInN0YXR1cyIsImVyciIsImNvbnNvbGUiLCJsb2ciXSwibWFwcGluZ3MiOiJBQUlBQSxFQUFFQyxVQUFVQyxNQUFNLFdBRWRDLFNBQVNDLFFBR2IsSUFBSUQsVUFBVyxXQUVYLEdBQUlBLEtBRUpBLEdBQVNFLFlBQWMsS0FDdkJGLEdBQVNHLGFBQWUsQ0FDeEJILEdBQVNJLE1BQVEsQ0FDakJKLEdBQVNLLFdBQWEsQ0FFdEJMLEdBQVNDLEtBQU8sV0FHWkssZUFBZSxLQUVmTixHQUFTSSxLQUFPUCxFQUFFLGVBQWVVLEtBQUssT0FDdENQLEdBQVNHLFlBQWNOLEVBQUUsZUFBZVUsS0FBSyxlQUM3QyxJQUFJUCxFQUFTSSxNQUFRLEVBQUcsQ0FDcEJKLEVBQVNLLFVBQVlHLGVBQWUsTUFHeENYLEVBQUUsbUJBQW1CWSxNQUFNLFdBR3ZCLEdBQUlULEVBQVNFLGFBQWUsS0FBTSxDQUM5QlEsVUFBVUMsS0FBS0MsT0FBTyxjQUN0QixPQUFPLE9BTVgsR0FBSUMsS0FFSixJQUFJQyxHQUFlakIsRUFBRSxpQkFBaUJrQixLQUN0QyxJQUFJRCxHQUFnQixJQUFNQSxHQUFnQkUsVUFBVyxDQUNqRE4sVUFBVUMsS0FBS0MsT0FBTyxVQUV0QixPQUFPLE9BRVhDLEVBQU8sU0FBV0MsQ0FHbEIsSUFBSUcsR0FBS0MsR0FBR0MsVUFBVSxZQUN0QixJQUFJQyxHQUFjSCxFQUFHSSxZQUNyQixJQUFJQyxHQUFTTCxFQUFHTSxhQUVoQixJQUFJSCxHQUFlLElBQU1BLEdBQWVKLFVBQVcsQ0FDL0NOLFVBQVVDLEtBQUtDLE9BQU8sVUFFdEIsT0FBTyxPQUVYQyxFQUFPLGVBQWlCTyxDQUN4QlAsR0FBTyxXQUFhUyxDQUVwQlQsR0FBTyxnQkFBa0JiLEVBQVNHLFdBRWxDLElBQUlxQixHQUFVLEVBQ2QsSUFBSXhCLEVBQVNJLE1BQVEsRUFBRyxDQUNwQlMsRUFBTyxNQUFRYixFQUFTSyxTQUN4Qm1CLEdBQVUsb0NBQ1AsQ0FDSEEsRUFBVSxnQ0FHZHhCLEVBQVNFLFlBQWMsSUFFdkJMLEdBQUU0QixLQUFLRCxHQUNIcEIsS0FBTSxPQUNOc0IsU0FBVSxPQUNWbkIsTUFDSU0sT0FBUUEsR0FFWmMsUUFBUyxTQUFVQyxHQUNmLEdBQUlBLEVBQU9DLE1BQVEsRUFBRyxDQUNsQixHQUFJN0IsRUFBU0ksTUFBUSxFQUFHLENBQ3BCTSxVQUFVQyxLQUFLbUIsUUFBUSxjQUNwQixDQUNIcEIsVUFBVUMsS0FBS21CLFFBQVEsVUFFM0JDLFdBQVcsV0FDUEMsT0FBT0MsU0FBU0MsS0FBSyw0Q0FBOENsQyxFQUFTRyxhQUM3RSxTQUNBLENBQ0hPLFVBQVVDLEtBQUtDLE9BQU8sZUFDdEJaLEdBQVNFLFlBQWMsUUFHL0JpQyxNQUFPLFNBQVVDLEVBQUtDLEVBQVFDLEdBQzFCdEMsRUFBU0UsWUFBYyxLQUN2QnFDLFNBQVFDLElBQUlGLEVBQ1o1QixXQUFVQyxLQUFLQyxPQUFPLG9CQVF0QyxPQUFPWiIsImZpbGUiOiJtYW5hZ2VEeW5hbWljLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIENyZWF0ZWQgYnkgQWRtaW5pc3RyYXRvciBvbiAyMDE3LzUvMi5cclxuICovXHJcblxyXG4kKGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgQnVzaW5lc3MuaW5pdCgpO1xyXG59KVxyXG5cclxudmFyIEJ1c2luZXNzID0gKGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICB2YXIgQnVzaW5lc3MgPSB7fTtcclxuXHJcbiAgICBCdXNpbmVzcy5zdWJtaXRMaW1pdCA9IGZhbHNlOyAgIC8v5o+Q5Lqk6ZmQ5Yi2XHJcbiAgICBCdXNpbmVzcy5jb21tdW5pdHlJZCA9IC0xO1xyXG4gICAgQnVzaW5lc3MudHlwZSA9IC0xOyAgICAgICAgICAgICAvLyAgMSAtIOe8lui+kSDvvJsgMCAtIOaWsOW7ulxyXG4gICAgQnVzaW5lc3MuZHluYW1pY0lkID0gLTE7XHJcblxyXG4gICAgQnVzaW5lc3MuaW5pdCA9IGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICAgICAgLy/ngrnlh7vkvqfovrnmoI/nprvlvIDml7bnmoTlvLnmoYZcclxuICAgICAgICBjaGFuZ2VTYXZlRmxhZyh0cnVlKTtcclxuXHJcbiAgICAgICAgQnVzaW5lc3MudHlwZSA9ICQoXCIjYWRtaW5fZGF0YVwiKS5kYXRhKFwidHlwZVwiKTtcclxuICAgICAgICBCdXNpbmVzcy5jb21tdW5pdHlJZCA9ICQoXCIjYWRtaW5fZGF0YVwiKS5kYXRhKFwiY29tbXVuaXR5X2lkXCIpO1xyXG4gICAgICAgIGlmIChCdXNpbmVzcy50eXBlID09IDEpIHtcclxuICAgICAgICAgICAgQnVzaW5lc3MuZHluYW1pY0lkID0gR2V0UXVlcnlTdHJpbmcoXCJpZFwiKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgICQoXCIjcmVsZWFzZUR5bmFtaWNcIikuY2xpY2soZnVuY3Rpb24gKCkge1xyXG5cclxuICAgICAgICAgICAgLy8gIOmYsuatoumHjeWkjeaPkOS6pFxyXG4gICAgICAgICAgICBpZiAoQnVzaW5lc3Muc3VibWl0TGltaXQgPT0gdHJ1ZSkge1xyXG4gICAgICAgICAgICAgICAgYmFzZVV0aWxzLnNob3cucmVkVGlwKFwi5q2j5Zyo5o+Q5Lqk5Lit77yM6K+356iN5ZCO5YaN6K+VXCIpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvKipcclxuICAgICAgICAgICAgICog6ZyA6KaB55qE5Y+C5pWwIO+8miBjb21tdW5pdHlfaWQgLSB0aXRsZSAtIG9yZ19jb250ZW50IC0gY29udGVudFxyXG4gICAgICAgICAgICAgKi9cclxuICAgICAgICAgICAgdmFyIHBhcmFtcyA9IHt9O1xyXG5cclxuICAgICAgICAgICAgdmFyIGR5bmFtaWNUaXRsZSA9ICQoXCIjZHluYW1pY1RpdGxlXCIpLnZhbCgpO1xyXG4gICAgICAgICAgICBpZiAoZHluYW1pY1RpdGxlID09ICcnIHx8IGR5bmFtaWNUaXRsZSA9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgIGJhc2VVdGlscy5zaG93LnJlZFRpcChcIuivt+i+k+WFpeWKqOaAgeagh+mimFwiKTtcclxuXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcGFyYW1zWyd0aXRsZSddID0gZHluYW1pY1RpdGxlO1xyXG5cclxuICAgICAgICAgICAgLy8gIOiOt+WPluWKqOaAgSBodG1s5YaF5a6577yM6L+U5ZueOiA8cD5oZWxsbzwvcD5cclxuICAgICAgICAgICAgdmFyIHVlID0gVUUuZ2V0RWRpdG9yKCdjb250YWluZXInKTtcclxuICAgICAgICAgICAgdmFyIG9yZ19jb250ZW50ID0gdWUuZ2V0Q29udGVudCgpOyAgICAvLyAg5Y6f5aeLaHRtbOWGheWuuVxyXG4gICAgICAgICAgICB2YXIgZGVzY3JiID0gdWUuZ2V0UGxhaW5UeHQoKTsgICAgICAgIC8vICDnuq/mlofmnKxcclxuXHJcbiAgICAgICAgICAgIGlmIChvcmdfY29udGVudCA9PSAnJyB8fCBvcmdfY29udGVudCA9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgIGJhc2VVdGlscy5zaG93LnJlZFRpcChcIuivt+i+k+WFpeWKqOaAgeWGheWuuVwiKTtcclxuXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcGFyYW1zWydvcmdfY29udGVudCddID0gb3JnX2NvbnRlbnQ7XHJcbiAgICAgICAgICAgIHBhcmFtc1snY29udGVudCddID0gZGVzY3JiO1xyXG5cclxuICAgICAgICAgICAgcGFyYW1zWydjb21tdW5pdHlfaWQnXSA9IEJ1c2luZXNzLmNvbW11bml0eUlkO1xyXG5cclxuICAgICAgICAgICAgdmFyIHBvc3RVcmwgPSBcIlwiO1xyXG4gICAgICAgICAgICBpZiAoQnVzaW5lc3MudHlwZSA9PSAxKSB7ICAgLy8gIOe8lui+kVxyXG4gICAgICAgICAgICAgICAgcGFyYW1zWydpZCddID0gQnVzaW5lc3MuZHluYW1pY0lkO1xyXG4gICAgICAgICAgICAgICAgcG9zdFVybCA9IFwiL3NtYWxsQ29tbXVuaXR5L3VwZGF0ZUR5bmFtaWNcIjtcclxuICAgICAgICAgICAgfSBlbHNlIHsgICAgLy8gIOaWsOW7ulxyXG4gICAgICAgICAgICAgICAgcG9zdFVybCA9IFwiL3NtYWxsQ29tbXVuaXR5L3VwbG9hZER5bmFtaWNcIjtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgQnVzaW5lc3Muc3VibWl0TGltaXQgPSB0cnVlO1xyXG5cclxuICAgICAgICAgICAgJC5hamF4KHBvc3RVcmwsIHtcclxuICAgICAgICAgICAgICAgIHR5cGU6IFwiUE9TVFwiLFxyXG4gICAgICAgICAgICAgICAgZGF0YVR5cGU6IFwianNvblwiLFxyXG4gICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgIHBhcmFtczogcGFyYW1zXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24gKHJlc3VsdCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChyZXN1bHQuY29kZSA9PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChCdXNpbmVzcy50eXBlID09IDEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhc2VVdGlscy5zaG93LmJsdWVUaXAoXCLkv53lrZjnvJbovpHmiJDlip9cIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiYXNlVXRpbHMuc2hvdy5ibHVlVGlwKFwi5Y+R5biD5Yqo5oCB5oiQ5YqfXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWY9XCIvc21hbGxDb21tdW5pdHkvZHluYW1pY0xpc3Q/Y29tbXVuaXR5X2lkPVwiICsgQnVzaW5lc3MuY29tbXVuaXR5SWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sIDcwMCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYmFzZVV0aWxzLnNob3cucmVkVGlwKFwi5Y+R5biD5Ye6546w6Zeu6aKY77yM6K+356iN5ZCO5YaN6K+VXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBCdXNpbmVzcy5zdWJtaXRMaW1pdCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICBlcnJvcjogZnVuY3Rpb24gKHhociwgc3RhdHVzLCBlcnIpIHtcclxuICAgICAgICAgICAgICAgICAgICBCdXNpbmVzcy5zdWJtaXRMaW1pdCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycik7XHJcbiAgICAgICAgICAgICAgICAgICAgYmFzZVV0aWxzLnNob3cucmVkVGlwKFwi572R57uc6ZSZ6K+v77yM6K+356iN5ZCO5YaN6K+V77yBXCIpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgfTtcclxuXHJcbiAgICByZXR1cm4gQnVzaW5lc3M7XHJcblxyXG59KSgpO1xyXG5cclxuIl19
