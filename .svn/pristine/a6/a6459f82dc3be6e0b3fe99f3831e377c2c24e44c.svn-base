var TYPE_ACCOUNT_CHARGE=1;var TYPE_GROW_UP_VERSION=2;var TYPE_VIP_VERSION=3;var order_id="";var create_qr_flag=true;var last_pay_time=0;var last_pay_price=0;function pre_pay_wechat(e,t){var r={};r["price"]=e;r["type"]=t;$.post("/pre_wechatPay",r,function(r){if(t!=1){var a=r.data["user_local_version"];if(a==TYPE_VIP_VERSION&&(t==TYPE_VIP_VERSION||t==TYPE_GROW_UP_VERSION)){alert("您已经是专业版了，点击确定跳回管理台");window.location.href="/accountview";return false}else if(a==TYPE_GROW_UP_VERSION&&t==TYPE_GROW_UP_VERSION){alert("您已经是成长版了，点击确定跳回管理台");window.location.href="/accountview";return false}}if(r.code==0){$(".scan_screen").fadeIn(300);$(".scan_screen_content").fadeIn(300);if(r.data){if(t==TYPE_ACCOUNT_CHARGE){if(last_pay_price==0){last_pay_price=e;create_new_qr_code(r)}else{if(last_pay_price==e){judge_pay_valid_time(r)}else{last_pay_price=e;create_new_qr_code(r)}}}else{judge_pay_valid_time(r)}}else{baseUtils.show.redTip("生成二维码失败!")}}else{baseUtils.show.redTip(r.msg)}})}function create_new_qr_code(e){order_id=e.data["order_id"];$("#qr_code").html("");createQR(e.data["code_url"]);clear=setInterval(queryresult,5e3)}function createQR(e){var t=new QRCode(document.getElementById("qr_code"),{text:e,width:200,height:200,colorDark:"#000000",colorLight:"#ffffff",correctLevel:QRCode.CorrectLevel.H});create_qr_flag=false}function judge_pay_valid_time(e){if(last_pay_time!=0){var t=(new Date).valueOf();if(t-last_pay_time>=max_time){create_new_qr_code(e)}last_pay_time=t}else{var t=(new Date).valueOf();last_pay_time=t;create_new_qr_code(e)}}var clear;var max_time=300*1e3;var current_time=0;function queryresult(){query_pay_result(order_id)}function query_pay_result(e){$.post("/getPayResult",{order_id:e},function(e){if(e.code==0){clearInterval(clear);$(".scan_screen_content").hide();$(".scan_status_success").show();var t=3;var r=setInterval(function(){console.log(t);t--;if(t>=0){$(".scan_status_countdown span").text(t)}if(t<0){$(".scan_screen").fadeOut(300);clearInterval(r);if(GetQueryString("first")!=1){window.location.href="/accountview"}else{var e=window.location.href;if(/open_growUp/.test(e)){if(GetQueryString("first_login")==1){window.location.href="/accountview?first=1&type=1&first_login=1"}else{window.location.href="/accountview?first=1&type=1"}}else if(/open_vip/.test(e)){if(GetQueryString("first_login")==1){window.location.href="/accountview?first=1&type=2&first_login=1"}else{window.location.href="/accountview?first=1&type=2"}}}}},1e3)}else{current_time+=1e3;if(current_time==max_time){clearInterval(clear);$(".scan_screen_content").hide();$(".scan_status_fail").show()}}})}function GetQueryString(e){var t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)");var r=window.location.search.substr(1).match(t);if(r!=null)return unescape(r[2]);return null}
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInV0aWxzL1dlWGluUGF5LmpzIl0sIm5hbWVzIjpbIlRZUEVfQUNDT1VOVF9DSEFSR0UiLCJUWVBFX0dST1dfVVBfVkVSU0lPTiIsIlRZUEVfVklQX1ZFUlNJT04iLCJvcmRlcl9pZCIsImNyZWF0ZV9xcl9mbGFnIiwibGFzdF9wYXlfdGltZSIsImxhc3RfcGF5X3ByaWNlIiwicHJlX3BheV93ZWNoYXQiLCJwcmljZSIsInR5cGUiLCJwYXJhbXMiLCIkIiwicG9zdCIsImRhdGEiLCJsb2NhbF92ZXJzaW9uIiwiYWxlcnQiLCJ3aW5kb3ciLCJsb2NhdGlvbiIsImhyZWYiLCJjb2RlIiwiZmFkZUluIiwiY3JlYXRlX25ld19xcl9jb2RlIiwianVkZ2VfcGF5X3ZhbGlkX3RpbWUiLCJiYXNlVXRpbHMiLCJzaG93IiwicmVkVGlwIiwibXNnIiwiaHRtbCIsImNyZWF0ZVFSIiwiY2xlYXIiLCJzZXRJbnRlcnZhbCIsInF1ZXJ5cmVzdWx0IiwiY29kZV91cmwiLCJxcmNvZGUiLCJRUkNvZGUiLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwidGV4dCIsIndpZHRoIiwiaGVpZ2h0IiwiY29sb3JEYXJrIiwiY29sb3JMaWdodCIsImNvcnJlY3RMZXZlbCIsIkNvcnJlY3RMZXZlbCIsIkgiLCJ0aW1lX3N0YW1wIiwiRGF0ZSIsInZhbHVlT2YiLCJtYXhfdGltZSIsImN1cnJlbnRfdGltZSIsInF1ZXJ5X3BheV9yZXN1bHQiLCJvcmRlcklkIiwiY2xlYXJJbnRlcnZhbCIsImhpZGUiLCJjaGFyZ2VSZW1haW4iLCJjaGFyZ2VfdGltZXIiLCJjb25zb2xlIiwibG9nIiwiZmFkZU91dCIsIkdldFF1ZXJ5U3RyaW5nIiwidGVzdCIsIm5hbWUiLCJyZWciLCJSZWdFeHAiLCJyIiwic2VhcmNoIiwic3Vic3RyIiwibWF0Y2giLCJ1bmVzY2FwZSJdLCJtYXBwaW5ncyI6IkFBSUEsR0FBSUEscUJBQXNCLENBQzFCLElBQUlDLHNCQUF1QixDQUMzQixJQUFJQyxrQkFBbUIsQ0FF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T0FBT0MsU0FBU0MsS0FBTyxnREFDckIsQ0FDRkYsT0FBT0MsU0FBU0MsS0FBTyxtQ0FFekIsSUFBRyxXQUFXMEMsS0FBSzFDLEdBQU0sQ0FDM0IsR0FBR3lDLGVBQWUsZ0JBQWdCLEVBQUUsQ0FDaEMzQyxPQUFPQyxTQUFTQyxLQUFPLGdEQUNyQixDQUNGRixPQUFPQyxTQUFTQyxLQUFPLG1DQUt4QyxTQUVBLENBR0grQixjQUFnQixHQUVoQixJQUFJQSxjQUFnQkQsU0FBVSxDQUMxQkksY0FBY3ZCLE1BQ2RsQixHQUFFLHdCQUF3QjBDLE1BQzFCMUMsR0FBRSxxQkFBcUJhLFdBT3ZDLFFBQVNtQyxnQkFBZUUsR0FDcEIsR0FBSUMsR0FBTSxHQUFJQyxRQUFPLFFBQVVGLEVBQU8sZ0JBQ3RDLElBQUlHLEdBQUloRCxPQUFPQyxTQUFTZ0QsT0FBT0MsT0FBTyxHQUFHQyxNQUFNTCxFQUMvQyxJQUFJRSxHQUFLLEtBQU0sTUFBT0ksVUFBU0osRUFBRSxHQUNqQyxPQUFPIiwiZmlsZSI6InV0aWxzL1dlWGluUGF5LmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIENyZWF0ZWQgYnkgQWRtaW5pc3RyYXRvciBvbiAyMDE3LzMvNi5cclxuICovXHJcbi8vICDlhYXlgLznsbvlnovluLjph49cclxudmFyIFRZUEVfQUNDT1VOVF9DSEFSR0UgPSAxO1xyXG52YXIgVFlQRV9HUk9XX1VQX1ZFUlNJT04gPSAyO1xyXG52YXIgVFlQRV9WSVBfVkVSU0lPTiA9IDM7XHJcblxyXG52YXIgb3JkZXJfaWQgPSAnJztcclxudmFyIGNyZWF0ZV9xcl9mbGFnID0gdHJ1ZTtcclxuLy8gIOiusOW9leS4iuS4gOasoeeahOaIkOWKn+eUn+aIkOS6jOe7tOeggeeahOaXtumXtOeCuVxyXG52YXIgbGFzdF9wYXlfdGltZSA9IDA7XHJcblxyXG4vLyAg6K6w5b2V5LiK5LiA5qyh55qE5oiQ5Yqf55Sf5oiQ5LqM57u056CB5pe255qE5Lu35qC8XHJcbnZhciBsYXN0X3BheV9wcmljZSA9IDA7XHJcblxyXG5cclxuLyoqXHJcbiAqXHJcbiAqIEBwYXJhbSBwcmljZSAgICAg5b6u5L+h5YWF5YC86ZKx5pWwLOWNleS9jTrliIZcclxuICogQHBhcmFtIHR5cGUgICAgICDlvq7kv6HlhYXlgLznsbvlnovvvJoxLeS9memineWFheWAvCwyLeaIkOmVv+eJiCwzLeS4k+S4mueJiOOAglxyXG4gKi9cclxuZnVuY3Rpb24gcHJlX3BheV93ZWNoYXQocHJpY2UsIHR5cGUpIHtcclxuICAgIHZhciBwYXJhbXMgPSB7fTtcclxuICAgIHBhcmFtc1sncHJpY2UnXSA9IHByaWNlOyAvL+WNleS9jTrliIZcclxuICAgIHBhcmFtc1sndHlwZSddID0gdHlwZTtcclxuICAgICQucG9zdCgnL3ByZV93ZWNoYXRQYXknLCBwYXJhbXMsIGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICBpZiAodHlwZSAhPSAxKSB7XHJcbiAgICAgICAgICAgIHZhciBsb2NhbF92ZXJzaW9uID0gZGF0YS5kYXRhWyd1c2VyX2xvY2FsX3ZlcnNpb24nXTtcclxuICAgICAgICAgICAgaWYgKGxvY2FsX3ZlcnNpb24gPT0gVFlQRV9WSVBfVkVSU0lPTiAmJiAodHlwZSA9PSBUWVBFX1ZJUF9WRVJTSU9OIHx8IHR5cGUgPT0gVFlQRV9HUk9XX1VQX1ZFUlNJT04pKSB7XHJcbiAgICAgICAgICAgICAgICBhbGVydChcIuaCqOW3sue7j+aYr+S4k+S4mueJiOS6hu+8jOeCueWHu+ehruWumui3s+WbnueuoeeQhuWPsFwiKTtcclxuICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gXCIvYWNjb3VudHZpZXdcIjtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgfSBlbHNlIGlmIChsb2NhbF92ZXJzaW9uID09IFRZUEVfR1JPV19VUF9WRVJTSU9OICYmIHR5cGUgPT0gVFlQRV9HUk9XX1VQX1ZFUlNJT04pIHtcclxuICAgICAgICAgICAgICAgIGFsZXJ0KFwi5oKo5bey57uP5piv5oiQ6ZW/54mI5LqG77yM54K55Ye756Gu5a6a6Lez5Zue566h55CG5Y+wXCIpO1xyXG4gICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSBcIi9hY2NvdW50dmlld1wiO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChkYXRhLmNvZGUgPT0gMCkge1xyXG4gICAgICAgICAgICAkKFwiLnNjYW5fc2NyZWVuXCIpLmZhZGVJbigzMDApO1xyXG4gICAgICAgICAgICAkKFwiLnNjYW5fc2NyZWVuX2NvbnRlbnRcIikuZmFkZUluKDMwMCk7XHJcbiAgICAgICAgICAgIGlmIChkYXRhLmRhdGEpIHtcclxuICAgICAgICAgICAgICAgIGlmICh0eXBlID09IFRZUEVfQUNDT1VOVF9DSEFSR0UpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAobGFzdF9wYXlfcHJpY2UgPT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBsYXN0X3BheV9wcmljZSA9IHByaWNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyAg5paw5bu6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNyZWF0ZV9uZXdfcXJfY29kZShkYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobGFzdF9wYXlfcHJpY2UgPT0gcHJpY2UpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGp1ZGdlX3BheV92YWxpZF90aW1lKGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFzdF9wYXlfcHJpY2UgPSBwcmljZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vICDmlrDlu7pcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNyZWF0ZV9uZXdfcXJfY29kZShkYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAganVkZ2VfcGF5X3ZhbGlkX3RpbWUoZGF0YSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBiYXNlVXRpbHMuc2hvdy5yZWRUaXAoXCLnlJ/miJDkuoznu7TnoIHlpLHotKUhXCIpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGJhc2VVdGlscy5zaG93LnJlZFRpcChkYXRhLm1zZyk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgIH0pO1xyXG59XHJcblxyXG5mdW5jdGlvbiBjcmVhdGVfbmV3X3FyX2NvZGUoZGF0YSkge1xyXG4gICAgb3JkZXJfaWQgPSBkYXRhLmRhdGFbJ29yZGVyX2lkJ107XHJcbiAgICAkKFwiI3FyX2NvZGVcIikuaHRtbChcIlwiKTtcclxuICAgIGNyZWF0ZVFSKGRhdGEuZGF0YVsnY29kZV91cmwnXSk7XHJcbiAgICBjbGVhciA9IHNldEludGVydmFsKHF1ZXJ5cmVzdWx0LCA1MDAwKTtcclxufVxyXG5cclxuZnVuY3Rpb24gY3JlYXRlUVIoY29kZV91cmwpIHtcclxuICAgIC8v55Sf5oiQ5LqM57u056CBXHJcbiAgICB2YXIgcXJjb2RlID0gbmV3IFFSQ29kZShkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInFyX2NvZGVcIiksIHtcclxuICAgICAgICB0ZXh0OiBjb2RlX3VybCxcclxuICAgICAgICB3aWR0aDogMjAwLFxyXG4gICAgICAgIGhlaWdodDogMjAwLFxyXG4gICAgICAgIGNvbG9yRGFyazogXCIjMDAwMDAwXCIsXHJcbiAgICAgICAgY29sb3JMaWdodDogXCIjZmZmZmZmXCIsXHJcbiAgICAgICAgY29ycmVjdExldmVsOiBRUkNvZGUuQ29ycmVjdExldmVsLkhcclxuICAgIH0pO1xyXG4gICAgY3JlYXRlX3FyX2ZsYWcgPSBmYWxzZTtcclxufVxyXG5cclxuLyoqXHJcbiAqIOWIpOaWreaUr+S7mOaXtumXtOaYr+WQpui/h+acn1xyXG4gKi9cclxuZnVuY3Rpb24ganVkZ2VfcGF5X3ZhbGlkX3RpbWUoZGF0YSkge1xyXG4gICAgaWYgKGxhc3RfcGF5X3RpbWUgIT0gMCkge1xyXG4gICAgICAgIC8vICDojrflj5blvZPliY3ml7bpl7TmiLNcclxuICAgICAgICB2YXIgdGltZV9zdGFtcCA9IChuZXcgRGF0ZSgpKS52YWx1ZU9mKCk7XHJcbiAgICAgICAgaWYgKHRpbWVfc3RhbXAgLSBsYXN0X3BheV90aW1lID49IG1heF90aW1lKSB7XHJcbiAgICAgICAgICAgIGNyZWF0ZV9uZXdfcXJfY29kZShkYXRhKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgbGFzdF9wYXlfdGltZSA9IHRpbWVfc3RhbXA7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIHZhciB0aW1lX3N0YW1wID0gKG5ldyBEYXRlKCkpLnZhbHVlT2YoKTtcclxuICAgICAgICBsYXN0X3BheV90aW1lID0gdGltZV9zdGFtcDtcclxuXHJcbiAgICAgICAgY3JlYXRlX25ld19xcl9jb2RlKGRhdGEpO1xyXG4gICAgfVxyXG59XHJcblxyXG5cclxuLy/mn6Xor6LmlK/ku5jnu5PmnpxcclxudmFyIGNsZWFyO1xyXG52YXIgbWF4X3RpbWUgPSAzMDAgKiAxMDAwO1xyXG52YXIgY3VycmVudF90aW1lID0gMDtcclxuXHJcbmZ1bmN0aW9uIHF1ZXJ5cmVzdWx0KCkge1xyXG4gICAgcXVlcnlfcGF5X3Jlc3VsdChvcmRlcl9pZCk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHF1ZXJ5X3BheV9yZXN1bHQob3JkZXJJZCkge1xyXG5cclxuICAgICQucG9zdCgnL2dldFBheVJlc3VsdCcsIHsgXCJvcmRlcl9pZFwiOiBvcmRlcklkIH0sIGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICBpZiAoZGF0YS5jb2RlID09IDApIHtcclxuICAgICAgICAgICAgY2xlYXJJbnRlcnZhbChjbGVhcik7XHJcbiAgICAgICAgICAgICQoXCIuc2Nhbl9zY3JlZW5fY29udGVudFwiKS5oaWRlKCk7XHJcbiAgICAgICAgICAgICQoXCIuc2Nhbl9zdGF0dXNfc3VjY2Vzc1wiKS5zaG93KCk7XHJcbiAgICAgICAgICAgIHZhciBjaGFyZ2VSZW1haW4gPSAzO1xyXG4gICAgICAgICAgICB2YXIgY2hhcmdlX3RpbWVyID0gc2V0SW50ZXJ2YWwoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhjaGFyZ2VSZW1haW4pO1xyXG4gICAgICAgICAgICAgICAgY2hhcmdlUmVtYWluLS07XHJcbiAgICAgICAgICAgICAgICBpZiAoY2hhcmdlUmVtYWluID49IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAkKFwiLnNjYW5fc3RhdHVzX2NvdW50ZG93biBzcGFuXCIpLnRleHQoY2hhcmdlUmVtYWluKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChjaGFyZ2VSZW1haW4gPCAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJChcIi5zY2FuX3NjcmVlblwiKS5mYWRlT3V0KDMwMCk7XHJcbiAgICAgICAgICAgICAgICAgICAgY2xlYXJJbnRlcnZhbChjaGFyZ2VfdGltZXIpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmKEdldFF1ZXJ5U3RyaW5nKCdmaXJzdCcpIT0xKXsgIC8v5LuO5Z+656GA54mI5Y2H57qnXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gXCIvYWNjb3VudHZpZXdcIjtcclxuICAgICAgICAgICAgICAgICAgICB9ZWxzZXsvL+esrOS4gOasoeazqOWGjOaIkOmVv+eJiOaIluS4k+S4mueJiFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaHJlZiA9IHdpbmRvdy5sb2NhdGlvbi5ocmVmO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZigvb3Blbl9ncm93VXAvLnRlc3QoaHJlZikpey8v5oiQ6ZW/54mIXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihHZXRRdWVyeVN0cmluZygnZmlyc3RfbG9naW4nKT09MSl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSBcIi9hY2NvdW50dmlldz9maXJzdD0xJnR5cGU9MSZmaXJzdF9sb2dpbj0xXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9ZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSBcIi9hY2NvdW50dmlldz9maXJzdD0xJnR5cGU9MVwiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9ZWxzZSBpZigvb3Blbl92aXAvLnRlc3QoaHJlZikpey8v5LiT5Lia54mIXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihHZXRRdWVyeVN0cmluZygnZmlyc3RfbG9naW4nKT09MSl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSBcIi9hY2NvdW50dmlldz9maXJzdD0xJnR5cGU9MiZmaXJzdF9sb2dpbj0xXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9ZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSBcIi9hY2NvdW50dmlldz9maXJzdD0xJnR5cGU9MlwiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LCAxMDAwKVxyXG4gICAgICAgICAgICAvLyAkKFwiI2JpbmRfd3hfYWNjb3VudFwiKS5odG1sKGRhdGEuZGF0YSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgLy8gY2xlYXIgPSBzZXRJbnRlcnZhbChxdWVyeXJlc3VsdCw1MDAwKTtcclxuXHJcbiAgICAgICAgICAgIGN1cnJlbnRfdGltZSArPSAxMDAwO1xyXG5cclxuICAgICAgICAgICAgaWYgKGN1cnJlbnRfdGltZSA9PSBtYXhfdGltZSkge1xyXG4gICAgICAgICAgICAgICAgY2xlYXJJbnRlcnZhbChjbGVhcik7XHJcbiAgICAgICAgICAgICAgICAkKFwiLnNjYW5fc2NyZWVuX2NvbnRlbnRcIikuaGlkZSgpO1xyXG4gICAgICAgICAgICAgICAgJChcIi5zY2FuX3N0YXR1c19mYWlsXCIpLnNob3coKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG5cclxufVxyXG5cclxuZnVuY3Rpb24gR2V0UXVlcnlTdHJpbmcobmFtZSkge1xyXG4gICAgdmFyIHJlZyA9IG5ldyBSZWdFeHAoXCIoXnwmKVwiICsgbmFtZSArIFwiPShbXiZdKikoJnwkKVwiKTtcclxuICAgIHZhciByID0gd2luZG93LmxvY2F0aW9uLnNlYXJjaC5zdWJzdHIoMSkubWF0Y2gocmVnKTtcclxuICAgIGlmIChyICE9IG51bGwpIHJldHVybiB1bmVzY2FwZShyWzJdKTtcclxuICAgIHJldHVybiBudWxsO1xyXG59XHJcbiJdfQ==
