$(document).ready(function(){$manageExercise.init()});$manageExercise=function(){var e={};var i={submitLimit:false,pageType:$("#admin_data").data("page_type")};e.init=function(){changeSaveFlag(true);if(i.pageType==1){i.resType=$("#admin_data").data("resource_type");i.resId=$("#admin_data").data("resource_id");i.resName=$("#admin_data").data("resource_name")}$(".characterNumLimit>span").text($("#exerciseBookName").val().length);$("#exerciseBookName").on("change",function(){t()});$("#resTypeSelector").on("change",function(){var e=$(this).val();if(e==-1){$("#resItemSelector").html(' <option value="-1">请选择具体课程</option>')}else{$.ajax("/exercise/get_resource_list",{type:"POST",dataType:"json",data:{resource_type:e},success:function(t){if(t.code==0){var a=t.data.resource_list,r="";if(i.pageType==1&&i.resType==e){r+='<option value="'+i.resId+'" selected>'+i.resName+"</option>"}$.each(a,function(i,t){var a=e==5?t.name:t.title;r+='<option value="'+t.id+'">'+a+"</option>"});if(r.length==0){r='<option value="-1">暂无数据</option>'}$("#resItemSelector").html(r)}else{baseUtils.show.redTip("网络问题，请稍后再试")}},error:function(e,i,t){console.log(t);alert("服务器出小差了，请稍后再试！")}})}});$(".remindRadio").on("click",function(){$(".remindRadio").children(".circleRadio").removeClass("radioActive");$(this).children(".circleRadio").addClass("radioActive")});$("#cancelSaveExercise").click(function(){window.history.back()});$("#confirmSaveExercise").click(function(){var e=$.trim($("#exerciseBookName").val()),t=$("#resItemSelector").val(),a=$("#resTypeSelector").val(),r=$("#resItemSelector > option:selected").text(),o=$("#communitySelector").val(),s=$(".circleRadio.radioActive").data("is_remind"),c="";s=0;if(e.length==0){baseUtils.show.redTip("还没有输入作业本名称");return false}if(e.length>14){baseUtils.show.redTip("作业本名称长度不能超过14字");return false}if(t==-1){baseUtils.show.redTip("还没有选择具体课程");return false}var n={title:e,resource_id:t,resource_type:a,resource_name:r,is_enable_notify:s};if(o!=-1&&o!=undefined){n.community_id=o}if(i.pageType==0){c="/exercise/upload_exercise_book"}else if(i.pageType==1){c="/exercise/update_exercise_book";n.exercise_book_id=GetQueryString("exercise_book_id")}else{console.log(" pageType 参数有误。");baseUtils.show.redTip("网络错误，请稍后再试");return false}if(i.submitLimit){baseUtils.show.redTip("正在提交中，请稍后再试");return false}i.submitLimit=true;$.ajax(c,{type:"POST",dataType:"json",data:{params:n},success:function(e){i.submitLimit=false;if(e.code==0){baseUtils.show.blueTip(i.pageType==0?"创建作业本成功":"编辑作业成功");setTimeout(function(){window.location.href="/exercise/exercise_book_list"},1e3)}else{baseUtils.show.redTip(e.msg)}},error:function(e,t,a){i.submitLimit=false;console.log(a);alert("服务器出小差了，请稍后再试！")}})})};function t(){var e=$("#exerciseBookName"),i=$.trim(e.val());if(i.length>=14){i=i.substr(0,14);e.val(i);$(".characterNumLimit").css({color:"red"});setTimeout(function(){$(".characterNumLimit").css({color:"#888888"})},3e3)}$(".characterNumLimit>span").text(i.length)}return e}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1hbmFnZUV4ZXJjaXNlQm9vay5qcyJdLCJuYW1lcyI6WyIkIiwiZG9jdW1lbnQiLCJyZWFkeSIsIiRtYW5hZ2VFeGVyY2lzZSIsImluaXQiLCIkcHJpdmF0ZSIsInN1Ym1pdExpbWl0IiwicGFnZVR5cGUiLCJkYXRhIiwiY2hhbmdlU2F2ZUZsYWciLCJyZXNUeXBlIiwicmVzSWQiLCJyZXNOYW1lIiwidGV4dCIsInZhbCIsImxlbmd0aCIsIm9uIiwiY2hlY2tJbnB1dE5hbWUiLCJ0aGlzIiwiaHRtbCIsImFqYXgiLCJ0eXBlIiwiZGF0YVR5cGUiLCJyZXNvdXJjZV90eXBlIiwic3VjY2VzcyIsInJlc3VsdCIsImNvZGUiLCJyZXNvdXJjZUxpc3QiLCJyZXNvdXJjZV9saXN0IiwiaHRtbFN0ciIsImVhY2giLCJrIiwidiIsIm5hbWUiLCJ0aXRsZSIsImlkIiwiYmFzZVV0aWxzIiwic2hvdyIsInJlZFRpcCIsImVycm9yIiwieGhyIiwic3RhdHVzIiwiZXJyIiwiY29uc29sZSIsImxvZyIsImFsZXJ0IiwiY2hpbGRyZW4iLCJyZW1vdmVDbGFzcyIsImFkZENsYXNzIiwiY2xpY2siLCJ3aW5kb3ciLCJoaXN0b3J5IiwiYmFjayIsImV4ZXJjaXNlQm9va05hbWUiLCJ0cmltIiwiY29tbXVuaXR5SWQiLCJpc1JlbWluZCIsInBvc3RVcmwiLCJwYXJhbXMiLCJyZXNvdXJjZV9pZCIsInJlc291cmNlX25hbWUiLCJpc19lbmFibGVfbm90aWZ5IiwidW5kZWZpbmVkIiwiY29tbXVuaXR5X2lkIiwiZXhlcmNpc2VfYm9va19pZCIsIkdldFF1ZXJ5U3RyaW5nIiwiYmx1ZVRpcCIsInNldFRpbWVvdXQiLCJsb2NhdGlvbiIsImhyZWYiLCJtc2ciLCIkc2VsZiIsImV4ZXJjaXNlTmFtZSIsInN1YnN0ciIsImNzcyIsImNvbG9yIl0sIm1hcHBpbmdzIjoiQUFJQUEsRUFBRUMsVUFBVUMsTUFBTSxXQUNkQyxnQkFBZ0JDLFFBR3BCRCxpQkFBa0IsV0FDZCxHQUFJQSxLQUNK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Q1pSLFdBQVVDLEtBQUtDLE9BQU8sYUFDdEIsT0FBTyxPQUVYLEdBQUlqQyxFQUFTQyxZQUFhLENBQ3RCOEIsVUFBVUMsS0FBS0MsT0FBTyxjQUN0QixPQUFPLE9BRVhqQyxFQUFTQyxZQUFjLElBQ3ZCTixHQUFFb0IsS0FBS3FDLEdBQ0hwQyxLQUFNLE9BQ05DLFNBQVUsT0FDVmQsTUFDSWtELE9BQVFBLEdBRVpsQyxRQUFTLFNBQVVDLEdBQ2ZwQixFQUFTQyxZQUFjLEtBQ3ZCLElBQUltQixFQUFPQyxNQUFRLEVBQUcsQ0FDbEJVLFVBQVVDLEtBQUs2QixRQUFRN0QsRUFBU0UsVUFBVSxFQUFFLFVBQVUsU0FDdEQ0RCxZQUFXLFdBQ1BqQixPQUFPa0IsU0FBU0MsS0FBTyxnQ0FDeEIsU0FDQSxDQUNIakMsVUFBVUMsS0FBS0MsT0FBT2IsRUFBTzZDLE9BR3JDL0IsTUFBTyxTQUFVQyxFQUFLQyxFQUFRQyxHQUMxQnJDLEVBQVNDLFlBQWMsS0FDdkJxQyxTQUFRQyxJQUFJRixFQUNaRyxPQUFNLHVCQU90QixTQUFTNUIsS0FDTCxHQUFJc0QsR0FBUXZFLEVBQUUscUJBQ1Z3RSxFQUFleEUsRUFBRXNELEtBQUtpQixFQUFNekQsTUFFaEMsSUFBSTBELEVBQWF6RCxRQUFVLEdBQUksQ0FDM0J5RCxFQUFlQSxFQUFhQyxPQUFPLEVBQUcsR0FDdENGLEdBQU16RCxJQUFJMEQsRUFDVnhFLEdBQUUsc0JBQXNCMEUsS0FBS0MsTUFBUyxPQUN0Q1IsWUFBVyxXQUNQbkUsRUFBRSxzQkFBc0IwRSxLQUFLQyxNQUFTLGFBQ3ZDLEtBRVAzRSxFQUFFLDJCQUEyQmEsS0FBSzJELEVBQWF6RCxRQUduRCxNQUFPWiIsImZpbGUiOiJtYW5hZ2VFeGVyY2lzZUJvb2suanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICogQ3JlYXRlZCBieSBBZG1pbmlzdHJhdG9yIG9uIDIwMTcvNy8zMS5cclxuICovXHJcblxyXG4kKGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbiAoKSB7XHJcbiAgICAkbWFuYWdlRXhlcmNpc2UuaW5pdCgpO1xyXG59KTtcclxuXHJcbiRtYW5hZ2VFeGVyY2lzZSA9IChmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgJG1hbmFnZUV4ZXJjaXNlID0ge307XHJcbiAgICB2YXIgJHByaXZhdGUgPSB7XHJcbiAgICAgICAgc3VibWl0TGltaXQ6IGZhbHNlLFxyXG4gICAgICAgIHBhZ2VUeXBlOiAkKFwiI2FkbWluX2RhdGFcIikuZGF0YShcInBhZ2VfdHlwZVwiKSwgICAgICAgLy8wLeWIm+W7uu+8mzEt57yW6L6RXHJcbiAgICB9XHJcblxyXG4gICAgJG1hbmFnZUV4ZXJjaXNlLmluaXQgPSBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgICAgIC8v54K55Ye75L6n6L655qCP56a75byA5pe255qE5by55qGGXHJcbiAgICAgICAgY2hhbmdlU2F2ZUZsYWcodHJ1ZSk7XHJcblxyXG4gICAgICAgIGlmICgkcHJpdmF0ZS5wYWdlVHlwZSA9PSAxKSB7XHJcbiAgICAgICAgICAgICRwcml2YXRlLnJlc1R5cGUgPSAkKFwiI2FkbWluX2RhdGFcIikuZGF0YShcInJlc291cmNlX3R5cGVcIik7ICAgIC8v5bey5YWz6IGU6K++56iL55qE57G75Z6LXHJcbiAgICAgICAgICAgICRwcml2YXRlLnJlc0lkID0gJChcIiNhZG1pbl9kYXRhXCIpLmRhdGEoXCJyZXNvdXJjZV9pZFwiKTsgICAgLy/lt7LlhbPogZTor77nqIvnmoRpZFxyXG4gICAgICAgICAgICAkcHJpdmF0ZS5yZXNOYW1lID0gJChcIiNhZG1pbl9kYXRhXCIpLmRhdGEoXCJyZXNvdXJjZV9uYW1lXCIpOyAgICAvL+W3suWFs+iBlOivvueoi+eahGlkXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAkKFwiLmNoYXJhY3Rlck51bUxpbWl0PnNwYW5cIikudGV4dCgkKFwiI2V4ZXJjaXNlQm9va05hbWVcIikudmFsKCkubGVuZ3RoKTtcclxuXHJcbiAgICAgICAgJChcIiNleGVyY2lzZUJvb2tOYW1lXCIpLm9uKFwiY2hhbmdlXCIsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgY2hlY2tJbnB1dE5hbWUoKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgLy/lhbPogZTor77nqItcclxuICAgICAgICAkKFwiI3Jlc1R5cGVTZWxlY3RvclwiKS5vbihcImNoYW5nZVwiLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciByZXNUeXBlID0gJCh0aGlzKS52YWwoKTtcclxuICAgICAgICAgICAgaWYgKHJlc1R5cGUgPT0gLTEpIHtcclxuICAgICAgICAgICAgICAgICQoXCIjcmVzSXRlbVNlbGVjdG9yXCIpLmh0bWwoXHJcbiAgICAgICAgICAgICAgICAgICAgJyA8b3B0aW9uIHZhbHVlPVwiLTFcIj7or7fpgInmi6nlhbfkvZPor77nqIs8L29wdGlvbj4nXHJcbiAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgJC5hamF4KFwiL2V4ZXJjaXNlL2dldF9yZXNvdXJjZV9saXN0XCIsIHtcclxuICAgICAgICAgICAgICAgICAgICB0eXBlOiBcIlBPU1RcIixcclxuICAgICAgICAgICAgICAgICAgICBkYXRhVHlwZTogXCJqc29uXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvdXJjZV90eXBlOiByZXNUeXBlXHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbiAocmVzdWx0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXN1bHQuY29kZSA9PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVzb3VyY2VMaXN0ID0gcmVzdWx0LmRhdGEucmVzb3VyY2VfbGlzdCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBodG1sU3RyID0gXCJcIjtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoJHByaXZhdGUucGFnZVR5cGUgPT0gMSAmJiAkcHJpdmF0ZS5yZXNUeXBlID09IHJlc1R5cGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBodG1sU3RyICs9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICc8b3B0aW9uIHZhbHVlPVwiJyskcHJpdmF0ZS5yZXNJZCsnXCIgc2VsZWN0ZWQ+JyskcHJpdmF0ZS5yZXNOYW1lKyc8L29wdGlvbj4nO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJC5lYWNoKHJlc291cmNlTGlzdCwgZnVuY3Rpb24gKGssIHYpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVzTmFtZSA9IChyZXNUeXBlPT01P3YubmFtZTp2LnRpdGxlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBodG1sU3RyICs9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICc8b3B0aW9uIHZhbHVlPVwiJyt2LmlkKydcIj4nK3Jlc05hbWUrJzwvb3B0aW9uPic7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChodG1sU3RyLmxlbmd0aCA9PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaHRtbFN0ciA9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICc8b3B0aW9uIHZhbHVlPVwiLTFcIj7mmoLml6DmlbDmja48L29wdGlvbj4nO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJChcIiNyZXNJdGVtU2VsZWN0b3JcIikuaHRtbChodG1sU3RyKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiYXNlVXRpbHMuc2hvdy5yZWRUaXAoXCLnvZHnu5zpl67popjvvIzor7fnqI3lkI7lho3or5VcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiBmdW5jdGlvbiAoeGhyLCBzdGF0dXMsIGVycikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhbGVydChcIuacjeWKoeWZqOWHuuWwj+W3ruS6hu+8jOivt+eojeWQjuWGjeivle+8gVwiKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgLy8gcmFkaW8g5oyJ6ZKu54K55Ye75YiH5o2i5pWI5p6cXHJcbiAgICAgICAgJCgnLnJlbWluZFJhZGlvJykub24oJ2NsaWNrJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICQoJy5yZW1pbmRSYWRpbycpLmNoaWxkcmVuKCcuY2lyY2xlUmFkaW8nKS5yZW1vdmVDbGFzcygncmFkaW9BY3RpdmUnKTtcclxuICAgICAgICAgICAgJCh0aGlzKS5jaGlsZHJlbignLmNpcmNsZVJhZGlvJykuYWRkQ2xhc3MoJ3JhZGlvQWN0aXZlJyk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICQoXCIjY2FuY2VsU2F2ZUV4ZXJjaXNlXCIpLmNsaWNrKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgd2luZG93Lmhpc3RvcnkuYmFjaygpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICAkKFwiI2NvbmZpcm1TYXZlRXhlcmNpc2VcIikuY2xpY2soZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgZXhlcmNpc2VCb29rTmFtZSA9ICQudHJpbSgkKFwiI2V4ZXJjaXNlQm9va05hbWVcIikudmFsKCkpLFxyXG4gICAgICAgICAgICAgICAgcmVzSWQgPSAkKFwiI3Jlc0l0ZW1TZWxlY3RvclwiKS52YWwoKSxcclxuICAgICAgICAgICAgICAgIHJlc1R5cGUgPSAkKFwiI3Jlc1R5cGVTZWxlY3RvclwiKS52YWwoKSxcclxuICAgICAgICAgICAgICAgIHJlc05hbWUgPSAkKFwiI3Jlc0l0ZW1TZWxlY3RvciA+IG9wdGlvbjpzZWxlY3RlZFwiKS50ZXh0KCksXHJcbiAgICAgICAgICAgICAgICBjb21tdW5pdHlJZCA9ICQoXCIjY29tbXVuaXR5U2VsZWN0b3JcIikudmFsKCksXHJcbiAgICAgICAgICAgICAgICBpc1JlbWluZCA9ICQoXCIuY2lyY2xlUmFkaW8ucmFkaW9BY3RpdmVcIikuZGF0YShcImlzX3JlbWluZFwiKSwgLy8gMSAtIOaPkOmGku+8jCAwIC0g5LiN5o+Q6YaSPOm7mOiupOS4jeaPkOmGkj5cclxuICAgICAgICAgICAgICAgIHBvc3RVcmwgPSBcIlwiO1xyXG5cclxuICAgICAgICAgICAgaXNSZW1pbmQgPSAwOyAgIC8vICBUT0RPIOaaguaXtuWFiOiuvue9ruS4uuS4jeaPkOmGklxyXG5cclxuICAgICAgICAgICAgaWYgKGV4ZXJjaXNlQm9va05hbWUubGVuZ3RoID09IDApIHtcclxuICAgICAgICAgICAgICAgIGJhc2VVdGlscy5zaG93LnJlZFRpcChcIui/mOayoeaciei+k+WFpeS9nOS4muacrOWQjeensFwiKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoZXhlcmNpc2VCb29rTmFtZS5sZW5ndGggPiAxNCkge1xyXG4gICAgICAgICAgICAgICAgYmFzZVV0aWxzLnNob3cucmVkVGlwKFwi5L2c5Lia5pys5ZCN56ew6ZW/5bqm5LiN6IO96LaF6L+HMTTlrZdcIik7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHJlc0lkID09IC0xKSB7XHJcbiAgICAgICAgICAgICAgICBiYXNlVXRpbHMuc2hvdy5yZWRUaXAoXCLov5jmsqHmnInpgInmi6nlhbfkvZPor77nqItcIik7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHZhciBwYXJhbXMgPSB7XHJcbiAgICAgICAgICAgICAgICB0aXRsZTogZXhlcmNpc2VCb29rTmFtZSxcclxuICAgICAgICAgICAgICAgIHJlc291cmNlX2lkOiByZXNJZCxcclxuICAgICAgICAgICAgICAgIHJlc291cmNlX3R5cGU6IHJlc1R5cGUsXHJcbiAgICAgICAgICAgICAgICByZXNvdXJjZV9uYW1lOiByZXNOYW1lLFxyXG4gICAgICAgICAgICAgICAgaXNfZW5hYmxlX25vdGlmeTogaXNSZW1pbmRcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoY29tbXVuaXR5SWQgIT0gLTEgJiYgY29tbXVuaXR5SWQgIT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgICAgICBwYXJhbXMuY29tbXVuaXR5X2lkID0gY29tbXVuaXR5SWQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKCRwcml2YXRlLnBhZ2VUeXBlID09IDApIHsgICAgICAgICAgICAvL+WIm+W7ulxyXG4gICAgICAgICAgICAgICAgcG9zdFVybCA9IFwiL2V4ZXJjaXNlL3VwbG9hZF9leGVyY2lzZV9ib29rXCI7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoJHByaXZhdGUucGFnZVR5cGUgPT0gMSkgeyAgICAgLy/nvJbovpFcclxuICAgICAgICAgICAgICAgIHBvc3RVcmwgPSBcIi9leGVyY2lzZS91cGRhdGVfZXhlcmNpc2VfYm9va1wiO1xyXG4gICAgICAgICAgICAgICAgcGFyYW1zLmV4ZXJjaXNlX2Jvb2tfaWQgPSBHZXRRdWVyeVN0cmluZyhcImV4ZXJjaXNlX2Jvb2tfaWRcIik7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIiBwYWdlVHlwZSDlj4LmlbDmnInor6/jgIJcIik7XHJcbiAgICAgICAgICAgICAgICBiYXNlVXRpbHMuc2hvdy5yZWRUaXAoXCLnvZHnu5zplJnor6/vvIzor7fnqI3lkI7lho3or5VcIik7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKCRwcml2YXRlLnN1Ym1pdExpbWl0KSB7XHJcbiAgICAgICAgICAgICAgICBiYXNlVXRpbHMuc2hvdy5yZWRUaXAoXCLmraPlnKjmj5DkuqTkuK3vvIzor7fnqI3lkI7lho3or5VcIik7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgJHByaXZhdGUuc3VibWl0TGltaXQgPSB0cnVlO1xyXG4gICAgICAgICAgICAkLmFqYXgocG9zdFVybCwge1xyXG4gICAgICAgICAgICAgICAgdHlwZTogXCJQT1NUXCIsXHJcbiAgICAgICAgICAgICAgICBkYXRhVHlwZTogXCJqc29uXCIsXHJcbiAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgcGFyYW1zOiBwYXJhbXNcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbiAocmVzdWx0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHByaXZhdGUuc3VibWl0TGltaXQgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAocmVzdWx0LmNvZGUgPT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBiYXNlVXRpbHMuc2hvdy5ibHVlVGlwKCRwcml2YXRlLnBhZ2VUeXBlPT0wP1wi5Yib5bu65L2c5Lia5pys5oiQ5YqfXCI6XCLnvJbovpHkvZzkuJrmiJDlip9cIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSBcIi9leGVyY2lzZS9leGVyY2lzZV9ib29rX2xpc3RcIjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSwgMTAwMCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYmFzZVV0aWxzLnNob3cucmVkVGlwKHJlc3VsdC5tc2cpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICBlcnJvcjogZnVuY3Rpb24gKHhociwgc3RhdHVzLCBlcnIpIHtcclxuICAgICAgICAgICAgICAgICAgICAkcHJpdmF0ZS5zdWJtaXRMaW1pdCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycik7XHJcbiAgICAgICAgICAgICAgICAgICAgYWxlcnQoXCLmnI3liqHlmajlh7rlsI/lt67kuobvvIzor7fnqI3lkI7lho3or5XvvIFcIik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICB9KTtcclxuXHJcbiAgICB9O1xyXG4gICAgZnVuY3Rpb24gY2hlY2tJbnB1dE5hbWUoKSB7XHJcbiAgICAgICAgdmFyICRzZWxmID0gJChcIiNleGVyY2lzZUJvb2tOYW1lXCIpLFxyXG4gICAgICAgICAgICBleGVyY2lzZU5hbWUgPSAkLnRyaW0oJHNlbGYudmFsKCkpO1xyXG5cclxuICAgICAgICBpZiAoZXhlcmNpc2VOYW1lLmxlbmd0aCA+PSAxNCkge1xyXG4gICAgICAgICAgICBleGVyY2lzZU5hbWUgPSBleGVyY2lzZU5hbWUuc3Vic3RyKDAsIDE0KTtcclxuICAgICAgICAgICAgJHNlbGYudmFsKGV4ZXJjaXNlTmFtZSk7XHJcbiAgICAgICAgICAgICQoXCIuY2hhcmFjdGVyTnVtTGltaXRcIikuY3NzKHtcImNvbG9yXCI6IFwicmVkXCJ9KTtcclxuICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAkKFwiLmNoYXJhY3Rlck51bUxpbWl0XCIpLmNzcyh7XCJjb2xvclwiOiBcIiM4ODg4ODhcIn0pO1xyXG4gICAgICAgICAgICB9LCAzMDAwKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgJChcIi5jaGFyYWN0ZXJOdW1MaW1pdD5zcGFuXCIpLnRleHQoZXhlcmNpc2VOYW1lLmxlbmd0aCk7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuICRtYW5hZ2VFeGVyY2lzZTtcclxufSkoKTtcclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG4iXX0=
