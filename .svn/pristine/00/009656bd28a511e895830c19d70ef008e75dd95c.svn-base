$(document).ready(function(){$manageExercise.init()});$manageExercise=function(){var e={};var i={submitLimit:false,pageType:$("#admin_data").data("page_type")};e.init=function(){changeSaveFlag(true);if(i.pageType==1){i.resType=$("#admin_data").data("resource_type");i.resId=$("#admin_data").data("resource_id");i.resName=$("#admin_data").data("resource_name")}$(".characterNumLimit>span").text($("#exerciseBookName").val().length);$("#exerciseBookName").on("input",function(){t()});$("#resTypeSelector").on("change",function(){var e=$(this).val();if(e==-1){$("#resItemSelector").html(' <option value="-1">请选择具体课程</option>')}else{$.ajax("/exercise/get_resource_list",{type:"POST",dataType:"json",data:{resource_type:e},success:function(t){if(t.code==0){var a=t.data.resource_list,r="";if(i.pageType==1&&i.resType==e){r+='<option value="'+i.resId+'" selected>'+i.resName+"</option>"}$.each(a,function(i,t){var a=e==5?t.name:t.title;r+='<option value="'+t.id+'">'+a+"</option>"});if(r.length==0){r='<option value="-1">暂无数据</option>'}$("#resItemSelector").html(r)}else{baseUtils.show.redTip("网络问题，请稍后再试")}},error:function(e,i,t){console.log(t);alert("服务器出小差了，请稍后再试！")}})}});$(".remindRadio").on("click",function(){$(".remindRadio").children(".circleRadio").removeClass("radioActive");$(this).children(".circleRadio").addClass("radioActive")});$("#cancelSaveExercise").click(function(){window.history.back()});$("#confirmSaveExercise").click(function(){var e=$.trim($("#exerciseBookName").val()),t=$("#resItemSelector").val(),a=$("#resTypeSelector").val(),r=$("#resItemSelector > option:selected").text(),o=$("#communitySelector").val(),s=$(".circleRadio.radioActive").data("is_remind"),c="";s=0;if(e.length==0){baseUtils.show.redTip("还没有输入作业本名称");return false}if(e.length>14){baseUtils.show.redTip("作业本名称长度不能超过14字");return false}if(t==-1){baseUtils.show.redTip("还没有选择具体课程");return false}var n={title:e,resource_id:t,resource_type:a,resource_name:r,is_enable_notify:s};if(o!=-1&&o!=undefined){n.community_id=o}if(i.pageType==0){c="/exercise/upload_exercise_book"}else if(i.pageType==1){c="/exercise/update_exercise_book";n.exercise_book_id=GetQueryString("exercise_book_id")}else{console.log(" pageType 参数有误。");baseUtils.show.redTip("网络错误，请稍后再试");return false}if(i.submitLimit){baseUtils.show.redTip("正在提交中，请稍后再试");return false}i.submitLimit=true;$.ajax(c,{type:"POST",dataType:"json",data:{params:n},success:function(e){i.submitLimit=false;if(e.code==0){baseUtils.show.blueTip(i.pageType==0?"创建成功":"编辑成功");if(i.pageType==0){var t=e.data.exerciseBookId;sessionStorage.setItem("lastExerciseBookId",t);sessionStorage.setItem("lastResourceType",a)}setTimeout(function(){var e=GetQueryString("page_index")||1;window.location.href="/exercise/exercise_book_list?page="+e},1e3)}else{baseUtils.show.redTip(e.msg)}},error:function(e,t,a){i.submitLimit=false;console.log(a);alert("服务器出小差了，请稍后再试！")}})})};function t(){var e=$("#exerciseBookName"),i=$.trim(e.val());if(i.length>14){$(".characterNumLimit").css({color:"red"});$("#exerciseBookName").css({"border-color":"red"})}else{$(".characterNumLimit").css({color:"#b2b2b2"});$("#exerciseBookName").css({"border-color":"#dcdcdc"})}$(".characterNumLimit>span").text(i.length)}return e}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1hbmFnZUV4ZXJjaXNlQm9vay5qcyJdLCJuYW1lcyI6WyIkIiwiZG9jdW1lbnQiLCJyZWFkeSIsIiRtYW5hZ2VFeGVyY2lzZSIsImluaXQiLCIkcHJpdmF0ZSIsInN1Ym1pdExpbWl0IiwicGFnZVR5cGUiLCJkYXRhIiwiY2hhbmdlU2F2ZUZsYWciLCJyZXNUeXBlIiwicmVzSWQiLCJyZXNOYW1lIiwidGV4dCIsInZhbCIsImxlbmd0aCIsIm9uIiwiY2hlY2tJbnB1dE5hbWUiLCJ0aGlzIiwiaHRtbCIsImFqYXgiLCJ0eXBlIiwiZGF0YVR5cGUiLCJyZXNvdXJjZV90eXBlIiwic3VjY2VzcyIsInJlc3VsdCIsImNvZGUiLCJyZXNvdXJjZUxpc3QiLCJyZXNvdXJjZV9saXN0IiwiaHRtbFN0ciIsImVhY2giLCJrIiwidiIsIm5hbWUiLCJ0aXRsZSIsImlkIiwiYmFzZVV0aWxzIiwic2hvdyIsInJlZFRpcCIsImVycm9yIiwieGhyIiwic3RhdHVzIiwiZXJyIiwiY29uc29sZSIsImxvZyIsImFsZXJ0IiwiY2hpbGRyZW4iLCJyZW1vdmVDbGFzcyIsImFkZENsYXNzIiwiY2xpY2siLCJ3aW5kb3ciLCJoaXN0b3J5IiwiYmFjayIsImV4ZXJjaXNlQm9va05hbWUiLCJ0cmltIiwiY29tbXVuaXR5SWQiLCJpc1JlbWluZCIsInBvc3RVcmwiLCJwYXJhbXMiLCJyZXNvdXJjZV9pZCIsInJlc291cmNlX25hbWUiLCJpc19lbmFibGVfbm90aWZ5IiwidW5kZWZpbmVkIiwiY29tbXVuaXR5X2lkIiwiZXhlcmNpc2VfYm9va19pZCIsIkdldFF1ZXJ5U3RyaW5nIiwiYmx1ZVRpcCIsImV4ZXJjaXNlQm9va0lkIiwic2Vzc2lvblN0b3JhZ2UiLCJzZXRJdGVtIiwic2V0VGltZW91dCIsInBhZ2VJbmRleCIsImxvY2F0aW9uIiwiaHJlZiIsIm1zZyIsIiRzZWxmIiwiZXhlcmNpc2VOYW1lIiwiY3NzIiwiY29sb3IiLCJib3JkZXItY29sb3IiXSwibWFwcGluZ3MiOiJBQUlBQSxFQUFFQyxVQUFVQyxNQUFNLFdBQ2RDLGdCQUFnQkMsUUFHcEJELGlCQUFrQixXQUNkLEdBQUlBLEtBQ0osSUFBSUUsSUFDQUMsWUFBYSxNQUNiQyxTQUFVUCxFQUFFLGVBQWVRLEtBQUssYUFHcENMLEdBQWdCQyxLQUFPLFdBR25CSyxlQUFlLEtBRWYsSUFBSUosRUFBU0UsVUFBWSxFQUFHLENBQ3hCRixFQUFTSyxRQUFVVixFQUFFLGVBQWVRLEtBQUssZ0JBQ3pDSCxHQUFTTSxNQUFRWCxFQUFFLGVBQWVRLEtBQUssY0FDdkNILEdBQVNPLFFBQVVaLEVBQUUsZUFBZVEsS0FBSyxpQkFHN0NSLEVBQUUsMkJBQTJCYSxLQUFLYixFQUFFLHFCQUFxQmMsTUFBTUMsT0FFL0RmLEdBQUUscUJBQXFCZ0IsR0FBRyxRQUFTLFdBQy9CQyxLQUlKakIsR0FBRSxvQkFBb0JnQixHQUFHLFNBQVUsV0FDL0IsR0FBSU4sR0FBVVYsRUFBRWtCLE1BQU1KLEtBQ3RCLElBQUlKLElBQVksRUFBRyxDQUNmVixFQUFFLG9CQUFvQm1CLEtBQ2xCLDRDQUVELENBQ0huQixFQUFFb0IsS0FBSywrQkFDSEMsS0FBTSxPQUNOQyxTQUFVLE9BQ1ZkLE1BQ0llLGNBQWViLEdBRW5CYyxRQUFTLFNBQVVDLEdBQ2YsR0FBSUEsRUFBT0MsTUFBUSxFQUFHLENBQ2xCLEdBQUlDLEdBQWVGLEVBQU9qQixLQUFLb0IsY0FDM0JDLEVBQVUsRUFFZCxJQUFJeEIsRUFBU0UsVUFBWSxHQUFLRixFQUFTSyxTQUFXQSxFQUFTLENBQ3ZEbUIsR0FDSSxrQkFBa0J4QixFQUFTTSxNQUFNLGNBQWNOLEVBQVNPLFFBQVEsWUFFeEVaLEVBQUU4QixLQUFLSCxFQUFjLFNBQVVJLEVBQUdDLEdBQzlCLEdBQUlwQixHQUFXRixHQUFTLEVBQUVzQixFQUFFQyxLQUFLRCxFQUFFRSxLQUNuQ0wsSUFDSSxrQkFBa0JHLEVBQUVHLEdBQUcsS0FBS3ZCLEVBQVEsYUFFNUMsSUFBSWlCLEVBQVFkLFFBQVUsRUFBRyxDQUNyQmMsRUFDSSxtQ0FFUjdCLEVBQUUsb0JBQW9CbUIsS0FBS1UsT0FFeEIsQ0FDSE8sVUFBVUMsS0FBS0MsT0FBTyxnQkFHOUJDLE1BQU8sU0FBVUMsRUFBS0MsRUFBUUMsR0FDMUJDLFFBQVFDLElBQUlGLEVBQ1pHLE9BQU0sdUJBUXRCN0MsR0FBRSxnQkFBZ0JnQixHQUFHLFFBQVMsV0FDMUJoQixFQUFFLGdCQUFnQjhDLFNBQVMsZ0JBQWdCQyxZQUFZLGNBQ3ZEL0MsR0FBRWtCLE1BQU00QixTQUFTLGdCQUFnQkUsU0FBUyxnQkFHOUNoRCxHQUFFLHVCQUF1QmlELE1BQU0sV0FDM0JDLE9BQU9DLFFBQVFDLFFBR25CcEQsR0FBRSx3QkFBd0JpRCxNQUFNLFdBQzVCLEdBQUlJLEdBQW1CckQsRUFBRXNELEtBQUt0RCxFQUFFLHFCQUFxQmMsT0FDakRILEVBQVFYLEVBQUUsb0JBQW9CYyxNQUM5QkosRUFBVVYsRUFBRSxvQkFBb0JjLE1BQ2hDRixFQUFVWixFQUFFLHNDQUFzQ2EsT0FDbEQwQyxFQUFjdkQsRUFBRSxzQkFBc0JjLE1BQ3RDMEMsRUFBV3hELEVBQUUsNEJBQTRCUSxLQUFLLGFBQzlDaUQsRUFBVSxFQUVkRCxHQUFXLENBRVgsSUFBSUgsRUFBaUJ0QyxRQUFVLEVBQUcsQ0FDOUJxQixVQUFVQyxLQUFLQyxPQUFPLGFBQ3RCLE9BQU8sT0FFWCxHQUFJZSxFQUFpQnRDLE9BQVMsR0FBSSxDQUM5QnFCLFVBQVVDLEtBQUtDLE9BQU8saUJBQ3RCLE9BQU8sT0FFWCxHQUFJM0IsSUFBVSxFQUFHLENBQ2J5QixVQUFVQyxLQUFLQyxPQUFPLFlBQ3RCLE9BQU8sT0FHWCxHQUFJb0IsSUFDQXhCLE1BQU9tQixFQUNQTSxZQUFhaEQsRUFDYlksY0FBZWIsRUFDZmtELGNBQWVoRCxFQUNmaUQsaUJBQWtCTCxFQUV0QixJQUFJRCxJQUFnQixHQUFLQSxHQUFlTyxVQUFXLENBQy9DSixFQUFPSyxhQUFlUixFQUUxQixHQUFJbEQsRUFBU0UsVUFBWSxFQUFHLENBQ3hCa0QsRUFBVSxxQ0FDUCxJQUFJcEQsRUFBU0UsVUFBWSxFQUFHLENBQy9Ca0QsRUFBVSxnQ0FDVkMsR0FBT00saUJBQW1CQyxlQUFlLHdCQUN0QyxDQUNIdEIsUUFBUUMsSUFBSSxrQkFDWlIsV0FBVUMsS0FBS0MsT0FBTyxhQUN0QixPQUFPLE9BRVgsR0FBSWpDLEVBQVNDLFlBQWEsQ0FDdEI4QixVQUFVQyxLQUFLQyxPQUFPLGNBQ3RCLE9BQU8sT0FFWGpDLEVBQVNDLFlBQWMsSUFDdkJOLEdBQUVvQixLQUFLcUMsR0FDSHBDLEtBQU0sT0FDTkMsU0FBVSxPQUNWZCxNQUNJa0QsT0FBUUEsR0FFWmxDLFFBQVMsU0FBVUMsR0FDZnBCLEVBQVNDLFlBQWMsS0FDdkIsSUFBSW1CLEVBQU9DLE1BQVEsRUFBRyxDQUNsQlUsVUFBVUMsS0FBSzZCLFFBQVE3RCxFQUFTRSxVQUFVLEVBQUUsT0FBTyxPQUNuRCxJQUFJRixFQUFTRSxVQUFZLEVBQUcsQ0FDeEIsR0FBSTRELEdBQWlCMUMsRUFBT2pCLEtBQUsyRCxjQUNqQ0MsZ0JBQWVDLFFBQVEscUJBQXNCRixFQUM3Q0MsZ0JBQWVDLFFBQVEsbUJBQW9CM0QsR0FFL0M0RCxXQUFXLFdBQ1AsR0FBSUMsR0FBWU4sZUFBZSxlQUFpQixDQUNoRGYsUUFBT3NCLFNBQVNDLEtBQU8scUNBQXVDRixHQUMvRCxTQUNBLENBQ0huQyxVQUFVQyxLQUFLQyxPQUFPYixFQUFPaUQsT0FHckNuQyxNQUFPLFNBQVVDLEVBQUtDLEVBQVFDLEdBQzFCckMsRUFBU0MsWUFBYyxLQUN2QnFDLFNBQVFDLElBQUlGLEVBQ1pHLE9BQU0sdUJBT3RCLFNBQVM1QixLQUNMLEdBQUkwRCxHQUFRM0UsRUFBRSxxQkFDVjRFLEVBQWU1RSxFQUFFc0QsS0FBS3FCLEVBQU03RCxNQUVoQyxJQUFJOEQsRUFBYTdELE9BQVMsR0FBSSxDQUcxQmYsRUFBRSxzQkFBc0I2RSxLQUFLQyxNQUFTLE9BQ3RDOUUsR0FBRSxxQkFBcUI2RSxLQUFLRSxlQUFnQixZQUN6QyxDQUNIL0UsRUFBRSxzQkFBc0I2RSxLQUFLQyxNQUFTLFdBQ3RDOUUsR0FBRSxxQkFBcUI2RSxLQUFLRSxlQUFnQixZQUVoRC9FLEVBQUUsMkJBQTJCYSxLQUFLK0QsRUFBYTdELFFBR25ELE1BQU9aIiwiZmlsZSI6Im1hbmFnZUV4ZXJjaXNlQm9vay5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBDcmVhdGVkIGJ5IEFkbWluaXN0cmF0b3Igb24gMjAxNy83LzMxLlxyXG4gKi9cclxuXHJcbiQoZG9jdW1lbnQpLnJlYWR5KGZ1bmN0aW9uICgpIHtcclxuICAgICRtYW5hZ2VFeGVyY2lzZS5pbml0KCk7XHJcbn0pO1xyXG5cclxuJG1hbmFnZUV4ZXJjaXNlID0gKGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciAkbWFuYWdlRXhlcmNpc2UgPSB7fTtcclxuICAgIHZhciAkcHJpdmF0ZSA9IHtcclxuICAgICAgICBzdWJtaXRMaW1pdDogZmFsc2UsXHJcbiAgICAgICAgcGFnZVR5cGU6ICQoXCIjYWRtaW5fZGF0YVwiKS5kYXRhKFwicGFnZV90eXBlXCIpLCAgICAgICAvLzAt5Yib5bu677ybMS3nvJbovpFcclxuICAgIH1cclxuXHJcbiAgICAkbWFuYWdlRXhlcmNpc2UuaW5pdCA9IGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICAgICAgLy/ngrnlh7vkvqfovrnmoI/nprvlvIDml7bnmoTlvLnmoYZcclxuICAgICAgICBjaGFuZ2VTYXZlRmxhZyh0cnVlKTtcclxuXHJcbiAgICAgICAgaWYgKCRwcml2YXRlLnBhZ2VUeXBlID09IDEpIHtcclxuICAgICAgICAgICAgJHByaXZhdGUucmVzVHlwZSA9ICQoXCIjYWRtaW5fZGF0YVwiKS5kYXRhKFwicmVzb3VyY2VfdHlwZVwiKTsgICAgLy/lt7LlhbPogZTor77nqIvnmoTnsbvlnotcclxuICAgICAgICAgICAgJHByaXZhdGUucmVzSWQgPSAkKFwiI2FkbWluX2RhdGFcIikuZGF0YShcInJlc291cmNlX2lkXCIpOyAgICAvL+W3suWFs+iBlOivvueoi+eahGlkXHJcbiAgICAgICAgICAgICRwcml2YXRlLnJlc05hbWUgPSAkKFwiI2FkbWluX2RhdGFcIikuZGF0YShcInJlc291cmNlX25hbWVcIik7ICAgIC8v5bey5YWz6IGU6K++56iL55qEaWRcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgICQoXCIuY2hhcmFjdGVyTnVtTGltaXQ+c3BhblwiKS50ZXh0KCQoXCIjZXhlcmNpc2VCb29rTmFtZVwiKS52YWwoKS5sZW5ndGgpO1xyXG5cclxuICAgICAgICAkKFwiI2V4ZXJjaXNlQm9va05hbWVcIikub24oXCJpbnB1dFwiLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGNoZWNrSW5wdXROYW1lKCk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIC8v5YWz6IGU6K++56iLXHJcbiAgICAgICAgJChcIiNyZXNUeXBlU2VsZWN0b3JcIikub24oXCJjaGFuZ2VcIiwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgcmVzVHlwZSA9ICQodGhpcykudmFsKCk7XHJcbiAgICAgICAgICAgIGlmIChyZXNUeXBlID09IC0xKSB7XHJcbiAgICAgICAgICAgICAgICAkKFwiI3Jlc0l0ZW1TZWxlY3RvclwiKS5odG1sKFxyXG4gICAgICAgICAgICAgICAgICAgICcgPG9wdGlvbiB2YWx1ZT1cIi0xXCI+6K+36YCJ5oup5YW35L2T6K++56iLPC9vcHRpb24+J1xyXG4gICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICQuYWpheChcIi9leGVyY2lzZS9nZXRfcmVzb3VyY2VfbGlzdFwiLCB7XHJcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJQT1NUXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YVR5cGU6IFwianNvblwiLFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb3VyY2VfdHlwZTogcmVzVHlwZVxyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24gKHJlc3VsdCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzdWx0LmNvZGUgPT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlc291cmNlTGlzdCA9IHJlc3VsdC5kYXRhLnJlc291cmNlX2xpc3QsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaHRtbFN0ciA9IFwiXCI7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCRwcml2YXRlLnBhZ2VUeXBlID09IDEgJiYgJHByaXZhdGUucmVzVHlwZSA9PSByZXNUeXBlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaHRtbFN0ciArPVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnPG9wdGlvbiB2YWx1ZT1cIicrJHByaXZhdGUucmVzSWQrJ1wiIHNlbGVjdGVkPicrJHByaXZhdGUucmVzTmFtZSsnPC9vcHRpb24+JztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICQuZWFjaChyZXNvdXJjZUxpc3QsIGZ1bmN0aW9uIChrLCB2KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlc05hbWUgPSAocmVzVHlwZT09NT92Lm5hbWU6di50aXRsZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaHRtbFN0ciArPVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnPG9wdGlvbiB2YWx1ZT1cIicrdi5pZCsnXCI+JytyZXNOYW1lKyc8L29wdGlvbj4nO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaHRtbFN0ci5sZW5ndGggPT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxTdHIgPVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnPG9wdGlvbiB2YWx1ZT1cIi0xXCI+5pqC5peg5pWw5o2uPC9vcHRpb24+JztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICQoXCIjcmVzSXRlbVNlbGVjdG9yXCIpLmh0bWwoaHRtbFN0cik7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYmFzZVV0aWxzLnNob3cucmVkVGlwKFwi572R57uc6Zeu6aKY77yM6K+356iN5ZCO5YaN6K+VXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogZnVuY3Rpb24gKHhociwgc3RhdHVzLCBlcnIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYWxlcnQoXCLmnI3liqHlmajlh7rlsI/lt67kuobvvIzor7fnqI3lkI7lho3or5XvvIFcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIC8vIHJhZGlvIOaMiemSrueCueWHu+WIh+aNouaViOaenFxyXG4gICAgICAgICQoJy5yZW1pbmRSYWRpbycpLm9uKCdjbGljaycsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAkKCcucmVtaW5kUmFkaW8nKS5jaGlsZHJlbignLmNpcmNsZVJhZGlvJykucmVtb3ZlQ2xhc3MoJ3JhZGlvQWN0aXZlJyk7XHJcbiAgICAgICAgICAgICQodGhpcykuY2hpbGRyZW4oJy5jaXJjbGVSYWRpbycpLmFkZENsYXNzKCdyYWRpb0FjdGl2ZScpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICAkKFwiI2NhbmNlbFNhdmVFeGVyY2lzZVwiKS5jbGljayhmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHdpbmRvdy5oaXN0b3J5LmJhY2soKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgJChcIiNjb25maXJtU2F2ZUV4ZXJjaXNlXCIpLmNsaWNrKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIGV4ZXJjaXNlQm9va05hbWUgPSAkLnRyaW0oJChcIiNleGVyY2lzZUJvb2tOYW1lXCIpLnZhbCgpKSxcclxuICAgICAgICAgICAgICAgIHJlc0lkID0gJChcIiNyZXNJdGVtU2VsZWN0b3JcIikudmFsKCksXHJcbiAgICAgICAgICAgICAgICByZXNUeXBlID0gJChcIiNyZXNUeXBlU2VsZWN0b3JcIikudmFsKCksXHJcbiAgICAgICAgICAgICAgICByZXNOYW1lID0gJChcIiNyZXNJdGVtU2VsZWN0b3IgPiBvcHRpb246c2VsZWN0ZWRcIikudGV4dCgpLFxyXG4gICAgICAgICAgICAgICAgY29tbXVuaXR5SWQgPSAkKFwiI2NvbW11bml0eVNlbGVjdG9yXCIpLnZhbCgpLFxyXG4gICAgICAgICAgICAgICAgaXNSZW1pbmQgPSAkKFwiLmNpcmNsZVJhZGlvLnJhZGlvQWN0aXZlXCIpLmRhdGEoXCJpc19yZW1pbmRcIiksIC8vIDEgLSDmj5DphpLvvIwgMCAtIOS4jeaPkOmGkjzpu5jorqTkuI3mj5DphpI+XHJcbiAgICAgICAgICAgICAgICBwb3N0VXJsID0gXCJcIjtcclxuXHJcbiAgICAgICAgICAgIGlzUmVtaW5kID0gMDsgICAvLyAgVE9ETyDmmoLml7blhYjorr7nva7kuLrkuI3mj5DphpJcclxuXHJcbiAgICAgICAgICAgIGlmIChleGVyY2lzZUJvb2tOYW1lLmxlbmd0aCA9PSAwKSB7XHJcbiAgICAgICAgICAgICAgICBiYXNlVXRpbHMuc2hvdy5yZWRUaXAoXCLov5jmsqHmnInovpPlhaXkvZzkuJrmnKzlkI3np7BcIik7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGV4ZXJjaXNlQm9va05hbWUubGVuZ3RoID4gMTQpIHtcclxuICAgICAgICAgICAgICAgIGJhc2VVdGlscy5zaG93LnJlZFRpcChcIuS9nOS4muacrOWQjeensOmVv+W6puS4jeiDvei2hei/hzE05a2XXCIpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChyZXNJZCA9PSAtMSkge1xyXG4gICAgICAgICAgICAgICAgYmFzZVV0aWxzLnNob3cucmVkVGlwKFwi6L+Y5rKh5pyJ6YCJ5oup5YW35L2T6K++56iLXCIpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB2YXIgcGFyYW1zID0ge1xyXG4gICAgICAgICAgICAgICAgdGl0bGU6IGV4ZXJjaXNlQm9va05hbWUsXHJcbiAgICAgICAgICAgICAgICByZXNvdXJjZV9pZDogcmVzSWQsXHJcbiAgICAgICAgICAgICAgICByZXNvdXJjZV90eXBlOiByZXNUeXBlLFxyXG4gICAgICAgICAgICAgICAgcmVzb3VyY2VfbmFtZTogcmVzTmFtZSxcclxuICAgICAgICAgICAgICAgIGlzX2VuYWJsZV9ub3RpZnk6IGlzUmVtaW5kXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGNvbW11bml0eUlkICE9IC0xICYmIGNvbW11bml0eUlkICE9IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgcGFyYW1zLmNvbW11bml0eV9pZCA9IGNvbW11bml0eUlkO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICgkcHJpdmF0ZS5wYWdlVHlwZSA9PSAwKSB7ICAgICAgICAgICAgLy/liJvlu7pcclxuICAgICAgICAgICAgICAgIHBvc3RVcmwgPSBcIi9leGVyY2lzZS91cGxvYWRfZXhlcmNpc2VfYm9va1wiO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKCRwcml2YXRlLnBhZ2VUeXBlID09IDEpIHsgICAgIC8v57yW6L6RXHJcbiAgICAgICAgICAgICAgICBwb3N0VXJsID0gXCIvZXhlcmNpc2UvdXBkYXRlX2V4ZXJjaXNlX2Jvb2tcIjtcclxuICAgICAgICAgICAgICAgIHBhcmFtcy5leGVyY2lzZV9ib29rX2lkID0gR2V0UXVlcnlTdHJpbmcoXCJleGVyY2lzZV9ib29rX2lkXCIpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCIgcGFnZVR5cGUg5Y+C5pWw5pyJ6K+v44CCXCIpO1xyXG4gICAgICAgICAgICAgICAgYmFzZVV0aWxzLnNob3cucmVkVGlwKFwi572R57uc6ZSZ6K+v77yM6K+356iN5ZCO5YaN6K+VXCIpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICgkcHJpdmF0ZS5zdWJtaXRMaW1pdCkge1xyXG4gICAgICAgICAgICAgICAgYmFzZVV0aWxzLnNob3cucmVkVGlwKFwi5q2j5Zyo5o+Q5Lqk5Lit77yM6K+356iN5ZCO5YaN6K+VXCIpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICRwcml2YXRlLnN1Ym1pdExpbWl0ID0gdHJ1ZTtcclxuICAgICAgICAgICAgJC5hamF4KHBvc3RVcmwsIHtcclxuICAgICAgICAgICAgICAgIHR5cGU6IFwiUE9TVFwiLFxyXG4gICAgICAgICAgICAgICAgZGF0YVR5cGU6IFwianNvblwiLFxyXG4gICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgIHBhcmFtczogcGFyYW1zXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24gKHJlc3VsdCkge1xyXG4gICAgICAgICAgICAgICAgICAgICRwcml2YXRlLnN1Ym1pdExpbWl0ID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3VsdC5jb2RlID09IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYmFzZVV0aWxzLnNob3cuYmx1ZVRpcCgkcHJpdmF0ZS5wYWdlVHlwZT09MD9cIuWIm+W7uuaIkOWKn1wiOlwi57yW6L6R5oiQ5YqfXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoJHByaXZhdGUucGFnZVR5cGUgPT0gMCkgeyAgIC8v5Yib5bu6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZXhlcmNpc2VCb29rSWQgPSByZXN1bHQuZGF0YS5leGVyY2lzZUJvb2tJZDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlc3Npb25TdG9yYWdlLnNldEl0ZW0oXCJsYXN0RXhlcmNpc2VCb29rSWRcIiwgZXhlcmNpc2VCb29rSWQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2Vzc2lvblN0b3JhZ2Uuc2V0SXRlbShcImxhc3RSZXNvdXJjZVR5cGVcIiwgcmVzVHlwZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcGFnZUluZGV4ID0gR2V0UXVlcnlTdHJpbmcoXCJwYWdlX2luZGV4XCIpIHx8IDE7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9IFwiL2V4ZXJjaXNlL2V4ZXJjaXNlX2Jvb2tfbGlzdD9wYWdlPVwiICsgcGFnZUluZGV4O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LCAxMDAwKTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBiYXNlVXRpbHMuc2hvdy5yZWRUaXAocmVzdWx0Lm1zZyk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIGVycm9yOiBmdW5jdGlvbiAoeGhyLCBzdGF0dXMsIGVycikge1xyXG4gICAgICAgICAgICAgICAgICAgICRwcml2YXRlLnN1Ym1pdExpbWl0ID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyKTtcclxuICAgICAgICAgICAgICAgICAgICBhbGVydChcIuacjeWKoeWZqOWHuuWwj+W3ruS6hu+8jOivt+eojeWQjuWGjeivle+8gVwiKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgIH07XHJcbiAgICBmdW5jdGlvbiBjaGVja0lucHV0TmFtZSgpIHtcclxuICAgICAgICB2YXIgJHNlbGYgPSAkKFwiI2V4ZXJjaXNlQm9va05hbWVcIiksXHJcbiAgICAgICAgICAgIGV4ZXJjaXNlTmFtZSA9ICQudHJpbSgkc2VsZi52YWwoKSk7XHJcblxyXG4gICAgICAgIGlmIChleGVyY2lzZU5hbWUubGVuZ3RoID4gMTQpIHtcclxuICAgICAgICAgICAgLy8gZXhlcmNpc2VOYW1lID0gZXhlcmNpc2VOYW1lLnN1YnN0cigwLCAxNCk7XHJcbiAgICAgICAgICAgIC8vICRzZWxmLnZhbChleGVyY2lzZU5hbWUpO1xyXG4gICAgICAgICAgICAkKFwiLmNoYXJhY3Rlck51bUxpbWl0XCIpLmNzcyh7XCJjb2xvclwiOiBcInJlZFwifSk7XHJcbiAgICAgICAgICAgICQoXCIjZXhlcmNpc2VCb29rTmFtZVwiKS5jc3Moe1wiYm9yZGVyLWNvbG9yXCI6IFwicmVkXCJ9KTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAkKFwiLmNoYXJhY3Rlck51bUxpbWl0XCIpLmNzcyh7XCJjb2xvclwiOiBcIiNiMmIyYjJcIn0pO1xyXG4gICAgICAgICAgICAkKFwiI2V4ZXJjaXNlQm9va05hbWVcIikuY3NzKHtcImJvcmRlci1jb2xvclwiOiBcIiNkY2RjZGNcIn0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICAkKFwiLmNoYXJhY3Rlck51bUxpbWl0PnNwYW5cIikudGV4dChleGVyY2lzZU5hbWUubGVuZ3RoKTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gJG1hbmFnZUV4ZXJjaXNlO1xyXG59KSgpO1xyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcbiJdfQ==
