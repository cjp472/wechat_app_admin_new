var width;var height;var params={};var category_type;var resource_type;var cos=new InitCosCloud;var maxlen=256;var cnmaxlen=Math.floor(maxlen/2);$(document).ready(function(){$("#maxletter").text(maxlen);$("#maxword").text(cnmaxlen);$("#letter").text(maxlen);$("#word").text(cnmaxlen);$("#resource_title").on("blur keyup",function(){setMsgDim(this)});$("#resource_summary").on("blur keyup",function(){setMsgDim(this)});$(".header_level.left").click(function(){window.location.href="/content_create"})});$(function(){$("#resource_summary").keyup(function(){var e=$(this).val().replace(/[^\x00-\xff]/g,"**").length;if(e>maxlen){$(this).val($(this).val().substring(0,maxlen))}var r=e>maxlen?0:maxlen-e;var t=Math.floor(r/2);$("#letter").text(r);$("#word").text(t)});inputLimitPrice("#resource_price");$(".pic_input").on("change",function(){var e=getObjectURL(this.files[0]);var r=this.files[0].size;if($(this).attr("id")=="resource_pic"&&r>4*1e3*1e3){baseUtils.show.redTip("图片太大!请不要超过4M!");return}try{var t,i;if(t=this.files[0]){i=new Image;i.onload=function(){width=this.width;height=this.height};i.src=e}}catch(e){}$(this).nextAll(".pic_add").addClass("hide");$(this).nextAll(".pic_close").removeClass("hide");$(this).nextAll(".pic_show").removeClass("hide");$(this).nextAll(".pic_show").attr("src",e);$(".pic_close").on("click",function(){$(this).addClass("hide");$(this).nextAll(".pic_show").addClass("hide");$(this).nextAll(".pic_add").removeClass("hide");$(this).prevAll(".pic_input").val("")})})});function getObjectURL(e){var r=null;if(window.createObjectURL!=undefined){r=window.createObjectURL(e)}else if(window.URL!=undefined){r=window.URL.createObjectURL(e)}else if(window.webkitURL!=undefined){r=window.webkitURL.createObjectURL(e)}return r}function uploadResource(e){this.resource_type=e;showLoading();if(!checkForm()){hideLoading();return}sliceUpload(".pic_input",get_cos_image_path(),pic_successCallBack,pic_errorCallBack)}function checkForm(){params={};var e=$("#resource_title").val().trim();if(e.length==0){baseUtils.show.redTip("名称不能为空!");setHighLightMsg("#resource_title");$("#resource_title").focus();return false}params["name"]=e;var r=$("#resource_summary").val().trim();if(r.length==0){baseUtils.show.redTip("简介不能为空!");setHighLightMsg("#resource_summary");$("#resource_summary").focus();return false}params["summary"]=r;var t=$(".pic_input").val();if(t.length==0){baseUtils.show.redTip("封面不能为空!");return false}var i=UE.getEditor("resource_desc");var a=i.getContent();params["org_content"]=a;var s=i.getPlainTxt();if(s.length==0){baseUtils.show.redTip("描述不能为空!");i.focus();return false}params["descrb"]=s;var o=$("#resource_period").find("option:selected").val().trim();params["period"]=o;var c=$("#resource_price").val().trim();if(c.length==0){c=0}else{c=c*100}params["price"]=c;category_type=new Array;var l=0;$(".checkBoxWrapper :checkbox:checked").each(function(){var e=$(this).attr("value");category_type[l++]=e});return true}function sliceUpload(e,r,t,i){var a=$(e).prop("files");if(a&&a.length==1){browserMD5File(a[0],function(e,s){console.log("MD5:"+s);var o=a[0]["name"];var c=o.split(".");var l=c[c.length-1];console.log("suffix:"+l);r=r+s+"."+l;console.log("remotePath:"+r);cos.uploadFileWithoutPro(t,i,r,a[0],0)})}else{baseUtils.show.redTip("请选择一个文件")}}var pic_successCallBack=function(e){console.log("图片上传成功!");var r=e.data.access_url;console.log("图片链接!"+r);params["img_url"]=r;params["img_url_compressed"]=r;var t={};t["resource_type"]=resource_type;t["params"]=params;t["category_type"]=category_type;$.post("/upload_package",t,function(e){hideLoading();var r=e.code;var t=e.msg;if(r==0){baseUtils.show.blueTip(t,function(){window.location.href="/package_list"})}else{baseUtils.show.redTip(t)}})};var pic_errorCallBack=function(e){hideLoading();baseUtils.show.redTip("配图上传失败!请重新上传!");uploadErrorShow(e.responseText)};
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFkbWluL2NyZWF0ZVBhY2thZ2UuanMiXSwibmFtZXMiOlsid2lkdGgiLCJoZWlnaHQiLCJwYXJhbXMiLCJjYXRlZ29yeV90eXBlIiwicmVzb3VyY2VfdHlwZSIsImNvcyIsIkluaXRDb3NDbG91ZCIsIm1heGxlbiIsImNubWF4bGVuIiwiTWF0aCIsImZsb29yIiwiJCIsImRvY3VtZW50IiwicmVhZHkiLCJ0ZXh0Iiwib24iLCJzZXRNc2dEaW0iLCJ0aGlzIiwiY2xpY2siLCJ3aW5kb3ciLCJsb2NhdGlvbiIsImhyZWYiLCJrZXl1cCIsImxlbiIsInZhbCIsInJlcGxhY2UiLCJsZW5ndGgiLCJzdWJzdHJpbmciLCJFbm51bSIsIkNubnVtIiwiaW5wdXRMaW1pdFByaWNlIiwic3JjcyIsImdldE9iamVjdFVSTCIsImZpbGVzIiwiZmlsZVNpemUiLCJzaXplIiwiYXR0ciIsImJhc2VVdGlscyIsInNob3ciLCJyZWRUaXAiLCJmaWxlIiwiaW1nIiwiSW1hZ2UiLCJvbmxvYWQiLCJzcmMiLCJlIiwibmV4dEFsbCIsImFkZENsYXNzIiwicmVtb3ZlQ2xhc3MiLCJwcmV2QWxsIiwidXJsIiwiY3JlYXRlT2JqZWN0VVJMIiwidW5kZWZpbmVkIiwiVVJMIiwid2Via2l0VVJMIiwidXBsb2FkUmVzb3VyY2UiLCJzaG93TG9hZGluZyIsImNoZWNrRm9ybSIsImhpZGVMb2FkaW5nIiwic2xpY2VVcGxvYWQiLCJnZXRfY29zX2ltYWdlX3BhdGgiLCJwaWNfc3VjY2Vzc0NhbGxCYWNrIiwicGljX2Vycm9yQ2FsbEJhY2siLCJyZXNvdXJjZV90aXRsZSIsInRyaW0iLCJzZXRIaWdoTGlnaHRNc2ciLCJmb2N1cyIsInJlc291cmNlX3N1bW1hcnkiLCJwaWNfaW5wdXQiLCJ1ZSIsIlVFIiwiZ2V0RWRpdG9yIiwiaHRtbCIsImdldENvbnRlbnQiLCJyZXNvdXJjZV9kZXNjIiwiZ2V0UGxhaW5UeHQiLCJyZXNvdXJjZV9wZXJpb2QiLCJmaW5kIiwicmVzb3VyY2VfcHJpY2UiLCJBcnJheSIsImkiLCJlYWNoIiwidmFsdWUiLCJpZGVudGl0eSIsInJlbW90ZVBhdGgiLCJzdWNjZXNzQ2FsbEJhY2siLCJlcnJvckNhbGxCYWNrIiwicHJvcCIsImJyb3dzZXJNRDVGaWxlIiwiZXJyIiwibWQ1IiwiY29uc29sZSIsImxvZyIsImZpbGVfbmFtZSIsIm5hbWVzIiwic3BsaXQiLCJzdWZmaXgiLCJ1cGxvYWRGaWxlV2l0aG91dFBybyIsInJlc3VsdCIsInBpY191cmwiLCJkYXRhIiwiYWNjZXNzX3VybCIsImFsbFBhcmFtcyIsInBvc3QiLCJjb2RlIiwibXNnIiwiYmx1ZVRpcCIsInVwbG9hZEVycm9yU2hvdyIsInJlc3BvbnNlVGV4dCJdLCJtYXBwaW5ncyI6IkFBQUEsR0FBSUEsTUFDSixJQUFJQyxPQUVKLElBQUlDLFVBRUosSUFBSUMsY0FFSixJQUFJQyxjQUlKLElBQUlDLEtBQU0sR0FBSUMsYUFHZCxJQUFJQyxRQUFTLEdBQ2IsSUFBSUMsVUFBV0MsS0FBS0MsTUFBTUgsT0FBUyxFQUVuQ0ksR0FBRUMsVUFBVUMsTUFBTSxXQUVkRixFQUFFLGNBQWNHLEtBQUtQLE9BQ3JCSSxHQUFFLFlBQVlHLEtBQUtOLFNBQ25CRyxHQUFFLFdBQVdHLEtBQUtQLE9BQ2xCSSxHQUFFLFNBQVNHLEtBQUtOLFNBR2hCRyxHQUFFLG1CQUFtQkksR0FBRyxhQUFjLFdBQ2xDQyxVQUFVQyxPQUdkTixHQUFFLHFCQUFxQkksR0FBRyxhQUFjLFdBQ3BDQyxVQUFVQyxPQUlkTixHQUFFLHNCQUFzQk8sTUFBTSxXQUMxQkMsT0FBT0MsU0FBU0MsS0FBSyxxQkFNN0JWLEdBQUUsV0FDRUEsRUFBRSxxQkFBcUJXLE1BQU0sV0FDekIsR0FBSUMsR0FBTVosRUFBRU0sTUFBTU8sTUFBTUMsUUFBUSxnQkFBZ0IsTUFBTUMsTUFDdEQsSUFBR0gsRUFBTWhCLE9BQU8sQ0FDWkksRUFBRU0sTUFBTU8sSUFBSWIsRUFBRU0sTUFBTU8sTUFBTUcsVUFBVSxFQUFFcEIsU0FFMUMsR0FBSXFCLEdBQVFMLEVBQU1oQixPQUFR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LEdBQVUsaUJBQW1CbEcsYUFDN0JrRyxHQUFVLFVBQVlwRyxNQUN0Qm9HLEdBQVUsaUJBQW1CbkcsYUFHN0JRLEdBQUU0RixLQUFLLGtCQUFtQkQsRUFBVyxTQUFVSixHQUMzQ3hDLGFBQ0EsSUFBSThDLEdBQU9OLEVBQU9NLElBQ2xCLElBQUlDLEdBQU1QLEVBQU9PLEdBQ2pCLElBQUlELEdBQVEsRUFBRyxDQUNYbkUsVUFBVUMsS0FBS29FLFFBQVFELEVBQUssV0FDeEJ0RixPQUFPQyxTQUFTQyxLQUFLLHNCQUV0QixDQUNIZ0IsVUFBVUMsS0FBS0MsT0FBT2tFLE1BT2xDLElBQUkzQyxtQkFBb0IsU0FBVW9DLEdBRTlCeEMsYUFDQXJCLFdBQVVDLEtBQUtDLE9BQU8sZ0JBQ3RCb0UsaUJBQWdCVCxFQUFPVSIsImZpbGUiOiJhZG1pbi9jcmVhdGVQYWNrYWdlLmpzIiwic291cmNlc0NvbnRlbnQiOlsidmFyIHdpZHRoO1xyXG52YXIgaGVpZ2h0O1xyXG5cclxudmFyIHBhcmFtcyA9IHt9O1xyXG5cclxudmFyIGNhdGVnb3J5X3R5cGU7XHJcblxyXG52YXIgcmVzb3VyY2VfdHlwZTtcclxuLy/ohb7orq/kupHotYTmupBcclxuLy92YXIgYnVja2V0TmFtZSA9IHdpbmRvdy5jb3NfYnVja2V0X25hbWU7XHJcbi8vdmFyIGNvcyA9IG5ldyBDb3NDbG91ZCh3aW5kb3cuY29zX2FwcF9pZCk7XHJcbnZhciBjb3MgPSBuZXcgSW5pdENvc0Nsb3VkKCk7XHJcblxyXG4vL+i+k+WFpeWtl+espumZkOWItlxyXG52YXIgbWF4bGVuID0gMjU2O1xyXG52YXIgY25tYXhsZW4gPSBNYXRoLmZsb29yKG1heGxlbiAvIDIpO1xyXG5cclxuJChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24gKCkge1xyXG5cclxuICAgICQoXCIjbWF4bGV0dGVyXCIpLnRleHQobWF4bGVuKTtcclxuICAgICQoXCIjbWF4d29yZFwiKS50ZXh0KGNubWF4bGVuKTtcclxuICAgICQoXCIjbGV0dGVyXCIpLnRleHQobWF4bGVuKTtcclxuICAgICQoXCIjd29yZFwiKS50ZXh0KGNubWF4bGVuKTtcclxuXHJcblxyXG4gICAgJChcIiNyZXNvdXJjZV90aXRsZVwiKS5vbihcImJsdXIga2V5dXBcIiwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHNldE1zZ0RpbSh0aGlzKTtcclxuICAgIH0pO1xyXG5cclxuICAgICQoXCIjcmVzb3VyY2Vfc3VtbWFyeVwiKS5vbihcImJsdXIga2V5dXBcIiwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHNldE1zZ0RpbSh0aGlzKTtcclxuICAgIH0pO1xyXG5cclxuICAgIC8vICDlm57kuJPmoI/liJfooajpobXpnaJcclxuICAgICQoXCIuaGVhZGVyX2xldmVsLmxlZnRcIikuY2xpY2soZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmPVwiL2NvbnRlbnRfY3JlYXRlXCI7XHJcbiAgICB9KTtcclxuXHJcbn0pO1xyXG5cclxuXHJcbiQoZnVuY3Rpb24gKCkge1xyXG4gICAgJChcIiNyZXNvdXJjZV9zdW1tYXJ5XCIpLmtleXVwKGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgdmFyIGxlbiA9ICQodGhpcykudmFsKCkucmVwbGFjZSgvW15cXHgwMC1cXHhmZl0vZyxcIioqXCIpLmxlbmd0aDtcclxuICAgICAgICBpZihsZW4gPiBtYXhsZW4pe1xyXG4gICAgICAgICAgICAkKHRoaXMpLnZhbCgkKHRoaXMpLnZhbCgpLnN1YnN0cmluZygwLG1heGxlbikpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgRW5udW0gPSBsZW4gPiBtYXhsZW4/IDAgOiBtYXhsZW4gLSBsZW47XHJcbiAgICAgICAgdmFyIENubnVtID0gTWF0aC5mbG9vcihFbm51bSAvIDIpO1xyXG4gICAgICAgICQoXCIjbGV0dGVyXCIpLnRleHQoRW5udW0pOyQoXCIjd29yZFwiKS50ZXh0KENubnVtKTtcclxuICAgIH0pO1xyXG5cclxuICAgIC8v6YeR6aKd6L6T5YWl6ZmQ5Yi2XHJcbiAgICBpbnB1dExpbWl0UHJpY2UoXCIjcmVzb3VyY2VfcHJpY2VcIik7XHJcblxyXG4gICAgJChcIi5waWNfaW5wdXRcIikub24oXCJjaGFuZ2VcIiwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBzcmNzID0gZ2V0T2JqZWN0VVJMKHRoaXMuZmlsZXNbMF0pOyAgIC8v6I635Y+W6Lev5b6EXHJcbiAgICAgICAgdmFyIGZpbGVTaXplID0gdGhpcy5maWxlc1swXS5zaXplO1xyXG5cclxuICAgICAgICAvL+WIpOaWreWbvueJh+Wkp+Wwj1xyXG4gICAgICAgIGlmKCQodGhpcykuYXR0cihcImlkXCIpPT0ncmVzb3VyY2VfcGljJyYmZmlsZVNpemU+NCoxMDAwKjEwMDApe1xyXG4gICAgICAgICAgICBiYXNlVXRpbHMuc2hvdy5yZWRUaXAoJ+WbvueJh+WkquWkpyHor7fkuI3opoHotoXov4c0TSEnKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgLy/ojrflj5blm77niYfnmoTlrr3pq5hcclxuICAgICAgICAgICAgdmFyIGZpbGUsIGltZztcclxuICAgICAgICAgICAgaWYgKChmaWxlID0gdGhpcy5maWxlc1swXSkpIHtcclxuICAgICAgICAgICAgICAgIGltZyA9IG5ldyBJbWFnZSgpO1xyXG4gICAgICAgICAgICAgICAgaW1nLm9ubG9hZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICB3aWR0aCA9IHRoaXMud2lkdGg7XHJcbiAgICAgICAgICAgICAgICAgICAgaGVpZ2h0ID0gdGhpcy5oZWlnaHQ7XHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgaW1nLnNyYyA9IHNyY3M7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGNhdGNoIChlKSB7XHJcblxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgJCh0aGlzKS5uZXh0QWxsKFwiLnBpY19hZGRcIikuYWRkQ2xhc3MoJ2hpZGUnKTsgICAvL3RoaXPmjIfnmoTmmK9pbnB1dFxyXG4gICAgICAgICQodGhpcykubmV4dEFsbCgnLnBpY19jbG9zZScpLnJlbW92ZUNsYXNzKCdoaWRlJyk7ICAgLy90aGlz5oyH55qE5pivaW5wdXRcclxuICAgICAgICAkKHRoaXMpLm5leHRBbGwoXCIucGljX3Nob3dcIikucmVtb3ZlQ2xhc3MoJ2hpZGUnKTtcclxuICAgICAgICAkKHRoaXMpLm5leHRBbGwoXCIucGljX3Nob3dcIikuYXR0cihcInNyY1wiLCBzcmNzKTsgICAgLy90aGlz5oyH55qE5pivaW5wdXRcclxuICAgICAgICAkKFwiLnBpY19jbG9zZVwiKS5vbihcImNsaWNrXCIsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgJCh0aGlzKS5hZGRDbGFzcygnaGlkZScpOyAgICAgLy90aGlz5oyH55qE5pivc3BhblxyXG4gICAgICAgICAgICAkKHRoaXMpLm5leHRBbGwoXCIucGljX3Nob3dcIikuYWRkQ2xhc3MoJ2hpZGUnKTtcclxuICAgICAgICAgICAgJCh0aGlzKS5uZXh0QWxsKFwiLnBpY19hZGRcIikucmVtb3ZlQ2xhc3MoJ2hpZGUnKTtcclxuICAgICAgICAgICAgJCh0aGlzKS5wcmV2QWxsKCcucGljX2lucHV0JykudmFsKCcnKTtcclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG59KVxyXG5cclxuZnVuY3Rpb24gZ2V0T2JqZWN0VVJMKGZpbGUpIHtcclxuICAgIHZhciB1cmwgPSBudWxsO1xyXG4gICAgaWYgKHdpbmRvdy5jcmVhdGVPYmplY3RVUkwgIT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgdXJsID0gd2luZG93LmNyZWF0ZU9iamVjdFVSTChmaWxlKVxyXG4gICAgfSBlbHNlIGlmICh3aW5kb3cuVVJMICE9IHVuZGVmaW5lZCkge1xyXG4gICAgICAgIHVybCA9IHdpbmRvdy5VUkwuY3JlYXRlT2JqZWN0VVJMKGZpbGUpXHJcbiAgICB9IGVsc2UgaWYgKHdpbmRvdy53ZWJraXRVUkwgIT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgdXJsID0gd2luZG93LndlYmtpdFVSTC5jcmVhdGVPYmplY3RVUkwoZmlsZSlcclxuICAgIH1cclxuICAgIHJldHVybiB1cmxcclxufVxyXG5cclxuXHJcbmZ1bmN0aW9uIHVwbG9hZFJlc291cmNlKHJlc291cmNlX3R5cGUpIHtcclxuXHJcbiAgICB0aGlzLnJlc291cmNlX3R5cGUgPSByZXNvdXJjZV90eXBlO1xyXG4gICAgc2hvd0xvYWRpbmcoKTtcclxuICAgIGlmICghY2hlY2tGb3JtKCkpIHtcclxuICAgICAgICBoaWRlTG9hZGluZygpO1xyXG4gICAgICAgIHJldHVybjtcclxuICAgIH1cclxuXHJcbiAgICAvL+aOpeedgOS4iuS8oOWbvueJh1xyXG4gICAgc2xpY2VVcGxvYWQoJy5waWNfaW5wdXQnLCBnZXRfY29zX2ltYWdlX3BhdGgoKSwgcGljX3N1Y2Nlc3NDYWxsQmFjaywgcGljX2Vycm9yQ2FsbEJhY2spO1xyXG5cclxuXHJcbn1cclxuXHJcbi8v5qC45a+56KGo5Y2VXHJcbmZ1bmN0aW9uIGNoZWNrRm9ybSgpIHtcclxuXHJcbiAgICBwYXJhbXMgPSB7fTsgLy/muIXnqbrkuYvliY3nmoTmlbDmja5cclxuICAgIC8v6LWE5rqQ5ZCN56ewXHJcbiAgICB2YXIgcmVzb3VyY2VfdGl0bGUgPSAkKCcjcmVzb3VyY2VfdGl0bGUnKS52YWwoKS50cmltKCk7XHJcbiAgICBpZiAocmVzb3VyY2VfdGl0bGUubGVuZ3RoID09IDApIHtcclxuICAgICAgICBiYXNlVXRpbHMuc2hvdy5yZWRUaXAoJ+WQjeensOS4jeiDveS4uuepuiEnKTtcclxuICAgICAgICBzZXRIaWdoTGlnaHRNc2coJyNyZXNvdXJjZV90aXRsZScpO1xyXG4gICAgICAgICQoJyNyZXNvdXJjZV90aXRsZScpLmZvY3VzKCk7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG4gICAgcGFyYW1zWyduYW1lJ10gPSByZXNvdXJjZV90aXRsZTtcclxuXHJcblxyXG4gICAgLy8g6LWE5rqQ566A5LuLXHJcbiAgICB2YXIgcmVzb3VyY2Vfc3VtbWFyeSA9ICQoJyNyZXNvdXJjZV9zdW1tYXJ5JykudmFsKCkudHJpbSgpO1xyXG4gICAgaWYgKHJlc291cmNlX3N1bW1hcnkubGVuZ3RoID09IDApIHtcclxuICAgICAgICBiYXNlVXRpbHMuc2hvdy5yZWRUaXAoJ+eugOS7i+S4jeiDveS4uuepuiEnKTtcclxuICAgICAgICBzZXRIaWdoTGlnaHRNc2coJyNyZXNvdXJjZV9zdW1tYXJ5Jyk7XHJcbiAgICAgICAgJCgnI3Jlc291cmNlX3N1bW1hcnknKS5mb2N1cygpO1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuICAgIHBhcmFtc1snc3VtbWFyeSddID0gcmVzb3VyY2Vfc3VtbWFyeTtcclxuXHJcblxyXG4gICAgLy/otYTmupDlsIHpnaJcclxuICAgIHZhciBwaWNfaW5wdXQgPSAkKCcucGljX2lucHV0JykudmFsKCk7XHJcbiAgICBpZiAocGljX2lucHV0Lmxlbmd0aCA9PSAwKSB7XHJcbiAgICAgICAgYmFzZVV0aWxzLnNob3cucmVkVGlwKCflsIHpnaLkuI3og73kuLrnqbohJyk7XHJcbiAgICAgICAgLy9zZXRIaWdoTGlnaHRNc2coJy5waWNfZGl2Jyk7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG5cclxuXHJcbiAgICB2YXIgdWUgPSBVRS5nZXRFZGl0b3IoJ3Jlc291cmNlX2Rlc2MnKTtcclxuXHJcbiAgICB2YXIgaHRtbD11ZS5nZXRDb250ZW50KCk7XHJcbiAgICBwYXJhbXNbJ29yZ19jb250ZW50J10gPSBodG1sO1xyXG5cclxuICAgIC8v6LWE5rqQ5o+P6L+wXHJcbiAgICB2YXIgcmVzb3VyY2VfZGVzYyA9IHVlLmdldFBsYWluVHh0KCk7XHJcbiAgICBpZiAocmVzb3VyY2VfZGVzYy5sZW5ndGggPT0gMCkge1xyXG4gICAgICAgIGJhc2VVdGlscy5zaG93LnJlZFRpcCgn5o+P6L+w5LiN6IO95Li656m6IScpO1xyXG4gICAgICAgIHVlLmZvY3VzKCk7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG4gICAgcGFyYW1zWydkZXNjcmInXSA9IHJlc291cmNlX2Rlc2M7XHJcblxyXG5cclxuICAgIC8v5pyJ5pWI5pe26Ze0XHJcbiAgICB2YXIgcmVzb3VyY2VfcGVyaW9kID0gJCgnI3Jlc291cmNlX3BlcmlvZCcpLmZpbmQoJ29wdGlvbjpzZWxlY3RlZCcpLnZhbCgpLnRyaW0oKTtcclxuICAgIC8qaWYgKHJlc291cmNlX3BlcmlvZC5sZW5ndGggPT0gMCkge1xyXG4gICAgICAgIGJhc2VVdGlscy5zaG93LnJlZFRpcCgn6K+36YCJ5oup5pyJ5pWI5pe26Ze0IScpO1xyXG4gICAgICAgIHNldEhpZ2hMaWdodE1zZygnI3Jlc291cmNlX3BlcmlvZCcpO1xyXG4gICAgICAgICQoJyNyZXNvdXJjZV9wZXJpb2QnKS5mb2N1cygpO1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH0qL1xyXG4gICAgcGFyYW1zWydwZXJpb2QnXSA9IHJlc291cmNlX3BlcmlvZDtcclxuXHJcbiAgICAvL+S7t+agvFxyXG4gICAgdmFyIHJlc291cmNlX3ByaWNlID0gJCgnI3Jlc291cmNlX3ByaWNlJykudmFsKCkudHJpbSgpO1xyXG4gICAgaWYgKHJlc291cmNlX3ByaWNlLmxlbmd0aCA9PSAwKSB7XHJcbiAgICAgICAgcmVzb3VyY2VfcHJpY2UgPSAwO1xyXG4gICAgfWVsc2V7XHJcbiAgICAgICAgcmVzb3VyY2VfcHJpY2UgPSByZXNvdXJjZV9wcmljZSoxMDA7XHJcbiAgICB9XHJcblxyXG4gICAgcGFyYW1zWydwcmljZSddID0gcmVzb3VyY2VfcHJpY2U7XHJcblxyXG4gICAgLyrliIbnsbvlr7zoiKogLSAqL1xyXG4gICAgY2F0ZWdvcnlfdHlwZSA9IG5ldyBBcnJheSgpO1xyXG4gICAgdmFyIGkgPSAwO1xyXG4gICAgJChcIi5jaGVja0JveFdyYXBwZXIgOmNoZWNrYm94OmNoZWNrZWRcIikuZWFjaChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIHZhbHVlID0gJCh0aGlzKS5hdHRyKFwidmFsdWVcIik7XHJcbiAgICAgICAgY2F0ZWdvcnlfdHlwZVtpKytdID0gdmFsdWU7XHJcbiAgICB9KTtcclxuXHJcbiAgICByZXR1cm4gdHJ1ZTtcclxuXHJcbn1cclxuXHJcblxyXG5mdW5jdGlvbiBzbGljZVVwbG9hZChpZGVudGl0eSwgcmVtb3RlUGF0aCwgc3VjY2Vzc0NhbGxCYWNrLCBlcnJvckNhbGxCYWNrKSB7XHJcblxyXG4gICAgLy8gLy/kuIrkvKAo55u05o6l6YCa6L+HanPkuIrkvKBjZG4pXHJcbiAgICAvLyB2YXIgZmlsZXMgPSAkKGlkZW50aXR5KS5wcm9wKCdmaWxlcycpO1xyXG4gICAgLy8gaWYgKGZpbGVzICYmIGZpbGVzLmxlbmd0aCA9PSAxKSB7XHJcbiAgICAvL1xyXG4gICAgLy8gICAgIC8v6I635Y+W5paH5Lu255qETUQ15YC8XHJcbiAgICAvLyAgICAgYnJvd3Nlck1ENUZpbGUoZmlsZXNbMF0sIGZ1bmN0aW9uIChlcnIsIG1kNSkge1xyXG4gICAgLy8gICAgICAgICAvL+iOt+WPluaWh+S7tuWGheWuueeahE1ENVxyXG4gICAgLy8gICAgICAgICBjb25zb2xlLmxvZygnTUQ1OicgKyBtZDUpO1xyXG4gICAgLy8gICAgICAgICAvL+WPluaWh+S7tuWQjeWQjue8gFxyXG4gICAgLy8gICAgICAgICB2YXIgZmlsZV9uYW1lID0gZmlsZXNbMF1bJ25hbWUnXTtcclxuICAgIC8vICAgICAgICAgdmFyIG5hbWVzID0gZmlsZV9uYW1lLnNwbGl0KCcuJyk7XHJcbiAgICAvLyAgICAgICAgIHZhciBzdWZmaXggPSBuYW1lc1tuYW1lcy5sZW5ndGggLSAxXTtcclxuICAgIC8vICAgICAgICAgY29uc29sZS5sb2coJ3N1ZmZpeDonICsgc3VmZml4KTtcclxuICAgIC8vICAgICAgICAgcmVtb3RlUGF0aCA9IHJlbW90ZVBhdGggKyBtZDUgKyBcIi5cIiArIHN1ZmZpeDtcclxuICAgIC8vICAgICAgICAgY29uc29sZS5sb2coJ3JlbW90ZVBhdGg6JyArIHJlbW90ZVBhdGgpO1xyXG4gICAgLy8gICAgICAgICBjb3MudXBsb2FkRmlsZShzdWNjZXNzQ2FsbEJhY2ssIGVycm9yQ2FsbEJhY2ssIGJ1Y2tldE5hbWUsIHJlbW90ZVBhdGgsIGZpbGVzWzBdLCAwKTtcclxuICAgIC8vICAgICB9KTtcclxuICAgIC8vXHJcbiAgICAvLyB9XHJcbiAgICAvLyBlbHNlIHtcclxuICAgIC8vICAgICBhbGVydChcIuivt+mAieaLqeS4gOS4quaWh+S7tlwiKTtcclxuICAgIC8vIH1cclxuXHJcbiAgICAvL+S4iuS8oCjnm7TmjqXpgJrov4dqc+S4iuS8oGNkbilcclxuICAgIHZhciBmaWxlcyA9ICQoaWRlbnRpdHkpLnByb3AoJ2ZpbGVzJyk7XHJcbiAgICBpZiAoZmlsZXMgJiYgZmlsZXMubGVuZ3RoID09IDEpIHtcclxuICAgICAgICAvL2lmICghY29zLmhhc0ZsYXNoVmVyc2lvbk9yQmV0dGVyKDIwLCAwKSkge1xyXG4gICAgICAgIC8vICAgIGhpZGVMb2FkaW5nKCk7XHJcbiAgICAgICAgLy8gICAgaWYgKGNvbmZpcm0oXCLlvZPliY3mtY/op4jlmajkuI3mlK/mjIFGbGFzaO+8jOaXoOazleS4iuS8oOaWh+S7tu+8jOimgeS4i+i9vWZsYXNo5ZCXP1wiKSkge1xyXG4gICAgICAgIC8vICAgICAgICB3aW5kb3cub3BlbihcImh0dHBzOi8vZ2V0LmFkb2JlLmNvbS9jbi9mbGFzaHBsYXllci9cIiwgXCJfYmxhbmtcIik7XHJcbiAgICAgICAgLy8gICAgICAgIHJldHVybjtcclxuICAgICAgICAvLyAgICB9XHJcbiAgICAgICAgLy8gICAgcmV0dXJuO1xyXG4gICAgICAgIC8vfVxyXG4gICAgICAgIC8vaWYgKCEkKCcjcXMnKS5sZW5ndGgpIHtcclxuICAgICAgICAvLyAgICAkKCdib2R5JykuYXBwZW5kKCc8b2JqZWN0IGlkPVwicXNcIiB3aWR0aD1cIjBcIiBoZWlnaHQ9XCIwXCIgdHlwZT1cImFwcGxpY2F0aW9uL3gtc2hvY2t3YXZlLWZsYXNoXCIgZGF0YT1cInNkay9Tb21ldGhpbmd0ZXN0LnN3ZlwiIHN0eWxlPVwidmlzaWJpbGl0eTogdmlzaWJsZTtcIj48L29iamVjdD4nKTtcclxuICAgICAgICAvL31cclxuXHJcbiAgICAgICAgLy/ojrflj5bmlofku7bnmoRNRDXlgLxcclxuICAgICAgICBicm93c2VyTUQ1RmlsZShmaWxlc1swXSwgZnVuY3Rpb24gKGVyciwgbWQ1KSB7XHJcbiAgICAgICAgICAgIC8v6I635Y+W5paH5Lu25YaF5a6555qETUQ1XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdNRDU6JyArIG1kNSk7XHJcbiAgICAgICAgICAgIC8v5Y+W5paH5Lu25ZCN5ZCO57yAXHJcbiAgICAgICAgICAgIHZhciBmaWxlX25hbWUgPSBmaWxlc1swXVsnbmFtZSddO1xyXG4gICAgICAgICAgICB2YXIgbmFtZXMgPSBmaWxlX25hbWUuc3BsaXQoJy4nKTtcclxuICAgICAgICAgICAgdmFyIHN1ZmZpeCA9IG5hbWVzW25hbWVzLmxlbmd0aCAtIDFdO1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZygnc3VmZml4OicgKyBzdWZmaXgpO1xyXG4gICAgICAgICAgICByZW1vdGVQYXRoID0gcmVtb3RlUGF0aCArIG1kNSArIFwiLlwiICsgc3VmZml4O1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZygncmVtb3RlUGF0aDonICsgcmVtb3RlUGF0aCk7XHJcbiAgICAgICAgICAgIGNvcy51cGxvYWRGaWxlV2l0aG91dFBybyhzdWNjZXNzQ2FsbEJhY2ssIGVycm9yQ2FsbEJhY2ssIHJlbW90ZVBhdGgsIGZpbGVzWzBdLCAwKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICB9ZWxzZSB7XHJcbiAgICAgICAgICAgIGJhc2VVdGlscy5zaG93LnJlZFRpcChcIuivt+mAieaLqeS4gOS4quaWh+S7tlwiKTtcclxuICAgICAgICB9XHJcblxyXG59XHJcblxyXG5cclxuLy/phY3lm77miJDlip/kuIrkvKDlm57osINcclxudmFyIHBpY19zdWNjZXNzQ2FsbEJhY2sgPSBmdW5jdGlvbiAocmVzdWx0KSB7XHJcblxyXG4gICAgLy92YXIganNvblJlc3VsdCA9ICQucGFyc2VKU09OKHJlc3VsdCk7XHJcbiAgICBjb25zb2xlLmxvZygn5Zu+54mH5LiK5Lyg5oiQ5YqfIScpO1xyXG5cclxuICAgIC8v6I635Y+W5Yiw6LWE5rqQY2Ru6K6/6Zeu6L+e5o6lXHJcbiAgICB2YXIgcGljX3VybCA9IHJlc3VsdC5kYXRhLmFjY2Vzc191cmw7XHJcbiAgICBjb25zb2xlLmxvZygn5Zu+54mH6ZO+5o6lIScgKyBwaWNfdXJsKTtcclxuXHJcbiAgICBwYXJhbXNbJ2ltZ191cmwnXSA9IHBpY191cmw7XHJcbiAgICBwYXJhbXNbJ2ltZ191cmxfY29tcHJlc3NlZCddID0gcGljX3VybDtcclxuXHJcbiAgICB2YXIgYWxsUGFyYW1zID0ge307XHJcbiAgICBhbGxQYXJhbXNbJ3Jlc291cmNlX3R5cGUnXSA9IHJlc291cmNlX3R5cGU7XHJcbiAgICBhbGxQYXJhbXNbJ3BhcmFtcyddID0gcGFyYW1zO1xyXG4gICAgYWxsUGFyYW1zWydjYXRlZ29yeV90eXBlJ10gPSBjYXRlZ29yeV90eXBlO1xyXG5cclxuICAgIC8v5LiK5Lyg6Iez5pyN5Yqh5ZmoXHJcbiAgICAkLnBvc3QoJy91cGxvYWRfcGFja2FnZScsIGFsbFBhcmFtcywgZnVuY3Rpb24gKHJlc3VsdCkge1xyXG4gICAgICAgIGhpZGVMb2FkaW5nKCk7XHJcbiAgICAgICAgdmFyIGNvZGUgPSByZXN1bHQuY29kZTtcclxuICAgICAgICB2YXIgbXNnID0gcmVzdWx0Lm1zZztcclxuICAgICAgICBpZiAoY29kZSA9PSAwKSB7XHJcbiAgICAgICAgICAgIGJhc2VVdGlscy5zaG93LmJsdWVUaXAobXNnLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmPScvcGFja2FnZV9saXN0JztcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgYmFzZVV0aWxzLnNob3cucmVkVGlwKG1zZyk7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG59O1xyXG5cclxuLy/otYTmupDphY3lm77lpLHotKXkuIrkvKDlm57osINcclxudmFyIHBpY19lcnJvckNhbGxCYWNrID0gZnVuY3Rpb24gKHJlc3VsdCkge1xyXG4gICAgLy92YXIganNvblJlc3VsdCA9ICQucGFyc2VKU09OKHJlc3VsdCk7XHJcbiAgICBoaWRlTG9hZGluZygpO1xyXG4gICAgYmFzZVV0aWxzLnNob3cucmVkVGlwKCfphY3lm77kuIrkvKDlpLHotKUh6K+36YeN5paw5LiK5LygIScpO1xyXG4gICAgdXBsb2FkRXJyb3JTaG93KHJlc3VsdC5yZXNwb25zZVRleHQpO1xyXG59XHJcblxyXG5cclxuXHJcbiJdfQ==
