$(document).ready(function(){Business.init()});var Business=function(){var e={};var i=false;e.submitLimit=false;e.communityId=-1;e.type=-1;e.dynamicId=-1;e.init=function(){changeSaveFlag(true);e.type=$("#admin_data").data("type");e.communityId=$("#admin_data").data("community_id");if(e.type==1){e.dynamicId=GetQueryString("id")}$("#uploadFile").click(function(){$("#selectPdfFile").click()});$("#deleteUploadedPdfFile").click(function(){$("#uploadedFileUrl").data("file_url","");$("#selectPdfFile").val("");$(".uploadBoxPdf").fadeOut(100)});$(".uploadFileBtnWrapper").on("change","#selectPdfFile",function(){if(!i){a(this.files,"pdf","Pdf",20)}else{baseUtils.show.redTip("文件正在上传中，请稍后再试")}});$("#releaseDynamic").click(function(){if(e.submitLimit==true){baseUtils.show.redTip("正在提交中，请稍后再试");return false}if(i){baseUtils.show.redTip("文件正在上传中，请稍后再提交");return false}var l={};var t=$("#dynamicTitle").val();if(t==""||t==undefined){baseUtils.show.redTip("请输入动态标题");return false}l["title"]=t;var a=UE.getEditor("container");var d=a.getContent();var n=a.getPlainTxt();if(d==""||d==undefined){baseUtils.show.redTip("请输入动态内容");return false}l["org_content"]=d;l["content"]=n;l["community_id"]=e.communityId;var o=$("#uploadedFileUrl").data("file_url");var s=$("#uploadedFileUrl").data("file_name");var u=$("#uploadedFileUrl").data("file_size");if(o!=""&&o!=undefined){l["file_url"]=o;l["file_name"]=s;l["file_size"]=u}else{l["file_url"]="";l["file_name"]="";l["file_size"]=""}var f="";if(e.type==1){l["id"]=e.dynamicId;f="/smallCommunity/updateDynamic"}else{f="/smallCommunity/uploadDynamic"}e.submitLimit=true;$.ajax(f,{type:"POST",dataType:"json",data:{params:l},success:function(i){if(i.code==0){if(e.type==1){baseUtils.show.blueTip("保存编辑成功")}else{baseUtils.show.blueTip("发布动态成功")}setTimeout(function(){window.location.href="/smallCommunity/dynamicList?community_id="+e.communityId},700)}else{baseUtils.show.redTip("发布出现问题，请稍后再试");e.submitLimit=false}},error:function(i,l,t){e.submitLimit=false;console.log(t);baseUtils.show.redTip("网络错误，请稍后再试！")}})})};function l(e){var i=null;if(window.createObjectURL!=undefined){i=window.createObjectURL(e)}else if(window.URL!=undefined){i=window.URL.createObjectURL(e)}else if(window.webkitURL!=undefined){i=window.webkitURL.createObjectURL(e)}return i}function t(e){if(window.revokeObjectURL!=undefined){window.revokeObjectURL(e)}else if(window.URL!=undefined){window.URL.revokeObjectURL(e)}else if(window.webkitURL!=undefined){window.webkitURL.revokeObjectURL(e)}}function a(e,l,t,a){if(e&&e.length>0){var n=e[0];var o=n.name;if(!o.toLowerCase().endsWith("pdf")){baseUtils.show.redTip("请选择 pdf 格式的文件");$("#selectPdfFile").remove();$("#uploadedFileUrl").before('<input class="selectPdfFileInput" id="selectPdfFile" type="file" accept="application/pdf"/>');return false}if($uploadFile.checkFileSize(n,a)){var s=(n.size/(1024*1024)).toFixed(2);$("#uploadedFileUrl").data("file_size",s);$("#audioURL"+t).hide();$(".uploadBox"+t).fadeIn(300);d(o,s);$("#uploadedFileUrl").data("file_name",o);i=true;$uploadFile.uploadRes(n,l,function(e){var i=parseInt(e*100);$(".uploadPLineActive"+t).css("width",i+"%");$(".uploadPercent"+t).text(i+"%")},function(e){i=false;console.log(e);baseUtils.show.blueTip("上传成功！");$(".uploadPLine"+t).hide();$(".upload"+t+"Name").show();$(".uploadPercent"+t).text("删除");var l=e.data.access_url;$("#uploadedFileUrl").data("file_url",l)},function(e){i=false;console.error("上传失败!!!");console.log(e);baseUtils.show.redTip("上传失败！")})}else{baseUtils.show.redTip("上传失败，请勿上传超过 "+a+"Mb 的PDF文件");$(".upLoad"+t).val("")}}else{console.log("网络错误，请稍后再试！")}}function d(e,i){$(".uploadPdfName").html(e).hide();$(".uploadPdfSize span").html(i);$(".uploadPLinePdf").show().find(".uploadPLineActivePdf").css("width","0");$(".uploadPercentPdf").html("")}return e}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1hbmFnZUR5bmFtaWMuanMiXSwibmFtZXMiOlsiJCIsImRvY3VtZW50IiwicmVhZHkiLCJCdXNpbmVzcyIsImluaXQiLCJpc1BkZkZpbGVVcGxvYWRpbmciLCJzdWJtaXRMaW1pdCIsImNvbW11bml0eUlkIiwidHlwZSIsImR5bmFtaWNJZCIsImNoYW5nZVNhdmVGbGFnIiwiZGF0YSIsIkdldFF1ZXJ5U3RyaW5nIiwiY2xpY2siLCJ2YWwiLCJmYWRlT3V0Iiwib24iLCJyZXNVcGxvYWQiLCJ0aGlzIiwiZmlsZXMiLCJiYXNlVXRpbHMiLCJzaG93IiwicmVkVGlwIiwicGFyYW1zIiwiZHluYW1pY1RpdGxlIiwidW5kZWZpbmVkIiwidWUiLCJVRSIsImdldEVkaXRvciIsIm9yZ19jb250ZW50IiwiZ2V0Q29udGVudCIsImRlc2NyYiIsImdldFBsYWluVHh0IiwicGRmRmlsZVVybCIsInBkZkZpbGVOYW1lIiwicGRmRmlsZVNpemUiLCJwb3N0VXJsIiwiYWpheCIsImRhdGFUeXBlIiwic3VjY2VzcyIsInJlc3VsdCIsImNvZGUiLCJibHVlVGlwIiwic2V0VGltZW91dCIsIndpbmRvdyIsImxvY2F0aW9uIiwiaHJlZiIsImVycm9yIiwieGhyIiwic3RhdHVzIiwiZXJyIiwiY29uc29sZSIsImxvZyIsImdldE9iamVjdFVSTCIsImZpbGUiLCJ1cmwiLCJjcmVhdGVPYmplY3RVUkwiLCJVUkwiLCJ3ZWJraXRVUkwiLCJyZW1vdmVPYmplY3RVUkwiLCJyZXZva2VPYmplY3RVUkwiLCJyZXNUeXBlIiwicmVzVHlwZUNsYXNzIiwicmVzTGltaXRTaXplIiwibGVuZ3RoIiwibmFtZSIsInRvTG93ZXJDYXNlIiwiZW5kc1dpdGgiLCJyZW1vdmUiLCJiZWZvcmUiLCIkdXBsb2FkRmlsZSIsImNoZWNrRmlsZVNpemUiLCJmaWxlU2l6ZSIsInNpemUiLCJ0b0ZpeGVkIiwiaGlkZSIsImZhZGVJbiIsImluaXRGaWxlQW5kUHJvZ3Jlc3NCYXIiLCJ1cGxvYWRSZXMiLCJwcm9ncmVzcyIsInBhcnNlSW50IiwiY3NzIiwidGV4dCIsInJlc1VybCIsImFjY2Vzc191cmwiLCJmaWxlTmFtZSIsImh0bWwiLCJmaW5kIl0sIm1hcHBpbmdzIjoiQUFJQUEsRUFBRUMsVUFBVUMsTUFBTSxXQUVkQyxTQUFTQyxRQUdiLElBQUlELFVBQVcsV0FFWCxHQUFJQSxLQUVKLElBQUlFLEdBQXFCLEtBRXpCRixHQUFTRyxZQUFjLEtBQ3ZCSCxHQUFTSSxhQUFlLENBQ3hCSixHQUFTSyxNQUFRLENBQ2pCTCxHQUFTTSxXQUFhLENBRXRCTixHQUFTQyxLQUFPLFdBR1pNLGVBQWUsS0FFZlAsR0FBU0ssS0FBT1IsRUFBRSxlQUFlVyxLQUFLLE9BQ3RDUixHQUFTSSxZQUFjUCxFQUFFLGVBQWVXLEtBQUssZUFDN0MsSUFBSVIsRUFBU0ssTUFBUSxFQUFHLENBQ3BCTCxFQUFTTSxVQUFZRyxlQUFlLE1BSXhDWixFQUFFLGVBQWVhLE1BQU0sV0FDbkJiLEVBQUUsa0JBQWtCYSxTQUl4QmIsR0FBRSwwQkFBMEJhLE1BQU0sV0FDOUJiLEVBQUUsb0JBQW9CVyxLQUFLLFdBQVksR0FDdkNYLEdBQUUsa0JBQWtCYyxJQUFJLEdBQ3hCZCxHQUFFLGlCQUFpQmUsUUFBUSxNQUkvQmYsR0FBRSx5QkFBeUJnQixHQUFHLFNBQVUsaUJBQWtCLFdBQ3RELElBQUtYLEVBQW9CLENBQ3JCWSxFQUFVQyxLQUFLQyxNQUFPLE1BQU8sTUFBTyxRQUNqQyxDQUNIQyxVQUFVQyxLQUFLQyxPQUFPLG1CQUs5QnRCLEdBQUUsbUJBQW1CYSxNQUFNLFdBR3ZCLEdBQUlWLEVBQVNHLGFBQWUsS0FBTSxDQUM5QmMsVUFBVUMsS0FBS0MsT0FBTyxjQUN0QixPQUFPLE9BSVgsR0FBSWpCLEVBQW9CLENBQ3BCZSxVQUFVQyxLQUFLQyxPQUFPLGlCQUN0QixPQUFPLE9BTVgsR0FBSUMsS0FFSixJQUFJQyxHQUFleEIsRUFBRSxpQkFBaUJjLEtBQ3RDLElBQUlVLEdBQWdCLElBQU1BLEdBQWdCQyxVQUFXLENBQ2pETCxVQUFVQyxLQUFLQyxP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dXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBDcmVhdGVkIGJ5IEFkbWluaXN0cmF0b3Igb24gMjAxNy81LzIuXHJcbiAqL1xyXG5cclxuJChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24gKCkge1xyXG5cclxuICAgIEJ1c2luZXNzLmluaXQoKTtcclxufSlcclxuXHJcbnZhciBCdXNpbmVzcyA9IChmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgdmFyIEJ1c2luZXNzID0ge307XHJcblxyXG4gICAgdmFyIGlzUGRmRmlsZVVwbG9hZGluZyA9IGZhbHNlO1xyXG5cclxuICAgIEJ1c2luZXNzLnN1Ym1pdExpbWl0ID0gZmFsc2U7ICAgLy/mj5DkuqTpmZDliLZcclxuICAgIEJ1c2luZXNzLmNvbW11bml0eUlkID0gLTE7XHJcbiAgICBCdXNpbmVzcy50eXBlID0gLTE7ICAgICAgICAgICAgIC8vICAxIC0g57yW6L6RIO+8myAwIC0g5paw5bu6XHJcbiAgICBCdXNpbmVzcy5keW5hbWljSWQgPSAtMTtcclxuXHJcbiAgICBCdXNpbmVzcy5pbml0ID0gZnVuY3Rpb24gKCkge1xyXG5cclxuICAgICAgICAvL+eCueWHu+S+p+i+ueagj+emu+W8gOaXtueahOW8ueahhlxyXG4gICAgICAgIGNoYW5nZVNhdmVGbGFnKHRydWUpO1xyXG5cclxuICAgICAgICBCdXNpbmVzcy50eXBlID0gJChcIiNhZG1pbl9kYXRhXCIpLmRhdGEoXCJ0eXBlXCIpO1xyXG4gICAgICAgIEJ1c2luZXNzLmNvbW11bml0eUlkID0gJChcIiNhZG1pbl9kYXRhXCIpLmRhdGEoXCJjb21tdW5pdHlfaWRcIik7XHJcbiAgICAgICAgaWYgKEJ1c2luZXNzLnR5cGUgPT0gMSkge1xyXG4gICAgICAgICAgICBCdXNpbmVzcy5keW5hbWljSWQgPSBHZXRRdWVyeVN0cmluZyhcImlkXCIpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy/pgInmi6npnIDopoHkuIrkvKDnmoTmlofku7ZcclxuICAgICAgICAkKFwiI3VwbG9hZEZpbGVcIikuY2xpY2soZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAkKFwiI3NlbGVjdFBkZkZpbGVcIikuY2xpY2soKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgLy/liKDpmaTlt7Lnu4/kuIrkvKDnmoRwZGbmlofku7ZcclxuICAgICAgICAkKFwiI2RlbGV0ZVVwbG9hZGVkUGRmRmlsZVwiKS5jbGljayhmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICQoXCIjdXBsb2FkZWRGaWxlVXJsXCIpLmRhdGEoXCJmaWxlX3VybFwiLCBcIlwiKTtcclxuICAgICAgICAgICAgJChcIiNzZWxlY3RQZGZGaWxlXCIpLnZhbChcIlwiKTtcclxuICAgICAgICAgICAgJChcIi51cGxvYWRCb3hQZGZcIikuZmFkZU91dCgxMDApO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICAvL+WkhOeQhumAieaLqeaWh+S7tuWQjueahOS4iuS8oFxyXG4gICAgICAgICQoXCIudXBsb2FkRmlsZUJ0bldyYXBwZXJcIikub24oXCJjaGFuZ2VcIiwgXCIjc2VsZWN0UGRmRmlsZVwiLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGlmICghaXNQZGZGaWxlVXBsb2FkaW5nKSB7XHJcbiAgICAgICAgICAgICAgICByZXNVcGxvYWQodGhpcy5maWxlcywgXCJwZGZcIiwgXCJQZGZcIiwgMjApO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgYmFzZVV0aWxzLnNob3cucmVkVGlwKFwi5paH5Lu25q2j5Zyo5LiK5Lyg5Lit77yM6K+356iN5ZCO5YaN6K+VXCIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIC8v5Y+R5biD5Yqo5oCBXHJcbiAgICAgICAgJChcIiNyZWxlYXNlRHluYW1pY1wiKS5jbGljayhmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgICAgICAgICAvLyAg6Ziy5q2i6YeN5aSN5o+Q5LqkXHJcbiAgICAgICAgICAgIGlmIChCdXNpbmVzcy5zdWJtaXRMaW1pdCA9PSB0cnVlKSB7XHJcbiAgICAgICAgICAgICAgICBiYXNlVXRpbHMuc2hvdy5yZWRUaXAoXCLmraPlnKjmj5DkuqTkuK3vvIzor7fnqI3lkI7lho3or5VcIik7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIC8vICDmlofku7bmraPlnKjkuIrkvKDkuK1cclxuICAgICAgICAgICAgaWYgKGlzUGRmRmlsZVVwbG9hZGluZykge1xyXG4gICAgICAgICAgICAgICAgYmFzZVV0aWxzLnNob3cucmVkVGlwKFwi5paH5Lu25q2j5Zyo5LiK5Lyg5Lit77yM6K+356iN5ZCO5YaN5o+Q5LqkXCIpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvKipcclxuICAgICAgICAgICAgICog6ZyA6KaB55qE5Y+C5pWwIO+8miBjb21tdW5pdHlfaWQgLSB0aXRsZSAtIG9yZ19jb250ZW50IC0gY29udGVudCAtIGZpbGVfdXJsIC0gZmlsZV9uYW1lIC0gZmlsZV9zaXplXHJcbiAgICAgICAgICAgICAqL1xyXG4gICAgICAgICAgICB2YXIgcGFyYW1zID0ge307XHJcblxyXG4gICAgICAgICAgICB2YXIgZHluYW1pY1RpdGxlID0gJChcIiNkeW5hbWljVGl0bGVcIikudmFsKCk7XHJcbiAgICAgICAgICAgIGlmIChkeW5hbWljVGl0bGUgPT0gJycgfHwgZHluYW1pY1RpdGxlID09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgYmFzZVV0aWxzLnNob3cucmVkVGlwKFwi6K+36L6T5YWl5Yqo5oCB5qCH6aKYXCIpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHBhcmFtc1sndGl0bGUnXSA9IGR5bmFtaWNUaXRsZTtcclxuXHJcbiAgICAgICAgICAgIC8vICDojrflj5bliqjmgIEgaHRtbOWGheWuue+8jOi/lOWbnjogPHA+aGVsbG88L3A+XHJcbiAgICAgICAgICAgIHZhciB1ZSA9IFVFLmdldEVkaXRvcignY29udGFpbmVyJyk7XHJcbiAgICAgICAgICAgIHZhciBvcmdfY29udGVudCA9IHVlLmdldENvbnRlbnQoKTsgICAgLy8gIOWOn+Wni2h0bWzlhoXlrrlcclxuICAgICAgICAgICAgdmFyIGRlc2NyYiA9IHVlLmdldFBsYWluVHh0KCk7ICAgICAgICAvLyAg57qv5paH5pysXHJcblxyXG4gICAgICAgICAgICBpZiAob3JnX2NvbnRlbnQgPT0gJycgfHwgb3JnX2NvbnRlbnQgPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgICAgICBiYXNlVXRpbHMuc2hvdy5yZWRUaXAoXCLor7fovpPlhaXliqjmgIHlhoXlrrlcIik7XHJcblxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHBhcmFtc1snb3JnX2NvbnRlbnQnXSA9IG9yZ19jb250ZW50O1xyXG4gICAgICAgICAgICBwYXJhbXNbJ2NvbnRlbnQnXSA9IGRlc2NyYjtcclxuXHJcbiAgICAgICAgICAgIHBhcmFtc1snY29tbXVuaXR5X2lkJ10gPSBCdXNpbmVzcy5jb21tdW5pdHlJZDtcclxuXHJcbiAgICAgICAgICAgIC8v5paH5Lu25bGe5oCnXHJcbiAgICAgICAgICAgIHZhciBwZGZGaWxlVXJsID0gJChcIiN1cGxvYWRlZEZpbGVVcmxcIikuZGF0YShcImZpbGVfdXJsXCIpO1xyXG4gICAgICAgICAgICB2YXIgcGRmRmlsZU5hbWUgPSAkKFwiI3VwbG9hZGVkRmlsZVVybFwiKS5kYXRhKFwiZmlsZV9uYW1lXCIpO1xyXG4gICAgICAgICAgICB2YXIgcGRmRmlsZVNpemUgPSAkKFwiI3VwbG9hZGVkRmlsZVVybFwiKS5kYXRhKFwiZmlsZV9zaXplXCIpO1xyXG5cclxuICAgICAgICAgICAgaWYgKHBkZkZpbGVVcmwgIT0gXCJcIiAmJiBwZGZGaWxlVXJsICE9IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgcGFyYW1zWydmaWxlX3VybCddID0gcGRmRmlsZVVybDtcclxuICAgICAgICAgICAgICAgIHBhcmFtc1snZmlsZV9uYW1lJ10gPSBwZGZGaWxlTmFtZTtcclxuICAgICAgICAgICAgICAgIHBhcmFtc1snZmlsZV9zaXplJ10gPSBwZGZGaWxlU2l6ZTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHBhcmFtc1snZmlsZV91cmwnXSA9IFwiXCI7XHJcbiAgICAgICAgICAgICAgICBwYXJhbXNbJ2ZpbGVfbmFtZSddID0gXCJcIjtcclxuICAgICAgICAgICAgICAgIHBhcmFtc1snZmlsZV9zaXplJ10gPSBcIlwiO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB2YXIgcG9zdFVybCA9IFwiXCI7XHJcbiAgICAgICAgICAgIGlmIChCdXNpbmVzcy50eXBlID09IDEpIHsgICAvLyAg57yW6L6RXHJcbiAgICAgICAgICAgICAgICBwYXJhbXNbJ2lkJ10gPSBCdXNpbmVzcy5keW5hbWljSWQ7XHJcbiAgICAgICAgICAgICAgICBwb3N0VXJsID0gXCIvc21hbGxDb21tdW5pdHkvdXBkYXRlRHluYW1pY1wiO1xyXG4gICAgICAgICAgICB9IGVsc2UgeyAgICAvLyAg5paw5bu6XHJcbiAgICAgICAgICAgICAgICBwb3N0VXJsID0gXCIvc21hbGxDb21tdW5pdHkvdXBsb2FkRHluYW1pY1wiO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBCdXNpbmVzcy5zdWJtaXRMaW1pdCA9IHRydWU7XHJcblxyXG4gICAgICAgICAgICAkLmFqYXgocG9zdFVybCwge1xyXG4gICAgICAgICAgICAgICAgdHlwZTogXCJQT1NUXCIsXHJcbiAgICAgICAgICAgICAgICBkYXRhVHlwZTogXCJqc29uXCIsXHJcbiAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgcGFyYW1zOiBwYXJhbXNcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbiAocmVzdWx0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3VsdC5jb2RlID09IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKEJ1c2luZXNzLnR5cGUgPT0gMSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYmFzZVV0aWxzLnNob3cuYmx1ZVRpcChcIuS/neWtmOe8lui+keaIkOWKn1wiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhc2VVdGlscy5zaG93LmJsdWVUaXAoXCLlj5HluIPliqjmgIHmiJDlip9cIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24uaHJlZj1cIi9zbWFsbENvbW11bml0eS9keW5hbWljTGlzdD9jb21tdW5pdHlfaWQ9XCIgKyBCdXNpbmVzcy5jb21tdW5pdHlJZDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSwgNzAwKTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBiYXNlVXRpbHMuc2hvdy5yZWRUaXAoXCLlj5HluIPlh7rnjrDpl67popjvvIzor7fnqI3lkI7lho3or5VcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIEJ1c2luZXNzLnN1Ym1pdExpbWl0ID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIGVycm9yOiBmdW5jdGlvbiAoeGhyLCBzdGF0dXMsIGVycikge1xyXG4gICAgICAgICAgICAgICAgICAgIEJ1c2luZXNzLnN1Ym1pdExpbWl0ID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyKTtcclxuICAgICAgICAgICAgICAgICAgICBiYXNlVXRpbHMuc2hvdy5yZWRUaXAoXCLnvZHnu5zplJnor6/vvIzor7fnqI3lkI7lho3or5XvvIFcIik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICB9KTtcclxuXHJcbiAgICB9O1xyXG5cclxuICAgIC8v5Y+W5raI5LiK5Lyg5Yik5pat5Y+C5pWwXHJcbiAgICAvLyB2YXIgdXBsb2FkQ2FuY2VsPTA7XHJcbiAgICBmdW5jdGlvbiBnZXRPYmplY3RVUkwoZmlsZSkge1xyXG4gICAgICAgIHZhciB1cmwgPSBudWxsO1xyXG4gICAgICAgIGlmICh3aW5kb3cuY3JlYXRlT2JqZWN0VVJMICE9IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICB1cmwgPSB3aW5kb3cuY3JlYXRlT2JqZWN0VVJMKGZpbGUpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAod2luZG93LlVSTCAhPSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgdXJsID0gd2luZG93LlVSTC5jcmVhdGVPYmplY3RVUkwoZmlsZSk7XHJcbiAgICAgICAgfSBlbHNlIGlmICh3aW5kb3cud2Via2l0VVJMICE9IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICB1cmwgPSB3aW5kb3cud2Via2l0VVJMLmNyZWF0ZU9iamVjdFVSTChmaWxlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHVybDtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiByZW1vdmVPYmplY3RVUkwodXJsKSB7Ly/ph4rmlL7otYTmupBVUkxcclxuICAgICAgICBpZiAod2luZG93LnJldm9rZU9iamVjdFVSTCAhPSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgd2luZG93LnJldm9rZU9iamVjdFVSTCh1cmwpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAod2luZG93LlVSTCAhPSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgd2luZG93LlVSTC5yZXZva2VPYmplY3RVUkwodXJsKTtcclxuICAgICAgICB9IGVsc2UgaWYgKHdpbmRvdy53ZWJraXRVUkwgIT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIHdpbmRvdy53ZWJraXRVUkwucmV2b2tlT2JqZWN0VVJMKHVybCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuXHJcbiAgICAvL+i1hOa6kOS4iuS8oOWHveaVsCjlj4LmlbDvvJpyZXNUeXBlOui1hOa6kOexu+WeiyxyZXNUeXBlQ2xhc3M66LWE5rqQ57G75Z6L5Lit57uG5YiG55qE56eN57G7LHJlc0xpbWl0U2l6ZTrotYTmupDpmZDliLblpKflsI8pXHJcbiAgICBmdW5jdGlvbiByZXNVcGxvYWQoZmlsZXMsIHJlc1R5cGUsIHJlc1R5cGVDbGFzcywgcmVzTGltaXRTaXplKSB7XHJcbiAgICAgICAgaWYgKGZpbGVzICYmIGZpbGVzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgdmFyIGZpbGUgPSBmaWxlc1swXTtcclxuICAgICAgICAgICAgdmFyIHBkZkZpbGVOYW1lID0gZmlsZS5uYW1lO1xyXG4gICAgICAgICAgICBpZiAoIXBkZkZpbGVOYW1lLnRvTG93ZXJDYXNlKCkuZW5kc1dpdGgoXCJwZGZcIikpIHtcclxuICAgICAgICAgICAgICAgIGJhc2VVdGlscy5zaG93LnJlZFRpcChcIuivt+mAieaLqSBwZGYg5qC85byP55qE5paH5Lu2XCIpO1xyXG4gICAgICAgICAgICAgICAgJChcIiNzZWxlY3RQZGZGaWxlXCIpLnJlbW92ZSgpO1xyXG4gICAgICAgICAgICAgICAgJChcIiN1cGxvYWRlZEZpbGVVcmxcIikuYmVmb3JlKCc8aW5wdXQgY2xhc3M9XCJzZWxlY3RQZGZGaWxlSW5wdXRcIiBpZD1cInNlbGVjdFBkZkZpbGVcIiB0eXBlPVwiZmlsZVwiIGFjY2VwdD1cImFwcGxpY2F0aW9uL3BkZlwiLz4nKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgLy8g6ZmQ5Yi26LWE5rqQ5ZyoKk1C5YaFXHJcbiAgICAgICAgICAgIGlmICgkdXBsb2FkRmlsZS5jaGVja0ZpbGVTaXplKGZpbGUsIHJlc0xpbWl0U2l6ZSkpIHtcclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgZmlsZVNpemUgPSAoZmlsZS5zaXplIC8gKDEwMjQgKiAxMDI0KSkudG9GaXhlZCgyKTtcclxuICAgICAgICAgICAgICAgICQoXCIjdXBsb2FkZWRGaWxlVXJsXCIpLmRhdGEoXCJmaWxlX3NpemVcIiwgZmlsZVNpemUpO1xyXG4gICAgICAgICAgICAgICAgJCgnI2F1ZGlvVVJMJytyZXNUeXBlQ2xhc3MpLmhpZGUoKTtcclxuICAgICAgICAgICAgICAgICQoXCIudXBsb2FkQm94XCIrcmVzVHlwZUNsYXNzKS5mYWRlSW4oMzAwKTtcclxuICAgICAgICAgICAgICAgIC8vIOWIneWni+WMluaWh+S7tuS7peWPiui/m+W6puadoVxyXG4gICAgICAgICAgICAgICAgaW5pdEZpbGVBbmRQcm9ncmVzc0JhcihwZGZGaWxlTmFtZSwgZmlsZVNpemUpO1xyXG5cclxuICAgICAgICAgICAgICAgICQoXCIjdXBsb2FkZWRGaWxlVXJsXCIpLmRhdGEoXCJmaWxlX25hbWVcIiwgcGRmRmlsZU5hbWUpO1xyXG5cclxuICAgICAgICAgICAgICAgIGlzUGRmRmlsZVVwbG9hZGluZyA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAkdXBsb2FkRmlsZS51cGxvYWRSZXMoZmlsZSwgcmVzVHlwZSwgZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHByb2dyZXNzID0gcGFyc2VJbnQoZGF0YSAqIDEwMCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2cocHJvZ3Jlc3MpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkKFwiLnVwbG9hZFBMaW5lQWN0aXZlXCIgKyByZXNUeXBlQ2xhc3MpLmNzcyhcIndpZHRoXCIsIHByb2dyZXNzICsgJyUnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJChcIi51cGxvYWRQZXJjZW50XCIgKyByZXNUeXBlQ2xhc3MpLnRleHQocHJvZ3Jlc3MgKyBcIiVcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAvLyDkuIrkvKDmiJDlip/lm57osINcclxuICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpc1BkZkZpbGVVcGxvYWRpbmcgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJhc2VVdGlscy5zaG93LmJsdWVUaXAoXCLkuIrkvKDmiJDlip/vvIFcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICQoXCIudXBsb2FkUExpbmVcIiArIHJlc1R5cGVDbGFzcykuaGlkZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkKFwiLnVwbG9hZFwiICsgcmVzVHlwZUNsYXNzICsgXCJOYW1lXCIpLnNob3coKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJChcIi51cGxvYWRQZXJjZW50XCIgKyByZXNUeXBlQ2xhc3MpLnRleHQoXCLliKDpmaRcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZXNVcmwgPSBkYXRhLmRhdGEuYWNjZXNzX3VybDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJChcIiN1cGxvYWRlZEZpbGVVcmxcIikuZGF0YShcImZpbGVfdXJsXCIsIHJlc1VybCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgLy8g5LiK5Lyg5aSx6LSl5Zue6LCDXHJcbiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaXNQZGZGaWxlVXBsb2FkaW5nICA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKFwi5LiK5Lyg5aSx6LSlISEhXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhkYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYmFzZVV0aWxzLnNob3cucmVkVGlwKFwi5LiK5Lyg5aSx6LSl77yBXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgYmFzZVV0aWxzLnNob3cucmVkVGlwKFwi5LiK5Lyg5aSx6LSl77yM6K+35Yu/5LiK5Lyg6LaF6L+HIFwiICsgcmVzTGltaXRTaXplICsgXCJNYiDnmoRQREbmlofku7ZcIik7XHJcbiAgICAgICAgICAgICAgICAkKFwiLnVwTG9hZFwiK3Jlc1R5cGVDbGFzcykudmFsKFwiXCIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCLnvZHnu5zplJnor6/vvIzor7fnqI3lkI7lho3or5XvvIFcIik7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICAvLyDliJ3lp4vljJbmlofku7bku6Xlj4rov5vluqbmnaFcclxuICAgIGZ1bmN0aW9uIGluaXRGaWxlQW5kUHJvZ3Jlc3NCYXIoZmlsZU5hbWUsIGZpbGVTaXplKSB7XHJcblxyXG4gICAgICAgICQoXCIudXBsb2FkUGRmTmFtZVwiKS5odG1sKGZpbGVOYW1lKS5oaWRlKCk7XHJcbiAgICAgICAgJChcIi51cGxvYWRQZGZTaXplIHNwYW5cIikuaHRtbChmaWxlU2l6ZSk7XHJcbiAgICAgICAgJChcIi51cGxvYWRQTGluZVBkZlwiKS5zaG93KClcclxuICAgICAgICAgICAgLmZpbmQoXCIudXBsb2FkUExpbmVBY3RpdmVQZGZcIikuY3NzKFwid2lkdGhcIiwgJzAnKTtcclxuICAgICAgICAkKFwiLnVwbG9hZFBlcmNlbnRQZGZcIikuaHRtbCgnJyk7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBCdXNpbmVzcztcclxuXHJcbn0pKCk7XHJcblxyXG4iXX0=
