$(document).ready(function(){Business.init()});var Business=function(){var e={};var i=false;e.submitLimit=false;e.communityId=-1;e.type=-1;e.dynamicId=-1;e.init=function(){changeSaveFlag(true);e.type=$("#admin_data").data("type");e.communityId=$("#admin_data").data("community_id");if(e.type==1){e.dynamicId=GetQueryString("id")}$("#uploadFile").click(function(){$("#selectPdfFile").click()});$("#preview").on("click",function(){var e=ue.getContent();document.getElementById("preview_content").innerHTML=e;$(".preview_con").addClass("active");$(".preview_box").addClass("active");document.documentElement.style.overflow="hidden"});$(".preview_con").on("click",function(){$(this).removeClass("active");$("#preview_content").html("");$(".preview_box").removeClass("active");document.documentElement.style.overflow="auto"});$("#deleteUploadedPdfFile").click(function(){$("#uploadedFileUrl").data("file_url","");$("#selectPdfFile").val("");$(".uploadBoxPdf").fadeOut(100)});$(".uploadFileBtnWrapper").on("change","#selectPdfFile",function(){if(!i){o(this.files,"pdf","Pdf",20)}else{baseUtils.show.redTip("文件正在上传中，请稍后再试")}});var l=$("#service_radio");var n=l.data("collection");var s=l.data("set-temp");var d=l.data("message-push");if(n==0&&s==1){l.on("click",":radio",function(e){console.log("企业模式");e.preventDefault();var i=$(this);var t="您需要到微信公众号后台将您的服务号所在行业设置为“教育/培训”，设置完成后，开启服务号通知方可正常发送模板消息。"+"<br/><a target='_blank' href='/help/instructions#hp5_wx_service' style='margin-top:10px;'>什么是模板消息？</a>";var a={title:"提示",btn:3,oktext:"我已设置",canceltext:"关闭",icon:"blue",onOk:function(){$.ajax("/has_industry",{type:"GET",dataType:"json",data:{}}).done(function(e){var t=e.ret;if(t==0){i.prop("checked",true);prevVal=currVal;baseUtils.show.blueTip("模板消息推送开启")}else{baseUtils.show.redTip("无法开启消息推送，请按照提示修改设置")}}).fail(function(e,i,t){console.error(t);baseUtils.show.redTip("网络错误，请稍后再试！")})}};$.alert(t,"custom",a)})}else if(n==1&&d==false){l.on("click",":radio",function(e){e.preventDefault();console.log("person");var i=$(this);var t='您尚未开启服务号通知，是否立即开启服务号通知？</br><a target="_blank" href="/helpCenter/problem?first_id=44&second_id=45&document_id=doc_598dcf69a8367_8AjB9">什么是服务号通知？</a>';var a={title:"提示",btn:3,oktext:"开启通知",canceltext:"关闭",icon:"blue",onOk:function(){$.ajax("/set_service_notification",{type:"POST",dataType:"json",data:{status:1}}).done(function(e){if(e.code==0){i.prop("checked",true);baseUtils.show.blueTip("已开启服务号消息通知")}else{baseUtils.show.redTip("操作失败，请稍后再试。")}}).fail(function(e,i,t){console.error(t);baseUtils.show.redTip("网络错误，请稍后再试！")})}};$.alert(t,"custom",a)})}$("#releaseDynamic").click(function(){var l=$(".selectContent input:checked").attr("value");if(e.submitLimit==true){baseUtils.show.redTip("正在提交中，请稍后再试");return false}if(i){baseUtils.show.redTip("文件正在上传中，请稍后再提交");return false}var n={};var o=$("#dynamicTitle").val();if(o==""||o==undefined){baseUtils.show.redTip("请输入动态标题");return false}n["title"]=o;var s=UE.getEditor("container");var d=s.getContent();var c=s.getPlainTxt();if(d==""||d==undefined){baseUtils.show.redTip("请输入动态内容");return false}n["org_content"]=d;n["content"]=c;n["community_id"]=e.communityId;var r=$(".selectItem input:checked").val();var u=$("#uploadedFileUrl").data("file_url");var f=$("#uploadedFileUrl").data("file_name");var p=$("#uploadedFileUrl").data("file_size");if(u!=""&&u!=undefined){n["file_url"]=u;n["file_name"]=f;n["file_size"]=p}else{n["file_url"]="";n["file_name"]="";n["file_size"]=""}var m="";if(e.type==1){n["id"]=e.dynamicId;m="/smallCommunity/updateDynamic"}else{m="/smallCommunity/uploadDynamic"}e.submitLimit=true;console.log(l);if(l==1){a(e.communityId,m,n,r)}else{t(m,n,r,l)}})};function t(i,t,a){$.ajax(i,{type:"POST",dataType:"json",data:{params:t,push_state:a},success:function(i){if(i.code==0){if(e.type==1){baseUtils.show.blueTip("保存编辑成功")}else{baseUtils.show.blueTip("发布动态成功")}setTimeout(function(){window.location.href="/smallCommunity/dynamicList?community_id="+e.communityId},700)}else{baseUtils.show.redTip("发布出现问题，请稍后再试");e.submitLimit=false}},error:function(i,t,a){e.submitLimit=false;console.log(a);baseUtils.show.redTip("网络错误，请稍后再试！")}})}function a(i,a,l,n){console.log(i);$.ajax("/smallCommunity/checkFeedsMessagePush/"+i,{type:"POST",dataType:"JSON",async:false,success:function(i){console.log(i);if(i.code==0){baseUtils.show.blueTip(i.msg);t(a,l,n)}else if(i.code==-1){baseUtils.show.redTip(i.msg);e.submitLimit=false;return false}else{baseUtils.show.redTip(i.msg);e.submitLimit=false;return false}},error:function(i,t,a){e.submitLimit=false;console.log(a);baseUtils.show.redTip("网络错误，请稍后再试！")}})}function l(e){var i=null;if(window.createObjectURL!=undefined){i=window.createObjectURL(e)}else if(window.URL!=undefined){i=window.URL.createObjectURL(e)}else if(window.webkitURL!=undefined){i=window.webkitURL.createObjectURL(e)}return i}function n(e){if(window.revokeObjectURL!=undefined){window.revokeObjectURL(e)}else if(window.URL!=undefined){window.URL.revokeObjectURL(e)}else if(window.webkitURL!=undefined){window.webkitURL.revokeObjectURL(e)}}function o(e,t,a,l){if(e&&e.length>0){var n=e[0];var o=n.name;if(!o.toLowerCase().endsWith("pdf")){baseUtils.show.redTip("请选择 pdf 格式的文件");$("#selectPdfFile").remove();$("#uploadedFileUrl").before('<input class="selectPdfFileInput" id="selectPdfFile" type="file" accept="application/pdf"/>');return false}if($uploadFile.checkFileSize(n,l)){var d=(n.size/(1024*1024)).toFixed(2);$("#uploadedFileUrl").data("file_size",d);$("#audioURL"+a).hide();$(".uploadBox"+a).fadeIn(300);s(o,d);$("#uploadedFileUrl").data("file_name",o);i=true;$uploadFile.uploadRes(n,t,function(e){var i=parseInt(e*100);$(".uploadPLineActive"+a).css("width",i+"%");$(".uploadPercent"+a).text(i+"%")},function(e){i=false;console.log(e);baseUtils.show.blueTip("上传成功！");$(".uploadPLine"+a).hide();$(".upload"+a+"Name").show();$(".uploadPercent"+a).text("删除");var t=e.data.access_url;$("#uploadedFileUrl").data("file_url",t)},function(e){i=false;console.error("上传失败!!!");console.log(e);baseUtils.show.redTip("上传失败！")})}else{baseUtils.show.redTip("上传失败，请勿上传超过 "+l+"Mb 的PDF文件");$(".upLoad"+a).val("")}}else{console.log("网络错误，请稍后再试！")}}function s(e,i){$(".uploadPdfName").html(e).hide();$(".uploadPdfSize span").html(i);$(".uploadPLinePdf").show().find(".uploadPLineActivePdf").css("width","0");$(".uploadPercentPdf").html("")}return e}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1hbmFnZUR5bmFtaWMuanMiXSwibmFtZXMiOlsiJCIsImRvY3VtZW50IiwicmVhZHkiLCJCdXNpbmVzcyIsImluaXQiLCJpc1BkZkZpbGVVcGxvYWRpbmciLCJzdWJtaXRMaW1pdCIsImNvbW11bml0eUlkIiwidHlwZSIsImR5bmFtaWNJZCIsImNoYW5nZVNhdmVGbGFnIiwiZGF0YSIsIkdldFF1ZXJ5U3RyaW5nIiwiY2xpY2siLCJvbiIsImh0bWwiLCJ1ZSIsImdldENvbnRlbnQiLCJnZXRFbGVtZW50QnlJZCIsImlubmVySFRNTCIsImFkZENsYXNzIiwiZG9jdW1lbnRFbGVtZW50Iiwic3R5bGUiLCJvdmVyZmxvdyIsInRoaXMiLCJyZW1vdmVDbGFzcyIsInZhbCIsImZhZGVPdXQiLCJyZXNVcGxvYWQiLCJmaWxlcyIsImJhc2VVdGlscyIsInNob3ciLCJyZWRUaXAiLCIkc2VydmljZVRvZ2dsZSIsImNvbGxlY3Rpb24iLCJzZXRUZW1wIiwibWVzc2FnZVB1c2giLCJlIiwiY29uc29sZSIsImxvZyIsInByZXZlbnREZWZhdWx0IiwiZWxlIiwidHh0Iiwib3B0aW9uIiwidGl0bGUiLCJidG4iLCJva3RleHQiLCJjYW5jZWx0ZXh0IiwiaWNvbiIsIm9uT2siLCJhamF4IiwiZGF0YVR5cGUiLCJkb25lIiwiY29kZSIsInJldCIsInByb3AiLCJwcmV2VmFsIiwiY3VyclZhbCIsImJsdWVUaXAiLCJmYWlsIiwieGhyIiwidGV4dCIsImVyciIsImVycm9yIiwiYWxlcnQiLCJzdGF0dXMiLCJyZXN1bHQiLCJrZXkiLCJhdHRyIiwicGFyYW1zIiwiZHluYW1pY1RpdGxlIiwidW5kZWZpbmVkIiwiVUUiLCJnZXRFZGl0b3IiLCJvcmdfY29udGVudCIsImRlc2NyYiIsImdldFBsYWluVHh0IiwicHVzaF9zdGF0ZSIsInBkZkZpbGVVcmwiLCJwZGZGaWxlTmFtZSIsInBkZkZpbGVTaXplIiwicG9zdFVybCIsInNldFNlcnZpY2UiLCJwdWJsaXNoIiwic3VjY2VzcyIsInNldFRpbWVvdXQiLCJ3aW5kb3ciLCJsb2NhdGlvbiIsImhyZWYiLCJjX2lkIiwiYXN5bmMiLCJtc2ciLCJnZXRPYmplY3RVUkwiLCJmaWxlIiwidXJsIiwiY3JlYXRlT2JqZWN0VVJMIiwiVVJMIiwid2Via2l0VVJMIiwicmVtb3ZlT2JqZWN0VVJMIiwicmV2b2tlT2JqZWN0VVJMIiwicmVzVHlwZSIsInJlc1R5cGVDbGFzcyIsInJlc0xpbWl0U2l6ZSIsImxlbmd0aCIsIm5hbWUiLCJ0b0xvd2VyQ2FzZSIsImVuZHNXaXRoIiwicmVtb3ZlIiwiYmVmb3JlIiwiJHVwbG9hZEZpbGUiLCJjaGVja0ZpbGVTaXplIiwiZmlsZVNpemUiLCJzaXplIiwidG9GaXhlZCIsImhpZGUiLCJmYWRlSW4iLCJpbml0RmlsZUFuZFByb2dyZXNzQmFyIiwidXBsb2FkUmVzIiwicHJvZ3Jlc3MiLCJwYXJzZUludCIsImNzcyIsInJlc1VybCIsImFjY2Vzc191cmwiLCJmaWxlTmFtZSIsImZpbmQiXSwibWFwcGluZ3MiOiJBQUlBQSxFQUFFQyxVQUFVQyxNQUFNLFdBRWRDLFNBQVNDLFFBR2IsSUFBSUQsVUFBVyxXQUVYLEdBQUlBLEtBRUosSUFBSUUsR0FBcUIsS0FFekJGLEdBQVNHLFlBQWMsS0FDdkJILEdBQVNJLGFBQWUsQ0FDeEJKLEdBQVNLLE1BQVEsQ0FDakJMLEdBQVNNLFdBQWEsQ0FFdEJOLEdBQVNDLEtBQU8sV0FHWk0sZUFBZSxLQUVmUCxHQUFTSyxLQUFPUixFQUFFLGVBQWVXLEtBQUssT0FDdENSLEdBQVNJLFlBQWNQLEVBQUUsZUFBZVcsS0FBSyxlQUM3QyxJQUFJUixFQUFTSyxNQUFRLEVBQUcsQ0FDcEJMLEVBQVNNLFVBQVlHLGVBQWUsTUFJeENaLEVBQUUsZUFBZWEsTUFBTSxXQUNuQmIsRUFBRSxrQkFBa0JhLFNBR3hCYixHQUFFLFlBQVljLEdBQUcsUUFBUSxXQUNyQixHQUFJQyxHQUFPQyxHQUFHQyxZQUNkaEIsVUFBU2lCLGVBQWUsbUJBQW1CQyxVQUFZSixDQUN2RGYsR0FBRSxnQkFBZ0JvQixTQUFTLFNBQzNCcEIsR0FBRSxnQkFBZ0JvQixTQUFTLFNBQzNCbkIsVUFBU29CLGdCQUFnQkMsTUFBTUMsU0FBVyxVQUU5Q3ZCLEdBQUUsZ0JBQWdCYyxHQUFHLFFBQVEsV0FDekJkLEVBQUV3QixNQUFNQyxZQUFZLFNBQ3BCekIsR0FBRSxvQkFBb0JlLEtBQUssR0FDM0JmLEdBQUUsZ0JBQWdCeUIsWUFBWSxTQUM5QnhCLFVBQVNvQixnQkFBZ0JDLE1BQU1DLFNBQVcsUUFHOUN2QixHQUFFLDBCQUEwQmEsTUFBTSxXQUM5QmIsRUFBRSxvQkFBb0JXLEtBQUssV0FBWSxHQUN2Q1gsR0FBRSxrQkFBa0IwQixJQUFJLEdBQ3hCMUIsR0FBRSxpQkFBaUIyQixRQUFRLE1BSS9CM0IsR0FBRSx5QkFBeUJjLEdBQUcsU0FBVSxpQkFBa0IsV0FDdEQsSUFBS1QsRUFBb0IsQ0FDckJ1QixFQUFVSixLQUFLSyxNQUFPLE1BQU8sTUFBTyxRQUNqQyxDQUNIQyxVQUFVQyxLQUFLQyxPQUFPLG1CQUk5QixJQUFJQyxHQUFpQmpDLEVBQUUsaUJBQ3ZCLElBQUlrQyxHQUFhRCxFQUFldEIsS0FBSyxhQUNyQyxJQUFJd0IsR0FBVUYsRUFBZXRCLEtBQUssV0FDbEMsSUFBSXlCLEdBQWNILEVBQWV0QixLQUFLLGVBQ3RDLElBQUd1QixHQUFjLEdBQUtDLEdBQVcsRUFBRSxDQUMvQkYsRUFBZW5CLEdBQUcsUUFBUSxTQUFTLFNBQVN1QixHQUN4Q0MsUUFBUUMsSUFBSSxPQUNaRixHQUFFRyxnQkFDRixJQUFJQyxHQUFNekMsRUFBRXdCLEtBQ1osSUFBSWtCLEdBQU0sMkRBQ04sd0dBQ0osSUFBSUMsSUFDQUMsTUFBTyxLQUNQQyxJQUFLLEVBQ0xDLE9BQVEsT0FDUkMsV0FBWSxLQUNaQyxLQUFNLE9BQ05DLEtBQU0sV0FDRmpELEVBQUVrRCxLQUFLLGlCQUNIMUMsS0FBTSxNQUNOMkMsU0FBVSxPQUNWeEMsVUFDRHlDLEtBQUssU0FBU3pDLEdBQ2IsR0FBSTBDLEdBQU8xQyxFQUFLMkMsR0FDaEIsSUFBR0QsR0FBUSxFQUFFLENBQ1RaLEVBQUljLEtBQUssVUFBVyxLQUNwQkMsU0FBVUMsT0FFVjNCLFdBQVVDLEtBQUsyQixRQUFRLGdCQUNwQixDQUNINUIsVUFBVUMsS0FBS0MsT0FBTyx5QkFFM0IyQixLQUFLLFNBQVNDLEVBQUtDLEVBQU1DLEdBQ3hCeEIsUUFBUXlCLE1BQU1ELEVBQ2RoQyxXQUFVQyxLQUFLQyxPQUFPLGtCQUlsQ2hDLEdBQUVnRSxNQUFNdEIsRUFBSyxTQUFVQyxTQUV6QixJQUFHVCxHQUFjLEdBQUtFLEdBQWUsTUFBTSxDQUM3Q0gsRUFBZW5CLEdBQUcsUUFBUSxTQUFTLFNBQVN1QixHQUN4Q0EsRUFBRUcsZ0JBQ0ZGLFNBQVFDLElBQUksU0FDWixJQUFJRSxHQUFNekMsRUFBRXdCLEtBQ1osSUFBSWtCLEdBQU0sc0pBQ1YsSUFBSUMsSUFDQUMsTUFBTyxLQUNQQyxJQUFLLEVBQ0xDLE9BQVEsT0FDUkMsV0FBWSxLQUNaQyxLQUFNLE9BQ05DLEtBQU0sV0FDRmpELEVBQUVrRCxLQUFLLDZCQUNIMUMsS0FBTSxPQUNOMkMsU0FBVSxPQUNWeEMsTUFBT3NELE9BQU8sS0FDZmIsS0FBSyxTQUFTYyxHQUNiLEdBQUlBLEVBQU9iLE1BQVEsRUFBRyxDQUNsQlosRUFBSWMsS0FBSyxVQUFXLEtBQ3BCekIsV0FBVUMsS0FBSzJCLFFBQVEsa0JBRXBCLENBQ0g1QixVQUFVQyxLQUFLQyxPQUFPLGtCQUUzQjJCLEtBQUssU0FBU0MsRUFBS0MsRUFBTUMsR0FDeEJ4QixRQUFReUIsTUFBTUQsRUFDZGhDLFdBQVVDLEtBQUtDLE9BQU8sa0JBSWxDaEMsR0FBRWdFLE1BQU10QixFQUFLLFNBQVVDLEtBSS9CM0MsRUFBRSxtQkFBbUJhLE1BQU0sV0FDdkIsR0FBSXNELEdBQUluRSxFQUFFLGdDQUFnQ29FLEtBQUssUUFFL0MsSUFBSWpFLEVBQVNHLGFBQWUsS0FBTSxDQUM5QndCLFVBQVVDLEtBQUtDLE9BQU8sY0FDdEIsT0FBTyxPQUlYLEdBQUkzQixFQUFvQixDQUNwQnlCLFVBQVVDLEtBQUtDLE9BQU8saUJBQ3RCLE9BQU8sT0FNWCxHQUFJcUMsS0FFSixJQUFJQyxHQUFldEUsRUFBRSxpQkFBaUIwQixLQUN0QyxJQUFJNEMsR0FBZ0IsSUFBTUEsR0FBZ0JDLFVBQVcsQ0FDakR6QyxVQUFVQyxLQUFLQyxPQUFPLFVBQ3RCLE9BQU8sT0FFWHFDLEVBQU8sU0FBV0MsQ0FHbEIsSUFBSXRELEdBQUt3RCxHQUFHQyxVQUFVLFlBQ3RCLElBQUlDLEdBQWMxRCxFQUFHQyxZQUNyQixJQUFJMEQsR0FBUzNELEVBQUc0RCxhQUVoQixJQUFJRixHQUFlLElBQU1BLEdBQWVILFVBQVcsQ0FDL0N6QyxVQUFVQyxLQUFLQyxPQUFPLFVBRXRCLE9BQU8sT0FFWHFDLEVBQU8sZUFBaUJLLENBQ3hCTCxHQUFPLFdBQWFNLENBRXBCTixHQUFPLGdCQUFrQmxFLEVBQVNJLFdBR2xDLElBQUlzRSxHQUFhN0UsRUFBRSw2QkFBNkIwQixLQUVoRCxJQUFJb0QsR0FBYTlFLEVBQUUsb0JBQW9CVyxLQUFLLFdBQzVDLElBQUlvRSxHQUFjL0UsRUFBRSxvQkFBb0JXLEtBQUssWUFDN0MsSUFBSXFFLEdBQWNoRixFQUFFLG9CQUFvQlcsS0FBSyxZQUk3QyxJQUFJbUUsR0FBYyxJQUFNQSxHQUFjUCxVQUFXLENBQzdDRixFQUFPLFlBQWNTLENBQ3JCVCxHQUFPLGFBQWVVLENBQ3RCVixHQUFPLGFBQWVXLE1BQ25CLENBQ0hYLEVBQU8sWUFBYyxFQUNyQkEsR0FBTyxhQUFlLEVBQ3RCQSxHQUFPLGFBQWUsR0FHMUIsR0FBSVksR0FBVSxFQUNkLElBQUk5RSxFQUFTSyxNQUFRLEVBQUcsQ0FDcEI2RCxFQUFPLE1BQVFsRSxFQUFTTSxTQUN4QndFLEdBQVUsb0NBQ1AsQ0FDSEEsRUFBVSxnQ0FHZDlFLEVBQVNHLFlBQWMsSUFHdkJnQyxTQUFRQyxJQUFJNEIsRUFDWixJQUFHQSxHQUFPLEVBQUUsQ0FDUmUsRUFBVy9FLEVBQVNJLFlBQVkwRSxFQUFRWixFQUFPUSxPQUM5QyxDQUNETSxFQUFRRixFQUFRWixFQUFPUSxFQUFXVixNQVM5QyxTQUFTZ0IsR0FBUUYsRUFBUVosRUFBT1EsR0FDNUI3RSxFQUFFa0QsS0FBSytCLEdBQ0h6RSxLQUFNLE9BQ04yQyxTQUFVLE9BQ1Z4QyxNQUNJMEQsT0FBUUEsRUFDUlEsV0FBWUEsR0FFaEJPLFFBQVMsU0FBVWxCLEdBQ2YsR0FBSUEsRUFBT2IsTUFBUSxFQUFHLENBQ2xCLEdBQUlsRCxFQUFTSyxNQUFRLEVBQUcsQ0FDcEJzQixVQUFVQyxLQUFLMkIsUUFBUSxjQUNwQixDQUNINUIsVUFBVUMsS0FBSzJCLFFBQVEsVUFFM0IyQixXQUFXLFdBQ1BDLE9BQU9DLFNBQVNDLEtBQU8sNENBQThDckYsRUFBU0ksYUFDL0UsU0FDQSxDQUNIdUIsVUFBVUMsS0FBS0MsT0FBTyxlQUN0QjdCLEdBQVNHLFlBQWMsUUFHL0J5RCxNQUFPLFNBQVVILEVBQUtLLEVBQVFILEdBQzFCM0QsRUFBU0csWUFBYyxLQUN2QmdDLFNBQVFDLElBQUl1QixFQUNaaEMsV0FBVUMsS0FBS0MsT0FBTyxrQkFLbEMsUUFBU2tELEdBQVdPLEVBQUtSLEVBQVFaLEVBQU9RLEdBQ3BDdkMsUUFBUUMsSUFBSWtELEVBQ1p6RixHQUFFa0QsS0FBSyx5Q0FBeUN1QyxHQUM1Q2pGLEtBQUssT0FDTDJDLFNBQVMsT0FDVHVDLE1BQU0sTUFDTk4sUUFBUSxTQUFTekUsR0FDYjJCLFFBQVFDLElBQUk1QixFQUNaLElBQUdBLEVBQUswQyxNQUFRLEVBQUUsQ0FDZHZCLFVBQVVDLEtBQUsyQixRQUFRL0MsRUFBS2dGLElBRTVCUixHQUFRRixFQUFRWixFQUFPUSxPQUNyQixJQUFHbEUsRUFBSzBDLE9BQVMsRUFBRSxDQUNyQnZCLFVBQVVDLEtBQUtDLE9BQU9yQixFQUFLZ0YsSUFDM0J4RixHQUFTRyxZQUFjLEtBRXZCLE9BQU8sV0F5Qk4sQ0FDRHdCLFVBQVVDLEtBQUtDLE9BQU9yQixFQUFLZ0YsSUFDM0J4RixHQUFTRyxZQUFjLEtBQ3ZCLE9BQU8sU0FJZnlELE1BQU8sU0FBVUgsRUFBS0ssRUFBUUgsR0FDMUIzRCxFQUFTRyxZQUFjLEtBQ3ZCZ0MsU0FBUUMsSUFBSXVCLEVBQ1poQyxXQUFVQyxLQUFLQyxPQUFPLGtCQU9sQyxRQUFTNEQsR0FBYUMsR0FDbEIsR0FBSUMsR0FBTSxJQUNWLElBQUlSLE9BQU9TLGlCQUFtQnhCLFVBQVcsQ0FDckN1QixFQUFNUixPQUFPUyxnQkFBZ0JGLE9BQzFCLElBQUlQLE9BQU9VLEtBQU96QixVQUFXLENBQ2hDdUIsRUFBTVIsT0FBT1UsSUFBSUQsZ0JBQWdCRixPQUM5QixJQUFJUCxPQUFPVyxXQUFhMUIsVUFBVyxDQUN0Q3VCLEVBQU1SLE9BQU9XLFVBQVVGLGdCQUFnQkYsR0FFM0MsTUFBT0MsR0FHWCxRQUFTSSxHQUFnQkosR0FDckIsR0FBSVIsT0FBT2EsaUJBQW1CNUIsVUFBVyxDQUNyQ2UsT0FBT2EsZ0JBQWdCTCxPQUNwQixJQUFJUixPQUFPVSxLQUFPekIsVUFBVyxDQUNoQ2UsT0FBT1UsSUFBSUcsZ0JBQWdCTCxPQUN4QixJQUFJUixPQUFPVyxXQUFhMUIsVUFBVyxDQUN0Q2UsT0FBT1csVUFBVUUsZ0JBQWdCTCxJQU16QyxRQUFTbEUsR0FBVUMsRUFBT3VFLEVBQVNDLEVBQWNDLEdBQzdDLEdBQUl6RSxHQUFTQSxFQUFNMEUsT0FBUyxFQUFHLENBQzNCLEdBQUlWLEdBQU9oRSxFQUFNLEVBQ2pCLElBQUlrRCxHQUFjYyxFQUFLVyxJQUN2QixLQUFLekIsRUFBWTBCLGNBQWNDLFNBQVMsT0FBUSxDQUM1QzVFLFVBQVVDLEtBQUtDLE9BQU8sZ0JBQ3RCaEMsR0FBRSxrQkFBa0IyRyxRQUNwQjNHLEdBQUUsb0JBQW9CNEcsT0FBTyw4RkFDN0IsT0FBTyxPQUlYLEdBQUlDLFlBQVlDLGNBQWNqQixFQUFNUyxHQUFlLENBRS9DLEdBQUlTLElBQVlsQixFQUFLbUIsTUFBUSxLQUFPLE9BQU9DLFFBQVEsRUFDbkRqSCxHQUFFLG9CQUFvQlcsS0FBSyxZQUFhb0csRUFDeEMvRyxHQUFFLFlBQVlxRyxHQUFjYSxNQUM1QmxILEdBQUUsYUFBYXFHLEdBQWNjLE9BQU8sSUFFcENDLEdBQXVCckMsRUFBYWdDLEVBRXBDL0csR0FBRSxvQkFBb0JXLEtBQUssWUFBYW9FLEVBRXhDMUUsR0FBcUIsSUFDckJ3RyxhQUFZUSxVQUFVeEIsRUFBTU8sRUFBUyxTQUFVekYsR0FDdkMsR0FBSTJHLEdBQVdDLFNBQVM1RyxFQUFPLElBRS9CWCxHQUFFLHFCQUF1QnFHLEdBQWNtQixJQUFJLFFBQVNGLEVBQVcsSUFDL0R0SCxHQUFFLGlCQUFtQnFHLEdBQWN4QyxLQUFLeUQsRUFBVyxNQUd2RCxTQUFVM0csR0FDTk4sRUFBcUIsS0FDckJpQyxTQUFRQyxJQUFJNUIsRUFDWm1CLFdBQVVDLEtBQUsyQixRQUFRLFFBQ3ZCMUQsR0FBRSxlQUFpQnFHLEdBQWNhLE1BQ2pDbEgsR0FBRSxVQUFZcUcsRUFBZSxRQUFRdEUsTUFDckMvQixHQUFFLGlCQUFtQnFHLEdBQWN4QyxLQUFLLEtBQ3hDLElBQUk0RCxHQUFTOUcsRUFBS0EsS0FBSytHLFVBQ3ZCMUgsR0FBRSxvQkFBb0JXLEtBQUssV0FBWThHLElBSTNDLFNBQVU5RyxHQUNOTixFQUFzQixLQUN0QmlDLFNBQVF5QixNQUFNLFVBQ2R6QixTQUFRQyxJQUFJNUIsRUFDWm1CLFdBQVVDLEtBQUtDLE9BQU8sZUFFM0IsQ0FDSEYsVUFBVUMsS0FBS0MsT0FBTyxlQUFpQnNFLEVBQWUsWUFDdER0RyxHQUFFLFVBQVVxRyxHQUFjM0UsSUFBSSxTQUUvQixDQUNIWSxRQUFRQyxJQUFJLGdCQUtwQixRQUFTNkUsR0FBdUJPLEVBQVVaLEdBRXRDL0csRUFBRSxrQkFBa0JlLEtBQUs0RyxHQUFVVCxNQUNuQ2xILEdBQUUsdUJBQXVCZSxLQUFLZ0csRUFDOUIvRyxHQUFFLG1CQUFtQitCLE9BQ2hCNkYsS0FBSyx5QkFBeUJKLElBQUksUUFBUyxJQUNoRHhILEdBQUUscUJBQXFCZSxLQUFLLElBSWhDLE1BQU9aIiwiZmlsZSI6Im1hbmFnZUR5bmFtaWMuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICogQ3JlYXRlZCBieSBBZG1pbmlzdHJhdG9yIG9uIDIwMTcvNS8yLlxyXG4gKi9cclxuXHJcbiQoZG9jdW1lbnQpLnJlYWR5KGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICBCdXNpbmVzcy5pbml0KCk7XHJcbn0pXHJcblxyXG52YXIgQnVzaW5lc3MgPSAoZnVuY3Rpb24gKCkge1xyXG5cclxuICAgIHZhciBCdXNpbmVzcyA9IHt9O1xyXG5cclxuICAgIHZhciBpc1BkZkZpbGVVcGxvYWRpbmcgPSBmYWxzZTtcclxuXHJcbiAgICBCdXNpbmVzcy5zdWJtaXRMaW1pdCA9IGZhbHNlOyAgIC8v5o+Q5Lqk6ZmQ5Yi2XHJcbiAgICBCdXNpbmVzcy5jb21tdW5pdHlJZCA9IC0xO1xyXG4gICAgQnVzaW5lc3MudHlwZSA9IC0xOyAgICAgICAgICAgICAvLyAgMSAtIOe8lui+kSDvvJsgMCAtIOaWsOW7ulxyXG4gICAgQnVzaW5lc3MuZHluYW1pY0lkID0gLTE7XHJcblxyXG4gICAgQnVzaW5lc3MuaW5pdCA9IGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICAgICAgLy/ngrnlh7vkvqfovrnmoI/nprvlvIDml7bnmoTlvLnmoYZcclxuICAgICAgICBjaGFuZ2VTYXZlRmxhZyh0cnVlKTtcclxuXHJcbiAgICAgICAgQnVzaW5lc3MudHlwZSA9ICQoXCIjYWRtaW5fZGF0YVwiKS5kYXRhKFwidHlwZVwiKTtcclxuICAgICAgICBCdXNpbmVzcy5jb21tdW5pdHlJZCA9ICQoXCIjYWRtaW5fZGF0YVwiKS5kYXRhKFwiY29tbXVuaXR5X2lkXCIpO1xyXG4gICAgICAgIGlmIChCdXNpbmVzcy50eXBlID09IDEpIHtcclxuICAgICAgICAgICAgQnVzaW5lc3MuZHluYW1pY0lkID0gR2V0UXVlcnlTdHJpbmcoXCJpZFwiKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8v6YCJ5oup6ZyA6KaB5LiK5Lyg55qE5paH5Lu2XHJcbiAgICAgICAgJChcIiN1cGxvYWRGaWxlXCIpLmNsaWNrKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgJChcIiNzZWxlY3RQZGZGaWxlXCIpLmNsaWNrKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgLy/nvJbovpHlmajpooTop4hcclxuICAgICAgICAkKCcjcHJldmlldycpLm9uKCdjbGljaycsZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgdmFyIGh0bWwgPSB1ZS5nZXRDb250ZW50KCk7XHJcbiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwcmV2aWV3X2NvbnRlbnQnKS5pbm5lckhUTUwgPSBodG1sO1xyXG4gICAgICAgICAgICAkKCcucHJldmlld19jb24nKS5hZGRDbGFzcygnYWN0aXZlJyk7XHJcbiAgICAgICAgICAgICQoJy5wcmV2aWV3X2JveCcpLmFkZENsYXNzKCdhY3RpdmUnKTtcclxuICAgICAgICAgICAgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnN0eWxlLm92ZXJmbG93ID0gXCJoaWRkZW5cIjtcclxuICAgICAgICB9KTtcclxuICAgICAgICAkKCcucHJldmlld19jb24nKS5vbignY2xpY2snLGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgICQodGhpcykucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xyXG4gICAgICAgICAgICAkKCcjcHJldmlld19jb250ZW50JykuaHRtbCgnJyk7XHJcbiAgICAgICAgICAgICQoJy5wcmV2aWV3X2JveCcpLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcclxuICAgICAgICAgICAgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnN0eWxlLm92ZXJmbG93ID0gXCJhdXRvXCI7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgLy/liKDpmaTlt7Lnu4/kuIrkvKDnmoRwZGbmlofku7ZcclxuICAgICAgICAkKFwiI2RlbGV0ZVVwbG9hZGVkUGRmRmlsZVwiKS5jbGljayhmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICQoXCIjdXBsb2FkZWRGaWxlVXJsXCIpLmRhdGEoXCJmaWxlX3VybFwiLCBcIlwiKTtcclxuICAgICAgICAgICAgJChcIiNzZWxlY3RQZGZGaWxlXCIpLnZhbChcIlwiKTtcclxuICAgICAgICAgICAgJChcIi51cGxvYWRCb3hQZGZcIikuZmFkZU91dCgxMDApO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICAvL+WkhOeQhumAieaLqeaWh+S7tuWQjueahOS4iuS8oFxyXG4gICAgICAgICQoXCIudXBsb2FkRmlsZUJ0bldyYXBwZXJcIikub24oXCJjaGFuZ2VcIiwgXCIjc2VsZWN0UGRmRmlsZVwiLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGlmICghaXNQZGZGaWxlVXBsb2FkaW5nKSB7XHJcbiAgICAgICAgICAgICAgICByZXNVcGxvYWQodGhpcy5maWxlcywgXCJwZGZcIiwgXCJQZGZcIiwgMjApO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgYmFzZVV0aWxzLnNob3cucmVkVGlwKFwi5paH5Lu25q2j5Zyo5LiK5Lyg5Lit77yM6K+356iN5ZCO5YaN6K+VXCIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgLy/mnI3liqHlj7fpgJrnn6XljZXpgInngrnlh7vmgIHliKTmlq0gLS0t5LyB5Lia5qih5byP77yI5piv5ZCm5byA6YCa6K6+572u57uP6JCl6IyD5Zu077yJIC0tLeS4quS6uuaooeW8j+aYr+WQpuiuvue9riDlip/og73nrqHnkIYtLeacjeWKoeWPt+mAmuefpeW8gOWFs1xyXG4gICAgICAgIHZhciAkc2VydmljZVRvZ2dsZSA9ICQoJyNzZXJ2aWNlX3JhZGlvJyk7XHJcbiAgICAgICAgdmFyIGNvbGxlY3Rpb24gPSAkc2VydmljZVRvZ2dsZS5kYXRhKCdjb2xsZWN0aW9uJyk7Ly/liKTmlq3mqKHlvI8gMC0t5LyB5Lia5qih5byPIDEtLeS4quS6uuaooeW8j1xyXG4gICAgICAgIHZhciBzZXRUZW1wID0gJHNlcnZpY2VUb2dnbGUuZGF0YSgnc2V0LXRlbXAnKTsvL+WIpOaWreaYr+WQpuacieiuvue9ruaVmeiCsuihjOS4miAwLS3lt7Lorr7nva4gIDEtLeacquiuvue9rlxyXG4gICAgICAgIHZhciBtZXNzYWdlUHVzaCA9ICRzZXJ2aWNlVG9nZ2xlLmRhdGEoJ21lc3NhZ2UtcHVzaCcpOy8v5Liq5Lq65qih5byP5piv5ZCm5pyJ5omT5byA5raI5oGv5o6o6YCB5byA5YWz5byA5YWz77ybdHJ1ZSDlvIDlkK8gZmFsc2Ug5YWz6ZetXHJcbiAgICAgICAgaWYoY29sbGVjdGlvbiA9PSAwICYmIHNldFRlbXAgPT0gMSl7XHJcbiAgICAgICAgICAgICRzZXJ2aWNlVG9nZ2xlLm9uKCdjbGljaycsJzpyYWRpbycsZnVuY3Rpb24oZSl7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygn5LyB5Lia5qih5byPJylcclxuICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgICAgIHZhciBlbGUgPSAkKHRoaXMpO1xyXG4gICAgICAgICAgICAgICAgdmFyIHR4dD0gIFwi5oKo6ZyA6KaB5Yiw5b6u5L+h5YWs5LyX5Y+35ZCO5Y+w5bCG5oKo55qE5pyN5Yqh5Y+35omA5Zyo6KGM5Lia6K6+572u5Li64oCc5pWZ6IKyL+WfueiureKAne+8jOiuvue9ruWujOaIkOWQju+8jOW8gOWQr+acjeWKoeWPt+mAmuefpeaWueWPr+ato+W4uOWPkemAgeaooeadv+a2iOaBr+OAglwiK1xyXG4gICAgICAgICAgICAgICAgICAgIFwiPGJyLz48YSB0YXJnZXQ9J19ibGFuaycgaHJlZj0nL2hlbHAvaW5zdHJ1Y3Rpb25zI2hwNV93eF9zZXJ2aWNlJyBzdHlsZT0nbWFyZ2luLXRvcDoxMHB4Oyc+5LuA5LmI5piv5qih5p2/5raI5oGv77yfPC9hPlwiO1xyXG4gICAgICAgICAgICAgICAgdmFyIG9wdGlvbiA9IHtcclxuICAgICAgICAgICAgICAgICAgICB0aXRsZTogXCLmj5DnpLpcIiwgLy/lvLnlh7rmoYbmoIfpophcclxuICAgICAgICAgICAgICAgICAgICBidG46IDMsIC8v56Gu5a6aJiblj5bmtohcclxuICAgICAgICAgICAgICAgICAgICBva3RleHQ6ICfmiJHlt7Lorr7nva4nLFxyXG4gICAgICAgICAgICAgICAgICAgIGNhbmNlbHRleHQ6ICflhbPpl60nLFxyXG4gICAgICAgICAgICAgICAgICAgIGljb246ICdibHVlJyxcclxuICAgICAgICAgICAgICAgICAgICBvbk9rOiBmdW5jdGlvbigpey8v5Y+R6YCB6K+35rGC77yM5Yik5pat55So5oi35piv5ZCm6K6+572u5pyN5Yqh5Y+36KGM5LiaXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICQuYWpheCgnL2hhc19pbmR1c3RyeScse1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ0dFVCcsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhVHlwZTogJ2pzb24nLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YToge31cclxuICAgICAgICAgICAgICAgICAgICAgICAgfSkuZG9uZShmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgY29kZSA9IGRhdGEucmV0O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoY29kZSA9PSAwKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbGUucHJvcCgnY2hlY2tlZCcsIHRydWUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByZXZWYWwgPSBjdXJyVmFsO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8q5raI5oGv5o6o6YCB5byA5ZCvKi9cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiYXNlVXRpbHMuc2hvdy5ibHVlVGlwKFwi5qih5p2/5raI5oGv5o6o6YCB5byA5ZCvXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiYXNlVXRpbHMuc2hvdy5yZWRUaXAoXCLml6Dms5XlvIDlkK/mtojmga/mjqjpgIHvvIzor7fmjInnhafmj5DnpLrkv67mlLnorr7nva5cIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pLmZhaWwoZnVuY3Rpb24oeGhyLCB0ZXh0LCBlcnIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhc2VVdGlscy5zaG93LnJlZFRpcChcIue9kee7nOmUmeivr++8jOivt+eojeWQjuWGjeivle+8gVwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgICQuYWxlcnQodHh0LCBcImN1c3RvbVwiLCBvcHRpb24pO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgIH1lbHNlIGlmKGNvbGxlY3Rpb24gPT0gMSAmJiBtZXNzYWdlUHVzaCA9PSBmYWxzZSl7XHJcbiAgICAgICAgICAgICRzZXJ2aWNlVG9nZ2xlLm9uKCdjbGljaycsJzpyYWRpbycsZnVuY3Rpb24oZSl7XHJcbiAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygncGVyc29uJyk7XHJcbiAgICAgICAgICAgICAgICB2YXIgZWxlID0gJCh0aGlzKTtcclxuICAgICAgICAgICAgICAgIHZhciB0eHQgPSAn5oKo5bCa5pyq5byA5ZCv5pyN5Yqh5Y+36YCa55+l77yM5piv5ZCm56uL5Y2z5byA5ZCv5pyN5Yqh5Y+36YCa55+l77yfPC9icj48YSB0YXJnZXQ9XCJfYmxhbmtcIiBocmVmPVwiL2hlbHBDZW50ZXIvcHJvYmxlbT9maXJzdF9pZD00NCZzZWNvbmRfaWQ9NDUmZG9jdW1lbnRfaWQ9ZG9jXzU5OGRjZjY5YTgzNjdfOEFqQjlcIj7ku4DkuYjmmK/mnI3liqHlj7fpgJrnn6XvvJ88L2E+JztcclxuICAgICAgICAgICAgICAgIHZhciBvcHRpb24gPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6IFwi5o+Q56S6XCIsIC8v5by55Ye65qGG5qCH6aKYXHJcbiAgICAgICAgICAgICAgICAgICAgYnRuOiAzLCAvL+ehruWumiYm5Y+W5raIXHJcbiAgICAgICAgICAgICAgICAgICAgb2t0ZXh0OiAn5byA5ZCv6YCa55+lJyxcclxuICAgICAgICAgICAgICAgICAgICBjYW5jZWx0ZXh0OiAn5YWz6ZetJyxcclxuICAgICAgICAgICAgICAgICAgICBpY29uOiAnYmx1ZScsXHJcbiAgICAgICAgICAgICAgICAgICAgb25PazogZnVuY3Rpb24oKXsvL+WPkemAgeivt+axgu+8jOaJk+W8gOa2iOaBr+aOqOmAgeW8gOWFs1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkLmFqYXgoJy9zZXRfc2VydmljZV9ub3RpZmljYXRpb24nLHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICdQT1NUJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFUeXBlOiAnanNvbicsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiB7c3RhdHVzOjF9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pLmRvbmUoZnVuY3Rpb24ocmVzdWx0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzdWx0LmNvZGUgPT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsZS5wcm9wKCdjaGVja2VkJywgdHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmFzZVV0aWxzLnNob3cuYmx1ZVRpcChcIuW3suW8gOWQr+acjeWKoeWPt+a2iOaBr+mAmuefpVwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBiYXNlVXRpbHMuc2hvdy5ibHVlVGlwKFwi5qih5p2/5raI5oGv5o6o6YCB5byA5ZCvXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiYXNlVXRpbHMuc2hvdy5yZWRUaXAoXCLmk43kvZzlpLHotKXvvIzor7fnqI3lkI7lho3or5XjgIJcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pLmZhaWwoZnVuY3Rpb24oeGhyLCB0ZXh0LCBlcnIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhc2VVdGlscy5zaG93LnJlZFRpcChcIue9kee7nOmUmeivr++8jOivt+eojeWQjuWGjeivle+8gVwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgICQuYWxlcnQodHh0LCBcImN1c3RvbVwiLCBvcHRpb24pO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgIH1cclxuICAgICAgICAvL+WPkeW4g+WKqOaAgVxyXG4gICAgICAgICQoXCIjcmVsZWFzZUR5bmFtaWNcIikuY2xpY2soZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIga2V5PSQoJy5zZWxlY3RDb250ZW50IGlucHV0OmNoZWNrZWQnKS5hdHRyKCd2YWx1ZScpOy8v5Y+R5biD5Yqo5oCB5oyJ6ZKu6YCJ5Lit54q25oCB77ybXHJcbiAgICAgICAgICAgIC8vICDpmLLmraLph43lpI3mj5DkuqRcclxuICAgICAgICAgICAgaWYgKEJ1c2luZXNzLnN1Ym1pdExpbWl0ID09IHRydWUpIHtcclxuICAgICAgICAgICAgICAgIGJhc2VVdGlscy5zaG93LnJlZFRpcChcIuato+WcqOaPkOS6pOS4re+8jOivt+eojeWQjuWGjeivlVwiKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgLy8gIOaWh+S7tuato+WcqOS4iuS8oOS4rVxyXG4gICAgICAgICAgICBpZiAoaXNQZGZGaWxlVXBsb2FkaW5nKSB7XHJcbiAgICAgICAgICAgICAgICBiYXNlVXRpbHMuc2hvdy5yZWRUaXAoXCLmlofku7bmraPlnKjkuIrkvKDkuK3vvIzor7fnqI3lkI7lho3mj5DkuqRcIik7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIC8qKlxyXG4gICAgICAgICAgICAgKiDpnIDopoHnmoTlj4LmlbAg77yaIGNvbW11bml0eV9pZCAtIHRpdGxlIC0gb3JnX2NvbnRlbnQgLSBjb250ZW50IC0gZmlsZV91cmwgLSBmaWxlX25hbWUgLSBmaWxlX3NpemVcclxuICAgICAgICAgICAgICovXHJcbiAgICAgICAgICAgIHZhciBwYXJhbXMgPSB7fTtcclxuXHJcbiAgICAgICAgICAgIHZhciBkeW5hbWljVGl0bGUgPSAkKFwiI2R5bmFtaWNUaXRsZVwiKS52YWwoKTtcclxuICAgICAgICAgICAgaWYgKGR5bmFtaWNUaXRsZSA9PSAnJyB8fCBkeW5hbWljVGl0bGUgPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgICAgICBiYXNlVXRpbHMuc2hvdy5yZWRUaXAoXCLor7fovpPlhaXliqjmgIHmoIfpophcIik7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcGFyYW1zWyd0aXRsZSddID0gZHluYW1pY1RpdGxlO1xyXG5cclxuICAgICAgICAgICAgLy8gIOiOt+WPluWKqOaAgSBodG1s5YaF5a6577yM6L+U5ZueOiA8cD5oZWxsbzwvcD5cclxuICAgICAgICAgICAgdmFyIHVlID0gVUUuZ2V0RWRpdG9yKCdjb250YWluZXInKTtcclxuICAgICAgICAgICAgdmFyIG9yZ19jb250ZW50ID0gdWUuZ2V0Q29udGVudCgpOyAgICAvLyAg5Y6f5aeLaHRtbOWGheWuuVxyXG4gICAgICAgICAgICB2YXIgZGVzY3JiID0gdWUuZ2V0UGxhaW5UeHQoKTsgICAgICAgIC8vICDnuq/mlofmnKxcclxuXHJcbiAgICAgICAgICAgIGlmIChvcmdfY29udGVudCA9PSAnJyB8fCBvcmdfY29udGVudCA9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgIGJhc2VVdGlscy5zaG93LnJlZFRpcChcIuivt+i+k+WFpeWKqOaAgeWGheWuuVwiKTtcclxuXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcGFyYW1zWydvcmdfY29udGVudCddID0gb3JnX2NvbnRlbnQ7XHJcbiAgICAgICAgICAgIHBhcmFtc1snY29udGVudCddID0gZGVzY3JiO1xyXG5cclxuICAgICAgICAgICAgcGFyYW1zWydjb21tdW5pdHlfaWQnXSA9IEJ1c2luZXNzLmNvbW11bml0eUlkO1xyXG5cclxuICAgICAgICAgICAgLy/ojrflj5bmnIDlkI7mnI3liqHlj7fpgJrnn6XlgLxcclxuICAgICAgICAgICAgdmFyIHB1c2hfc3RhdGUgPSAkKCcuc2VsZWN0SXRlbSBpbnB1dDpjaGVja2VkJykudmFsKCk7XHJcbiAgICAgICAgICAgIC8v5paH5Lu25bGe5oCnXHJcbiAgICAgICAgICAgIHZhciBwZGZGaWxlVXJsID0gJChcIiN1cGxvYWRlZEZpbGVVcmxcIikuZGF0YShcImZpbGVfdXJsXCIpO1xyXG4gICAgICAgICAgICB2YXIgcGRmRmlsZU5hbWUgPSAkKFwiI3VwbG9hZGVkRmlsZVVybFwiKS5kYXRhKFwiZmlsZV9uYW1lXCIpO1xyXG4gICAgICAgICAgICB2YXIgcGRmRmlsZVNpemUgPSAkKFwiI3VwbG9hZGVkRmlsZVVybFwiKS5kYXRhKFwiZmlsZV9zaXplXCIpO1xyXG5cclxuXHJcblxyXG4gICAgICAgICAgICBpZiAocGRmRmlsZVVybCAhPSBcIlwiICYmIHBkZkZpbGVVcmwgIT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgICAgICBwYXJhbXNbJ2ZpbGVfdXJsJ10gPSBwZGZGaWxlVXJsO1xyXG4gICAgICAgICAgICAgICAgcGFyYW1zWydmaWxlX25hbWUnXSA9IHBkZkZpbGVOYW1lO1xyXG4gICAgICAgICAgICAgICAgcGFyYW1zWydmaWxlX3NpemUnXSA9IHBkZkZpbGVTaXplO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgcGFyYW1zWydmaWxlX3VybCddID0gXCJcIjtcclxuICAgICAgICAgICAgICAgIHBhcmFtc1snZmlsZV9uYW1lJ10gPSBcIlwiO1xyXG4gICAgICAgICAgICAgICAgcGFyYW1zWydmaWxlX3NpemUnXSA9IFwiXCI7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHZhciBwb3N0VXJsID0gXCJcIjtcclxuICAgICAgICAgICAgaWYgKEJ1c2luZXNzLnR5cGUgPT0gMSkgeyAgIC8vICDnvJbovpFcclxuICAgICAgICAgICAgICAgIHBhcmFtc1snaWQnXSA9IEJ1c2luZXNzLmR5bmFtaWNJZDtcclxuICAgICAgICAgICAgICAgIHBvc3RVcmwgPSBcIi9zbWFsbENvbW11bml0eS91cGRhdGVEeW5hbWljXCI7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7ICAgIC8vICDmlrDlu7pcclxuICAgICAgICAgICAgICAgIHBvc3RVcmwgPSBcIi9zbWFsbENvbW11bml0eS91cGxvYWREeW5hbWljXCI7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIEJ1c2luZXNzLnN1Ym1pdExpbWl0ID0gdHJ1ZTtcclxuXHJcblxyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhrZXkpO1xyXG4gICAgICAgICAgICBpZihrZXkgPT0gMSl7XHJcbiAgICAgICAgICAgICAgICBzZXRTZXJ2aWNlKEJ1c2luZXNzLmNvbW11bml0eUlkLHBvc3RVcmwscGFyYW1zLHB1c2hfc3RhdGUpO1xyXG4gICAgICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgICAgIHB1Ymxpc2gocG9zdFVybCxwYXJhbXMscHVzaF9zdGF0ZSxrZXkpOy8v5Y+R5biD5Yqo5oCBXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgfSk7XHJcblxyXG5cclxuXHJcbiAgICB9O1xyXG5cclxuICAgIGZ1bmN0aW9uIHB1Ymxpc2gocG9zdFVybCxwYXJhbXMscHVzaF9zdGF0ZSkge1xyXG4gICAgICAgICQuYWpheChwb3N0VXJsLCB7XHJcbiAgICAgICAgICAgIHR5cGU6IFwiUE9TVFwiLFxyXG4gICAgICAgICAgICBkYXRhVHlwZTogXCJqc29uXCIsXHJcbiAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgIHBhcmFtczogcGFyYW1zLFxyXG4gICAgICAgICAgICAgICAgcHVzaF9zdGF0ZTogcHVzaF9zdGF0ZVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbiAocmVzdWx0KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAocmVzdWx0LmNvZGUgPT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChCdXNpbmVzcy50eXBlID09IDEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYmFzZVV0aWxzLnNob3cuYmx1ZVRpcChcIuS/neWtmOe8lui+keaIkOWKn1wiKTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBiYXNlVXRpbHMuc2hvdy5ibHVlVGlwKFwi5Y+R5biD5Yqo5oCB5oiQ5YqfXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSBcIi9zbWFsbENvbW11bml0eS9keW5hbWljTGlzdD9jb21tdW5pdHlfaWQ9XCIgKyBCdXNpbmVzcy5jb21tdW5pdHlJZDtcclxuICAgICAgICAgICAgICAgICAgICB9LCA3MDApO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBiYXNlVXRpbHMuc2hvdy5yZWRUaXAoXCLlj5HluIPlh7rnjrDpl67popjvvIzor7fnqI3lkI7lho3or5VcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgQnVzaW5lc3Muc3VibWl0TGltaXQgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgZXJyb3I6IGZ1bmN0aW9uICh4aHIsIHN0YXR1cywgZXJyKSB7XHJcbiAgICAgICAgICAgICAgICBCdXNpbmVzcy5zdWJtaXRMaW1pdCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyKTtcclxuICAgICAgICAgICAgICAgIGJhc2VVdGlscy5zaG93LnJlZFRpcChcIue9kee7nOmUmeivr++8jOivt+eojeWQjuWGjeivle+8gVwiKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgLy/mnI3liqHlj7fmtojmga/pgJrnn6VhamF45pa55rOVXHJcbiAgICBmdW5jdGlvbiBzZXRTZXJ2aWNlKGNfaWQscG9zdFVybCxwYXJhbXMscHVzaF9zdGF0ZSl7XHJcbiAgICAgICAgY29uc29sZS5sb2coY19pZCk7XHJcbiAgICAgICAgJC5hamF4KCcvc21hbGxDb21tdW5pdHkvY2hlY2tGZWVkc01lc3NhZ2VQdXNoLycrY19pZCx7XHJcbiAgICAgICAgICAgIHR5cGU6J1BPU1QnLFxyXG4gICAgICAgICAgICBkYXRhVHlwZTonSlNPTicsXHJcbiAgICAgICAgICAgIGFzeW5jOmZhbHNlLFxyXG4gICAgICAgICAgICBzdWNjZXNzOmZ1bmN0aW9uKGRhdGEpe1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coZGF0YSk7XHJcbiAgICAgICAgICAgICAgICBpZihkYXRhLmNvZGUgPT0gMCl7XHJcbiAgICAgICAgICAgICAgICAgICAgYmFzZVV0aWxzLnNob3cuYmx1ZVRpcChkYXRhLm1zZyk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHB1Ymxpc2gocG9zdFVybCxwYXJhbXMscHVzaF9zdGF0ZSk7XHJcbiAgICAgICAgICAgICAgICB9ZWxzZSBpZihkYXRhLmNvZGUgPT0gLTEpe1xyXG4gICAgICAgICAgICAgICAgICAgIGJhc2VVdGlscy5zaG93LnJlZFRpcChkYXRhLm1zZyk7XHJcbiAgICAgICAgICAgICAgICAgICAgQnVzaW5lc3Muc3VibWl0TGltaXQgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAvLyAkKCcjY2xvc2VJdGVtJykuYXR0cignY2hlY2tlZCcsJ3RydWUnKTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gJC5hbGVydChcIuaCqOmcgOWFiOihjOWQr+eUqCDlip/og73nrqHnkIbigJTigJTmnI3liqHlj7fpgJrnn6Ug5Yqf6IO977yM5pa55Y+v5oiQ5Yqf5byA5ZCvXCIse1xyXG4gICAgICAgICAgICAgICAgICAgIC8vICAgICBsaW5rOifkuKrkurrmqKHlvI/mnI3liqHlj7fpgJrnn6Xor7TmmI4nLFxyXG4gICAgICAgICAgICAgICAgICAgIC8vICAgICBocmVmOicjJyxcclxuICAgICAgICAgICAgICAgICAgICAvLyAgICAgb2t0ZXh0Oifnq4vljbPlvIDlkK8nLFxyXG4gICAgICAgICAgICAgICAgICAgIC8vICAgICBvbk9rOmZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgICAgICAkLmFqYXgoXCIvc2V0X3NlcnZpY2Vfbm90aWZpY2F0aW9uXCIsIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICB0eXBlOiBcIlBPU1RcIixcclxuICAgICAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICBkYXRhVHlwZTogXCJqc29uXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgZGF0YToge3N0YXR1czoxfSxcclxuICAgICAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbiAocmVzdWx0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgICAgIGlmIChyZXN1bHQuY29kZSA9PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICBiYXNlVXRpbHMuc2hvdy5ibHVlVGlwKFwi5byA5ZCv5oiQ5Yqf77yM5oKo546w5Zyo5Y+v5q2j5bi45L2/55So5pyN5Yqh5Y+36YCa55+l5Yqf6IO9XCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgYmFzZVV0aWxzLnNob3cucmVkVGlwKFwi5pON5L2c5aSx6LSl77yM6K+356iN5ZCO5YaN6K+V44CCXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICBlcnJvcjogZnVuY3Rpb24gKHhociwgc3RhdHVzLCBlcnIpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyKTtcclxuICAgICAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICAgICAgYmFzZVV0aWxzLnNob3cucmVkVGlwKFwi5pyN5Yqh5Zmo5Ye65bCP5beu5LqG77yM6K+356iN5ZCO5YaN6K+V77yBXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAvLyAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gJCgnI2Nsb3NlSXRlbScpLnByb3AoJ2NoZWNrZWQnLHRydWUpO1xyXG4gICAgICAgICAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgICAgICAgICAgYmFzZVV0aWxzLnNob3cucmVkVGlwKGRhdGEubXNnKTtcclxuICAgICAgICAgICAgICAgICAgICBCdXNpbmVzcy5zdWJtaXRMaW1pdCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAvL+Wksei0peWKoOWFpemAiemhuei/lOWbnlxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBlcnJvcjogZnVuY3Rpb24gKHhociwgc3RhdHVzLCBlcnIpIHtcclxuICAgICAgICAgICAgICAgIEJ1c2luZXNzLnN1Ym1pdExpbWl0ID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xyXG4gICAgICAgICAgICAgICAgYmFzZVV0aWxzLnNob3cucmVkVGlwKFwi572R57uc6ZSZ6K+v77yM6K+356iN5ZCO5YaN6K+V77yBXCIpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgIH0pXHJcbiAgICB9XHJcbiAgICAvL+WPlua2iOS4iuS8oOWIpOaWreWPguaVsFxyXG4gICAgLy8gdmFyIHVwbG9hZENhbmNlbD0wO1xyXG4gICAgZnVuY3Rpb24gZ2V0T2JqZWN0VVJMKGZpbGUpIHtcclxuICAgICAgICB2YXIgdXJsID0gbnVsbDtcclxuICAgICAgICBpZiAod2luZG93LmNyZWF0ZU9iamVjdFVSTCAhPSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgdXJsID0gd2luZG93LmNyZWF0ZU9iamVjdFVSTChmaWxlKTtcclxuICAgICAgICB9IGVsc2UgaWYgKHdpbmRvdy5VUkwgIT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIHVybCA9IHdpbmRvdy5VUkwuY3JlYXRlT2JqZWN0VVJMKGZpbGUpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAod2luZG93LndlYmtpdFVSTCAhPSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgdXJsID0gd2luZG93LndlYmtpdFVSTC5jcmVhdGVPYmplY3RVUkwoZmlsZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB1cmw7XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gcmVtb3ZlT2JqZWN0VVJMKHVybCkgey8v6YeK5pS+6LWE5rqQVVJMXHJcbiAgICAgICAgaWYgKHdpbmRvdy5yZXZva2VPYmplY3RVUkwgIT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIHdpbmRvdy5yZXZva2VPYmplY3RVUkwodXJsKTtcclxuICAgICAgICB9IGVsc2UgaWYgKHdpbmRvdy5VUkwgIT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIHdpbmRvdy5VUkwucmV2b2tlT2JqZWN0VVJMKHVybCk7XHJcbiAgICAgICAgfSBlbHNlIGlmICh3aW5kb3cud2Via2l0VVJMICE9IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICB3aW5kb3cud2Via2l0VVJMLnJldm9rZU9iamVjdFVSTCh1cmwpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcblxyXG4gICAgLy/otYTmupDkuIrkvKDlh73mlbAo5Y+C5pWw77yacmVzVHlwZTrotYTmupDnsbvlnosscmVzVHlwZUNsYXNzOui1hOa6kOexu+Wei+S4ree7huWIhueahOenjeexuyxyZXNMaW1pdFNpemU66LWE5rqQ6ZmQ5Yi25aSn5bCPKVxyXG4gICAgZnVuY3Rpb24gcmVzVXBsb2FkKGZpbGVzLCByZXNUeXBlLCByZXNUeXBlQ2xhc3MsIHJlc0xpbWl0U2l6ZSkge1xyXG4gICAgICAgIGlmIChmaWxlcyAmJiBmaWxlcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIHZhciBmaWxlID0gZmlsZXNbMF07XHJcbiAgICAgICAgICAgIHZhciBwZGZGaWxlTmFtZSA9IGZpbGUubmFtZTtcclxuICAgICAgICAgICAgaWYgKCFwZGZGaWxlTmFtZS50b0xvd2VyQ2FzZSgpLmVuZHNXaXRoKFwicGRmXCIpKSB7XHJcbiAgICAgICAgICAgICAgICBiYXNlVXRpbHMuc2hvdy5yZWRUaXAoXCLor7fpgInmi6kgcGRmIOagvOW8j+eahOaWh+S7tlwiKTtcclxuICAgICAgICAgICAgICAgICQoXCIjc2VsZWN0UGRmRmlsZVwiKS5yZW1vdmUoKTtcclxuICAgICAgICAgICAgICAgICQoXCIjdXBsb2FkZWRGaWxlVXJsXCIpLmJlZm9yZSgnPGlucHV0IGNsYXNzPVwic2VsZWN0UGRmRmlsZUlucHV0XCIgaWQ9XCJzZWxlY3RQZGZGaWxlXCIgdHlwZT1cImZpbGVcIiBhY2NlcHQ9XCJhcHBsaWNhdGlvbi9wZGZcIi8+Jyk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIC8vIOmZkOWItui1hOa6kOWcqCpNQuWGhVxyXG4gICAgICAgICAgICBpZiAoJHVwbG9hZEZpbGUuY2hlY2tGaWxlU2l6ZShmaWxlLCByZXNMaW1pdFNpemUpKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgdmFyIGZpbGVTaXplID0gKGZpbGUuc2l6ZSAvICgxMDI0ICogMTAyNCkpLnRvRml4ZWQoMik7XHJcbiAgICAgICAgICAgICAgICAkKFwiI3VwbG9hZGVkRmlsZVVybFwiKS5kYXRhKFwiZmlsZV9zaXplXCIsIGZpbGVTaXplKTtcclxuICAgICAgICAgICAgICAgICQoJyNhdWRpb1VSTCcrcmVzVHlwZUNsYXNzKS5oaWRlKCk7XHJcbiAgICAgICAgICAgICAgICAkKFwiLnVwbG9hZEJveFwiK3Jlc1R5cGVDbGFzcykuZmFkZUluKDMwMCk7XHJcbiAgICAgICAgICAgICAgICAvLyDliJ3lp4vljJbmlofku7bku6Xlj4rov5vluqbmnaFcclxuICAgICAgICAgICAgICAgIGluaXRGaWxlQW5kUHJvZ3Jlc3NCYXIocGRmRmlsZU5hbWUsIGZpbGVTaXplKTtcclxuXHJcbiAgICAgICAgICAgICAgICAkKFwiI3VwbG9hZGVkRmlsZVVybFwiKS5kYXRhKFwiZmlsZV9uYW1lXCIsIHBkZkZpbGVOYW1lKTtcclxuXHJcbiAgICAgICAgICAgICAgICBpc1BkZkZpbGVVcGxvYWRpbmcgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgJHVwbG9hZEZpbGUudXBsb2FkUmVzKGZpbGUsIHJlc1R5cGUsIGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwcm9ncmVzcyA9IHBhcnNlSW50KGRhdGEgKiAxMDApO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKHByb2dyZXNzKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJChcIi51cGxvYWRQTGluZUFjdGl2ZVwiICsgcmVzVHlwZUNsYXNzKS5jc3MoXCJ3aWR0aFwiLCBwcm9ncmVzcyArICclJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICQoXCIudXBsb2FkUGVyY2VudFwiICsgcmVzVHlwZUNsYXNzKS50ZXh0KHByb2dyZXNzICsgXCIlXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgLy8g5LiK5Lyg5oiQ5Yqf5Zue6LCDXHJcbiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaXNQZGZGaWxlVXBsb2FkaW5nID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBiYXNlVXRpbHMuc2hvdy5ibHVlVGlwKFwi5LiK5Lyg5oiQ5Yqf77yBXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkKFwiLnVwbG9hZFBMaW5lXCIgKyByZXNUeXBlQ2xhc3MpLmhpZGUoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJChcIi51cGxvYWRcIiArIHJlc1R5cGVDbGFzcyArIFwiTmFtZVwiKS5zaG93KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICQoXCIudXBsb2FkUGVyY2VudFwiICsgcmVzVHlwZUNsYXNzKS50ZXh0KFwi5Yig6ZmkXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVzVXJsID0gZGF0YS5kYXRhLmFjY2Vzc191cmw7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICQoXCIjdXBsb2FkZWRGaWxlVXJsXCIpLmRhdGEoXCJmaWxlX3VybFwiLCByZXNVcmwpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIC8vIOS4iuS8oOWksei0peWbnuiwg1xyXG4gICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlzUGRmRmlsZVVwbG9hZGluZyAgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihcIuS4iuS8oOWksei0pSEhIVwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJhc2VVdGlscy5zaG93LnJlZFRpcChcIuS4iuS8oOWksei0pe+8gVwiKTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGJhc2VVdGlscy5zaG93LnJlZFRpcChcIuS4iuS8oOWksei0pe+8jOivt+WLv+S4iuS8oOi2hei/hyBcIiArIHJlc0xpbWl0U2l6ZSArIFwiTWIg55qEUERG5paH5Lu2XCIpO1xyXG4gICAgICAgICAgICAgICAgJChcIi51cExvYWRcIityZXNUeXBlQ2xhc3MpLnZhbChcIlwiKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwi572R57uc6ZSZ6K+v77yM6K+356iN5ZCO5YaN6K+V77yBXCIpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgLy8g5Yid5aeL5YyW5paH5Lu25Lul5Y+K6L+b5bqm5p2hXHJcbiAgICBmdW5jdGlvbiBpbml0RmlsZUFuZFByb2dyZXNzQmFyKGZpbGVOYW1lLCBmaWxlU2l6ZSkge1xyXG5cclxuICAgICAgICAkKFwiLnVwbG9hZFBkZk5hbWVcIikuaHRtbChmaWxlTmFtZSkuaGlkZSgpO1xyXG4gICAgICAgICQoXCIudXBsb2FkUGRmU2l6ZSBzcGFuXCIpLmh0bWwoZmlsZVNpemUpO1xyXG4gICAgICAgICQoXCIudXBsb2FkUExpbmVQZGZcIikuc2hvdygpXHJcbiAgICAgICAgICAgIC5maW5kKFwiLnVwbG9hZFBMaW5lQWN0aXZlUGRmXCIpLmNzcyhcIndpZHRoXCIsICcwJyk7XHJcbiAgICAgICAgJChcIi51cGxvYWRQZXJjZW50UGRmXCIpLmh0bWwoJycpO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gQnVzaW5lc3M7XHJcblxyXG59KSgpO1xyXG5cclxuIl19
