$(document).ready(function(){$manageExercise.init()});$manageExercise=function(){var e={};var i={submitLimit:false,pageType:$("#admin_data").data("page_type")};e.init=function(){changeSaveFlag(true);if(i.pageType==1){i.resType=$("#admin_data").data("resource_type");i.resId=$("#admin_data").data("resource_id");i.resName=$("#admin_data").data("resource_name")}$("#exerciseBookName").on("keyup",function(){var e=$(this),i=$.trim(e.val());if(i.length>=14){i=i.substr(0,14);e.val(i);$(".characterNumLimit").css({color:"red"});setTimeout(function(){$(".characterNumLimit").css({color:"#888888"})},3e3)}$(".characterNumLimit>span").text(i.length)});$("#resTypeSelector").on("change",function(){var e=$(this).val();if(e==-1){$("#resItemSelector").html(' <option value="-1">请选择具体课程</option>')}else{$.ajax("/exercise/get_resource_list",{type:"POST",dataType:"json",data:{resource_type:e},success:function(t){if(t.code==0){var a=t.data.resource_list,r="";if(i.pageType==1&&i.resType==e){r+='<option value="'+i.resId+'" selected>'+i.resName+"</option>"}$.each(a,function(i,t){var a=e==5?t.name:t.title;r+='<option value="'+t.id+'">'+a+"</option>"});if(r.length==0){r='<option value="-1">暂无数据</option>'}$("#resItemSelector").html(r)}else{baseUtils.show.redTip("网络问题，请稍后再试")}},error:function(e,i,t){console.log(t);alert("服务器出小差了，请稍后再试！")}})}});$(".remindRadio").on("click",function(){$(".remindRadio").children(".circleRadio").removeClass("radioActive");$(this).children(".circleRadio").addClass("radioActive")});$("#cancelSaveExercise").click(function(){window.history.back()});$("#confirmSaveExercise").click(function(){var e=$.trim($("#exerciseBookName").val()),t=$("#resItemSelector").val(),a=$("#resTypeSelector").val(),r=$("#resItemSelector > option:selected").text(),o=$("#communitySelector").val(),s=$(".circleRadio.radioActive").data("is_remind"),c="";s=0;if(e.length==0){baseUtils.show.redTip("还没有输入作业本名称");return false}if(e.length>14){baseUtils.show.redTip("作业本名称长度不能超过14字");return false}if(t==-1){baseUtils.show.redTip("还没有选择具体课程");return false}var n={title:e,resource_id:t,resource_type:a,resource_name:r,is_enable_notify:s};if(o!=-1&&o!=undefined){n.community_id=o}if(i.pageType==0){c="/exercise/upload_exercise_book"}else if(i.pageType==1){c="/exercise/update_exercise_book";n.exercise_book_id=GetQueryString("exercise_book_id")}else{console.log(" pageType 参数有误。");baseUtils.show.redTip("网络错误，请稍后再试");return false}if(i.submitLimit){baseUtils.show.redTip("正在提交中，请稍后再试");return false}i.submitLimit=true;$.ajax(c,{type:"POST",dataType:"json",data:{params:n},success:function(e){i.submitLimit=false;if(e.code==0){baseUtils.show.blueTip("创建作业本成功");setTimeout(function(){window.location.href="/exercise/exercise_book_list"},1e3)}else{alert("网络问题，请稍后再试")}},error:function(e,t,a){i.submitLimit=false;console.log(a);alert("服务器出小差了，请稍后再试！")}})})};return e}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1hbmFnZUV4ZXJjaXNlQm9vay5qcyJdLCJuYW1lcyI6WyIkIiwiZG9jdW1lbnQiLCJyZWFkeSIsIiRtYW5hZ2VFeGVyY2lzZSIsImluaXQiLCIkcHJpdmF0ZSIsInN1Ym1pdExpbWl0IiwicGFnZVR5cGUiLCJkYXRhIiwiY2hhbmdlU2F2ZUZsYWciLCJyZXNUeXBlIiwicmVzSWQiLCJyZXNOYW1lIiwib24iLCIkc2VsZiIsInRoaXMiLCJleGVyY2lzZU5hbWUiLCJ0cmltIiwidmFsIiwibGVuZ3RoIiwic3Vic3RyIiwiY3NzIiwiY29sb3IiLCJzZXRUaW1lb3V0IiwidGV4dCIsImh0bWwiLCJhamF4IiwidHlwZSIsImRhdGFUeXBlIiwicmVzb3VyY2VfdHlwZSIsInN1Y2Nlc3MiLCJyZXN1bHQiLCJjb2RlIiwicmVzb3VyY2VMaXN0IiwicmVzb3VyY2VfbGlzdCIsImh0bWxTdHIiLCJlYWNoIiwiayIsInYiLCJuYW1lIiwidGl0bGUiLCJpZCIsImJhc2VVdGlscyIsInNob3ciLCJyZWRUaXAiLCJlcnJvciIsInhociIsInN0YXR1cyIsImVyciIsImNvbnNvbGUiLCJsb2ciLCJhbGVydCIsImNoaWxkcmVuIiwicmVtb3ZlQ2xhc3MiLCJhZGRDbGFzcyIsImNsaWNrIiwid2luZG93IiwiaGlzdG9yeSIsImJhY2siLCJleGVyY2lzZUJvb2tOYW1lIiwiY29tbXVuaXR5SWQiLCJpc1JlbWluZCIsInBvc3RVcmwiLCJwYXJhbXMiLCJyZXNvdXJjZV9pZCIsInJlc291cmNlX25hbWUiLCJpc19lbmFibGVfbm90aWZ5IiwidW5kZWZpbmVkIiwiY29tbXVuaXR5X2lkIiwiZXhlcmNpc2VfYm9va19pZCIsIkdldFF1ZXJ5U3RyaW5nIiwiYmx1ZVRpcCIsImxvY2F0aW9uIiwiaHJlZiJdLCJtYXBwaW5ncyI6IkFBSUFBLEVBQUVDLFVBQVVDLE1BQU0sV0FDZEMsZ0JBQWdCQyxRQUdwQkQsaUJBQWtCLFdBQ2QsR0FBSUEsS0FDSixJQUFJRSxJQUNBQyxZQUFhLE1BQ2JD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SUFBZ0IsR0FBS0EsR0FBZU8sVUFBVyxDQUMvQ0osRUFBT0ssYUFBZVIsRUFFMUIsR0FBSXZELEVBQVNFLFVBQVksRUFBRyxDQUN4QnVELEVBQVUscUNBQ1AsSUFBSXpELEVBQVNFLFVBQVksRUFBRyxDQUMvQnVELEVBQVUsZ0NBQ1ZDLEdBQU9NLGlCQUFtQkMsZUFBZSx3QkFDdEMsQ0FDSHJCLFFBQVFDLElBQUksa0JBQ1pSLFdBQVVDLEtBQUtDLE9BQU8sYUFDdEIsT0FBTyxPQUVYLEdBQUl2QyxFQUFTQyxZQUFhLENBQ3RCb0MsVUFBVUMsS0FBS0MsT0FBTyxjQUN0QixPQUFPLE9BRVh2QyxFQUFTQyxZQUFjLElBQ3ZCTixHQUFFMEIsS0FBS29DLEdBQ0huQyxLQUFNLE9BQ05DLFNBQVUsT0FDVnBCLE1BQ0l1RCxPQUFRQSxHQUVaakMsUUFBUyxTQUFVQyxHQUNmMUIsRUFBU0MsWUFBYyxLQUN2QixJQUFJeUIsRUFBT0MsTUFBUSxFQUFHLENBQ2xCVSxVQUFVQyxLQUFLNEIsUUFBUSxVQUN2QmhELFlBQVcsV0FDUGlDLE9BQU9nQixTQUFTQyxLQUFPLGdDQUN4QixTQUNBLENBQ0h0QixNQUFNLGdCQUdkTixNQUFPLFNBQVVDLEVBQUtDLEVBQVFDLEdBQzFCM0MsRUFBU0MsWUFBYyxLQUN2QjJDLFNBQVFDLElBQUlGLEVBQ1pHLE9BQU0sdUJBUXRCLE9BQU9oRCIsImZpbGUiOiJtYW5hZ2VFeGVyY2lzZUJvb2suanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICogQ3JlYXRlZCBieSBBZG1pbmlzdHJhdG9yIG9uIDIwMTcvNy8zMS5cclxuICovXHJcblxyXG4kKGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbiAoKSB7XHJcbiAgICAkbWFuYWdlRXhlcmNpc2UuaW5pdCgpO1xyXG59KTtcclxuXHJcbiRtYW5hZ2VFeGVyY2lzZSA9IChmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgJG1hbmFnZUV4ZXJjaXNlID0ge307XHJcbiAgICB2YXIgJHByaXZhdGUgPSB7XHJcbiAgICAgICAgc3VibWl0TGltaXQ6IGZhbHNlLFxyXG4gICAgICAgIHBhZ2VUeXBlOiAkKFwiI2FkbWluX2RhdGFcIikuZGF0YShcInBhZ2VfdHlwZVwiKSwgICAgICAgLy8wLeWIm+W7uu+8mzEt57yW6L6RXHJcbiAgICB9XHJcblxyXG4gICAgJG1hbmFnZUV4ZXJjaXNlLmluaXQgPSBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgICAgIC8v54K55Ye75L6n6L655qCP56a75byA5pe255qE5by55qGGXHJcbiAgICAgICAgY2hhbmdlU2F2ZUZsYWcodHJ1ZSk7XHJcblxyXG4gICAgICAgIGlmICgkcHJpdmF0ZS5wYWdlVHlwZSA9PSAxKSB7XHJcbiAgICAgICAgICAgICRwcml2YXRlLnJlc1R5cGUgPSAkKFwiI2FkbWluX2RhdGFcIikuZGF0YShcInJlc291cmNlX3R5cGVcIik7ICAgIC8v5bey5YWz6IGU6K++56iL55qE57G75Z6LXHJcbiAgICAgICAgICAgICRwcml2YXRlLnJlc0lkID0gJChcIiNhZG1pbl9kYXRhXCIpLmRhdGEoXCJyZXNvdXJjZV9pZFwiKTsgICAgLy/lt7LlhbPogZTor77nqIvnmoRpZFxyXG4gICAgICAgICAgICAkcHJpdmF0ZS5yZXNOYW1lID0gJChcIiNhZG1pbl9kYXRhXCIpLmRhdGEoXCJyZXNvdXJjZV9uYW1lXCIpOyAgICAvL+W3suWFs+iBlOivvueoi+eahGlkXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAkKFwiI2V4ZXJjaXNlQm9va05hbWVcIikub24oXCJrZXl1cFwiLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciAkc2VsZiA9ICQodGhpcyksXHJcbiAgICAgICAgICAgICAgICBleGVyY2lzZU5hbWUgPSAkLnRyaW0oJHNlbGYudmFsKCkpO1xyXG5cclxuICAgICAgICAgICAgaWYgKGV4ZXJjaXNlTmFtZS5sZW5ndGggPj0gMTQpIHtcclxuICAgICAgICAgICAgICAgIGV4ZXJjaXNlTmFtZSA9IGV4ZXJjaXNlTmFtZS5zdWJzdHIoMCwgMTQpO1xyXG4gICAgICAgICAgICAgICAgJHNlbGYudmFsKGV4ZXJjaXNlTmFtZSk7XHJcbiAgICAgICAgICAgICAgICAkKFwiLmNoYXJhY3Rlck51bUxpbWl0XCIpLmNzcyh7XCJjb2xvclwiOiBcInJlZFwifSk7XHJcbiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAkKFwiLmNoYXJhY3Rlck51bUxpbWl0XCIpLmNzcyh7XCJjb2xvclwiOiBcIiM4ODg4ODhcIn0pO1xyXG4gICAgICAgICAgICAgICAgfSwgMzAwMCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgJChcIi5jaGFyYWN0ZXJOdW1MaW1pdD5zcGFuXCIpLnRleHQoZXhlcmNpc2VOYW1lLmxlbmd0aCk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIC8v5YWz6IGU6K++56iLXHJcbiAgICAgICAgJChcIiNyZXNUeXBlU2VsZWN0b3JcIikub24oXCJjaGFuZ2VcIiwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgcmVzVHlwZSA9ICQodGhpcykudmFsKCk7XHJcbiAgICAgICAgICAgIGlmIChyZXNUeXBlID09IC0xKSB7XHJcbiAgICAgICAgICAgICAgICAkKFwiI3Jlc0l0ZW1TZWxlY3RvclwiKS5odG1sKFxyXG4gICAgICAgICAgICAgICAgICAgICcgPG9wdGlvbiB2YWx1ZT1cIi0xXCI+6K+36YCJ5oup5YW35L2T6K++56iLPC9vcHRpb24+J1xyXG4gICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICQuYWpheChcIi9leGVyY2lzZS9nZXRfcmVzb3VyY2VfbGlzdFwiLCB7XHJcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJQT1NUXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YVR5cGU6IFwianNvblwiLFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb3VyY2VfdHlwZTogcmVzVHlwZVxyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24gKHJlc3VsdCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzdWx0LmNvZGUgPT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlc291cmNlTGlzdCA9IHJlc3VsdC5kYXRhLnJlc291cmNlX2xpc3QsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaHRtbFN0ciA9IFwiXCI7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCRwcml2YXRlLnBhZ2VUeXBlID09IDEgJiYgJHByaXZhdGUucmVzVHlwZSA9PSByZXNUeXBlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaHRtbFN0ciArPVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnPG9wdGlvbiB2YWx1ZT1cIicrJHByaXZhdGUucmVzSWQrJ1wiIHNlbGVjdGVkPicrJHByaXZhdGUucmVzTmFtZSsnPC9vcHRpb24+JztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICQuZWFjaChyZXNvdXJjZUxpc3QsIGZ1bmN0aW9uIChrLCB2KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlc05hbWUgPSAocmVzVHlwZT09NT92Lm5hbWU6di50aXRsZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaHRtbFN0ciArPVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnPG9wdGlvbiB2YWx1ZT1cIicrdi5pZCsnXCI+JytyZXNOYW1lKyc8L29wdGlvbj4nO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaHRtbFN0ci5sZW5ndGggPT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxTdHIgPVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnPG9wdGlvbiB2YWx1ZT1cIi0xXCI+5pqC5peg5pWw5o2uPC9vcHRpb24+JztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICQoXCIjcmVzSXRlbVNlbGVjdG9yXCIpLmh0bWwoaHRtbFN0cik7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYmFzZVV0aWxzLnNob3cucmVkVGlwKFwi572R57uc6Zeu6aKY77yM6K+356iN5ZCO5YaN6K+VXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogZnVuY3Rpb24gKHhociwgc3RhdHVzLCBlcnIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYWxlcnQoXCLmnI3liqHlmajlh7rlsI/lt67kuobvvIzor7fnqI3lkI7lho3or5XvvIFcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIC8vIHJhZGlvIOaMiemSrueCueWHu+WIh+aNouaViOaenFxyXG4gICAgICAgICQoJy5yZW1pbmRSYWRpbycpLm9uKCdjbGljaycsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAkKCcucmVtaW5kUmFkaW8nKS5jaGlsZHJlbignLmNpcmNsZVJhZGlvJykucmVtb3ZlQ2xhc3MoJ3JhZGlvQWN0aXZlJyk7XHJcbiAgICAgICAgICAgICQodGhpcykuY2hpbGRyZW4oJy5jaXJjbGVSYWRpbycpLmFkZENsYXNzKCdyYWRpb0FjdGl2ZScpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICAkKFwiI2NhbmNlbFNhdmVFeGVyY2lzZVwiKS5jbGljayhmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHdpbmRvdy5oaXN0b3J5LmJhY2soKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgJChcIiNjb25maXJtU2F2ZUV4ZXJjaXNlXCIpLmNsaWNrKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIGV4ZXJjaXNlQm9va05hbWUgPSAkLnRyaW0oJChcIiNleGVyY2lzZUJvb2tOYW1lXCIpLnZhbCgpKSxcclxuICAgICAgICAgICAgICAgIHJlc0lkID0gJChcIiNyZXNJdGVtU2VsZWN0b3JcIikudmFsKCksXHJcbiAgICAgICAgICAgICAgICByZXNUeXBlID0gJChcIiNyZXNUeXBlU2VsZWN0b3JcIikudmFsKCksXHJcbiAgICAgICAgICAgICAgICByZXNOYW1lID0gJChcIiNyZXNJdGVtU2VsZWN0b3IgPiBvcHRpb246c2VsZWN0ZWRcIikudGV4dCgpLFxyXG4gICAgICAgICAgICAgICAgY29tbXVuaXR5SWQgPSAkKFwiI2NvbW11bml0eVNlbGVjdG9yXCIpLnZhbCgpLFxyXG4gICAgICAgICAgICAgICAgaXNSZW1pbmQgPSAkKFwiLmNpcmNsZVJhZGlvLnJhZGlvQWN0aXZlXCIpLmRhdGEoXCJpc19yZW1pbmRcIiksIC8vIDEgLSDmj5DphpLvvIwgMCAtIOS4jeaPkOmGkjzpu5jorqTkuI3mj5DphpI+XHJcbiAgICAgICAgICAgICAgICBwb3N0VXJsID0gXCJcIjtcclxuXHJcbiAgICAgICAgICAgIGlzUmVtaW5kID0gMDsgICAvLyAgVE9ETyDmmoLml7blhYjorr7nva7kuLrkuI3mj5DphpJcclxuXHJcbiAgICAgICAgICAgIGlmIChleGVyY2lzZUJvb2tOYW1lLmxlbmd0aCA9PSAwKSB7XHJcbiAgICAgICAgICAgICAgICBiYXNlVXRpbHMuc2hvdy5yZWRUaXAoXCLov5jmsqHmnInovpPlhaXkvZzkuJrmnKzlkI3np7BcIik7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGV4ZXJjaXNlQm9va05hbWUubGVuZ3RoID4gMTQpIHtcclxuICAgICAgICAgICAgICAgIGJhc2VVdGlscy5zaG93LnJlZFRpcChcIuS9nOS4muacrOWQjeensOmVv+W6puS4jeiDvei2hei/hzE05a2XXCIpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChyZXNJZCA9PSAtMSkge1xyXG4gICAgICAgICAgICAgICAgYmFzZVV0aWxzLnNob3cucmVkVGlwKFwi6L+Y5rKh5pyJ6YCJ5oup5YW35L2T6K++56iLXCIpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB2YXIgcGFyYW1zID0ge1xyXG4gICAgICAgICAgICAgICAgdGl0bGU6IGV4ZXJjaXNlQm9va05hbWUsXHJcbiAgICAgICAgICAgICAgICByZXNvdXJjZV9pZDogcmVzSWQsXHJcbiAgICAgICAgICAgICAgICByZXNvdXJjZV90eXBlOiByZXNUeXBlLFxyXG4gICAgICAgICAgICAgICAgcmVzb3VyY2VfbmFtZTogcmVzTmFtZSxcclxuICAgICAgICAgICAgICAgIGlzX2VuYWJsZV9ub3RpZnk6IGlzUmVtaW5kXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGNvbW11bml0eUlkICE9IC0xICYmIGNvbW11bml0eUlkICE9IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgcGFyYW1zLmNvbW11bml0eV9pZCA9IGNvbW11bml0eUlkO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICgkcHJpdmF0ZS5wYWdlVHlwZSA9PSAwKSB7ICAgICAgICAgICAgLy/liJvlu7pcclxuICAgICAgICAgICAgICAgIHBvc3RVcmwgPSBcIi9leGVyY2lzZS91cGxvYWRfZXhlcmNpc2VfYm9va1wiO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKCRwcml2YXRlLnBhZ2VUeXBlID09IDEpIHsgICAgIC8v57yW6L6RXHJcbiAgICAgICAgICAgICAgICBwb3N0VXJsID0gXCIvZXhlcmNpc2UvdXBkYXRlX2V4ZXJjaXNlX2Jvb2tcIjtcclxuICAgICAgICAgICAgICAgIHBhcmFtcy5leGVyY2lzZV9ib29rX2lkID0gR2V0UXVlcnlTdHJpbmcoXCJleGVyY2lzZV9ib29rX2lkXCIpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCIgcGFnZVR5cGUg5Y+C5pWw5pyJ6K+v44CCXCIpO1xyXG4gICAgICAgICAgICAgICAgYmFzZVV0aWxzLnNob3cucmVkVGlwKFwi572R57uc6ZSZ6K+v77yM6K+356iN5ZCO5YaN6K+VXCIpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICgkcHJpdmF0ZS5zdWJtaXRMaW1pdCkge1xyXG4gICAgICAgICAgICAgICAgYmFzZVV0aWxzLnNob3cucmVkVGlwKFwi5q2j5Zyo5o+Q5Lqk5Lit77yM6K+356iN5ZCO5YaN6K+VXCIpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICRwcml2YXRlLnN1Ym1pdExpbWl0ID0gdHJ1ZTtcclxuICAgICAgICAgICAgJC5hamF4KHBvc3RVcmwsIHtcclxuICAgICAgICAgICAgICAgIHR5cGU6IFwiUE9TVFwiLFxyXG4gICAgICAgICAgICAgICAgZGF0YVR5cGU6IFwianNvblwiLFxyXG4gICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgIHBhcmFtczogcGFyYW1zXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24gKHJlc3VsdCkge1xyXG4gICAgICAgICAgICAgICAgICAgICRwcml2YXRlLnN1Ym1pdExpbWl0ID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3VsdC5jb2RlID09IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYmFzZVV0aWxzLnNob3cuYmx1ZVRpcChcIuWIm+W7uuS9nOS4muacrOaIkOWKn1wiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9IFwiL2V4ZXJjaXNlL2V4ZXJjaXNlX2Jvb2tfbGlzdFwiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LCAxMDAwKTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhbGVydChcIue9kee7nOmXrumimO+8jOivt+eojeWQjuWGjeivlVwiKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgZXJyb3I6IGZ1bmN0aW9uICh4aHIsIHN0YXR1cywgZXJyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHByaXZhdGUuc3VibWl0TGltaXQgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xyXG4gICAgICAgICAgICAgICAgICAgIGFsZXJ0KFwi5pyN5Yqh5Zmo5Ye65bCP5beu5LqG77yM6K+356iN5ZCO5YaN6K+V77yBXCIpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgfTtcclxuXHJcbiAgICByZXR1cm4gJG1hbmFnZUV4ZXJjaXNlO1xyXG59KSgpO1xyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcbiJdfQ==
