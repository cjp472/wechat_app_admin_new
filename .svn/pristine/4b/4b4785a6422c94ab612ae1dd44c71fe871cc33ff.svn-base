$(document).ready(function(){$goodsList.init()});var $goodsList=function(){var e=$("#_mainContentPart"),o={},i="edit",t=new Array;var s={goodsCount:$("#addDistributeGoods").data("count"),init:function(){e.on("click","#addDistributeGoods",function(){var e=$("._switchOperateArea").data("switch_state");if(!e){$chosenShop.showOpenChosenTip();return false}if(s.goodsCount>=20){baseUtils.show.redTip("添加的推广商品数量已达到20个，不能再添加");return false}baseUtils.showWindow("_addDistributeGoodsWindow");s.getDistributeGoodsContent()});$("#_addDistributeGoodsWindow").on("click","._HeaderIcon, #_cancelAddDistributeGoods",function(){baseUtils.hideWindow("_addDistributeGoodsWindow")});$("#_addDistributeGoodsWindow").on("click","._addGoodsWindowTableItem",function(){var e=$(this).children("._selectSingleDistributeGoods"),o=e.prop("checked");if(!o){var i=s.goodsCount+$("#_addGoodsWindowTableBody").find("._selectSingleDistributeGoods:checked").length;if(i>=20){baseUtils.show.redTip("添加的推广商品数量已达到20个，不能再添加");return false}}e.prop("checked",!o)});$("#_addDistributeGoodsWindow").on("click","#_searchDistributeGoods",function(){var e=$.trim($("#_searchDistributeGoodsInput").val());s.getDistributeGoodsContent(e)});$("#_searchDistributeGoodsInput").on("keypress",function(e){if(e.keyCode==13){$("#_searchDistributeGoods").click()}});$("#_confirmAddDistributeGoods").click(function(){$("#_addGoodsWindowTableBody").find("._selectSingleDistributeGoods:checked").each(function(){var e={id:$(this).data("resource_id"),type:$(this).data("resource_type")};t.push(e)});if(s.goodsCount+t.length>20){baseUtils.show.redTip("添加的推广商品数量不能超过20个");return false}baseUtils.showLoading("addDistributeGoodsLoading");$.ajax("/chosen/add_resource_chosen",{type:"POST",dataType:"json",data:{params:t},success:function(e){baseUtils.hideLoading("addDistributeGoodsLoading");if(e.code==0){baseUtils.hideWindow("_addDistributeGoodsWindow");baseUtils.show.blueTip("保存成功");if(s.goodsCount==0){$.alert("您最多可添加20个商品，且商品添加后不支持删除，请谨慎选择。<br>您可以继续添加商品和设置商品相关属性","info",{btn:2,onOk:function(){$chosenShop.getNewPage("goods")}})}else{$chosenShop.getNewPage("goods")}}else{baseUtils.show.redTip("操作失败，请稍后再试")}},error:function(e,o,i){baseUtils.hideLoading("addDistributeGoodsLoading");console.log(i);alert("服务器出小差了，请稍后再试！")}})});e.on("click",".setGradient",function(){var e=$(this).parents(".tableBodyItem").data("resource_id"),t=$(this).parents(".tableBodyItem").data("resource_type"),s=$(this).data("type");o={resId:e,resType:t};if(s=="set"){$("#_setGoodsGradientWindow ._windowEditableValue").val("");i="set"}else if(s=="edit"){i="edit";var d=$(this).data("distribute_data");$("#_windowValue1").val(d.end1);$("#_windowValue2").val(d.start2);$("#_windowValue3").val(d.end2);$("#_windowValue4").val(d.start3);$("#_windowRatio1").val(d.percent1);$("#_windowRatio2").val(d.percent2);$("#_windowRatio3").val(d.percent3)}baseUtils.showWindow("_setGoodsGradientWindow")});$("#_setGoodsGradientWindow").on("click","._HeaderIcon, #_windowCancelBtn",function(){baseUtils.hideWindow("_setGoodsGradientWindow")});$("#_setGoodsGradientWindow").on("keyup","._windowEditableValue",function(){var e=$(this).attr("id");if(e=="_windowValue1"){$("#_windowValue2").val(+$.trim($("#_windowValue1").val())+1)}else if(e=="_windowValue3"){$("#_windowValue4").val(+$.trim($("#_windowValue3").val())+1)}});$("#_setGoodsGradientWindow").on("click","#_windowConfirmBtn",function(){var e=parseInt($("#_windowValue1").val()),t=parseInt($("#_windowValue2").val()),s=parseInt($("#_windowValue3").val()),d=parseInt($("#_windowValue4").val()),a=parseInt($("#_windowRatio1").val()),n=parseInt($("#_windowRatio2").val()),r=parseInt($("#_windowRatio3").val());if(!e||!t||!s||!d||!a||!n||!r){baseUtils.show.redTip("数据没有填写完整哦");return false}if(e+1!=t||s+1!=d||t>=s||e<=1){baseUtils.show.redTip("区间填写有误，请检查后重试");return false}if(a<=0||a>n||n>r){baseUtils.show.redTip("分成比例填写有误，请参考示例");return false}if(a>99||n>99||r>99){baseUtils.show.redTip("分成比例不能超过99%");return false}var l={data1:{end_order_num:e,distribute_percent:a},data2:{start_order_num:t,end_order_num:s,distribute_percent:n},data3:{start_order_num:d,distribute_percent:r},resource_id:o.resId,resource_type:o.resType,edit:i=="edit"?"edit":"set"};$.ajax("/chosen/set_xiaoe_distribute",{type:"POST",dataType:"json",data:l,success:function(e){if(e.code==0){baseUtils.show.blueTip("梯度设置成功");baseUtils.hideWindow("_setGoodsGradientWindow");$chosenShop.getNewPage("goods")}else{baseUtils.show.redTip("梯度设置失败，请稍后再试")}},error:function(e,o,i){console.log(i);baseUtils.show.redTip("服务器出小差了，请稍后再试！")}})});e.on("change",".selectChosenGoodsClass",function(){var e=$(this),o=e.children("option:selected"),i=o.val(),t=o.text();if(i==-1){console.log(i+" - "+t);return false}var s=e.parents(".tableBodyItem"),d=s.data("resource_id"),a=s.data("resource_type"),n=s.data("old_class_id")||-1;$.ajax("/chosen/set_classify",{type:"POST",dataType:"json",data:{class_id:i,resource_id:d,resource_type:a},success:function(o){if(o.code==0){baseUtils.show.blueTip("设置分类成功。")}else{baseUtils.show.redTip("设置分类失败。");e.val(n)}},error:function(e,o,i){console.log(i);alert("服务器出小差了，请稍后再试！")}})});e.find(".qrCodeImage").each(function(){var e=$(this).data("url"),o=$(this).attr("id");createQrCode(o,e,160,160)})},getDistributeGoodsContent:function(e){baseUtils.showLoading("addDistributeGoodsLoading");$.ajax("/chosen/search_resource",{type:"POST",dataType:"json",data:{search:e||""},success:function(e){var o="";$.each(e,function(e,i){o+='<div class="_addGoodsWindowTableItem clearfix">'+'<input type="checkbox" class="_selectSingleDistributeGoods" '+'data-resource_id="'+i.id+'" data-resource_type="'+i.type+'">'+'<div class="_singleDistributeGoodsCover">'+'<img src="'+i.img_url_compressed+'">'+"</div>"+'<div class="_singleDistributeGoodsTitle" title="'+i.name+'">'+i.name+"</div>"+'<div class="_singleDistributeGoodsTime">'+i.created_at+"</div>"+"</div>"});if(o.length==0){o="<div class='contentNoData'>暂无数据</div>"}$("#_addGoodsWindowTableBody").html(o);$("#_addGoodsWindowTableBody").scrollTop(0);baseUtils.hideLoading("addDistributeGoodsLoading")},error:function(e,o,i){console.log(i);alert("服务器出小差了，请稍后再试！")}})},checkInputValue:function(e){var o=$(e).val();o=o.replace(/[^\d]/g,"");o=o.replace(/^0[\d]+/g,"0");$(e).val(o)}};return s}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFkbWluL2Nob3Nlbi9nb29kc0xpc3QuanMiXSwibmFtZXMiOlsiJCIsImRvY3VtZW50IiwicmVhZHkiLCIkZ29vZHNMaXN0IiwiaW5pdCIsIiRob21lUGFnZSIsInNldEdyYWRpZW50SW5mbyIsInNldEdyYWRpZW50V2luZG93U3RhdGUiLCJhZGRSZXNvdXJjZVBhcmFtcyIsIkFycmF5IiwiZ29vZHNDb3VudCIsImRhdGEiLCJvbiIsInN3aXRjaFN0YXRlIiwiJGNob3NlblNob3AiLCJzaG93T3BlbkNob3NlblRpcCIsImJhc2VVdGlscyIsInNob3ciLCJyZWRUaXAiLCJzaG93V2luZG93IiwiZ2V0RGlzdHJpYnV0ZUdvb2RzQ29udGVudCIsImhpZGVXaW5kb3ciLCIkdGFyZ2V0IiwidGhpcyIsImNoaWxkcmVuIiwiY3VycmVudFN0YXRlIiwicHJvcCIsImFsbENvdW50IiwiZmluZCIsImxlbmd0aCIsInNlYXJjaENvbnRlbnQiLCJ0cmltIiwidmFsIiwiZSIsImtleUNvZGUiLCJjbGljayIsImVhY2giLCJvYmoiLCJpZCIsInR5cGUiLCJwdXNoIiwic2hvd0xvYWRpbmciLCJhamF4IiwiZGF0YVR5cGUiLCJwYXJhbXMiLCJzdWNjZXNzIiwicmVzdWx0IiwiaGlkZUxvYWRpbmciLCJjb2RlIiwiYmx1ZVRpcCIsImFsZXJ0IiwiYnRuIiwib25PayIsImdldE5ld1BhZ2UiLCJlcnJvciIsInhociIsInN0YXR1cyIsImVyciIsImNvbnNvbGUiLCJsb2ciLCJyZXNJZCIsInBhcmVudHMiLCJyZXNUeXBlIiwiZGlzdHJpYnV0ZURhdGEiLCJlbmQxIiwic3RhcnQyIiwiZW5kMiIsInN0YXJ0MyIsInBlcmNlbnQxIiwicGVyY2VudDIiLCJwZXJjZW50MyIsImF0dHIiLCJ2YWx1ZTEiLCJwYXJzZUludCIsInZhbHVlMiIsInZhbHVlMyIsInZhbHVlNCIsInJhdGlvMSIsInJhdGlvMiIsInJhdGlvMyIsImRhdGExIiwiZW5kX29yZGVyX251bSIsImRpc3RyaWJ1dGVfcGVyY2VudCIsImRhdGEyIiwic3RhcnRfb3JkZXJfbnVtIiwiZGF0YTMiLCJyZXNvdXJjZV9pZCIsInJlc291cmNlX3R5cGUiLCJlZGl0IiwiJHNlbGVjdCIsIiRvcHRpb24iLCJjbGFzc0lkIiwiY2xhc3NOYW1lIiwidGV4dCIsIiRkZWxlZ2F0ZSIsIm9sZENsYXNzSWQiLCJjbGFzc19pZCIsInFyQ29kZVVybCIsImNyZWF0ZVFyQ29kZSIsInNlYXJjaCIsImh0bWxTdHIiLCJrIiwidiIsImltZ191cmxfY29tcHJlc3NlZCIsIm5hbWUiLCJjcmVhdGVkX2F0IiwiaHRtbCIsInNjcm9sbFRvcCIsImNoZWNrSW5wdXRWYWx1ZSIsImN1cnJlbnREb20iLCJ2YWx1ZSIsInJlcGxhY2UiXSwibWFwcGluZ3MiOiJBQUNBQSxFQUFFQyxVQUFVQyxNQUFNLFdBQ2ZDLFdBQVdDLFFBR2QsSUFBSUQsWUFBYSxXQUViLEdBQUlFLEdBQVlMLEVBQUUscUJBQ2RNLEtBQ0FDLEVBQXlCLE9BQ3pCQyxFQUFvQixHQUFJQyxNQUU1QixJQUFJTixJQUVBTyxXQUFZVixFQUFFLHVCQUF1QlcsS0FBSyxTQUUxQ1AsS0FBTSxXQUtGQyxFQUFVTyxHQUFHLFFBQVMsc0JBQXVCLFdBRXpDLEdBQUlDLEdBQWNiLEVBQUUsdUJBQXVCVyxLQUFLLGVBQ2hELEtBQUtFLEVBQWEsQ0FDZEMsWUFBWUMsbUJBQ1osT0FBTyxPQUVYLEdBQUlaLEVBQVdPLFlBQWMsR0FBSSxDQUM3Qk0sVUFBVUMsS0FBS0MsT0FBTyx3QkFDdEIsT0FBTyxPQUVYRixVQUFVRyxXQUFXLDRCQUNyQmhCLEdBQVdpQiw2QkFHZnBCLEdBQUUsOEJBQThCWSxHQUFHLFFBQVMsMkNBQTRDLFdBQ3BGSSxVQUFVSyxXQUFXLDhCQUV6QnJCLEdBQUUsOEJBQThCWSxHQUFHLFFBQVMsNEJBQTZCLFdBQ3JFLEdBQUlVLEdBQVV0QixFQUFFdUIsTUFBTUMsU0FBUyxpQ0FDM0JDLEVBQWVILEVBQVFJLEtBQUssVUFDaEMsS0FBS0QsRUFBYyxDQUNmLEdBQUlFLEdBQVd4QixF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LnJlYWR5KGZ1bmN0aW9uICgpIHtcclxuICAgJGdvb2RzTGlzdC5pbml0KCk7XHJcbn0pO1xyXG5cclxudmFyICRnb29kc0xpc3QgPSAoZnVuY3Rpb24gKCkge1xyXG5cclxuICAgIHZhciAkaG9tZVBhZ2UgPSAkKFwiI19tYWluQ29udGVudFBhcnRcIiksXHJcbiAgICAgICAgc2V0R3JhZGllbnRJbmZvID0ge30sXHJcbiAgICAgICAgc2V0R3JhZGllbnRXaW5kb3dTdGF0ZSA9IFwiZWRpdFwiLCAgICAgICAgIC8vXCJlZGl0XCIsIFwic2V0XCJcclxuICAgICAgICBhZGRSZXNvdXJjZVBhcmFtcyA9IG5ldyBBcnJheTsgICAgICAgICAvL+a3u+WKoOeyvumAieWVhuWTgeeahOaOpeWPo+WPguaVsFxyXG5cclxuICAgIHZhciAkZ29vZHNMaXN0ID0ge1xyXG5cclxuICAgICAgICBnb29kc0NvdW50OiAkKFwiI2FkZERpc3RyaWJ1dGVHb29kc1wiKS5kYXRhKFwiY291bnRcIiksXHJcblxyXG4gICAgICAgIGluaXQ6IGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICAgICAgICAgIC8qKioqKioqKioqKioqKioqKioqKioqKiDmt7vliqDmjqjlub/llYblk4Hnqpflj6MgKioqKioqKioqKioqKioqKioqKioqKioqKi9cclxuXHJcbiAgICAgICAgICAgIC8v5omT5byA5re75Yqg5o6o5bm/5ZWG5ZOB56qX5Y+jXHJcbiAgICAgICAgICAgICRob21lUGFnZS5vbihcImNsaWNrXCIsIFwiI2FkZERpc3RyaWJ1dGVHb29kc1wiLCBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgdmFyIHN3aXRjaFN0YXRlID0gJChcIi5fc3dpdGNoT3BlcmF0ZUFyZWFcIikuZGF0YShcInN3aXRjaF9zdGF0ZVwiKTsvL+W9k+WJjeeKtuaAgVxyXG4gICAgICAgICAgICAgICAgaWYgKCFzd2l0Y2hTdGF0ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICRjaG9zZW5TaG9wLnNob3dPcGVuQ2hvc2VuVGlwKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKCRnb29kc0xpc3QuZ29vZHNDb3VudCA+PSAyMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGJhc2VVdGlscy5zaG93LnJlZFRpcChcIua3u+WKoOeahOaOqOW5v+WVhuWTgeaVsOmHj+W3sui+vuWIsDIw5Liq77yM5LiN6IO95YaN5re75YqgXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGJhc2VVdGlscy5zaG93V2luZG93KFwiX2FkZERpc3RyaWJ1dGVHb29kc1dpbmRvd1wiKTtcclxuICAgICAgICAgICAgICAgICRnb29kc0xpc3QuZ2V0RGlzdHJpYnV0ZUdvb2RzQ29udGVudCgpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgLy/lhbPpl63mt7vliqDmjqjlub/llYblk4Hnqpflj6NcclxuICAgICAgICAgICAgJChcIiNfYWRkRGlzdHJpYnV0ZUdvb2RzV2luZG93XCIpLm9uKFwiY2xpY2tcIiwgXCIuX0hlYWRlckljb24sICNfY2FuY2VsQWRkRGlzdHJpYnV0ZUdvb2RzXCIsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIGJhc2VVdGlscy5oaWRlV2luZG93KFwiX2FkZERpc3RyaWJ1dGVHb29kc1dpbmRvd1wiKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICQoXCIjX2FkZERpc3RyaWJ1dGVHb29kc1dpbmRvd1wiKS5vbihcImNsaWNrXCIsIFwiLl9hZGRHb29kc1dpbmRvd1RhYmxlSXRlbVwiLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgJHRhcmdldCA9ICQodGhpcykuY2hpbGRyZW4oXCIuX3NlbGVjdFNpbmdsZURpc3RyaWJ1dGVHb29kc1wiKSxcclxuICAgICAgICAgICAgICAgICAgICBjdXJyZW50U3RhdGUgPSAkdGFyZ2V0LnByb3AoXCJjaGVja2VkXCIpO1xyXG4gICAgICAgICAgICAgICAgaWYgKCFjdXJyZW50U3RhdGUpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgYWxsQ291bnQgPSAkZ29vZHNMaXN0Lmdvb2RzQ291bnQgKyAkKFwiI19hZGRHb29kc1dpbmRvd1RhYmxlQm9keVwiKS5maW5kKFwiLl9zZWxlY3RTaW5nbGVEaXN0cmlidXRlR29vZHM6Y2hlY2tlZFwiKS5sZW5ndGg7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGFsbENvdW50ID49IDIwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJhc2VVdGlscy5zaG93LnJlZFRpcChcIua3u+WKoOeahOaOqOW5v+WVhuWTgeaVsOmHj+W3sui+vuWIsDIw5Liq77yM5LiN6IO95YaN5re75YqgXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgJHRhcmdldC5wcm9wKFwiY2hlY2tlZFwiLCAhY3VycmVudFN0YXRlKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIC8v5re75Yqg5o6o5bm/5ZWG5ZOB56qX5Y+j5pCc57Si5ZWG5ZOBXHJcbiAgICAgICAgICAgICQoXCIjX2FkZERpc3RyaWJ1dGVHb29kc1dpbmRvd1wiKS5vbihcImNsaWNrXCIsIFwiI19zZWFyY2hEaXN0cmlidXRlR29vZHNcIiwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHNlYXJjaENvbnRlbnQgPSAkLnRyaW0oJChcIiNfc2VhcmNoRGlzdHJpYnV0ZUdvb2RzSW5wdXRcIikudmFsKCkpO1xyXG4gICAgICAgICAgICAgICAgJGdvb2RzTGlzdC5nZXREaXN0cmlidXRlR29vZHNDb250ZW50KHNlYXJjaENvbnRlbnQpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgJChcIiNfc2VhcmNoRGlzdHJpYnV0ZUdvb2RzSW5wdXRcIikub24oXCJrZXlwcmVzc1wiLCBmdW5jdGlvbiAoZSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGUua2V5Q29kZSA9PSAxMykge1xyXG4gICAgICAgICAgICAgICAgICAgICQoXCIjX3NlYXJjaERpc3RyaWJ1dGVHb29kc1wiKS5jbGljaygpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgLy/kv53lrZjmjqjlub/llYblk4Hnqpflj6PlhoXlrrlcclxuICAgICAgICAgICAgJChcIiNfY29uZmlybUFkZERpc3RyaWJ1dGVHb29kc1wiKS5jbGljayhmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAkKFwiI19hZGRHb29kc1dpbmRvd1RhYmxlQm9keVwiKS5maW5kKFwiLl9zZWxlY3RTaW5nbGVEaXN0cmlidXRlR29vZHM6Y2hlY2tlZFwiKS5lYWNoKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgb2JqID0ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZDogJCh0aGlzKS5kYXRhKFwicmVzb3VyY2VfaWRcIiksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICQodGhpcykuZGF0YShcInJlc291cmNlX3R5cGVcIilcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgYWRkUmVzb3VyY2VQYXJhbXMucHVzaChvYmopO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICBpZiAoJGdvb2RzTGlzdC5nb29kc0NvdW50ICsgYWRkUmVzb3VyY2VQYXJhbXMubGVuZ3RoID4gMjApIHtcclxuICAgICAgICAgICAgICAgICAgICBiYXNlVXRpbHMuc2hvdy5yZWRUaXAoXCLmt7vliqDnmoTmjqjlub/llYblk4HmlbDph4/kuI3og73otoXov4cyMOS4qlwiKTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBiYXNlVXRpbHMuc2hvd0xvYWRpbmcoXCJhZGREaXN0cmlidXRlR29vZHNMb2FkaW5nXCIpO1xyXG4gICAgICAgICAgICAgICAgJC5hamF4KFwiL2Nob3Nlbi9hZGRfcmVzb3VyY2VfY2hvc2VuXCIsIHtcclxuICAgICAgICAgICAgICAgICAgICB0eXBlOiBcIlBPU1RcIixcclxuICAgICAgICAgICAgICAgICAgICBkYXRhVHlwZTogXCJqc29uXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBwYXJhbXM6IGFkZFJlc291cmNlUGFyYW1zLFxyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24gKHJlc3VsdCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBiYXNlVXRpbHMuaGlkZUxvYWRpbmcoXCJhZGREaXN0cmlidXRlR29vZHNMb2FkaW5nXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzdWx0LmNvZGUgPT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYmFzZVV0aWxzLmhpZGVXaW5kb3coXCJfYWRkRGlzdHJpYnV0ZUdvb2RzV2luZG93XCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYmFzZVV0aWxzLnNob3cuYmx1ZVRpcChcIuS/neWtmOaIkOWKn1wiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkZ29vZHNMaXN0Lmdvb2RzQ291bnQgPT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICQuYWxlcnQoXCLmgqjmnIDlpJrlj6/mt7vliqAyMOS4quWVhuWTge+8jOS4lOWVhuWTgea3u+WKoOWQjuS4jeaUr+aMgeWIoOmZpO+8jOivt+iwqOaFjumAieaLqeOAgjxicj7mgqjlj6/ku6Xnu6fnu63mt7vliqDllYblk4Hlkozorr7nva7llYblk4Hnm7jlhbPlsZ7mgKdcIiwgXCJpbmZvXCIsIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnRuOiAyLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbk9rOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkY2hvc2VuU2hvcC5nZXROZXdQYWdlKFwiZ29vZHNcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRjaG9zZW5TaG9wLmdldE5ld1BhZ2UoXCJnb29kc1wiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhc2VVdGlscy5zaG93LnJlZFRpcChcIuaTjeS9nOWksei0pe+8jOivt+eojeWQjuWGjeivlVwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6IGZ1bmN0aW9uICh4aHIsIHN0YXR1cywgZXJyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJhc2VVdGlscy5oaWRlTG9hZGluZyhcImFkZERpc3RyaWJ1dGVHb29kc0xvYWRpbmdcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFsZXJ0KFwi5pyN5Yqh5Zmo5Ye65bCP5beu5LqG77yM6K+356iN5ZCO5YaN6K+V77yBXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuXHJcbiAgICAgICAgICAgIC8qKioqKioqKioqKioqKioqKioqKioqKiDorr7nva7moq/luqbnqpflj6MgKioqKioqKioqKioqKioqKioqKioqKioqKi9cclxuXHJcbiAgICAgICAgICAgIC8v5omT5byA6K6+572u5qKv5bqm56qX5Y+jXHJcbiAgICAgICAgICAgICRob21lUGFnZS5vbihcImNsaWNrXCIsIFwiLnNldEdyYWRpZW50XCIsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHZhciByZXNJZCA9ICQodGhpcykucGFyZW50cyhcIi50YWJsZUJvZHlJdGVtXCIpLmRhdGEoXCJyZXNvdXJjZV9pZFwiKSxcclxuICAgICAgICAgICAgICAgICAgICByZXNUeXBlID0gJCh0aGlzKS5wYXJlbnRzKFwiLnRhYmxlQm9keUl0ZW1cIikuZGF0YShcInJlc291cmNlX3R5cGVcIiksXHJcbiAgICAgICAgICAgICAgICAgICAgdHlwZSA9ICQodGhpcykuZGF0YShcInR5cGVcIik7XHJcbiAgICAgICAgICAgICAgICBzZXRHcmFkaWVudEluZm8gPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVzSWQgOiByZXNJZCxcclxuICAgICAgICAgICAgICAgICAgICByZXNUeXBlOiByZXNUeXBlXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAodHlwZSA9PSBcInNldFwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJChcIiNfc2V0R29vZHNHcmFkaWVudFdpbmRvdyAuX3dpbmRvd0VkaXRhYmxlVmFsdWVcIikudmFsKFwiXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIHNldEdyYWRpZW50V2luZG93U3RhdGUgPSBcInNldFwiO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0eXBlID09IFwiZWRpdFwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2V0R3JhZGllbnRXaW5kb3dTdGF0ZSA9IFwiZWRpdFwiO1xyXG4gICAgICAgICAgICAgICAgICAgIC8v5Zue5pi+5Y6f5p2l55qE5pWw5o2uXHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGRpc3RyaWJ1dGVEYXRhID0gJCh0aGlzKS5kYXRhKFwiZGlzdHJpYnV0ZV9kYXRhXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICQoXCIjX3dpbmRvd1ZhbHVlMVwiKS52YWwoZGlzdHJpYnV0ZURhdGEuZW5kMSk7XHJcbiAgICAgICAgICAgICAgICAgICAgJChcIiNfd2luZG93VmFsdWUyXCIpLnZhbChkaXN0cmlidXRlRGF0YS5zdGFydDIpO1xyXG4gICAgICAgICAgICAgICAgICAgICQoXCIjX3dpbmRvd1ZhbHVlM1wiKS52YWwoZGlzdHJpYnV0ZURhdGEuZW5kMik7XHJcbiAgICAgICAgICAgICAgICAgICAgJChcIiNfd2luZG93VmFsdWU0XCIpLnZhbChkaXN0cmlidXRlRGF0YS5zdGFydDMpO1xyXG4gICAgICAgICAgICAgICAgICAgICQoXCIjX3dpbmRvd1JhdGlvMVwiKS52YWwoZGlzdHJpYnV0ZURhdGEucGVyY2VudDEpO1xyXG4gICAgICAgICAgICAgICAgICAgICQoXCIjX3dpbmRvd1JhdGlvMlwiKS52YWwoZGlzdHJpYnV0ZURhdGEucGVyY2VudDIpO1xyXG4gICAgICAgICAgICAgICAgICAgICQoXCIjX3dpbmRvd1JhdGlvM1wiKS52YWwoZGlzdHJpYnV0ZURhdGEucGVyY2VudDMpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgYmFzZVV0aWxzLnNob3dXaW5kb3coXCJfc2V0R29vZHNHcmFkaWVudFdpbmRvd1wiKTtcclxuXHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgLy/lhbPpl63orr7nva7moq/luqbnqpflj6NcclxuICAgICAgICAgICAgJChcIiNfc2V0R29vZHNHcmFkaWVudFdpbmRvd1wiKS5vbihcImNsaWNrXCIsIFwiLl9IZWFkZXJJY29uLCAjX3dpbmRvd0NhbmNlbEJ0blwiLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBiYXNlVXRpbHMuaGlkZVdpbmRvdyhcIl9zZXRHb29kc0dyYWRpZW50V2luZG93XCIpO1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIC8v5YWz6IGU6K6+572u5qKv5bqm56qX5Y+jaW5wdXTlgLxcclxuICAgICAgICAgICAgJChcIiNfc2V0R29vZHNHcmFkaWVudFdpbmRvd1wiKS5vbihcImtleXVwXCIsIFwiLl93aW5kb3dFZGl0YWJsZVZhbHVlXCIsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHZhciBpZCA9ICQodGhpcykuYXR0cihcImlkXCIpO1xyXG4gICAgICAgICAgICAgICAgaWYgKGlkID09IFwiX3dpbmRvd1ZhbHVlMVwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJChcIiNfd2luZG93VmFsdWUyXCIpLnZhbCgrJC50cmltKCQoXCIjX3dpbmRvd1ZhbHVlMVwiKS52YWwoKSkrMSk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGlkID09IFwiX3dpbmRvd1ZhbHVlM1wiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJChcIiNfd2luZG93VmFsdWU0XCIpLnZhbCgrJC50cmltKCQoXCIjX3dpbmRvd1ZhbHVlM1wiKS52YWwoKSkrMSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgLy/kv53lrZjorr7nva7moq/luqZcclxuICAgICAgICAgICAgJChcIiNfc2V0R29vZHNHcmFkaWVudFdpbmRvd1wiKS5vbihcImNsaWNrXCIsIFwiI193aW5kb3dDb25maXJtQnRuXCIsIGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgdmFsdWUxID0gcGFyc2VJbnQoJChcIiNfd2luZG93VmFsdWUxXCIpLnZhbCgpKSxcclxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTIgPSBwYXJzZUludCgkKFwiI193aW5kb3dWYWx1ZTJcIikudmFsKCkpLFxyXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlMyA9IHBhcnNlSW50KCQoXCIjX3dpbmRvd1ZhbHVlM1wiKS52YWwoKSksXHJcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU0ID0gcGFyc2VJbnQoJChcIiNfd2luZG93VmFsdWU0XCIpLnZhbCgpKSxcclxuICAgICAgICAgICAgICAgICAgICByYXRpbzEgPSBwYXJzZUludCgkKFwiI193aW5kb3dSYXRpbzFcIikudmFsKCkpLFxyXG4gICAgICAgICAgICAgICAgICAgIHJhdGlvMiA9IHBhcnNlSW50KCQoXCIjX3dpbmRvd1JhdGlvMlwiKS52YWwoKSksXHJcbiAgICAgICAgICAgICAgICAgICAgcmF0aW8zID0gcGFyc2VJbnQoJChcIiNfd2luZG93UmF0aW8zXCIpLnZhbCgpKTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoIXZhbHVlMSB8fCAhdmFsdWUyIHx8ICF2YWx1ZTMgfHwgIXZhbHVlNCB8fCAhcmF0aW8xIHx8ICFyYXRpbzIgfHwgIXJhdGlvMykge1xyXG4gICAgICAgICAgICAgICAgICAgIGJhc2VVdGlscy5zaG93LnJlZFRpcChcIuaVsOaNruayoeacieWhq+WGmeWujOaVtOWTplwiKTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZigoKCB2YWx1ZTEgKyAxKSAhPSB2YWx1ZTIpIHx8ICgoIHZhbHVlMyArIDEpICE9IHZhbHVlNCkgfHwgKHZhbHVlMiA+PSB2YWx1ZTMpIHx8ICh2YWx1ZTEgPD0gMSkpe1xyXG4gICAgICAgICAgICAgICAgICAgIGJhc2VVdGlscy5zaG93LnJlZFRpcCgn5Yy66Ze05aGr5YaZ5pyJ6K+v77yM6K+35qOA5p+l5ZCO6YeN6K+VJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYoKHJhdGlvMSA8PSAwKSB8fCAocmF0aW8xID4gcmF0aW8yKSB8fCAocmF0aW8yID4gcmF0aW8zKSl7XHJcbiAgICAgICAgICAgICAgICAgICAgYmFzZVV0aWxzLnNob3cucmVkVGlwKCfliIbmiJDmr5TkvovloavlhpnmnInor6/vvIzor7flj4LogIPnpLrkvosnKTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAocmF0aW8xPjk5IHx8IHJhdGlvMiA+IDk5IHx8IHJhdGlvMyA+IDk5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYmFzZVV0aWxzLnNob3cucmVkVGlwKFwi5YiG5oiQ5q+U5L6L5LiN6IO96LaF6L+HOTklXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHZhciBwYXJhbXMgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YTE6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZW5kX29yZGVyX251bTogdmFsdWUxLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkaXN0cmlidXRlX3BlcmNlbnQ6IHJhdGlvMSxcclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGEyOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXJ0X29yZGVyX251bTogdmFsdWUyLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBlbmRfb3JkZXJfbnVtOiB2YWx1ZTMsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRpc3RyaWJ1dGVfcGVyY2VudDogcmF0aW8yLFxyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YTM6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc3RhcnRfb3JkZXJfbnVtOiB2YWx1ZTQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRpc3RyaWJ1dGVfcGVyY2VudDogcmF0aW8zLFxyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgcmVzb3VyY2VfaWQ6IHNldEdyYWRpZW50SW5mby5yZXNJZCxcclxuICAgICAgICAgICAgICAgICAgICByZXNvdXJjZV90eXBlOiBzZXRHcmFkaWVudEluZm8ucmVzVHlwZSxcclxuICAgICAgICAgICAgICAgICAgICBlZGl0OiBzZXRHcmFkaWVudFdpbmRvd1N0YXRlID09IFwiZWRpdFwiID8gXCJlZGl0XCIgOiBcInNldFwiLFxyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICQuYWpheChcIi9jaG9zZW4vc2V0X3hpYW9lX2Rpc3RyaWJ1dGVcIiwge1xyXG4gICAgICAgICAgICAgICAgICAgIHR5cGU6IFwiUE9TVFwiLFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGFUeXBlOiBcImpzb25cIixcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiBwYXJhbXMsXHJcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24gKHJlc3VsdCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzdWx0LmNvZGUgPT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYmFzZVV0aWxzLnNob3cuYmx1ZVRpcChcIuair+W6puiuvue9ruaIkOWKn1wiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhc2VVdGlscy5oaWRlV2luZG93KFwiX3NldEdvb2RzR3JhZGllbnRXaW5kb3dcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkY2hvc2VuU2hvcC5nZXROZXdQYWdlKFwiZ29vZHNcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiYXNlVXRpbHMuc2hvdy5yZWRUaXAoXCLmoq/luqborr7nva7lpLHotKXvvIzor7fnqI3lkI7lho3or5VcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiBmdW5jdGlvbiAoeGhyLCBzdGF0dXMsIGVycikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBiYXNlVXRpbHMuc2hvdy5yZWRUaXAoXCLmnI3liqHlmajlh7rlsI/lt67kuobvvIzor7fnqI3lkI7lho3or5XvvIFcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAvKioqKioqKioqKioqKioqKioqKioqKiog6K6+572u5YiG57G7ICoqKioqKioqKioqKioqKioqKioqKioqKiovXHJcblxyXG4gICAgICAgICAgICAkaG9tZVBhZ2Uub24oXCJjaGFuZ2VcIiwgXCIuc2VsZWN0Q2hvc2VuR29vZHNDbGFzc1wiLCBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgdmFyICRzZWxlY3QgPSAkKHRoaXMpLFxyXG4gICAgICAgICAgICAgICAgICAgICRvcHRpb24gPSAkc2VsZWN0LmNoaWxkcmVuKFwib3B0aW9uOnNlbGVjdGVkXCIpLFxyXG4gICAgICAgICAgICAgICAgICAgIGNsYXNzSWQgPSAkb3B0aW9uLnZhbCgpLFxyXG4gICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZSA9ICRvcHRpb24udGV4dCgpO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmIChjbGFzc0lkID09IC0xKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coY2xhc3NJZCArIFwiIC0gXCIgKyBjbGFzc05hbWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHZhciAkZGVsZWdhdGUgPSAkc2VsZWN0LnBhcmVudHMoXCIudGFibGVCb2R5SXRlbVwiKSxcclxuICAgICAgICAgICAgICAgICAgICByZXNJZCA9ICRkZWxlZ2F0ZS5kYXRhKFwicmVzb3VyY2VfaWRcIiksXHJcbiAgICAgICAgICAgICAgICAgICAgcmVzVHlwZSA9ICRkZWxlZ2F0ZS5kYXRhKFwicmVzb3VyY2VfdHlwZVwiKSxcclxuICAgICAgICAgICAgICAgICAgICBvbGRDbGFzc0lkID0gJGRlbGVnYXRlLmRhdGEoXCJvbGRfY2xhc3NfaWRcIikgfHwgLTE7XHJcblxyXG4gICAgICAgICAgICAgICAgJC5hamF4KFwiL2Nob3Nlbi9zZXRfY2xhc3NpZnlcIiwge1xyXG4gICAgICAgICAgICAgICAgICAgIHR5cGU6IFwiUE9TVFwiLFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGFUeXBlOiBcImpzb25cIixcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzX2lkOiBjbGFzc0lkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvdXJjZV9pZDogcmVzSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc291cmNlX3R5cGU6IHJlc1R5cGUsXHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbiAocmVzdWx0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXN1bHQuY29kZSA9PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiYXNlVXRpbHMuc2hvdy5ibHVlVGlwKFwi6K6+572u5YiG57G75oiQ5Yqf44CCXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYmFzZVV0aWxzLnNob3cucmVkVGlwKFwi6K6+572u5YiG57G75aSx6LSl44CCXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNlbGVjdC52YWwob2xkQ2xhc3NJZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiBmdW5jdGlvbiAoeGhyLCBzdGF0dXMsIGVycikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhbGVydChcIuacjeWKoeWZqOWHuuWwj+W3ruS6hu+8jOivt+eojeWQjuWGjeivle+8gVwiKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIC8qKioqKioqKioqKioqKioqKioqKioqKiDnlJ/miJDpooTop4jkuoznu7TnoIEgKioqKioqKioqKioqKioqKioqKioqKioqKi9cclxuXHJcbiAgICAgICAgICAgICRob21lUGFnZS5maW5kKFwiLnFyQ29kZUltYWdlXCIpLmVhY2goZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHFyQ29kZVVybCA9ICQodGhpcykuZGF0YShcInVybFwiKSxcclxuICAgICAgICAgICAgICAgICAgICBpZCA9ICQodGhpcykuYXR0cihcImlkXCIpO1xyXG5cclxuICAgICAgICAgICAgICAgIGNyZWF0ZVFyQ29kZShpZCwgcXJDb2RlVXJsLCAxNjAsIDE2MCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuXHJcblxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZ2V0RGlzdHJpYnV0ZUdvb2RzQ29udGVudDogZnVuY3Rpb24gKHNlYXJjaENvbnRlbnQpIHtcclxuICAgICAgICAgICAgYmFzZVV0aWxzLnNob3dMb2FkaW5nKFwiYWRkRGlzdHJpYnV0ZUdvb2RzTG9hZGluZ1wiKTtcclxuICAgICAgICAgICAgJC5hamF4KFwiL2Nob3Nlbi9zZWFyY2hfcmVzb3VyY2VcIiwge1xyXG4gICAgICAgICAgICAgICAgdHlwZTogXCJQT1NUXCIsXHJcbiAgICAgICAgICAgICAgICBkYXRhVHlwZTogXCJqc29uXCIsXHJcbiAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VhcmNoOiBzZWFyY2hDb250ZW50IHx8IFwiXCIsXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24gKHJlc3VsdCkge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB2YXIgaHRtbFN0ciA9IFwiXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgJC5lYWNoKHJlc3VsdCwgZnVuY3Rpb24gKGssIHYpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaHRtbFN0ciArPVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJfYWRkR29vZHNXaW5kb3dUYWJsZUl0ZW0gY2xlYXJmaXhcIj4nICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnPGlucHV0IHR5cGU9XCJjaGVja2JveFwiIGNsYXNzPVwiX3NlbGVjdFNpbmdsZURpc3RyaWJ1dGVHb29kc1wiICcgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGF0YS1yZXNvdXJjZV9pZD1cIicrdi5pZCsnXCIgZGF0YS1yZXNvdXJjZV90eXBlPVwiJyt2LnR5cGUrJ1wiPicgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwiX3NpbmdsZURpc3RyaWJ1dGVHb29kc0NvdmVyXCI+JyArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICc8aW1nIHNyYz1cIicgKyB2LmltZ191cmxfY29tcHJlc3NlZCArICdcIj4nICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnPC9kaXY+JyArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJfc2luZ2xlRGlzdHJpYnV0ZUdvb2RzVGl0bGVcIiB0aXRsZT1cIicrdi5uYW1lKydcIj4nK3YubmFtZSsnPC9kaXY+JyArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJfc2luZ2xlRGlzdHJpYnV0ZUdvb2RzVGltZVwiPicrdi5jcmVhdGVkX2F0Kyc8L2Rpdj4nICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICc8L2Rpdj4nO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChodG1sU3RyLmxlbmd0aCA9PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxTdHIgPSBcIjxkaXYgY2xhc3M9J2NvbnRlbnROb0RhdGEnPuaaguaXoOaVsOaNrjwvZGl2PlwiO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAkKFwiI19hZGRHb29kc1dpbmRvd1RhYmxlQm9keVwiKS5odG1sKGh0bWxTdHIpO1xyXG4gICAgICAgICAgICAgICAgICAgICQoXCIjX2FkZEdvb2RzV2luZG93VGFibGVCb2R5XCIpLnNjcm9sbFRvcCgwKTtcclxuICAgICAgICAgICAgICAgICAgICBiYXNlVXRpbHMuaGlkZUxvYWRpbmcoXCJhZGREaXN0cmlidXRlR29vZHNMb2FkaW5nXCIpO1xyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIGVycm9yOiBmdW5jdGlvbiAoeGhyLCBzdGF0dXMsIGVycikge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycik7XHJcbiAgICAgICAgICAgICAgICAgICAgYWxlcnQoXCLmnI3liqHlmajlh7rlsI/lt67kuobvvIzor7fnqI3lkI7lho3or5XvvIFcIik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICB9LFxyXG4gICAgICAgIGNoZWNrSW5wdXRWYWx1ZTogZnVuY3Rpb24gKGN1cnJlbnREb20pIHtcclxuXHJcbiAgICAgICAgICAgIHZhciB2YWx1ZSA9ICQoY3VycmVudERvbSkudmFsKCk7XHJcblxyXG4gICAgICAgICAgICAvL+a4hemZpFwi5pWw5a2XXCLlkoxcIi5cIuS7peWklueahOWtl+esplxyXG4gICAgICAgICAgICB2YWx1ZSA9IHZhbHVlLnJlcGxhY2UoL1teXFxkXS9nLCBcIlwiKTtcclxuICAgICAgICAgICAgLy/muIXpmaQw5ZCO6Z2i55qE5pWw5a2XXHJcbiAgICAgICAgICAgIHZhbHVlID0gdmFsdWUucmVwbGFjZSgvXjBbXFxkXSsvZywgXCIwXCIpO1xyXG5cclxuICAgICAgICAgICAgJChjdXJyZW50RG9tKS52YWwodmFsdWUpO1xyXG5cclxuICAgICAgICB9LFxyXG5cclxuXHJcblxyXG4gICAgfTtcclxuXHJcbiAgICByZXR1cm4gJGdvb2RzTGlzdDtcclxuXHJcbn0pKCk7Il19
