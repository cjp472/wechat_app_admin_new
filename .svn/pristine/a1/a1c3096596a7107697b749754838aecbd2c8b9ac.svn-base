(function(i,e,t,s){e(function(){new n});function n(i){this.options=i||{};this.app_id=e("#app_id").val();this.pay_verify=e("#pay_verify").val();this.is_update=e("#is_update").val();this.change=GetQueryString("change");this.init()}n.prototype={init:function(){var i=this;this.authHandle();if(this.pay_verify==0){if(this.is_update==0){e("#updateBindBtn").click(function(){e.get("/mini/updateBind",function(i){if(i.code==0){reloadPage()}else{console.error(i.msg);reloadPage()}},"json")})}else{e("#experUrlCode").attr("src",miniexperUrl+this.app_id);var t=new QRCode(document.getElementById("H5UrlCode"),{text:e("#H5Url").val(),width:135,height:135,colorDark:"#000000",colorLight:"#ffffff",correctLevel:QRCode.CorrectLevel.H});e("#screenBtn").click(function(){e.post("/mini/userCheck",function(i){console.log(i);if(i.code==0){e.alert("用户验证成功，您的小程序即将提交微信审核，请耐心等待!","success",{title:"验证成功",btn:2,onOk:function(){window.location.reload()}})}else{console.error(i.msg);e.alert("用户验证失败，请确认您关联至开放平台的小程序和服务号与授权信息一致。或者请重新使用管理员微信扫描两个二维码。确认无误仍无法验证成功，请联系产品鹅微信：chanpine2","error",{title:"",btn:2})}},"json")})}}else{if(this.change==1){this.editInfo()}}e("#editImg").click(this.editInfo.bind(this));e("#saveMer").click(this.saveMer.bind(this));e("#resubmitAudit").click(this.reSubmitAudit.bind(this))},authHandle:function(){var i=this.app_id;e("#reAuth").click(t);e("#bindSuccess").click(function(){window.location.reload()});e("#bindFail").click(t);function t(){var t=window.open("","_blank");e.post("/mini/authority ",{app_id:i,reAuth:1},function(s){if(s.code==0){t.location.href=miniauthUrl+i;e("#bindModal").modal("show")}else{baseUtils.show.redTip("系统繁忙")}},"json")}},editInfo:function(){e("#setMiniInfo input").prop("disabled",false).removeClass("disEdit");e("#saveMer").parent().removeClass("hide")},editsuccess:function(){e("#setMiniInfo input").prop("disabled",true).addClass("disEdit");e("#saveMer").parent().addClass("hide");if(e("#editImg").hasClass("hide")){e("#editImg").removeClass("hide")}if(!e("#pay_set_hint").hasClass("hide")){e("#pay_set_hint").addClass("hide")}e.alert("小程序正在开发中，等待提交审核，约1个工作日，请耐心等待","success",{title:"设置成功",btn:2})},saveMer:function(){var i=e.trim(e("#wx_mchid").val()),t=e.trim(e("#wx_mchkey").val()),s=this;if(i==""){baseUtils.show.redTip("商户号不能为空");return false}if(t==""){baseUtils.show.redTip("API密钥不能为空");return false}e.post("/mini/merchant",{wx_mchid:i,wx_mchkey:t},function(i){if(i.code==0){s.editsuccess()}else{baseUtils.show.redTip(i.msg)}},"json")},reSubmitAudit:function(){var i=e("#app_id").val();e.alert("请确认已按照审核失败原因进行修改并重新提交审核!","info",{title:"",btn:3,oktext:"提交审核",onOk:function(){e.post("/mini/resubmitAudit ",{app_id:i},function(i){if(i.code==0){baseUtils.show.blueTip("提交审核成功");window.location.reload()}else{baseUtils.show.redTip("提交审核失败")}},"json")}})}}})(window,window.$,document);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZm8uanMiXSwibmFtZXMiOlsid2luIiwiJCIsImRvYyIsInVuZGVmaW5lZCIsIlBlcnNvbiIsIm9wdGlvbnMiLCJ0aGlzIiwiYXBwX2lkIiwidmFsIiwicGF5X3ZlcmlmeSIsImlzX3VwZGF0ZSIsImNoYW5nZSIsIkdldFF1ZXJ5U3RyaW5nIiwiaW5pdCIsInByb3RvdHlwZSIsInNlbGYiLCJhdXRoSGFuZGxlIiwiY2xpY2siLCJnZXQiLCJqc29uIiwiY29kZSIsInJlbG9hZFBhZ2UiLCJjb25zb2xlIiwiZXJyb3IiLCJtc2ciLCJhdHRyIiwibWluaWV4cGVyVXJsIiwicXJjb2RlIiwiUVJDb2RlIiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsInRleHQiLCJ3aWR0aCIsImhlaWdodCIsImNvbG9yRGFyayIsImNvbG9yTGlnaHQiLCJjb3JyZWN0TGV2ZWwiLCJDb3JyZWN0TGV2ZWwiLCJIIiwicG9zdCIsImxvZyIsImFsZXJ0IiwidGl0bGUiLCJidG4iLCJvbk9rIiwid2luZG93IiwibG9jYXRpb24iLCJyZWxvYWQiLCJlZGl0SW5mbyIsImJpbmQiLCJzYXZlTWVyIiwicmVTdWJtaXRBdWRpdCIsInNob3dOZXdXaW4iLCJuZXdXaW4iLCJvcGVuIiwicmVBdXRoIiwiaHJlZiIsIm1pbmlhdXRoVXJsIiwibW9kYWwiLCJiYXNlVXRpbHMiLCJzaG93IiwicmVkVGlwIiwicHJvcCIsInJlbW92ZUNsYXNzIiwicGFyZW50IiwiZWRpdHN1Y2Nlc3MiLCJhZGRDbGFzcyIsImhhc0NsYXNzIiwid3hfbWNoaWQiLCJ0cmltIiwid3hfbWNoa2V5Iiwib2t0ZXh0IiwiYmx1ZVRpcCJdLCJtYXBwaW5ncyI6IkNBQUEsU0FBV0EsRUFBS0MsRUFBR0MsRUFBS0MsR0FDcEJGLEVBQUUsV0FDRSxHQUFJRyxJQUlSLFNBQVNBLEdBQU9DLEdBQ1pDLEtBQUtELFFBQVVBLEtBQ2ZDLE1BQUtDLE9BQVNOLEVBQUUsV0FBV08sS0FDM0JGLE1BQUtHLFdBQWFSLEVBQUUsZUFBZU8sS0FDbkNGLE1BQUtJLFVBQVlULEVBQUUsY0FBY08sS0FDakNGLE1BQUtLLE9BQVNDLGVBQWUsU0FDN0JOLE1BQUtPLE9BR1RULEVBQU9VLFdBQ0hELEtBQU0sV0FDRixHQUFJRSxHQUFPVCxJQUNYQSxNQUFLVSxZQUVMLElBQUlWLEtBQUtHLFlBQWMsRUFBRyxDQUN0QixHQUFJSCxLQUFLSSxXQUFhLEVBQUcsQ0FDckJULEVBQUUsa0JBQWtCZ0IsTUFBTSxXQUN0QmhCLEVBQUVpQixJQUFJLG1CQUFvQixTQUFVQyxHQUVoQyxHQUFJQSxFQUFLQyxNQUFRLEVBQUcsQ0FDaEJDLGlCQUNHLENBQ0hDLFFBQVFDLE1BQU1KLEVBQUtLLElBQ25CSCxnQkFFTCxjQUVKLENBQ0hwQixFQUFFLGlCQUFpQndCLEtBQUssTUFBT0MsYUFBZXBCLEtBQUtDLE9BQ25ELElBQUlvQixHQUFTLEdBQUlDLFFBQU9DLFNBQVNDLGVBQWUsY0FDNUNDLEtBQU05QixFQUFFLFVBQVVPLE1BQ2xCd0IsTUFBTyxJQUNQQyxPQUFRLElBQ1JDLFVBQVcsVUFDWEMsV0FBWSxVQUNaQyxhQUFjUixPQUFPUyxhQUFhQyxHQUV0Q3JDLEdBQUUsY0FBY2dCLE1BQU0sV0FDbEJoQixFQUFFc0MsS0FBSyxrQkFBbUIsU0FBVXBCLEdBQ2hDRyxRQUFRa0IsSUFBSXJCLEVBQ1osSUFBSUEsRUFBS0MsTUFBUSxFQUFHLENBTWhCbkIsRUFBRXdDLE1BQU0sOEJBQStCLFdBQ25DQyxNQUFPLE9BQ1BDLElBQUssRUFDTEMsS0FBSyxXQUNEQyxPQUFPQyxTQUFTQyxnQkFHckIsQ0FFSHpCLFFBQVFDLE1BQU1KLEVBQUtLLElBQ25CdkIsR0FBRXdDLE1BQU0sdUZBQ0osU0FFSUMsTUFBTyxHQUNQQyxJQUFLLE1BR2xCLGVBR1IsQ0FDSCxHQUFJckMsS0FBS0ssUUFBVSxFQUFHLENBQ2xCTCxLQUFLMEMsWUFJYi9DLEVBQUUsWUFBWWdCLE1BQU1YLEtBQUswQyxTQUFTQyxLQUFLM0MsTUFFdkNMLEdBQUUsWUFBWWdCLE1BQU1YLEtBQUs0QyxRQUFRRCxLQUFLM0MsTUFFdENMLEdBQUUsa0JBQWtCZ0IsTUFBTVgsS0FBSzZDLGNBQWNGLEtBQUszQyxRQUd0RFUsV0FBWSxXQUNSLEdBQUlULEdBQVNELEtBQUtDLE1BRWxCTixHQUFFLFdBQVdnQixNQUFNbUMsRUFHbkJuRCxHQUFFLGdCQUFnQmdCLE1BQU0sV0FDcEI0QixPQUFPQyxTQUFTQyxVQUlwQjlDLEdBQUUsYUFBYWdCLE1BQU1tQyxFQUVyQixTQUFTQSxLQUNMLEdBQUlDLEdBQVNSLE9BQU9TLEtBQUssR0FBSSxTQUU3QnJELEdBQUVzQyxLQUFLLG9CQUFxQmhDLE9BQVVBLEVBQU9nRCxPQUFTLEdBQUksU0FBVXBDLEdBQ2hFLEdBQUlBLEVBQUtDLE1BQVEsRUFBRyxDQUNoQmlDLEVBQU9QLFNBQVNVLEtBQU9DLFlBQWNsRCxDQUNyQ04sR0FBRSxjQUFjeUQsTUFBTSxZQUNuQixDQUNIQyxVQUFVQyxLQUFLQyxPQUFPLFVBRTNCLFVBR1hiLFNBQVUsV0FDTi9DLEVBQUUsc0JBQXNCNkQsS0FBSyxXQUFZLE9BQU9DLFlBQVksVUFDNUQ5RCxHQUFFLFlBQVkrRCxTQUFTRCxZQUFZLFNBRXZDRSxZQUFhLFdBQ1RoRSxFQUFFLHNCQUFzQjZELEtBQUssV0FBWSxNQUFNSSxTQUFTLFVBQ3hEakUsR0FBRSxZQUFZK0QsU0FBU0UsU0FBUyxPQUNoQyxJQUFJakUsRUFBRSxZQUFZa0UsU0FBUyxRQUFTLENBQ2hDbEUsRUFBRSxZQUFZOEQsWUFBWSxRQUU5QixJQUFNOUQsRUFBRSxpQkFBaUJrRSxTQUFTLFFBQVUsQ0FDeENsRSxFQUFFLGlCQUFpQmlFLFNBQVMsUUFHaENqRSxFQUFFd0MsTUFBTSwrQkFDSixXQUVJQyxNQUFPLE9BQ1BDLElBQUssS0FHakJPLFFBQVMsV0FDTCxHQUFJa0IsR0FBV25FLEVBQUVvRSxLQUFLcEUsRUFBRSxhQUFhTyxPQUNqQzhELEVBQVlyRSxFQUFFb0UsS0FBS3BFLEVBQUUsY0FBY08sT0FDbkNPLEVBQU9ULElBQ1gsSUFBSThELEdBQVksR0FBSSxDQUNoQlQsVUFBVUMsS0FBS0MsT0FBTyxVQUN0QixPQUFPLE9BRVgsR0FBSVMsR0FBYSxHQUFJLENBQ2pCWCxVQUFVQyxLQUFLQyxPQUFPLFlBQ3RCLE9BQU8sT0FFWDVELEVBQUVzQyxLQUFLLGtCQUNINkIsU0FBVUEsRUFDVkUsVUFBV0EsR0FDWixTQUFVbkQsR0FDVCxHQUFJQSxFQUFLQyxNQUFRLEVBQUcsQ0FDaEJMLEVBQUtrRCxrQkFDRixDQUNITixVQUFVQyxLQUFLQyxPQUFPMUMsRUFBS0ssT0FFaEMsU0FFUDJCLGNBQWMsV0FDVixHQUFJNUMsR0FBU04sRUFBRSxXQUFXTyxLQUMxQlAsR0FBRXdDLE1BQU0sMkJBQTRCLFFBQ2hDQyxNQUFPLEdBQ1BDLElBQUssRUFDTDRCLE9BQU8sT0FDUDNCLEtBQUssV0FDRDNDLEVBQUVzQyxLQUFLLHdCQUF5QmhDLE9BQVVBLEdBQVMsU0FBVVksR0FDekQsR0FBSUEsRUFBS0MsTUFBUSxFQUFHLENBQ2hCdUMsVUFBVUMsS0FBS1ksUUFBUSxTQUN2QjNCLFFBQU9DLFNBQVNDLGFBQ2IsQ0FDSFksVUFBVUMsS0FBS0MsT0FBTyxZQUUzQixlQVFwQmhCLE9BQVFBLE9BQU81QyxFQUFHNEIiLCJmaWxlIjoiaW5mby5qcyIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiAod2luLCAkLCBkb2MsIHVuZGVmaW5lZCkge1xyXG4gICAgJChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgbmV3IFBlcnNvbigpO1xyXG4gICAgfSk7XHJcblxyXG5cclxuICAgIGZ1bmN0aW9uIFBlcnNvbihvcHRpb25zKSB7XHJcbiAgICAgICAgdGhpcy5vcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcclxuICAgICAgICB0aGlzLmFwcF9pZCA9ICQoJyNhcHBfaWQnKS52YWwoKTtcclxuICAgICAgICB0aGlzLnBheV92ZXJpZnkgPSAkKCcjcGF5X3ZlcmlmeScpLnZhbCgpO1xyXG4gICAgICAgIHRoaXMuaXNfdXBkYXRlID0gJCgnI2lzX3VwZGF0ZScpLnZhbCgpO1xyXG4gICAgICAgIHRoaXMuY2hhbmdlID0gR2V0UXVlcnlTdHJpbmcoJ2NoYW5nZScpO1xyXG4gICAgICAgIHRoaXMuaW5pdCgpO1xyXG4gICAgfVxyXG5cclxuICAgIFBlcnNvbi5wcm90b3R5cGUgPSB7XHJcbiAgICAgICAgaW5pdDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgICAgIHRoaXMuYXV0aEhhbmRsZSgpO1xyXG5cclxuICAgICAgICAgICAgaWYgKHRoaXMucGF5X3ZlcmlmeSA9PSAwKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5pc191cGRhdGUgPT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICQoJyN1cGRhdGVCaW5kQnRuJykuY2xpY2soZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkLmdldCgnL21pbmkvdXBkYXRlQmluZCcsIGZ1bmN0aW9uIChqc29uKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGpzb24uY29kZSA9PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVsb2FkUGFnZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGpzb24ubXNnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWxvYWRQYWdlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sICdqc29uJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJCgnI2V4cGVyVXJsQ29kZScpLmF0dHIoJ3NyYycsIG1pbmlleHBlclVybCArIHRoaXMuYXBwX2lkKTtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgcXJjb2RlID0gbmV3IFFSQ29kZShkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcIkg1VXJsQ29kZVwiKSwge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0ZXh0OiAkKCcjSDVVcmwnKS52YWwoKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg6IDEzNSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgaGVpZ2h0OiAxMzUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbG9yRGFyazogXCIjMDAwMDAwXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbG9yTGlnaHQ6IFwiI2ZmZmZmZlwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb3JyZWN0TGV2ZWw6IFFSQ29kZS5Db3JyZWN0TGV2ZWwuSFxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICQoJyNzY3JlZW5CdG4nKS5jbGljayhmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICQucG9zdCgnL21pbmkvdXNlckNoZWNrJywgZnVuY3Rpb24gKGpzb24pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGpzb24pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGpzb24uY29kZSA9PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gYmFzZVV0aWxzLnNob3cuYmx1ZVRpcCgn6aqM6K+B5oiQ5YqfJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gJCgnI25vdFNjcmVlbkNvZGUnKS5hZGRDbGFzcygnaGlkZScpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vICQoJyNoYXNTY3JlZW5Db2RlJykucmVtb3ZlQ2xhc3MoJ2hpZGUnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyAkKCcjc2V0TWluaUluZm8nKS5yZW1vdmVDbGFzcygnaGlkZScpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHNlbGYuZWRpdEluZm8oKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkLmFsZXJ0KFwi55So5oi36aqM6K+B5oiQ5Yqf77yM5oKo55qE5bCP56iL5bqP5Y2z5bCG5o+Q5Lqk5b6u5L+h5a6h5qC477yM6K+36ICQ5b+D562J5b6FIVwiLCAnc3VjY2VzcycsIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU6ICfpqozor4HmiJDlip8nLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBidG46IDIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uT2s6ZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLnJlbG9hZCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGJhc2VVdGlscy5zaG93LnJlZFRpcChqc29uLm1zZyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihqc29uLm1zZyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJC5hbGVydCgn55So5oi36aqM6K+B5aSx6LSl77yM6K+356Gu6K6k5oKo5YWz6IGU6Iez5byA5pS+5bmz5Y+w55qE5bCP56iL5bqP5ZKM5pyN5Yqh5Y+35LiO5o6I5p2D5L+h5oGv5LiA6Ie044CC5oiW6ICF6K+36YeN5paw5L2/55So566h55CG5ZGY5b6u5L+h5omr5o+P5Lik5Liq5LqM57u056CB44CC56Gu6K6k5peg6K+v5LuN5peg5rOV6aqM6K+B5oiQ5Yqf77yM6K+36IGU57O75Lqn5ZOB6bmF5b6u5L+h77yaY2hhbnBpbmUyJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2Vycm9yJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU6ICcnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnRuOiAyXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LCAnanNvbicpXHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5jaGFuZ2UgPT0gMSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZWRpdEluZm8oKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgJCgnI2VkaXRJbWcnKS5jbGljayh0aGlzLmVkaXRJbmZvLmJpbmQodGhpcykpO1xyXG5cclxuICAgICAgICAgICAgJCgnI3NhdmVNZXInKS5jbGljayh0aGlzLnNhdmVNZXIuYmluZCh0aGlzKSk7XHJcblxyXG4gICAgICAgICAgICAkKFwiI3Jlc3VibWl0QXVkaXRcIikuY2xpY2sodGhpcy5yZVN1Ym1pdEF1ZGl0LmJpbmQodGhpcykpO1xyXG5cclxuICAgICAgICB9LFxyXG4gICAgICAgIGF1dGhIYW5kbGU6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIGFwcF9pZCA9IHRoaXMuYXBwX2lkO1xyXG4gICAgICAgICAgICAvL+mHjeaWsOaOiOadg+eCueWHu1xyXG4gICAgICAgICAgICAkKFwiI3JlQXV0aFwiKS5jbGljayhzaG93TmV3V2luKTtcclxuXHJcbiAgICAgICAgICAgIC8v5o6I5p2D5oiQ5Yqf5oyJ6ZKu54K55Ye75Yi35pawXHJcbiAgICAgICAgICAgICQoXCIjYmluZFN1Y2Nlc3NcIikuY2xpY2soZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLnJlbG9hZCgpO1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIC8v5o6I5p2D5aSx6LSl77yM57un57ut5by55Ye6XHJcbiAgICAgICAgICAgICQoXCIjYmluZEZhaWxcIikuY2xpY2soc2hvd05ld1dpbik7XHJcblxyXG4gICAgICAgICAgICBmdW5jdGlvbiBzaG93TmV3V2luKCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIG5ld1dpbiA9IHdpbmRvdy5vcGVuKCcnLCAnX2JsYW5rJyk7XHJcblxyXG4gICAgICAgICAgICAgICAgJC5wb3N0KFwiL21pbmkvYXV0aG9yaXR5IFwiLCB7XCJhcHBfaWRcIjogYXBwX2lkLFwicmVBdXRoXCI6MX0sIGZ1bmN0aW9uIChqc29uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGpzb24uY29kZSA9PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ld1dpbi5sb2NhdGlvbi5ocmVmID0gbWluaWF1dGhVcmwgKyBhcHBfaWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICQoXCIjYmluZE1vZGFsXCIpLm1vZGFsKFwic2hvd1wiKTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBiYXNlVXRpbHMuc2hvdy5yZWRUaXAoXCLns7vnu5/nuYHlv5lcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSwgJ2pzb24nKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZWRpdEluZm86IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgJCgnI3NldE1pbmlJbmZvIGlucHV0JykucHJvcCgnZGlzYWJsZWQnLCBmYWxzZSkucmVtb3ZlQ2xhc3MoJ2Rpc0VkaXQnKTtcclxuICAgICAgICAgICAgJCgnI3NhdmVNZXInKS5wYXJlbnQoKS5yZW1vdmVDbGFzcygnaGlkZScpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZWRpdHN1Y2Nlc3M6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgJCgnI3NldE1pbmlJbmZvIGlucHV0JykucHJvcCgnZGlzYWJsZWQnLCB0cnVlKS5hZGRDbGFzcygnZGlzRWRpdCcpO1xyXG4gICAgICAgICAgICAkKCcjc2F2ZU1lcicpLnBhcmVudCgpLmFkZENsYXNzKCdoaWRlJyk7XHJcbiAgICAgICAgICAgIGlmICgkKFwiI2VkaXRJbWdcIikuaGFzQ2xhc3MoXCJoaWRlXCIpKSB7XHJcbiAgICAgICAgICAgICAgICAkKFwiI2VkaXRJbWdcIikucmVtb3ZlQ2xhc3MoXCJoaWRlXCIpOyAvL+S/neWtmOaUr+S7mOmFjee9ruaIkOWKnyzmmL7npLrnvJbovpHmjInpkq5cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoISgkKFwiI3BheV9zZXRfaGludFwiKS5oYXNDbGFzcyhcImhpZGVcIikpKSB7XHJcbiAgICAgICAgICAgICAgICAkKFwiI3BheV9zZXRfaGludFwiKS5hZGRDbGFzcyhcImhpZGVcIik7IC8v6ZqQ6JeP5pSv5LuY6YWN572u5o+Q56S6XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICQuYWxlcnQoJ+Wwj+eoi+W6j+ato+WcqOW8gOWPkeS4re+8jOetieW+heaPkOS6pOWuoeaguO+8jOe6pjHkuKrlt6XkvZzml6XvvIzor7fogJDlv4PnrYnlvoUnLFxyXG4gICAgICAgICAgICAgICAgJ3N1Y2Nlc3MnLFxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIHRpdGxlOiAn6K6+572u5oiQ5YqfJyxcclxuICAgICAgICAgICAgICAgICAgICBidG46IDJcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgc2F2ZU1lcjogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgd3hfbWNoaWQgPSAkLnRyaW0oJCgnI3d4X21jaGlkJykudmFsKCkpLFxyXG4gICAgICAgICAgICAgICAgd3hfbWNoa2V5ID0gJC50cmltKCQoJyN3eF9tY2hrZXknKS52YWwoKSksXHJcbiAgICAgICAgICAgICAgICBzZWxmID0gdGhpcztcclxuICAgICAgICAgICAgaWYgKHd4X21jaGlkID09ICcnKSB7XHJcbiAgICAgICAgICAgICAgICBiYXNlVXRpbHMuc2hvdy5yZWRUaXAoJ+WVhuaIt+WPt+S4jeiDveS4uuepuicpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICh3eF9tY2hrZXkgPT0gJycpIHtcclxuICAgICAgICAgICAgICAgIGJhc2VVdGlscy5zaG93LnJlZFRpcCgnQVBJ5a+G6ZKl5LiN6IO95Li656m6Jyk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgJC5wb3N0KCcvbWluaS9tZXJjaGFudCcsIHtcclxuICAgICAgICAgICAgICAgIHd4X21jaGlkOiB3eF9tY2hpZCxcclxuICAgICAgICAgICAgICAgIHd4X21jaGtleTogd3hfbWNoa2V5XHJcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIChqc29uKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoanNvbi5jb2RlID09IDApIHtcclxuICAgICAgICAgICAgICAgICAgICBzZWxmLmVkaXRzdWNjZXNzKCk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGJhc2VVdGlscy5zaG93LnJlZFRpcChqc29uLm1zZyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sICdqc29uJyk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICByZVN1Ym1pdEF1ZGl0OmZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIGFwcF9pZCA9ICQoJyNhcHBfaWQnKS52YWwoKTtcclxuICAgICAgICAgICAgJC5hbGVydChcIuivt+ehruiupOW3suaMieeFp+WuoeaguOWksei0peWOn+WboOi/m+ihjOS/ruaUueW5tumHjeaWsOaPkOS6pOWuoeaguCFcIiwgJ2luZm8nLCB7XHJcbiAgICAgICAgICAgICAgICB0aXRsZTogJycsXHJcbiAgICAgICAgICAgICAgICBidG46IDMsXHJcbiAgICAgICAgICAgICAgICBva3RleHQ6XCLmj5DkuqTlrqHmoLhcIixcclxuICAgICAgICAgICAgICAgIG9uT2s6ZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICQucG9zdChcIi9taW5pL3Jlc3VibWl0QXVkaXQgXCIsIHtcImFwcF9pZFwiOiBhcHBfaWR9LCBmdW5jdGlvbiAoanNvbikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoanNvbi5jb2RlID09IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhc2VVdGlscy5zaG93LmJsdWVUaXAoXCLmj5DkuqTlrqHmoLjmiJDlip9cIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24ucmVsb2FkKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiYXNlVXRpbHMuc2hvdy5yZWRUaXAoXCLmj5DkuqTlrqHmoLjlpLHotKVcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9LCAnanNvbicpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuXHJcbn0pKHdpbmRvdywgd2luZG93LiQsIGRvY3VtZW50KTsiXX0=
