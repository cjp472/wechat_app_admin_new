$(function(){manageArticle.init()});var manageArticle=function(){var e={};var t;function a(e){if($formCheck.emptyString(e.title)){baseUtils.show.redTip("图文名称不能为空！");return false}if($formCheck.emptyString(e.img_url)){baseUtils.show.redTip("请上传您的图文封面！");return false}if($formCheck.emptyString(e.start_at)){baseUtils.show.redTip("请填入您的图文上架时间！");return false}if(!$formCheck.checkTime(e.start_at)){baseUtils.show.redTip("图文上架时间错误");return false}if(uploadChannelType==1&&e.payment_type==2&&$formCheck.emptyString(e.piece_price)){baseUtils.show.redTip("您选择的付费形式为付费，请输入价格！");return false}if(uploadChannelType==1&&e.payment_type==2&&!$formCheck.checkNum(e.piece_price)){baseUtils.show.redTip("您的价格输入格式有误，请重新输入！");return false}if(uploadChannelType==1&&e.payment_type==2&&e.piece_price>baseUtils.maxInputPrice*100){baseUtils.show.redTip("价格不能大于 "+baseUtils.maxInputPrice+" 元");return false}return true}function r(e,t){showLoading();$.ajax(e,{type:"POST",dataType:"json",data:t,success:function(e){if(parseInt(e.code)===0){baseUtils.show.blueTip("保存成功");setTimeout(function(){window.location.href=backURL},700)}else{hideLoading();baseUtils.show.redTip(e.msg);submitLimt=false}},error:function(e,t,a){hideLoading();console.error(a);baseUtils.show.redTip("网络错误，请稍后再试！");submitLimt=false}})}e.init=function(){var e=GetQueryString("package_id");var t=$("#dateInput").val();$("#dateInput").on("change",function(e){t=$(this).val();console.log(currentDate);if(t>currentDate){$("#nextDay").html("上架当日")}else{$("#nextDay").html("今日")}i();console.log(t)});console.log(packageId);i();function i(){$.get("/check_goods_message_push/"+e+"/"+t,function(e){console.log(e);console.log(t);$("#valid_push").html(e.data.valid_push);if(e.data.has_push>=3){$("#fBtn1").attr("disabled",true);$("#has_push").html(3)}else{$("#has_push").html(e.data.has_push);$("#fBtn1").attr("disabled",false)}if(e.code==-1){$("#subMsg").css("display","none")}})}$("#preview_try").on("click",function(){var e=ue1.getContent();document.getElementById("preview_content").innerHTML=e;$(".preview_con").addClass("active");$(".preview_box").addClass("active");document.documentElement.style.overflow="hidden"});$(".completeBtn").click(function(){var e=$.trim($(".resName").val());var t=$.trim($("#Image1Url").val());var i=UE.getEditor("resource_desc");var n=i.getContent();n=n.replace(/&quot;/gi,"'");var s=UE.getEditor("contentTry");var o=ue1.getContent();var l=i.getPlainTxt();if(l.length==0){baseUtils.show.redTip("描述不能为空!");return false}var c=s.getPlainTxt();if(c.length==0){baseUtils.show.redTip("描述不能为空!");return false}var p=$.trim($(".resPrize").val())*100;$('input[name="aliveClass"]:checked').each(function(){classArray.push($(this).attr("id"))});var u=$.trim($("#dateInput").val());var d={title:e,img_url:t,org_content:n,try_content:c,try_org_content:o,content:l,piece_price:p,start_at:u,id:GetQueryString("id")||null};var h=$("#serviceToggle :radio:checked").val();if(h){d.push_state=h}if(resourceFree){d.payment_type=resourceFree}if(a(d)){var m={params:d,resource_type:resourceType,upload_channel_type:uploadChannelType,package_id:packageId,resource_params:resourceParams,package_name:packageName,roleParams:roleParams,category_type:classArray};r(golbalUrl,m)}else{return false}})};return e}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1hbmFnZUFydGljbGUuanMiXSwibmFtZXMiOlsiJCIsIm1hbmFnZUFydGljbGUiLCJpbml0IiwicmVzVXJsIiwiY2hlY2tBcnRpY2xlRm9ybSIsImluZm8iLCIkZm9ybUNoZWNrIiwiZW1wdHlTdHJpbmciLCJ0aXRsZSIsImJhc2VVdGlscyIsInNob3ciLCJyZWRUaXAiLCJpbWdfdXJsIiwic3RhcnRfYXQiLCJjaGVja1RpbWUiLCJ1cGxvYWRDaGFubmVsVHlwZSIsInBheW1lbnRfdHlwZSIsInBpZWNlX3ByaWNlIiwiY2hlY2tOdW0iLCJtYXhJbnB1dFByaWNlIiwic3VibWl0Rm9ybSIsInVybCIsImFsbFBhcmFtcyIsInNob3dMb2FkaW5nIiwiYWpheCIsInR5cGUiLCJkYXRhVHlwZSIsImRhdGEiLCJzdWNjZXNzIiwicGFyc2VJbnQiLCJjb2RlIiwiYmx1ZVRpcCIsInNldFRpbWVvdXQiLCJ3aW5kb3ciLCJsb2NhdGlvbiIsImhyZWYiLCJiYWNrVVJMIiwiaGlkZUxvYWRpbmciLCJtc2ciLCJzdWJtaXRMaW10IiwiZXJyb3IiLCJ4aHIiLCJzdGF0dXMiLCJlcnIiLCJjb25zb2xlIiwicF9pZCIsIkdldFF1ZXJ5U3RyaW5nIiwic2VsZWN0VGltZSIsInZhbCIsIm9uIiwiZSIsInRoaXMiLCJsb2ciLCJjdXJyZW50RGF0ZSIsImh0bWwiLCJwdXNoRnVuY3Rpb24iLCJwYWNrYWdlSWQiLCJnZXQiLCJ2YWxpZF9wdXNoIiwiaGFzX3B1c2giLCJhdHRyIiwiY3NzIiwidWUxIiwiZ2V0Q29udGVudCIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJpbm5lckhUTUwiLCJhZGRDbGFzcyIsImRvY3VtZW50RWxlbWVudCIsInN0eWxlIiwib3ZlcmZsb3ciLCJjbGljayIsInRyaW0iLCJpbWFnZTFVcmwiLCJ1ZSIsIlVFIiwiZ2V0RWRpdG9yIiwib3JnQ29udGVudCIsInJlcGxhY2UiLCJ1ZVRyeSIsIm9yZ0NvbnRlbnRUcnkiLCJkZXNjcmliIiwiZ2V0UGxhaW5UeHQiLCJsZW5ndGgiLCJkZXNjcmliVHJ5IiwicmVzUHJpemUiLCJlYWNoIiwiY2xhc3NBcnJheSIsInB1c2giLCJzdGFydEF0IiwicmVzSW5mbyIsIm9yZ19jb250ZW50IiwidHJ5X2NvbnRlbnQiLCJ0cnlfb3JnX2NvbnRlbnQiLCJjb250ZW50IiwiaWQiLCJwdXNoU3RhdGUiLCJwdXNoX3N0YXRlIiwicmVzb3VyY2VGcmVlIiwicGFyYW1zIiwicmVzb3VyY2VfdHlwZSIsInJlc291cmNlVHlwZSIsInVwbG9hZF9jaGFubmVsX3R5cGUiLCJwYWNrYWdlX2lkIiwicmVzb3VyY2VfcGFyYW1zIiwicmVzb3VyY2VQYXJhbXMiLCJwYWNrYWdlX25hbWUiLCJwYWNrYWdlTmFtZSIsInJvbGVQYXJhbXMiLCJjYXRlZ29yeV90eXBlIiwiZ29sYmFsVXJsIl0sIm1hcHBpbmdzIjoiQUFNQUEsRUFBRSxXQUVFQyxjQUFjQyxRQUdsQixJQUFJRCxlQUFnQixXQUNoQixHQUFJQSxLQUVKLElBQUlFLEVBR0osU0FBU0MsR0FBaUJDLEdBQ3RCLEdBQUlDLFdBQVdDLFlBQVlGLEVBQUtHLE9BQVEsQ0FDcENDLFVBQVVDLEtBQUtDLE9BQU8sWUFDdEIsT0FBTyxPQUVYLEdBQUlMLFdBQVdDLFlBQVlGLEVBQUtPLFNBQVUsQ0FDdENILFVBQVVDLEtBQUtDLE9BQU8sYUFDdEIsT0FBTyxPQUVYLEdBQUlMLFdBQVdDLFlBQVlGLEVBQUtRLFVBQVcsQ0FDdkNKLFVBQVVDLEtBQUtDLE9BQU8sZUFDdEIsT0FBTyxPQUVYLElBQUtMLFdBQVdRLFVBQVVULEVBQUtRLFVBQVcsQ0FDdENKLFVBQVVDLEtBQUtDLE9BQU8sV0FDdEIsT0FBTyxPQUVYLEdBQUdJLG1CQUFtQixHQUFHVixFQUFLVyxjQUFjLEdBQUtWLFdBQVdDLFlBQVlGLEVBQUtZLGFBQWEsQ0FDdEZSLFVBQVVDLEtBQUtDLE9BQU8scUJBQ3RCLE9BQU8sT0FFWCxHQUFHSSxtQkFBbUIsR0FBR1YsRUFBS1csY0FBYyxJQUFNVixXQUFXWSxTQUFTYixFQUFLWSxh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d0UsS0FBS3hFLEVBQUUsYUFBYWdELE9BQU8sR0FHNUNoRCxHQUFFLG9DQUFvQ3NGLEtBQUssV0FDdkNDLFdBQVdDLEtBQUt4RixFQUFFbUQsTUFBTVMsS0FBSyxRQUtqQyxJQUFJNkIsR0FBVXpGLEVBQUV3RSxLQUFLeEUsRUFBRSxjQUFjZ0QsTUFHckMsSUFBSTBDLElBRUFsRixNQUFPQSxFQUVQSSxRQUFTNkQsRUFFVGtCLFlBQVlkLEVBRVplLFlBQVlSLEVBRVpTLGdCQUFnQmIsRUFFaEJjLFFBQVFiLEVBR1JoRSxZQUFhb0UsRUFFYnhFLFNBQVU0RSxFQUVWTSxHQUFJakQsZUFBZSxPQUFTLEtBSWhDLElBQUlrRCxHQUFZaEcsRUFBRSxpQ0FBaUNnRCxLQUNuRCxJQUFHZ0QsRUFBVSxDQUNUTixFQUFRTyxXQUFhRCxFQUd6QixHQUFHRSxhQUFjLENBQ2JSLEVBQVExRSxhQUFla0YsYUFLM0IsR0FBSTlGLEVBQWlCc0YsR0FBVSxDQUMzQixHQUFJcEUsSUFDQTZFLE9BQVFULEVBQ1JVLGNBQWVDLGFBQ2ZDLG9CQUFxQnZGLGtCQUNyQndGLFdBQVkvQyxVQUNaZ0QsZ0JBQWlCQyxlQUNqQkMsYUFBY0MsWUFDZEMsV0FBWUEsV0FDWkMsY0FBY3RCLFdBRWxCbkUsR0FBVzBGLFVBQVV4RixPQUdsQixDQUNILE1BQU8sVUFLbkIsT0FBT3JCIiwiZmlsZSI6Im1hbmFnZUFydGljbGUuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIENyZWF0ZWQgYnkganNlcmsgb24gMjAxNy8zLzIzLlxuICovXG4vKipcbiAqIENyZWF0ZWQgYnkganNlcmsgb24gMjAxNy8zLzIzLlxuICovXG4kKGZ1bmN0aW9uICgpIHtcblxuICAgIG1hbmFnZUFydGljbGUuaW5pdCgpO1xuXG59KTtcbnZhciBtYW5hZ2VBcnRpY2xlID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciBtYW5hZ2VBcnRpY2xlID0ge307XG5cbiAgICB2YXIgcmVzVXJsO1xuXG4gICAgLy/mo4Dmn6Xlm77mlofmj5DkuqTooajljZVcbiAgICBmdW5jdGlvbiBjaGVja0FydGljbGVGb3JtKGluZm8pIHtcbiAgICAgICAgaWYgKCRmb3JtQ2hlY2suZW1wdHlTdHJpbmcoaW5mby50aXRsZSkpIHtcbiAgICAgICAgICAgIGJhc2VVdGlscy5zaG93LnJlZFRpcChcIuWbvuaWh+WQjeensOS4jeiDveS4uuepuu+8gVwiKTtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoJGZvcm1DaGVjay5lbXB0eVN0cmluZyhpbmZvLmltZ191cmwpKSB7XG4gICAgICAgICAgICBiYXNlVXRpbHMuc2hvdy5yZWRUaXAoXCLor7fkuIrkvKDmgqjnmoTlm77mloflsIHpnaLvvIFcIik7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCRmb3JtQ2hlY2suZW1wdHlTdHJpbmcoaW5mby5zdGFydF9hdCkpIHtcbiAgICAgICAgICAgIGJhc2VVdGlscy5zaG93LnJlZFRpcChcIuivt+Whq+WFpeaCqOeahOWbvuaWh+S4iuaetuaXtumXtO+8gVwiKTtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoISRmb3JtQ2hlY2suY2hlY2tUaW1lKGluZm8uc3RhcnRfYXQpKSB7XG4gICAgICAgICAgICBiYXNlVXRpbHMuc2hvdy5yZWRUaXAoXCLlm77mlofkuIrmnrbml7bpl7TplJnor69cIik7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgaWYodXBsb2FkQ2hhbm5lbFR5cGU9PTEmJmluZm8ucGF5bWVudF90eXBlPT0yICYmICRmb3JtQ2hlY2suZW1wdHlTdHJpbmcoaW5mby5waWVjZV9wcmljZSkpe1xuICAgICAgICAgICAgYmFzZVV0aWxzLnNob3cucmVkVGlwKFwi5oKo6YCJ5oup55qE5LuY6LS55b2i5byP5Li65LuY6LS577yM6K+36L6T5YWl5Lu35qC877yBXCIpO1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGlmKHVwbG9hZENoYW5uZWxUeXBlPT0xJiZpbmZvLnBheW1lbnRfdHlwZT09MiAmJiAhJGZvcm1DaGVjay5jaGVja051bShpbmZvLnBpZWNlX3ByaWNlKSl7XG4gICAgICAgICAgICBiYXNlVXRpbHMuc2hvdy5yZWRUaXAoXCLmgqjnmoTku7fmoLzovpPlhaXmoLzlvI/mnInor6/vvIzor7fph43mlrDovpPlhaXvvIFcIik7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgaWYodXBsb2FkQ2hhbm5lbFR5cGU9PTEmJmluZm8ucGF5bWVudF90eXBlPT0yICYmIGluZm8ucGllY2VfcHJpY2UgPiBiYXNlVXRpbHMubWF4SW5wdXRQcmljZSAqIDEwMCl7XG4gICAgICAgICAgICBiYXNlVXRpbHMuc2hvdy5yZWRUaXAoXCLku7fmoLzkuI3og73lpKfkuo4gXCIgKyBiYXNlVXRpbHMubWF4SW5wdXRQcmljZSArIFwiIOWFg1wiKTtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG5cbiAgICAvL+aPkOS6pOS/oeaBr1xuICAgIGZ1bmN0aW9uIHN1Ym1pdEZvcm0odXJsLCBhbGxQYXJhbXMpIHtcbiAgICAgICAgc2hvd0xvYWRpbmcoKTtcbiAgICAgICAgJC5hamF4KHVybCwge1xuICAgICAgICAgICAgdHlwZTogJ1BPU1QnLFxuICAgICAgICAgICAgZGF0YVR5cGU6ICdqc29uJyxcbiAgICAgICAgICAgIGRhdGE6YWxsUGFyYW1zLFxuICAgICAgICAgICAgc3VjY2VzczpmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgIGlmIChwYXJzZUludChkYXRhLmNvZGUpID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGJhc2VVdGlscy5zaG93LmJsdWVUaXAoXCLkv53lrZjmiJDlip9cIik7XG4gICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSBiYWNrVVJMO1xuICAgICAgICAgICAgICAgICAgICB9LDcwMCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBoaWRlTG9hZGluZygpO1xuICAgICAgICAgICAgICAgICAgICBiYXNlVXRpbHMuc2hvdy5yZWRUaXAoZGF0YS5tc2cpO1xuICAgICAgICAgICAgICAgICAgICBzdWJtaXRMaW10ID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGVycm9yOiBmdW5jdGlvbih4aHIsc3RhdHVzLGVycikge1xuICAgICAgICAgICAgICAgIGhpZGVMb2FkaW5nKCk7XG4gICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihlcnIpO1xuICAgICAgICAgICAgICAgIGJhc2VVdGlscy5zaG93LnJlZFRpcCgn572R57uc6ZSZ6K+v77yM6K+356iN5ZCO5YaN6K+V77yBJyk7XG4gICAgICAgICAgICAgICAgc3VibWl0TGltdCA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgIH1cblxuXG4gICAgbWFuYWdlQXJ0aWNsZS5pbml0ID0gZnVuY3Rpb24gKCkge1xuXG4gICAgICAgIC8v5paw54mI5raI5oGv5o6o6YCB5ouJ5Y+W5pWw5o2uXG4gICAgICAgIHZhciBwX2lkID1HZXRRdWVyeVN0cmluZygncGFja2FnZV9pZCcpO1xuICAgICAgICB2YXIgc2VsZWN0VGltZSA9ICQoJyNkYXRlSW5wdXQnKS52YWwoKTtcbiAgICAgICAgLy/nm5Hmjqfml7bpl7TlvLnnqpfnu4Tku7ZcbiAgICAgICAgJCgnI2RhdGVJbnB1dCcpLm9uKCdjaGFuZ2UnLCBmdW5jdGlvbihlKSB7XG4gICAgICAgICAgICBzZWxlY3RUaW1lID0gJCh0aGlzKS52YWwoKTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGN1cnJlbnREYXRlKTtcbiAgICAgICAgICAgIGlmKHNlbGVjdFRpbWU+Y3VycmVudERhdGUpe1xuICAgICAgICAgICAgICAgICQoJyNuZXh0RGF5JykuaHRtbCgn5LiK5p625b2T5pelJyk7XG4gICAgICAgICAgICB9ZWxzZXtcbiAgICAgICAgICAgICAgICAkKCcjbmV4dERheScpLmh0bWwoJ+S7iuaXpScpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcHVzaEZ1bmN0aW9uKCk7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhzZWxlY3RUaW1lKTtcbiAgICAgICAgfSk7XG4gICAgICAgIGNvbnNvbGUubG9nKHBhY2thZ2VJZCk7XG4gICAgICAgIHB1c2hGdW5jdGlvbigpO1xuICAgICAgICBmdW5jdGlvbiBwdXNoRnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAkLmdldCgnL2NoZWNrX2dvb2RzX21lc3NhZ2VfcHVzaC8nICsgcF9pZCArICcvJyArIHNlbGVjdFRpbWUsIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coZGF0YSk7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coc2VsZWN0VGltZSk7XG4gICAgICAgICAgICAgICAgJCgnI3ZhbGlkX3B1c2gnKS5odG1sKGRhdGEuZGF0YS52YWxpZF9wdXNoKTtcbiAgICAgICAgICAgICAgICBpZiAoZGF0YS5kYXRhLmhhc19wdXNoID49IDMpIHtcbiAgICAgICAgICAgICAgICAgICAgJCgnI2ZCdG4xJykuYXR0cignZGlzYWJsZWQnLCB0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgJCgnI2hhc19wdXNoJykuaHRtbCgzKTsvL+WGmeatu+W3suWPkTPmnaFcbiAgICAgICAgICAgICAgICB9ZWxzZXtcbiAgICAgICAgICAgICAgICAgICAgJCgnI2hhc19wdXNoJykuaHRtbChkYXRhLmRhdGEuaGFzX3B1c2gpO1xuICAgICAgICAgICAgICAgICAgICAkKCcjZkJ0bjEnKS5hdHRyKCdkaXNhYmxlZCcsIGZhbHNlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGRhdGEuY29kZSA9PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICAkKCcjc3ViTXNnJykuY3NzKCdkaXNwbGF5JywgJ25vbmUnKVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgJCgnI3ByZXZpZXdfdHJ5Jykub24oJ2NsaWNrJyxmdW5jdGlvbigpe1xuICAgICAgICAgICAgdmFyIGh0bWwgPSB1ZTEuZ2V0Q29udGVudCgpO1xuICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3ByZXZpZXdfY29udGVudCcpLmlubmVySFRNTCA9IGh0bWw7XG4gICAgICAgICAgICAkKCcucHJldmlld19jb24nKS5hZGRDbGFzcygnYWN0aXZlJyk7XG4gICAgICAgICAgICAkKCcucHJldmlld19ib3gnKS5hZGRDbGFzcygnYWN0aXZlJyk7XG4gICAgICAgICAgICBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc3R5bGUub3ZlcmZsb3cgPSBcImhpZGRlblwiO1xuICAgICAgICB9KTtcblxuICAgICAgICAvLyDmj5DkuqTlm77mlofooajljZVcbiAgICAgICAgJChcIi5jb21wbGV0ZUJ0blwiKS5jbGljayhmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgICAgIC8v6I635Y+W5Zu+5paH6KGo5Y2V5pWw5o2uXG4gICAgICAgICAgICAvL+WbvuaWh+WQjeensFxuICAgICAgICAgICAgdmFyIHRpdGxlID0gJC50cmltKCQoXCIucmVzTmFtZVwiKS52YWwoKSk7XG5cbiAgICAgICAgICAgIC8v5Zu+5paH5bCB6Z2i5Zyw5Z2AXG4gICAgICAgICAgICB2YXIgaW1hZ2UxVXJsID0gJC50cmltKCQoXCIjSW1hZ2UxVXJsXCIpLnZhbCgpKTtcblxuICAgICAgICAgICAgLy/lm77mlofljp/lp4vlhoXlrrnor6bmg4VcbiAgICAgICAgICAgIHZhciB1ZSA9IFVFLmdldEVkaXRvcigncmVzb3VyY2VfZGVzYycpO1xuICAgICAgICAgICAgdmFyIG9yZ0NvbnRlbnQgPSB1ZS5nZXRDb250ZW50KCk7XG4gICAgICAgICAgICBvcmdDb250ZW50ID0gb3JnQ29udGVudC5yZXBsYWNlKCAvJnF1b3Q7L2dpLCBcIidcIiApO1xuICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhvcmdDb250ZW50KTtcbiAgICAgICAgICAgIC8v5Zu+5paH6K+V55yL6K+m5oOFXG4gICAgICAgICAgICB2YXIgdWVUcnkgPSBVRS5nZXRFZGl0b3IoJ2NvbnRlbnRUcnknKTtcbiAgICAgICAgICAgIHZhciBvcmdDb250ZW50VHJ5ID0gdWUxLmdldENvbnRlbnQoKTtcblxuICAgICAgICAgICAgLy/otYTmupDlhoXlrrnmj4/ov7BcbiAgICAgICAgICAgIHZhciBkZXNjcmliID0gdWUuZ2V0UGxhaW5UeHQoKTtcbiAgICAgICAgICAgIGlmIChkZXNjcmliLmxlbmd0aCA9PSAwKSB7XG4gICAgICAgICAgICAgICAgYmFzZVV0aWxzLnNob3cucmVkVGlwKCfmj4/ov7DkuI3og73kuLrnqbohJyk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvL+WbvuaWh+ivleeci+aPj+i/sFxuICAgICAgICAgICAgdmFyIGRlc2NyaWJUcnkgPSB1ZVRyeS5nZXRQbGFpblR4dCgpO1xuICAgICAgICAgICAgaWYgKGRlc2NyaWJUcnkubGVuZ3RoID09IDApIHtcbiAgICAgICAgICAgICAgICBiYXNlVXRpbHMuc2hvdy5yZWRUaXAoJ+aPj+i/sOS4jeiDveS4uuepuiEnKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8v5LuY6LS55Lu35qC8XG4gICAgICAgICAgICB2YXIgcmVzUHJpemUgPSAkLnRyaW0oJChcIi5yZXNQcml6ZVwiKS52YWwoKSkqMTAwO1xuXG4gICAgICAgICAgICAvL+ebtOaSremAieaLqeWIhuexu1xuICAgICAgICAgICAgJCgnaW5wdXRbbmFtZT1cImFsaXZlQ2xhc3NcIl06Y2hlY2tlZCcpLmVhY2goZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICBjbGFzc0FycmF5LnB1c2goJCh0aGlzKS5hdHRyKCdpZCcpKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhjbGFzc0FycmF5KTtcblxuICAgICAgICAgICAgLy/kuIrmnrbml7bpl7RcbiAgICAgICAgICAgIHZhciBzdGFydEF0ID0gJC50cmltKCQoXCIjZGF0ZUlucHV0XCIpLnZhbCgpKTtcblxuICAgICAgICAgICAgLy/lm77mlofljZXlk4HkuIrkvKDkv6Hmga9cbiAgICAgICAgICAgIHZhciByZXNJbmZvID0ge1xuICAgICAgICAgICAgICAgIC8vIOWbvuaWh+WQjeensFxuICAgICAgICAgICAgICAgIHRpdGxlOiB0aXRsZSxcbiAgICAgICAgICAgICAgICAvLyDlm77mloflsIHpnaLlnLDlnYBcbiAgICAgICAgICAgICAgICBpbWdfdXJsOiBpbWFnZTFVcmwsXG4gICAgICAgICAgICAgICAgLy/ljp/lp4vmlofmnKxcbiAgICAgICAgICAgICAgICBvcmdfY29udGVudDpvcmdDb250ZW50LFxuICAgICAgICAgICAgICAgIC8v5Zu+5paH6K+m5oOFXG4gICAgICAgICAgICAgICAgdHJ5X2NvbnRlbnQ6ZGVzY3JpYlRyeSxcbiAgICAgICAgICAgICAgICAvL+ivleeci+WOn+Wni+aWh+acrFxuICAgICAgICAgICAgICAgIHRyeV9vcmdfY29udGVudDpvcmdDb250ZW50VHJ5LFxuICAgICAgICAgICAgICAgIC8v6K+V55yL5Zu+5paH6K+m5oOFXG4gICAgICAgICAgICAgICAgY29udGVudDpkZXNjcmliLFxuICAgICAgICAgICAgICAgIC8v5LuY6LS55b2i5byPXG4gICAgICAgICAgICAgICAgLy/ku5jotLnku7fmoLxcbiAgICAgICAgICAgICAgICBwaWVjZV9wcmljZTogcmVzUHJpemUsXG4gICAgICAgICAgICAgICAgLy/kuIrmnrbml7bpl7RcbiAgICAgICAgICAgICAgICBzdGFydF9hdDogc3RhcnRBdCxcbiAgICAgICAgICAgICAgICAvL2lkXG4gICAgICAgICAgICAgICAgaWQ6IEdldFF1ZXJ5U3RyaW5nKCdpZCcpIHx8IG51bGxcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIC8v5raI5oGv5o6o6YCBXG4gICAgICAgICAgICB2YXIgcHVzaFN0YXRlID0gJCgnI3NlcnZpY2VUb2dnbGUgOnJhZGlvOmNoZWNrZWQnKS52YWwoKTtcbiAgICAgICAgICAgIGlmKHB1c2hTdGF0ZSl7Ly/lpoLmnpzmnInmtojmga/mjqjpgIHmnYPpmZBcbiAgICAgICAgICAgICAgICByZXNJbmZvLnB1c2hfc3RhdGUgPSBwdXNoU3RhdGU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvL+aYr+WQpuS7mOi0ue+8iDHooajnpLrlhY3otLnvvIwy6KGo56S65Y2V56yU77yJXG4gICAgICAgICAgICBpZihyZXNvdXJjZUZyZWUpIHtcbiAgICAgICAgICAgICAgICByZXNJbmZvLnBheW1lbnRfdHlwZSA9IHJlc291cmNlRnJlZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKHJlc0luZm8pO1xuICAgICAgICAgICAgLy/ojrflj5booajljZXkuK3nmoTmlbDmja5cblxuICAgICAgICAgICAgaWYgKGNoZWNrQXJ0aWNsZUZvcm0ocmVzSW5mbykpIHtcbiAgICAgICAgICAgICAgICB2YXIgYWxsUGFyYW1zID0ge1xuICAgICAgICAgICAgICAgICAgICBwYXJhbXM6IHJlc0luZm8sXG4gICAgICAgICAgICAgICAgICAgIHJlc291cmNlX3R5cGU6IHJlc291cmNlVHlwZSxcbiAgICAgICAgICAgICAgICAgICAgdXBsb2FkX2NoYW5uZWxfdHlwZTogdXBsb2FkQ2hhbm5lbFR5cGUsXG4gICAgICAgICAgICAgICAgICAgIHBhY2thZ2VfaWQ6IHBhY2thZ2VJZCxcbiAgICAgICAgICAgICAgICAgICAgcmVzb3VyY2VfcGFyYW1zOiByZXNvdXJjZVBhcmFtcyxcbiAgICAgICAgICAgICAgICAgICAgcGFja2FnZV9uYW1lOiBwYWNrYWdlTmFtZSxcbiAgICAgICAgICAgICAgICAgICAgcm9sZVBhcmFtczogcm9sZVBhcmFtcyxcbiAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcnlfdHlwZTpjbGFzc0FycmF5XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICBzdWJtaXRGb3JtKGdvbGJhbFVybCxhbGxQYXJhbXMpO1xuXG5cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KVxuICAgIH1cblxuICAgIHJldHVybiBtYW5hZ2VBcnRpY2xlO1xufSgpOyJdfQ==
