$(document).ready(function(){$manageExercise.init()});$manageExercise=function(){var e={};var i={submitLimit:false,pageType:$("#admin_data").data("page_type")};e.init=function(){changeSaveFlag(true);if(i.pageType==1){i.resType=$("#admin_data").data("resource_type");i.resId=$("#admin_data").data("resource_id");i.resName=$("#admin_data").data("resource_name")}$("#exerciseBookName").on("keyup",function(){var e=$(this),i=$.trim(e.val());if(i.length>=14){i=i.substr(0,14);e.val(i);$(".characterNumLimit").css({color:"red"});setTimeout(function(){$(".characterNumLimit").css({color:"#888888"})},3e3)}$(".characterNumLimit>span").text(i.length)});$("#resTypeSelector").on("change",function(){var e=$(this).val();if(e==-1){$("#resItemSelector").html(' <option value="-1">请选择具体课程</option>')}else{$.ajax("/exercise/get_resource_list",{type:"POST",dataType:"json",data:{resource_type:e},success:function(t){if(t.code==0){var a=t.data.resource_list,r="";if(i.pageType==1&&i.resType==e){r+='<option value="'+i.resId+'" selected>'+i.resName+"</option>"}$.each(a,function(i,t){var a=e==5?t.name:t.title;r+='<option value="'+t.id+'">'+a+"</option>"});if(r.length==0){r='<option value="-1">暂无数据</option>'}$("#resItemSelector").html(r)}else{baseUtils.show.redTip("网络问题，请稍后再试")}},error:function(e,i,t){console.log(t);alert("服务器出小差了，请稍后再试！")}})}});$(".remindRadio").on("click",function(){$(".remindRadio").children(".circleRadio").removeClass("radioActive");$(this).children(".circleRadio").addClass("radioActive")});$("#cancelSaveExercise").click(function(){window.history.back()});$("#confirmSaveExercise").click(function(){var e=$.trim($("#exerciseBookName").val()),t=$("#resItemSelector").val(),a=$("#resTypeSelector").val(),r=$("#resItemSelector > option:selected").text(),o=$("#communitySelector").val(),s=$(".circleRadio.radioActive").data("is_remind"),c="";s=0;if(e.length==0){baseUtils.show.redTip("还没有输入作业本名称");return false}if(e.length>14){baseUtils.show.redTip("作业本名称长度不能超过14字");return false}if(t==-1){baseUtils.show.redTip("还没有选择具体课程");return false}var n={title:e,resource_id:t,resource_type:a,resource_name:r,is_enable_notify:s};if(o!=-1&&o!=undefined){n.community_id=o}if(i.pageType==0){c="/exercise/upload_exercise_book"}else if(i.pageType==1){c="/exercise/update_exercise_book";n.exercise_book_id=GetQueryString("exercise_book_id")}else{console.log(" pageType 参数有误。");baseUtils.show.redTip("网络错误，请稍后再试");return false}if(i.submitLimit){baseUtils.show.redTip("正在提交中，请稍后再试");return false}i.submitLimit=true;$.ajax(c,{type:"POST",dataType:"json",data:{params:n},success:function(e){i.submitLimit=false;if(e.code==0){baseUtils.show.blueTip(i.pageType==0?"创建作业本成功":"编辑作业成功");setTimeout(function(){window.location.href="/exercise/exercise_book_list"},1e3)}else{baseUtils.show.redTip(e.msg)}},error:function(e,t,a){i.submitLimit=false;console.log(a);alert("服务器出小差了，请稍后再试！")}})})};return e}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1hbmFnZUV4ZXJjaXNlQm9vay5qcyJdLCJuYW1lcyI6WyIkIiwiZG9jdW1lbnQiLCJyZWFkeSIsIiRtYW5hZ2VFeGVyY2lzZSIsImluaXQiLCIkcHJpdmF0ZSIsInN1Ym1pdExpbWl0IiwicGFnZVR5cGUiLCJkYXRhIiwiY2hhbmdlU2F2ZUZsYWciLCJyZXNUeXBlIiwicmVzSWQiLCJyZXNOYW1lIiwib24iLCIkc2VsZiIsInRoaXMiLCJleGVyY2lzZU5hbWUiLCJ0cmltIiwidmFsIiwibGVuZ3RoIiwic3Vic3RyIiwiY3NzIiwiY29sb3IiLCJzZXRUaW1lb3V0IiwidGV4dCIsImh0bWwiLCJhamF4IiwidHlwZSIsImRhdGFUeXBlIiwicmVzb3VyY2VfdHlwZSIsInN1Y2Nlc3MiLCJyZXN1bHQiLCJjb2RlIiwicmVzb3VyY2VMaXN0IiwicmVzb3VyY2VfbGlzdCIsImh0bWxTdHIiLCJlYWNoIiwiayIsInYiLCJuYW1lIiwidGl0bGUiLCJpZCIsImJhc2VVdGlscyIsInNob3ciLCJyZWRUaXAiLCJlcnJvciIsInhociIsInN0YXR1cyIsImVyciIsImNvbnNvbGUiLCJsb2ciLCJhbGVydCIsImNoaWxkcmVuIiwicmVtb3ZlQ2xhc3MiLCJhZGRDbGFzcyIsImNsaWNrIiwid2luZG93IiwiaGlzdG9yeSIsImJhY2siLCJleGVyY2lzZUJvb2tOYW1lIiwiY29tbXVuaXR5SWQiLCJpc1JlbWluZCIsInBvc3RVcmwiLCJwYXJhbXMiLCJyZXNvdXJjZV9pZCIsInJlc291cmNlX25hbWUiLCJpc19lbmFibGVfbm90aWZ5IiwidW5kZWZpbmVkIiwiY29tbXVuaXR5X2lkIiwiZXhlcmNpc2VfYm9va19pZCIsIkdldFF1ZXJ5U3RyaW5nIiwiYmx1ZVRpcCIsImxvY2F0aW9uIiwiaHJlZiIsIm1zZyJdLCJtYXBwaW5ncyI6IkFBSUFBLEVBQUVDLFVBQVVDLE1BQU0sV0FDZEMsZ0JBQWdCQyxRQUdwQkQsaUJBQWtCLFdBQ2QsR0FBSUEsS0FDSixJQUFJRSxJQUNBQyxZQUFhLE1BQ2JDLFNBQVVQLEVBQUUsZUFBZVEsS0FBSyxhQUdwQ0wsR0FBZ0JDLEtBQU8sV0FHbkJLLGVBQWUsS0FFZixJQUFJSixFQUFTRSxVQUFZLEVBQUcsQ0FDeEJGLEVBQVNLLFFBQVVWLEVBQUUsZUFBZVEsS0FBSyxnQkFDekNILEdBQVNNLE1BQVFYLEVBQUUsZUFBZVEsS0FBSyxjQUN2Q0gsR0FBU08sUUFBVVosRUFBRSxlQUFlUSxLQUFLLGlCQUc3Q1IsRUFBRSxxQkFBcUJhLEdBQUcsUUFBUyxXQUMvQixHQUFJQyxHQUFRZCxFQUFFZSxNQUNWQyxFQUFlaEIsRUFBRWlCLEtBQUtILEVBQU1JLE1BRWhDLElBQUlGLEVBQWFHLFFBQVUsR0FBSSxDQUMzQkgsRUFBZUEsRUFBYUksT0FBTyxFQUFHLEdBQ3RDTixHQUFNSSxJQUFJRixFQUNWaEIsR0FBRSxzQkFBc0JxQixLQUFLQyxNQUFTLE9BQ3RDQyxZQUFXLFdBQ1B2QixFQUFFLHNCQUFzQnFCLEtBQUtDLE1BQVMsYUFDdkMsS0FFUHRCLEVBQUUsMkJBQTJCd0IsS0FBS1IsRUFBYUcsU0FJbkRuQixHQUFFLG9CQUFvQmEsR0FBRyxTQUFVLFdBQy9CLEdBQUlILEdBQVVWLEVBQUVlLE1BQU1HLEtBQ3RCLElBQUlSLElBQVksRUFBRyxDQUNmVixFQUFFLG9CQUFvQnlCLEtBQ2xCLDRDQUVELENBQ0h6QixFQUFFMEIsS0FBSywrQkFDSEMsS0FBTSxPQUNOQyxTQUFVLE9BQ1ZwQixNQUNJcUIsY0FBZW5CLEdBRW5Cb0IsUUFBUyxTQUFVQyxHQUNmLEdBQUlBLEVBQU9DLE1BQVEsRUFBRyxDQUNsQixHQUFJQyxHQUFlRixFQUFPdkIsS0FBSzBCLGNBQzNCQyxFQUFVLEVBRWQsSUFBSTlCLEVBQVNFLFVBQVksR0FBS0YsRUFBU0ssU0FBV0EsRUFBUyxDQUN2RHlCLEdBQ0ksa0JBQWtCOUIsRUFBU00sTUFBTSxjQUFjTixFQUFTTyxRQUFRLFlBRXhFWixFQUFFb0MsS0FBS0gsRUFBYyxTQUFVSSxFQUFHQyxHQUM5QixHQUFJMUIsR0FBV0YsR0FBUyxFQUFFNEIsRUFBRUMsS0FBS0QsRUFBRUUsS0FDbkNMLElBQ0ksa0JBQWtCRyxFQUFFRyxHQUFHLEtBQUs3QixFQUFRLGFBRTVDLElBQUl1QixFQUFRaEIsUUFBVSxFQUFHLENBQ3JCZ0IsRUFDSSxtQ0FFUm5DLEVBQUUsb0JBQW9CeUIsS0FBS1UsT0FFeEIsQ0FDSE8sVUFBVUMsS0FBS0MsT0FBTyxnQkFHOUJDLE1BQU8sU0FBVUMsRUFBS0MsRUFBUUMsR0FDMUJDLFFBQVFDLElBQUlGLEVBQ1pHLE9BQU0sdUJBUXRCbkQsR0FBRSxnQkFBZ0JhLEdBQUcsUUFBUyxXQUMxQmIsRUFBRSxnQkFBZ0JvRCxTQUFTLGdCQUFnQkMsWUFBWSxjQUN2RHJELEdBQUVlLE1BQU1xQyxTQUFTLGdCQUFnQkUsU0FBUyxnQkFHOUN0RCxHQUFFLHVCQUF1QnVELE1BQU0sV0FDM0JDLE9BQU9DLFFBQVFDLFFBR25CMUQsR0FBRSx3QkFBd0J1RCxNQUFNLFdBQzVCLEdBQUlJLEdBQW1CM0QsRUFBRWlCLEtBQUtqQixFQUFFLHFCQUFxQmtCLE9BQ2pEUCxFQUFRWCxFQUFFLG9CQUFvQmtCLE1BQzlCUixFQUFVVixFQUFFLG9CQUFvQmtCLE1BQ2hDTixFQUFVWixFQUFFLHNDQUFzQ3dCLE9BQ2xEb0MsRUFBYzVELEVBQUUsc0JBQXNCa0IsTUFDdEMyQyxFQUFXN0QsRUFBRSw0QkFBNEJRLEtBQUssYUFDOUNzRCxFQUFVLEVBRWRELEdBQVcsQ0FFWCxJQUFJRixFQUFpQnhDLFFBQVUsRUFBRyxDQUM5QnVCLFVBQVVDLEtBQUtDLE9BQU8sYUFDdEIsT0FBTyxPQUVYLEdBQUllLEVBQWlCeEMsT0FBUyxHQUFJLENBQzlCdUIsVUFBVUMsS0FBS0MsT0FBTyxpQkFDdEIsT0FBTyxPQUVYLEdBQUlqQyxJQUFVLEVBQUcsQ0FDYitCLFVBQVVDLEtBQUtDLE9BQU8sWUFDdEIsT0FBTyxPQUdYLEdBQUltQixJQUNBdkIsTUFBT21CLEVBQ1BLLFlBQWFyRCxFQUNia0IsY0FBZW5CLEVBQ2Z1RCxjQUFlckQsRUFDZnNELGlCQUFrQkwsRUFFdEIsSUFBSUQsSUFBZ0IsR0FBS0EsR0FBZU8sVUFBVyxDQUMvQ0osRUFBT0ssYUFBZVIsRUFFMUIsR0FBSXZELEVBQVNFLFVBQVksRUFBRyxDQUN4QnVELEVBQVUscUNBQ1AsSUFBSXpELEVBQVNFLFVBQVksRUFBRyxDQUMvQnVELEVBQVUsZ0NBQ1ZDLEdBQU9NLGlCQUFtQkMsZUFBZSx3QkFDdEMsQ0FDSHJCLFFBQVFDLElBQUksa0JBQ1pSLFdBQVVDLEtBQUtDLE9BQU8sYUFDdEIsT0FBTyxPQUVYLEdBQUl2QyxFQUFTQyxZQUFhLENBQ3RCb0MsVUFBVUMsS0FBS0MsT0FBTyxjQUN0QixPQUFPLE9BRVh2QyxFQUFTQyxZQUFjLElBQ3ZCTixHQUFFMEIsS0FBS29DLEdBQ0huQyxLQUFNLE9BQ05DLFNBQVUsT0FDVnBCLE1BQ0l1RCxPQUFRQSxHQUVaakMsUUFBUyxTQUFVQyxHQUNmMUIsRUFBU0MsWUFBYyxLQUN2QixJQUFJeUIsRUFBT0MsTUFBUSxFQUFHLENBQ2xCVSxVQUFVQyxLQUFLNEIsUUFBUWxFLEVBQVNFLFVBQVUsRUFBRSxVQUFVLFNBQ3REZ0IsWUFBVyxXQUNQaUMsT0FBT2dCLFNBQVNDLEtBQU8sZ0NBQ3hCLFNBQ0EsQ0FDSC9CLFVBQVVDLEtBQUtDLE9BQU9iLEVBQU8yQyxPQUdyQzdCLE1BQU8sU0FBVUMsRUFBS0MsRUFBUUMsR0FDMUIzQyxFQUFTQyxZQUFjLEtBQ3ZCMkMsU0FBUUMsSUFBSUYsRUFDWkcsT0FBTSx1QkFRdEIsT0FBT2hEIiwiZmlsZSI6Im1hbmFnZUV4ZXJjaXNlQm9vay5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBDcmVhdGVkIGJ5IEFkbWluaXN0cmF0b3Igb24gMjAxNy83LzMxLlxyXG4gKi9cclxuXHJcbiQoZG9jdW1lbnQpLnJlYWR5KGZ1bmN0aW9uICgpIHtcclxuICAgICRtYW5hZ2VFeGVyY2lzZS5pbml0KCk7XHJcbn0pO1xyXG5cclxuJG1hbmFnZUV4ZXJjaXNlID0gKGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciAkbWFuYWdlRXhlcmNpc2UgPSB7fTtcclxuICAgIHZhciAkcHJpdmF0ZSA9IHtcclxuICAgICAgICBzdWJtaXRMaW1pdDogZmFsc2UsXHJcbiAgICAgICAgcGFnZVR5cGU6ICQoXCIjYWRtaW5fZGF0YVwiKS5kYXRhKFwicGFnZV90eXBlXCIpLCAgICAgICAvLzAt5Yib5bu677ybMS3nvJbovpFcclxuICAgIH1cclxuXHJcbiAgICAkbWFuYWdlRXhlcmNpc2UuaW5pdCA9IGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICAgICAgLy/ngrnlh7vkvqfovrnmoI/nprvlvIDml7bnmoTlvLnmoYZcclxuICAgICAgICBjaGFuZ2VTYXZlRmxhZyh0cnVlKTtcclxuXHJcbiAgICAgICAgaWYgKCRwcml2YXRlLnBhZ2VUeXBlID09IDEpIHtcclxuICAgICAgICAgICAgJHByaXZhdGUucmVzVHlwZSA9ICQoXCIjYWRtaW5fZGF0YVwiKS5kYXRhKFwicmVzb3VyY2VfdHlwZVwiKTsgICAgLy/lt7LlhbPogZTor77nqIvnmoTnsbvlnotcclxuICAgICAgICAgICAgJHByaXZhdGUucmVzSWQgPSAkKFwiI2FkbWluX2RhdGFcIikuZGF0YShcInJlc291cmNlX2lkXCIpOyAgICAvL+W3suWFs+iBlOivvueoi+eahGlkXHJcbiAgICAgICAgICAgICRwcml2YXRlLnJlc05hbWUgPSAkKFwiI2FkbWluX2RhdGFcIikuZGF0YShcInJlc291cmNlX25hbWVcIik7ICAgIC8v5bey5YWz6IGU6K++56iL55qEaWRcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgICQoXCIjZXhlcmNpc2VCb29rTmFtZVwiKS5vbihcImtleXVwXCIsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyICRzZWxmID0gJCh0aGlzKSxcclxuICAgICAgICAgICAgICAgIGV4ZXJjaXNlTmFtZSA9ICQudHJpbSgkc2VsZi52YWwoKSk7XHJcblxyXG4gICAgICAgICAgICBpZiAoZXhlcmNpc2VOYW1lLmxlbmd0aCA+PSAxNCkge1xyXG4gICAgICAgICAgICAgICAgZXhlcmNpc2VOYW1lID0gZXhlcmNpc2VOYW1lLnN1YnN0cigwLCAxNCk7XHJcbiAgICAgICAgICAgICAgICAkc2VsZi52YWwoZXhlcmNpc2VOYW1lKTtcclxuICAgICAgICAgICAgICAgICQoXCIuY2hhcmFjdGVyTnVtTGltaXRcIikuY3NzKHtcImNvbG9yXCI6IFwicmVkXCJ9KTtcclxuICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICQoXCIuY2hhcmFjdGVyTnVtTGltaXRcIikuY3NzKHtcImNvbG9yXCI6IFwiIzg4ODg4OFwifSk7XHJcbiAgICAgICAgICAgICAgICB9LCAzMDAwKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAkKFwiLmNoYXJhY3Rlck51bUxpbWl0PnNwYW5cIikudGV4dChleGVyY2lzZU5hbWUubGVuZ3RoKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgLy/lhbPogZTor77nqItcclxuICAgICAgICAkKFwiI3Jlc1R5cGVTZWxlY3RvclwiKS5vbihcImNoYW5nZVwiLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciByZXNUeXBlID0gJCh0aGlzKS52YWwoKTtcclxuICAgICAgICAgICAgaWYgKHJlc1R5cGUgPT0gLTEpIHtcclxuICAgICAgICAgICAgICAgICQoXCIjcmVzSXRlbVNlbGVjdG9yXCIpLmh0bWwoXHJcbiAgICAgICAgICAgICAgICAgICAgJyA8b3B0aW9uIHZhbHVlPVwiLTFcIj7or7fpgInmi6nlhbfkvZPor77nqIs8L29wdGlvbj4nXHJcbiAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgJC5hamF4KFwiL2V4ZXJjaXNlL2dldF9yZXNvdXJjZV9saXN0XCIsIHtcclxuICAgICAgICAgICAgICAgICAgICB0eXBlOiBcIlBPU1RcIixcclxuICAgICAgICAgICAgICAgICAgICBkYXRhVHlwZTogXCJqc29uXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvdXJjZV90eXBlOiByZXNUeXBlXHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbiAocmVzdWx0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXN1bHQuY29kZSA9PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVzb3VyY2VMaXN0ID0gcmVzdWx0LmRhdGEucmVzb3VyY2VfbGlzdCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBodG1sU3RyID0gXCJcIjtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoJHByaXZhdGUucGFnZVR5cGUgPT0gMSAmJiAkcHJpdmF0ZS5yZXNUeXBlID09IHJlc1R5cGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBodG1sU3RyICs9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICc8b3B0aW9uIHZhbHVlPVwiJyskcHJpdmF0ZS5yZXNJZCsnXCIgc2VsZWN0ZWQ+JyskcHJpdmF0ZS5yZXNOYW1lKyc8L29wdGlvbj4nO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJC5lYWNoKHJlc291cmNlTGlzdCwgZnVuY3Rpb24gKGssIHYpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVzTmFtZSA9IChyZXNUeXBlPT01P3YubmFtZTp2LnRpdGxlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBodG1sU3RyICs9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICc8b3B0aW9uIHZhbHVlPVwiJyt2LmlkKydcIj4nK3Jlc05hbWUrJzwvb3B0aW9uPic7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChodG1sU3RyLmxlbmd0aCA9PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaHRtbFN0ciA9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICc8b3B0aW9uIHZhbHVlPVwiLTFcIj7mmoLml6DmlbDmja48L29wdGlvbj4nO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJChcIiNyZXNJdGVtU2VsZWN0b3JcIikuaHRtbChodG1sU3RyKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiYXNlVXRpbHMuc2hvdy5yZWRUaXAoXCLnvZHnu5zpl67popjvvIzor7fnqI3lkI7lho3or5VcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiBmdW5jdGlvbiAoeGhyLCBzdGF0dXMsIGVycikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhbGVydChcIuacjeWKoeWZqOWHuuWwj+W3ruS6hu+8jOivt+eojeWQjuWGjeivle+8gVwiKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgLy8gcmFkaW8g5oyJ6ZKu54K55Ye75YiH5o2i5pWI5p6cXHJcbiAgICAgICAgJCgnLnJlbWluZFJhZGlvJykub24oJ2NsaWNrJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICQoJy5yZW1pbmRSYWRpbycpLmNoaWxkcmVuKCcuY2lyY2xlUmFkaW8nKS5yZW1vdmVDbGFzcygncmFkaW9BY3RpdmUnKTtcclxuICAgICAgICAgICAgJCh0aGlzKS5jaGlsZHJlbignLmNpcmNsZVJhZGlvJykuYWRkQ2xhc3MoJ3JhZGlvQWN0aXZlJyk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICQoXCIjY2FuY2VsU2F2ZUV4ZXJjaXNlXCIpLmNsaWNrKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgd2luZG93Lmhpc3RvcnkuYmFjaygpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICAkKFwiI2NvbmZpcm1TYXZlRXhlcmNpc2VcIikuY2xpY2soZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgZXhlcmNpc2VCb29rTmFtZSA9ICQudHJpbSgkKFwiI2V4ZXJjaXNlQm9va05hbWVcIikudmFsKCkpLFxyXG4gICAgICAgICAgICAgICAgcmVzSWQgPSAkKFwiI3Jlc0l0ZW1TZWxlY3RvclwiKS52YWwoKSxcclxuICAgICAgICAgICAgICAgIHJlc1R5cGUgPSAkKFwiI3Jlc1R5cGVTZWxlY3RvclwiKS52YWwoKSxcclxuICAgICAgICAgICAgICAgIHJlc05hbWUgPSAkKFwiI3Jlc0l0ZW1TZWxlY3RvciA+IG9wdGlvbjpzZWxlY3RlZFwiKS50ZXh0KCksXHJcbiAgICAgICAgICAgICAgICBjb21tdW5pdHlJZCA9ICQoXCIjY29tbXVuaXR5U2VsZWN0b3JcIikudmFsKCksXHJcbiAgICAgICAgICAgICAgICBpc1JlbWluZCA9ICQoXCIuY2lyY2xlUmFkaW8ucmFkaW9BY3RpdmVcIikuZGF0YShcImlzX3JlbWluZFwiKSwgLy8gMSAtIOaPkOmGku+8jCAwIC0g5LiN5o+Q6YaSPOm7mOiupOS4jeaPkOmGkj5cclxuICAgICAgICAgICAgICAgIHBvc3RVcmwgPSBcIlwiO1xyXG5cclxuICAgICAgICAgICAgaXNSZW1pbmQgPSAwOyAgIC8vICBUT0RPIOaaguaXtuWFiOiuvue9ruS4uuS4jeaPkOmGklxyXG5cclxuICAgICAgICAgICAgaWYgKGV4ZXJjaXNlQm9va05hbWUubGVuZ3RoID09IDApIHtcclxuICAgICAgICAgICAgICAgIGJhc2VVdGlscy5zaG93LnJlZFRpcChcIui/mOayoeaciei+k+WFpeS9nOS4muacrOWQjeensFwiKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoZXhlcmNpc2VCb29rTmFtZS5sZW5ndGggPiAxNCkge1xyXG4gICAgICAgICAgICAgICAgYmFzZVV0aWxzLnNob3cucmVkVGlwKFwi5L2c5Lia5pys5ZCN56ew6ZW/5bqm5LiN6IO96LaF6L+HMTTlrZdcIik7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHJlc0lkID09IC0xKSB7XHJcbiAgICAgICAgICAgICAgICBiYXNlVXRpbHMuc2hvdy5yZWRUaXAoXCLov5jmsqHmnInpgInmi6nlhbfkvZPor77nqItcIik7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHZhciBwYXJhbXMgPSB7XHJcbiAgICAgICAgICAgICAgICB0aXRsZTogZXhlcmNpc2VCb29rTmFtZSxcclxuICAgICAgICAgICAgICAgIHJlc291cmNlX2lkOiByZXNJZCxcclxuICAgICAgICAgICAgICAgIHJlc291cmNlX3R5cGU6IHJlc1R5cGUsXHJcbiAgICAgICAgICAgICAgICByZXNvdXJjZV9uYW1lOiByZXNOYW1lLFxyXG4gICAgICAgICAgICAgICAgaXNfZW5hYmxlX25vdGlmeTogaXNSZW1pbmRcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoY29tbXVuaXR5SWQgIT0gLTEgJiYgY29tbXVuaXR5SWQgIT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgICAgICBwYXJhbXMuY29tbXVuaXR5X2lkID0gY29tbXVuaXR5SWQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKCRwcml2YXRlLnBhZ2VUeXBlID09IDApIHsgICAgICAgICAgICAvL+WIm+W7ulxyXG4gICAgICAgICAgICAgICAgcG9zdFVybCA9IFwiL2V4ZXJjaXNlL3VwbG9hZF9leGVyY2lzZV9ib29rXCI7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoJHByaXZhdGUucGFnZVR5cGUgPT0gMSkgeyAgICAgLy/nvJbovpFcclxuICAgICAgICAgICAgICAgIHBvc3RVcmwgPSBcIi9leGVyY2lzZS91cGRhdGVfZXhlcmNpc2VfYm9va1wiO1xyXG4gICAgICAgICAgICAgICAgcGFyYW1zLmV4ZXJjaXNlX2Jvb2tfaWQgPSBHZXRRdWVyeVN0cmluZyhcImV4ZXJjaXNlX2Jvb2tfaWRcIik7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIiBwYWdlVHlwZSDlj4LmlbDmnInor6/jgIJcIik7XHJcbiAgICAgICAgICAgICAgICBiYXNlVXRpbHMuc2hvdy5yZWRUaXAoXCLnvZHnu5zplJnor6/vvIzor7fnqI3lkI7lho3or5VcIik7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKCRwcml2YXRlLnN1Ym1pdExpbWl0KSB7XHJcbiAgICAgICAgICAgICAgICBiYXNlVXRpbHMuc2hvdy5yZWRUaXAoXCLmraPlnKjmj5DkuqTkuK3vvIzor7fnqI3lkI7lho3or5VcIik7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgJHByaXZhdGUuc3VibWl0TGltaXQgPSB0cnVlO1xyXG4gICAgICAgICAgICAkLmFqYXgocG9zdFVybCwge1xyXG4gICAgICAgICAgICAgICAgdHlwZTogXCJQT1NUXCIsXHJcbiAgICAgICAgICAgICAgICBkYXRhVHlwZTogXCJqc29uXCIsXHJcbiAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgcGFyYW1zOiBwYXJhbXNcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbiAocmVzdWx0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHByaXZhdGUuc3VibWl0TGltaXQgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAocmVzdWx0LmNvZGUgPT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBiYXNlVXRpbHMuc2hvdy5ibHVlVGlwKCRwcml2YXRlLnBhZ2VUeXBlPT0wP1wi5Yib5bu65L2c5Lia5pys5oiQ5YqfXCI6XCLnvJbovpHkvZzkuJrmiJDlip9cIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSBcIi9leGVyY2lzZS9leGVyY2lzZV9ib29rX2xpc3RcIjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSwgMTAwMCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYmFzZVV0aWxzLnNob3cucmVkVGlwKHJlc3VsdC5tc2cpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICBlcnJvcjogZnVuY3Rpb24gKHhociwgc3RhdHVzLCBlcnIpIHtcclxuICAgICAgICAgICAgICAgICAgICAkcHJpdmF0ZS5zdWJtaXRMaW1pdCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycik7XHJcbiAgICAgICAgICAgICAgICAgICAgYWxlcnQoXCLmnI3liqHlmajlh7rlsI/lt67kuobvvIzor7fnqI3lkI7lho3or5XvvIFcIik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICB9KTtcclxuXHJcbiAgICB9O1xyXG5cclxuICAgIHJldHVybiAkbWFuYWdlRXhlcmNpc2U7XHJcbn0pKCk7XHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuIl19
