$(document).ready(function(){$exeBookList.init()});$exeBookList=function(){var e={addUserType:1};var i={userListPageIndex:1,userListSearchContent:"",isSearchUserWindowLoading:false,isSearchUserWindowToBottom:false};e.init=function(){$(".operateList > li.operate").click(function(){var e=$(this),i=e.parents(".exerciseBookOperateArea"),a=e.data("type"),s=i.data("resource_id"),n=i.data("exercise_book_id");switch(a){case"role_manage":baseUtils.showWindow("roleManageWindow");break;case"exercise_list":window.location.href="/exercise/exercise_list";break;case"edit_exercise_book":window.location.href="/exercise/edit_exercise_book?exercise_book_id="+n;break;default:console.log("参数错误");break}});$("#windowCloseIcon1").click(function(){baseUtils.hideWindow("roleManageWindow")});$("#windowHoverBox").on("click","li",function(){var i=$(this).data("type");if(i=="add_teacher"){e.addUserType=1}else if(i=="add_assistant"){e.addUserType=0}a()});$("#windowCloseIcon2").click(function(){baseUtils.hideWindow("searchUserWindow");baseUtils.showWindow("roleManageWindow")});$("#searchUserWindow").on("click","#windowSearchBtn",function(){i.userListPageIndex=1;i.userListSearchContent=$.trim($("#windowSearchInput").val());i.isSearchUserWindowToBottom=false;$("#searchUserWindow .windowContentWrapper2").scrollTop(0);s()});$("#windowSearchInput").on("keypress",function(e){if(e.keyCode==13){$("#windowSearchBtn").click()}});$("#searchUserWindow .windowContentWrapper2").scroll(function(e){var a=$("#windowContent2").height(),n=$(this).height(),o=$(this).scrollTop();if(o+n>=a-5&&!i.isSearchUserWindowLoading&&!i.isSearchUserWindowToBottom){s()}});$("#confirmSaveAddedUser").click(function(){var e=$(".selectSingleGuest:checked"),i={};e.each(function(){var e=$(this).parents(".singleGuestInfo2"),a=e.data("user_id"),s=e.data("wx_avatar"),n=e.data("wx_nickname");if(i.userId==undefined){i.userId={user_id:a,wx_avatar:s,wx_nickname:n}}})})};function a(){baseUtils.hideWindow("roleManageWindow");$("#searchUserWindow").find(".headerText1").text(e.addUserType==1?"添加老师":"添加助教");baseUtils.showWindow("searchUserWindow");i.isSearchUserWindowToBottom=false;i.userListPageIndex=1;i.userListSearchContent="";s()}function s(){baseUtils.showLoading("searchUserLoading");i.isSearchUserWindowLoading=true;$.ajax("/zbsearch",{type:"GET",dataType:"json",data:{page:i.userListPageIndex,search:i.userListSearchContent},success:function(e){baseUtils.hideLoading("searchUserLoading");i.isSearchUserWindowLoading=false;var a=$("#windowContent2"),s="",n=e.page_offset;$.each(e.data,function(e,i){s+='<div class="singleGuestInfo2" data-user_id="'+i.user_id+'" data-wx_avatar="'+i.wx_avatar+'" data-wx_nickname="'+i.wx_nickname+'">'+'<input type="checkbox" class="selectSingleGuest" id="'+i.user_id+'">'+'<label for="'+i.user_id+'" class="singleGuestLabel">'+'<img src="'+i.wx_avatar+'" class="singleGuestAvatar2">'+'<div class="singleGuestName2" title="'+i.wx_nickname+'">'+i.wx_nickname+"</div>"+"</label>"+"</div>"});if(s.length==0){s='<div class="windowNoData" id="windowNoData">暂无数据</div>'}if(i.userListPageIndex==1){a.html(s);a.append('<div class="isDown">更多数据加载中</div>')}else{a.find(".isDown").before(s)}if(n.current_page>=n.total_pages){var o=0;if(n.total_count>10){a.find(".isDown").text("数据已加载完毕");o=3e3}else{o=0}setTimeout(function(){a.find(".isDown").hide()},o);i.isSearchUserWindowToBottom=true}i.userListPageIndex++},error:function(e,a,s){baseUtils.hideLoading("searchUserLoading");i.isSearchUserWindowLoading=false;console.log(s);alert("服务器出小差了，请稍后再试！")}})}return e}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImV4ZXJjaXNlQm9va0xpc3QuanMiXSwibmFtZXMiOlsiJCIsImRvY3VtZW50IiwicmVhZHkiLCIkZXhlQm9va0xpc3QiLCJpbml0IiwiYWRkVXNlclR5cGUiLCIkcHJpdmF0ZSIsInVzZXJMaXN0UGFnZUluZGV4IiwidXNlckxpc3RTZWFyY2hDb250ZW50IiwiaXNTZWFyY2hVc2VyV2luZG93TG9hZGluZyIsImlzU2VhcmNoVXNlcldpbmRvd1RvQm90dG9tIiwiY2xpY2siLCIkc2VsZiIsInRoaXMiLCIkcGFyZW50IiwicGFyZW50cyIsInR5cGUiLCJkYXRhIiwicmVzSWQiLCJleGVyY2lzZUJvb2tJZCIsImJhc2VVdGlscyIsInNob3dXaW5kb3ciLCJ3aW5kb3ciLCJsb2NhdGlvbiIsImhyZWYiLCJjb25zb2xlIiwibG9nIiwiaGlkZVdpbmRvdyIsIm9uIiwib3BlblNlYXJjaFVzZXJXaW5kb3ciLCJ0cmltIiwidmFsIiwic2Nyb2xsVG9wIiwiZ2V0QWxsVXNlckxpc3QiLCJlIiwia2V5Q29kZSIsInNjcm9sbCIsIkRpdkhlaWdodCIsImhlaWdodCIsIlNjcm9sbEhlaWdodCIsIlNjcm9sbFRvcCIsImNoZWNrZWRVc2VyIiwidXNlckFyciIsImVhY2giLCJ1c2VySWQiLCJ3eEF2YXRhciIsInd4Tmlja25hbWUiLCJ1bmRlZmluZWQiLCJ1c2VyX2lkIiwid3hfYXZhdGFyIiwid3hfbmlja25hbWUiLCJmaW5kIiwidGV4dCIsInNob3dMb2FkaW5nIiwiYWpheCIsImRhdGFUeXBlIiwicGFnZSIsInNlYXJjaCIsInN1Y2Nlc3MiLCJyZXN1bHQiLCJoaWRlTG9hZGluZyIsIiRhcmVhIiwiaHRtbFN0ciIsIm9mZnNldCIsInBhZ2Vfb2Zmc2V0IiwiayIsInYiLCJsZW5ndGgiLCJodG1sIiwiYXBwZW5kIiwiYmVmb3JlIiwiY3VycmVudF9wYWdlIiwidG90YWxfcGFnZXMiLCJ0aW1lUmFuZ2UiLCJ0b3RhbF9jb3VudCIsInNldFRpbWVvdXQiLCJoaWRlIiwiZXJy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ZXNDb250ZW50IjpbIi8qKlxyXG4gKiBDcmVhdGVkIGJ5IEFkbWluaXN0cmF0b3Igb24gMjAxNy83LzMxLlxyXG4gKi9cclxuXHJcbiQoZG9jdW1lbnQpLnJlYWR5KGZ1bmN0aW9uICgpIHtcclxuICAgICRleGVCb29rTGlzdC5pbml0KCk7XHJcbn0pO1xyXG5cclxuJGV4ZUJvb2tMaXN0ID0gKGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciAkZXhlQm9va0xpc3QgPSB7XHJcbiAgICAgICAgYWRkVXNlclR5cGU6IDEsIC8vMS3ogIHluIjvvJswLeWKqeaVmVxyXG5cclxuICAgIH07XHJcbiAgICB2YXIgJHByaXZhdGUgPSB7XHJcbiAgICAgICAgdXNlckxpc3RQYWdlSW5kZXg6IDEsXHJcbiAgICAgICAgdXNlckxpc3RTZWFyY2hDb250ZW50OiBcIlwiLFxyXG4gICAgICAgIGlzU2VhcmNoVXNlcldpbmRvd0xvYWRpbmc6IGZhbHNlLFxyXG4gICAgICAgIGlzU2VhcmNoVXNlcldpbmRvd1RvQm90dG9tOiBmYWxzZSxcclxuICAgIH07XHJcblxyXG4gICAgJGV4ZUJvb2tMaXN0LmluaXQgPSBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgICAgIC8v5L2c5Lia5pys55qE5pON5L2cXHJcbiAgICAgICAgJChcIi5vcGVyYXRlTGlzdCA+IGxpLm9wZXJhdGVcIikuY2xpY2soZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgJHNlbGYgPSAkKHRoaXMpLFxyXG4gICAgICAgICAgICAgICAgJHBhcmVudCA9ICRzZWxmLnBhcmVudHMoXCIuZXhlcmNpc2VCb29rT3BlcmF0ZUFyZWFcIiksXHJcbiAgICAgICAgICAgICAgICB0eXBlID0gJHNlbGYuZGF0YShcInR5cGVcIiksXHJcbiAgICAgICAgICAgICAgICByZXNJZCA9ICRwYXJlbnQuZGF0YShcInJlc291cmNlX2lkXCIpLFxyXG4gICAgICAgICAgICAgICAgZXhlcmNpc2VCb29rSWQgPSAkcGFyZW50LmRhdGEoXCJleGVyY2lzZV9ib29rX2lkXCIpO1xyXG5cclxuICAgICAgICAgICAgc3dpdGNoICh0eXBlKSB7XHJcbiAgICAgICAgICAgICAgICBjYXNlIFwicm9sZV9tYW5hZ2VcIjpcclxuICAgICAgICAgICAgICAgICAgICBiYXNlVXRpbHMuc2hvd1dpbmRvdyhcInJvbGVNYW5hZ2VXaW5kb3dcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlIFwiZXhlcmNpc2VfbGlzdFwiOlxyXG4gICAgICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gXCIvZXhlcmNpc2UvZXhlcmNpc2VfbGlzdFwiO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSBcImVkaXRfZXhlcmNpc2VfYm9va1wiOlxyXG4gICAgICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gXCIvZXhlcmNpc2UvZWRpdF9leGVyY2lzZV9ib29rP2V4ZXJjaXNlX2Jvb2tfaWQ9XCIrZXhlcmNpc2VCb29rSWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwi5Y+C5pWw6ZSZ6K+vXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICAvKioqKioqKioqKioqKioqKioqKioqKiog5Lq65ZGY6K6+572u56qX5Y+jICoqKioqKioqKioqKioqKioqKioqKioqKiovXHJcbiAgICAgICAgJChcIiN3aW5kb3dDbG9zZUljb24xXCIpLmNsaWNrKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgYmFzZVV0aWxzLmhpZGVXaW5kb3coXCJyb2xlTWFuYWdlV2luZG93XCIpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICAkKFwiI3dpbmRvd0hvdmVyQm94XCIpLm9uKFwiY2xpY2tcIiwgXCJsaVwiLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciB0eXBlID0gJCh0aGlzKS5kYXRhKFwidHlwZVwiKTtcclxuICAgICAgICAgICAgaWYgKHR5cGUgPT0gXCJhZGRfdGVhY2hlclwiKSB7XHJcbiAgICAgICAgICAgICAgICAkZXhlQm9va0xpc3QuYWRkVXNlclR5cGUgPSAxO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGUgPT0gXCJhZGRfYXNzaXN0YW50XCIpIHtcclxuICAgICAgICAgICAgICAgICRleGVCb29rTGlzdC5hZGRVc2VyVHlwZSA9IDA7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgb3BlblNlYXJjaFVzZXJXaW5kb3coKTtcclxuXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIC8qKioqKioqKioqKioqKioqKioqKioqKiDkurrlkZjmkJzntKLnqpflj6MgKioqKioqKioqKioqKioqKioqKioqKioqKi9cclxuXHJcbiAgICAgICAgJChcIiN3aW5kb3dDbG9zZUljb24yXCIpLmNsaWNrKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgYmFzZVV0aWxzLmhpZGVXaW5kb3coXCJzZWFyY2hVc2VyV2luZG93XCIpO1xyXG4gICAgICAgICAgICBiYXNlVXRpbHMuc2hvd1dpbmRvdyhcInJvbGVNYW5hZ2VXaW5kb3dcIik7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgLy/ngrnlh7vmkJzntKJcclxuICAgICAgICAkKFwiI3NlYXJjaFVzZXJXaW5kb3dcIikub24oXCJjbGlja1wiLCBcIiN3aW5kb3dTZWFyY2hCdG5cIiwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAkcHJpdmF0ZS51c2VyTGlzdFBhZ2VJbmRleCA9IDE7XHJcbiAgICAgICAgICAgICRwcml2YXRlLnVzZXJMaXN0U2VhcmNoQ29udGVudCA9ICQudHJpbSgkKFwiI3dpbmRvd1NlYXJjaElucHV0XCIpLnZhbCgpKTtcclxuICAgICAgICAgICAgJHByaXZhdGUuaXNTZWFyY2hVc2VyV2luZG93VG9Cb3R0b20gPSBmYWxzZTtcclxuICAgICAgICAgICAgJCgnI3NlYXJjaFVzZXJXaW5kb3cgLndpbmRvd0NvbnRlbnRXcmFwcGVyMicpLnNjcm9sbFRvcCgwKTtcclxuICAgICAgICAgICAgZ2V0QWxsVXNlckxpc3QoKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICAkKFwiI3dpbmRvd1NlYXJjaElucHV0XCIpLm9uKFwia2V5cHJlc3NcIiwgZnVuY3Rpb24gKGUpIHtcclxuICAgICAgICAgICAgaWYgKGUua2V5Q29kZSA9PSAxMykge1xyXG4gICAgICAgICAgICAgICAgJChcIiN3aW5kb3dTZWFyY2hCdG5cIikuY2xpY2soKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIC8v5ruR5Yqo5Yqg6L295pu05aSaXHJcbiAgICAgICAgJCgnI3NlYXJjaFVzZXJXaW5kb3cgLndpbmRvd0NvbnRlbnRXcmFwcGVyMicpLnNjcm9sbChmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICAgIHZhciBEaXZIZWlnaHQgPSAkKCcjd2luZG93Q29udGVudDInKS5oZWlnaHQoKSxcclxuICAgICAgICAgICAgICAgIFNjcm9sbEhlaWdodCA9ICQodGhpcykuaGVpZ2h0KCksXHJcbiAgICAgICAgICAgICAgICBTY3JvbGxUb3AgPSAkKHRoaXMpLnNjcm9sbFRvcCgpO1xyXG4gICAgICAgICAgICBpZiAoKFNjcm9sbFRvcCArIFNjcm9sbEhlaWdodCA+PSBEaXZIZWlnaHQgLSA1KSAmJiAhJHByaXZhdGUuaXNTZWFyY2hVc2VyV2luZG93TG9hZGluZ1xyXG4gICAgICAgICAgICAgICAgJiYgISRwcml2YXRlLmlzU2VhcmNoVXNlcldpbmRvd1RvQm90dG9tKSB7XHJcbiAgICAgICAgICAgICAgICBnZXRBbGxVc2VyTGlzdCgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgJChcIiNjb25maXJtU2F2ZUFkZGVkVXNlclwiKS5jbGljayhmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciBjaGVja2VkVXNlciA9ICQoXCIuc2VsZWN0U2luZ2xlR3Vlc3Q6Y2hlY2tlZFwiKSxcclxuICAgICAgICAgICAgICAgIHVzZXJBcnIgPSB7fTtcclxuICAgICAgICAgICAgY2hlY2tlZFVzZXIuZWFjaChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgJHBhcmVudCA9ICQodGhpcykucGFyZW50cyhcIi5zaW5nbGVHdWVzdEluZm8yXCIpLFxyXG4gICAgICAgICAgICAgICAgICAgIHVzZXJJZCA9ICRwYXJlbnQuZGF0YShcInVzZXJfaWRcIiksXHJcbiAgICAgICAgICAgICAgICAgICAgd3hBdmF0YXIgPSAkcGFyZW50LmRhdGEoXCJ3eF9hdmF0YXJcIiksXHJcbiAgICAgICAgICAgICAgICAgICAgd3hOaWNrbmFtZSA9ICRwYXJlbnQuZGF0YShcInd4X25pY2tuYW1lXCIpO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmICh1c2VyQXJyLnVzZXJJZCA9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICB1c2VyQXJyLnVzZXJJZCA9IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdXNlcl9pZDogdXNlcklkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB3eF9hdmF0YXI6IHd4QXZhdGFyLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB3eF9uaWNrbmFtZTogd3hOaWNrbmFtZVxyXG4gICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuXHJcbiAgICAgICAgfSk7XHJcblxyXG5cclxuICAgIH07XHJcbiAgICBmdW5jdGlvbiBvcGVuU2VhcmNoVXNlcldpbmRvdygpIHtcclxuICAgICAgICBiYXNlVXRpbHMuaGlkZVdpbmRvdyhcInJvbGVNYW5hZ2VXaW5kb3dcIik7XHJcbiAgICAgICAgXHJcbiAgICAgICAgJChcIiNzZWFyY2hVc2VyV2luZG93XCIpLmZpbmQoXCIuaGVhZGVyVGV4dDFcIikudGV4dChcclxuICAgICAgICAgICAgKCRleGVCb29rTGlzdC5hZGRVc2VyVHlwZT09MSk/XCLmt7vliqDogIHluIhcIjpcIua3u+WKoOWKqeaVmVwiXHJcbiAgICAgICAgKTtcclxuICAgICAgICBiYXNlVXRpbHMuc2hvd1dpbmRvdyhcInNlYXJjaFVzZXJXaW5kb3dcIik7XHJcbiAgICAgICAgXHJcbiAgICAgICAgJHByaXZhdGUuaXNTZWFyY2hVc2VyV2luZG93VG9Cb3R0b20gPSBmYWxzZTtcclxuICAgICAgICAkcHJpdmF0ZS51c2VyTGlzdFBhZ2VJbmRleCA9IDE7XHJcbiAgICAgICAgJHByaXZhdGUudXNlckxpc3RTZWFyY2hDb250ZW50ID0gXCJcIjtcclxuICAgICAgICBnZXRBbGxVc2VyTGlzdCgpO1xyXG4gICAgfVxyXG4gICAgZnVuY3Rpb24gZ2V0QWxsVXNlckxpc3QoKSB7XHJcbiAgICAgICAgYmFzZVV0aWxzLnNob3dMb2FkaW5nKFwic2VhcmNoVXNlckxvYWRpbmdcIik7XHJcbiAgICAgICAgJHByaXZhdGUuaXNTZWFyY2hVc2VyV2luZG93TG9hZGluZyA9IHRydWU7XHJcbiAgICAgICAgJC5hamF4KFwiL3pic2VhcmNoXCIsIHtcclxuICAgICAgICAgICAgdHlwZTogXCJHRVRcIixcclxuICAgICAgICAgICAgZGF0YVR5cGU6IFwianNvblwiLFxyXG4gICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICBwYWdlOiAkcHJpdmF0ZS51c2VyTGlzdFBhZ2VJbmRleCxcclxuICAgICAgICAgICAgICAgIHNlYXJjaDogJHByaXZhdGUudXNlckxpc3RTZWFyY2hDb250ZW50XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChyZXN1bHQpIHtcclxuICAgICAgICAgICAgICAgIGJhc2VVdGlscy5oaWRlTG9hZGluZyhcInNlYXJjaFVzZXJMb2FkaW5nXCIpO1xyXG4gICAgICAgICAgICAgICAgJHByaXZhdGUuaXNTZWFyY2hVc2VyV2luZG93TG9hZGluZyA9IGZhbHNlO1xyXG5cclxuICAgICAgICAgICAgICAgIHZhciAkYXJlYSA9ICQoXCIjd2luZG93Q29udGVudDJcIiksXHJcbiAgICAgICAgICAgICAgICAgICAgaHRtbFN0ciA9IFwiXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgb2Zmc2V0ID0gcmVzdWx0LnBhZ2Vfb2Zmc2V0O1xyXG5cclxuICAgICAgICAgICAgICAgICQuZWFjaChyZXN1bHQuZGF0YSwgZnVuY3Rpb24gKGssIHYpIHtcclxuICAgICAgICAgICAgICAgICAgICBodG1sU3RyICs9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwic2luZ2xlR3Vlc3RJbmZvMlwiIGRhdGEtdXNlcl9pZD1cIicrdi51c2VyX2lkK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdcIiBkYXRhLXd4X2F2YXRhcj1cIicrdi53eF9hdmF0YXIrJ1wiIGRhdGEtd3hfbmlja25hbWU9XCInK3Yud3hfbmlja25hbWUrJ1wiPicrXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnPGlucHV0IHR5cGU9XCJjaGVja2JveFwiIGNsYXNzPVwic2VsZWN0U2luZ2xlR3Vlc3RcIiBpZD1cIicrdi51c2VyX2lkKydcIj4nK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJzxsYWJlbCBmb3I9XCInK3YudXNlcl9pZCsnXCIgY2xhc3M9XCJzaW5nbGVHdWVzdExhYmVsXCI+JytcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnPGltZyBzcmM9XCInK3Yud3hfYXZhdGFyKydcIiBjbGFzcz1cInNpbmdsZUd1ZXN0QXZhdGFyMlwiPicrXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJzaW5nbGVHdWVzdE5hbWUyXCIgdGl0bGU9XCInK3Yud3hfbmlja25hbWUrJ1wiPicrdi53eF9uaWNrbmFtZSsnPC9kaXY+JytcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICc8L2xhYmVsPicrXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICc8L2Rpdj4nO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICBpZiAoaHRtbFN0ci5sZW5ndGggPT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGh0bWxTdHIgPVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAnPGRpdiBjbGFzcz1cIndpbmRvd05vRGF0YVwiIGlkPVwid2luZG93Tm9EYXRhXCI+5pqC5peg5pWw5o2uPC9kaXY+JztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmICgkcHJpdmF0ZS51c2VyTGlzdFBhZ2VJbmRleCA9PSAxKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJGFyZWEuaHRtbChodG1sU3RyKTtcclxuICAgICAgICAgICAgICAgICAgICAkYXJlYS5hcHBlbmQoJzxkaXYgY2xhc3M9XCJpc0Rvd25cIj7mm7TlpJrmlbDmja7liqDovb3kuK08L2Rpdj4nKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJGFyZWEuZmluZCgnLmlzRG93bicpLmJlZm9yZShodG1sU3RyKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChvZmZzZXQuY3VycmVudF9wYWdlID49IG9mZnNldC50b3RhbF9wYWdlcykgeyAgICAgIC8v5pWw5o2u5Yqg6L295a6M5q+V5ZCO55qE5pON5L2cXHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRpbWVSYW5nZSA9IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG9mZnNldC50b3RhbF9jb3VudCA+IDEwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRhcmVhLmZpbmQoJy5pc0Rvd24nKS50ZXh0KFwi5pWw5o2u5bey5Yqg6L295a6M5q+VXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aW1lUmFuZ2UgPSAzMDAwO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRpbWVSYW5nZSA9IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkYXJlYS5maW5kKCcuaXNEb3duJykuaGlkZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0sIHRpbWVSYW5nZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgJHByaXZhdGUuaXNTZWFyY2hVc2VyV2luZG93VG9Cb3R0b20gPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgJHByaXZhdGUudXNlckxpc3RQYWdlSW5kZXggKys7XHJcblxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBlcnJvcjogZnVuY3Rpb24gKHhociwgc3RhdHVzLCBlcnIpIHtcclxuICAgICAgICAgICAgICAgIGJhc2VVdGlscy5oaWRlTG9hZGluZyhcInNlYXJjaFVzZXJMb2FkaW5nXCIpO1xyXG4gICAgICAgICAgICAgICAgJHByaXZhdGUuaXNTZWFyY2hVc2VyV2luZG93TG9hZGluZyA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyKTtcclxuICAgICAgICAgICAgICAgIGFsZXJ0KFwi5pyN5Yqh5Zmo5Ye65bCP5beu5LqG77yM6K+356iN5ZCO5YaN6K+V77yBXCIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG5cclxuICAgIHJldHVybiAkZXhlQm9va0xpc3Q7XHJcbn0pKCk7XHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcbiJdfQ==
