$(function(){communityList.init()});var i=0;var iTime=null;function remainTime(){$.ajax("isCommunityHaveAdmin",{type:"GET",dataType:"json",data:{community_id:$("#community_id").val()},success:function(o){i+=1;if(i>=300){i=0;clearTimeout(iTime);$(".darkScreen").fadeOut(300);var e="您长时间未扫码  请重新验证";$.alert(e,"info",{oktext:"我知道了",btn:2,onOk:function(){window.location.href="/smallCommunity/communityList"},onClose:function(){window.location.href="/smallCommunity/communityList"}})}if(o.code==0){clearTimeout(iTime);var e="群主设置成功";$(".darkScreen").fadeOut(300);$.alert(e,"info",{oktext:"我知道了",btn:2,onOk:function(){window.location.href="/smallCommunity/communityList"},onClose:function(){window.location.href="/smallCommunity/communityList"}})}}});iTime=setTimeout("remainTime()",1500)}var communityList=function(){var o={};var e,t,n=0,a=[],c=1,l="",s,r="",d="",u="",m=0,f="";function h(o,e,t){$.ajax("getUserInfo",{type:"POST",textType:"json",data:{community_id:o,step:e,search:t},success:function(e){$(".loadingS").fadeOut(300);console.log(o);if(e.code==0){a=e.data;console.log(a);var t=0;for(t=0;t<a.length;t++){text='<div class="holderListPart" data-name="'+a[t].wx_nickname+'" data-userid="'+a[t].user_id+'"><div class="holderCheckBox"> <input class="with-gap" id="'+a[t].user_id+'" name="group2" type="radio" /> <label for="'+a[t].user_id+'"> </label> </div> <div class="holderListImg"><img src="'+a[t].wx_avatar+'"></div> <span class="holderListName">'+a[t].wx_nickname+"</span> </div>";$(".holderListContent").append(text)}}else{if(m==0){text='<p class="searchNone">'+f+" </p>";$(".holderListContent").append(text);m=1}}},error:function(o,e,t){console.log(t);baseUtils.show.redTip("网络错误，请稍后再试！")}})}function p(o){$.ajax("getCommunityLinkSetAdmin",{type:"POST",textType:"json",data:{community_id:o},success:function(o){console.log(o);if(o.code==0){u=o.data}},error:function(o,e,t){console.log(t);u="服务器出错了 请稍后再试"}})}function y(o,e){$.ajax("changeCommunityState",{type:"POST",textType:"json",data:{id:o,community_state:e},success:function(o){if(o.code==0){if(e==0){baseUtils.show.blueTip("已上架，当前小社群将在店内展示")}else{baseUtils.show.blueTip("已下架，当前小社群将不在店内展示")}location.reload()}else{baseUtils.show.redTip("操作失败!");console.log(o.msg)}},error:function(o,e,t){console.log(t);baseUtils.show.redTip("网络错误，请稍后再试！")}})}o.init=function(){var o=GetQueryString("is_new");if(o==1){$(".newCommunityTipWrapper").fadeIn(300);setTimeout(function(){$(".newCommunityTipWrapper").fadeOut(700)},5e3)}(function(){var o=new Clipboard(".copyHref");o.on("success",function(o){baseUtils.show.blueTip("复制成功！请在微信内打开哦 。");o.clearSelection()})})();$("body").on("mouseenter",".productCountBox",function(){$(this).next().fadeIn(200)});$("body").on("mouseleave",".productCountBox",function(){$(this).next().fadeOut(200)});$(".toolBox").on("click",".setHolderBtn",function(){m=0;c=1;var o=$(this).data("id");$("#community_id").val(o);$(".darkScreen").fadeIn(300);$(".holderSearchInput").val("");$(".holderListContent").empty();h(o,1);s=0;$(".setAdmin").show();p(o);f="暂无结果，请微信扫一扫设置群主"});$(".toolBox").on("click",".changeHolderBtn",function(){m=0;c=1;var o=$(this).data("id");$("#community_id").val(o);$(".darkScreen").fadeIn(300);$(".holderSearchInput").val("");$(".holderListContent").empty();h(o,1);f="暂无结果";s=1;$(".setAdmin").hide();r=$(this).data("old")});$(".GroupHolderSetBox").on("click",".holderSetClose",function(){$(".darkScreen").fadeOut(300)});$("body").on("click",".searchAllBtn",function(){e=$("#selector").val();t=$.trim($(".inputSearchAll").val());window.location="communityList?ruler="+e+"&search="+t});$("#selector").on("change",function(){$(".searchAllBtn").click()});$(".inputSearchAll").on("keypress",function(o){if(o.keyCode==13){$(".searchAllBtn").click()}});$(".GroupHolderSetBox").on("click",".holderSearchBtn",function(){m=0;c=1;$(".loadingS").fadeIn(300);$(".holderListContent").empty();h($("#community_id").val(),c,$(".holderSearchInput").val())});$(".holderList").scroll(function(){var o=$(this).height();var e=$(this).get(0).scrollHeight;var t=$(this).scrollTop();console.log(e);console.log(o);console.log(t);if(e-o-t<=35){if(n==0){c++;h($("#community_id").val(),c,$(".holderSearchInput").val());console.log("已经滚到底部了");n=1}}else{n=0}});$(".holderList").on("click",".holderListPart",function(){$(this).find("input").prop("checked",true);l=$(this).data("userid");d=$(this).data("name");console.log(l)});$(".boxConfirm").click(function(){if(s==1){$.alert("当前群主为"+r+",确认将群主转移给"+d+"吗？转移后，前群主曾经发的动态保留在群主动态中，新群主新发的动态将显示在群主动态中","info",{btn:3,onOk:function(){$.ajax("setCommunityAdmin",{type:"POST",textType:"json",data:{community_id:$("#community_id").val(),user_id:l},success:function(o){if(o.code==0){baseUtils.show.blueTip("操作成功！");window.location.href="/smallCommunity/communityList"}},error:function(o,e,t){console.log(t);baseUtils.show.redTip("网络错误，请稍后再试！")}})}})}else{$.ajax("setCommunityAdmin",{type:"POST",textType:"json",data:{community_id:$("#community_id").val(),user_id:l},success:function(o){if(o.code==0){baseUtils.show.blueTip("操作成功！");window.location.href="/smallCommunity/communityList"}},error:function(o,e,t){console.log(t);baseUtils.show.redTip("网络错误，请稍后再试！")}})}});$(".GroupHolderSetBox").on("mouseenter",".setWxFriend",function(){i=0;var o=new QRCode(document.getElementById("qrImgId"),{text:u,width:120,height:120,colorDark:"#000000",colorLight:"#ffffff",correctLevel:QRCode.CorrectLevel.L});$(".qrCodePaper").fadeIn(100);remainTime()});$(".GroupHolderSetBox").on("mouseleave",".setWxFriend",function(){clearTimeout(iTime);$("#qrImgId").empty();$(".qrCodePaper").fadeOut(10)});$(".toolBox").on("click",".communityHide",function(){var o=$(this).data("id");var e=1;y(o,e)});$(".toolBox").on("click",".communityShow",function(){var o=$(this).data("id");var e=0;y(o,e)})};return o}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbW11bml0eUxpc3QuanMiXSwibmFtZXMiOlsiJCIsImNvbW11bml0eUxpc3QiLCJpbml0IiwiaSIsImlUaW1lIiwicmVtYWluVGltZSIsImFqYXgiLCJ0eXBlIiwiZGF0YVR5cGUiLCJkYXRhIiwiY29tbXVuaXR5X2lkIiwidmFsIiwic3VjY2VzcyIsImNsZWFyVGltZW91dCIsImZhZGVPdXQiLCJ0ZXh0IiwiYWxlcnQiLCJva3RleHQiLCJidG4iLCJvbk9rIiwid2luZG93IiwibG9jYXRpb24iLCJocmVmIiwib25DbG9zZSIsImNvZGUiLCJzZXRUaW1lb3V0Iiwic2VsZWN0TnVtIiwic2VhcmNoQ29udGVudCIsImFqYXhMaXN0IiwidXNlckFyciIsInN0ZXAiLCJja2Vja2VkVXNlcklEIiwiaG9sZGVyQ2hhbmdlU3RhdGUiLCJvbGRBZG1pbk5hbWUiLCJuZXdBZG1pbk5hbWUiLCJRUkxpbmsiLCJyZXN1bHRTdGF0ZSIsImFsZXJ0VGV4dCIsImdldFVzZXJJbmZvIiwiaWQiLCJzZWFyY2giLCJ0ZXh0VHlwZSIsImNvbnNvbGUiLCJsb2ciLCJsZW5ndGgiLCJ3eF9uaWNrbmFtZSIsInVzZXJfaWQiLCJ3eF9hdmF0YXIiLCJhcHBlbmQiLCJlcnJvciIsInhociIsInN0YXR1cyIsImVyciIsImJhc2VVdGlscyIsInNob3ciLCJyZWRUaXAiLCJnZXRRUkxpbmsiLCJjaGFuZ2VDb21tdW5pdHlTdGF0ZSIsImNvbW11bml0eV9zdGF0ZSIsImJsdWVUaXAiLCJyZWxvYWQiLCJtc2ciLCJpc19uZXciLCJHZXRRdWVyeVN0cmluZyIsImZhZGVJbiIsImNsaXBib2FyZCIsIkNsaXBib2FyZCIsIm9uIiwiZSIsImNsZWFyU2VsZWN0aW9uIiwidGhpcyIsIm5leHQiLCJlbXB0eSIsImhpZGUiLCJ0cmltIiwiY2xpY2siLCJrZXlDb2RlIiwic2Nyb2xsIiwidmlld0giLCJoZWlnaHQiLCJjb250ZW50SCIsImdldCIsInNjcm9sbEhlaWdodCIsInNjcm9sbFRvcCIsImZpbmQiLCJwcm9wIiwicXJjb2RlQ29uZmlybVBheURpckNvZGUiLCJRUkNvZGUiLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwid2lkdGgiLCJjb2xvckRhcmsiLCJjb2xvckxpZ2h0IiwiY29ycmVjdExldmVsIiwiQ29ycmVjdExldmVsIiwiTCIsImNvbW11bml0eUlkIiwiY29tbXVuaXR5U3RhdGUiXSwibWFwcGluZ3MiOiJBQUFBQSxFQUFFLFdBQ0NDLGNBQWNDLFFBRWpCLElBQUlDLEdBQUksQ0FDUixJQUFJQyxPQUFRLElBQ1osU0FBVUMsY0FJTkwsRUFBRU0sS0FBSyx3QkFDSEMsS0FBTSxNQUNOQyxTQUFVLE9BQ1ZDLE1BQU1DLGFBQWVWLEVBQUUsaUJBQWlCVyxPQUN4Q0MsUUFBUSxTQUFVSCxHQUNkTixHQUFLLENBUUwsSUFBR0EsR0FBSyxJQUFJLENBQ1JBLEVBQUksQ0FDSlUsY0FBYVQsTUFDYkosR0FBRSxlQUFlYyxRQUFRLElBRXpCLElBQUlDLEdBQU8sZ0JBRVhmLEdBQUVnQixNQUFNRCxFQUFLLFFBQ1RFLE9BQVEsT0FDUkMsSUFBSyxFQUNMQyxLQUFNLFdBQ0ZDLE9BQU9DLFNBQVNDLEtBQU8saUNBRTNCQyxRQUFRLFdBQ0pILE9BQU9DLFNBQVNDLEtBQU8sbUNBT25DLEdBQUdiLEVBQUtlLE1BQVEsRUFBRSxDQUNkWCxhQUFhVCxNQUNiLElBQUlXLEdBQU8sUUFDWGYsR0FBRSxlQUFlYyxRQUFRLElBQ3pCZCxHQUFFZ0IsTUFBTUQsRUFBSyxRQUNURSxPQUFRLE9BQ1JDLElBQUssRUFDTEMsS0FBTSxXQUNGQyxPQUFPQyxTQUFTQyxLQUFPLGlDQUUzQkMsUUFBUSxXQUNKSCxPQUFPQyxTQUFTQyxLQUFPLHNDQU8zQ2xCLE9BQVFxQixXQUFXLGVBQWUsTUFFdEMsR0FBSXhCLGVBQWMsV0FDZCxHQUFJQSxLQUNKLElBQUl5QixHQUNBQyxFQUNBQyxFQUFTLEVBQ1RDLEtBQ0FDLEVBQU8sRUFDUEMsRUFBZ0IsR0FDaEJDLEVBQ0FDLEVBQWUsR0FDZkMsRUFBZSxHQUNmQyxFQUFT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Q29udGVudCI6WyIkKGZ1bmN0aW9uICgpIHtcclxuICAgY29tbXVuaXR5TGlzdC5pbml0KCk7XHJcbn0pO1xyXG52YXIgaSA9IDA7XHJcbnZhciBpVGltZSA9IG51bGw7XHJcbmZ1bmN0aW9uICByZW1haW5UaW1lKCkge1xyXG5cclxuICAgIC8v5qOA5rWL5piv5ZCm6K6+572u5oiQ5YqfXHJcblxyXG4gICAgJC5hamF4KCdpc0NvbW11bml0eUhhdmVBZG1pbicsIHtcclxuICAgICAgICB0eXBlOiAnR0VUJyxcclxuICAgICAgICBkYXRhVHlwZTogJ2pzb24nLFxyXG4gICAgICAgIGRhdGE6eydjb21tdW5pdHlfaWQnOiQoJyNjb21tdW5pdHlfaWQnKS52YWwoKX0sXHJcbiAgICAgICAgc3VjY2VzczpmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICBpICs9IDE7XHJcbiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCctLS3or7fmsYLmrKHmlbAtLS3vvJonKTtcclxuICAgICAgICAgICAgLy8gY29uc29sZS5sb2coaSk7XHJcbiAgICAgICAgICAgIC8vXHJcbiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCctLS3mo4DmtYvov5Tlm57lgLwtLS06Jyk7XHJcbiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKGRhdGEpO1xyXG5cclxuXHJcbiAgICAgICAgICAgIGlmKGkgPj0gMzAwKXtcclxuICAgICAgICAgICAgICAgIGkgPSAwO1xyXG4gICAgICAgICAgICAgICAgY2xlYXJUaW1lb3V0KGlUaW1lKTtcclxuICAgICAgICAgICAgICAgICQoXCIuZGFya1NjcmVlblwiKS5mYWRlT3V0KDMwMCk7Ly/lvLnnqpfpmpDol49cclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgdGV4dCA9ICfmgqjplb/ml7bpl7TmnKrmiavnoIEgIOivt+mHjeaWsOmqjOivgSc7XHJcblxyXG4gICAgICAgICAgICAgICAgJC5hbGVydCh0ZXh0LCdpbmZvJyx7XHJcbiAgICAgICAgICAgICAgICAgICAgb2t0ZXh0OiAn5oiR55+l6YGT5LqGJyxcclxuICAgICAgICAgICAgICAgICAgICBidG46IDIsXHJcbiAgICAgICAgICAgICAgICAgICAgb25PazogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gXCIvc21hbGxDb21tdW5pdHkvY29tbXVuaXR5TGlzdFwiO1xyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgb25DbG9zZTpmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gXCIvc21hbGxDb21tdW5pdHkvY29tbXVuaXR5TGlzdFwiO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgfVxyXG5cclxuXHJcbiAgICAgICAgICAgIGlmKGRhdGEuY29kZSA9PSAwKXtcclxuICAgICAgICAgICAgICAgIGNsZWFyVGltZW91dChpVGltZSk7XHJcbiAgICAgICAgICAgICAgICB2YXIgdGV4dCA9ICfnvqTkuLvorr7nva7miJDlip8nO1xyXG4gICAgICAgICAgICAgICAgJChcIi5kYXJrU2NyZWVuXCIpLmZhZGVPdXQoMzAwKTsvL+W8ueeql+makOiXj1xyXG4gICAgICAgICAgICAgICAgJC5hbGVydCh0ZXh0LCdpbmZvJyx7XHJcbiAgICAgICAgICAgICAgICAgICAgb2t0ZXh0OiAn5oiR55+l6YGT5LqGJyxcclxuICAgICAgICAgICAgICAgICAgICBidG46IDIsXHJcbiAgICAgICAgICAgICAgICAgICAgb25PazogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gXCIvc21hbGxDb21tdW5pdHkvY29tbXVuaXR5TGlzdFwiO1xyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgb25DbG9zZTpmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gXCIvc21hbGxDb21tdW5pdHkvY29tbXVuaXR5TGlzdFwiO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgaVRpbWUgPSBzZXRUaW1lb3V0KFwicmVtYWluVGltZSgpXCIsMTUwMCk7XHJcbn1cclxudmFyIGNvbW11bml0eUxpc3Q9ZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIGNvbW11bml0eUxpc3Q9e307XHJcbiAgICB2YXIgc2VsZWN0TnVtLFxyXG4gICAgICAgIHNlYXJjaENvbnRlbnQsXHJcbiAgICAgICAgYWpheExpc3Q9MCxcclxuICAgICAgICB1c2VyQXJyID0gW10sXHJcbiAgICAgICAgc3RlcCA9IDEsXHJcbiAgICAgICAgY2tlY2tlZFVzZXJJRCA9ICcnLFxyXG4gICAgICAgIGhvbGRlckNoYW5nZVN0YXRlLFxyXG4gICAgICAgIG9sZEFkbWluTmFtZSA9ICcnLFxyXG4gICAgICAgIG5ld0FkbWluTmFtZSA9ICcnLFxyXG4gICAgICAgIFFSTGluayA9ICcnLFxyXG4gICAgICAgIHJlc3VsdFN0YXRlID0gMCxcclxuICAgICAgICBhbGVydFRleHQgPSAnJztcclxuXHJcblxyXG5cclxuXHJcbiAgICBmdW5jdGlvbiBnZXRVc2VySW5mbyhpZCxzdGVwLHNlYXJjaCkge1xyXG4gICAgICAgICQuYWpheCgnZ2V0VXNlckluZm8nLHtcclxuICAgICAgICAgICAgdHlwZTonUE9TVCcsXHJcbiAgICAgICAgICAgIHRleHRUeXBlOidqc29uJyxcclxuICAgICAgICAgICAgZGF0YTp7XHJcbiAgICAgICAgICAgICAgICBjb21tdW5pdHlfaWQ6aWQsXHJcbiAgICAgICAgICAgICAgICBzdGVwOnN0ZXAsXHJcbiAgICAgICAgICAgICAgICBzZWFyY2g6c2VhcmNoXHJcbiAgICAgICAgICAgIH0sXHJcblxyXG4gICAgICAgICAgICBzdWNjZXNzOmZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAkKFwiLmxvYWRpbmdTXCIpLmZhZGVPdXQoMzAwKTtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGlkKTtcclxuICAgICAgICAgICAgICAgIGlmKGRhdGEuY29kZT09MCl7XHJcbiAgICAgICAgICAgICAgICAgICAgdXNlckFyciA9IGRhdGEuZGF0YTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyh1c2VyQXJyKTtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgaSA9IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IHVzZXJBcnIubGVuZ3RoO2krKyl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRleHQgPSAnPGRpdiBjbGFzcz1cImhvbGRlckxpc3RQYXJ0XCIgZGF0YS1uYW1lPVwiJyArIHVzZXJBcnJbaV0ud3hfbmlja25hbWUgKyAnXCIgZGF0YS11c2VyaWQ9XCInICsgdXNlckFycltpXS51c2VyX2lkICsgJ1wiPjxkaXYgY2xhc3M9XCJob2xkZXJDaGVja0JveFwiPiA8aW5wdXQgY2xhc3M9XCJ3aXRoLWdhcFwiIGlkPVwiJyArIHVzZXJBcnJbaV0udXNlcl9pZCArICdcIiBuYW1lPVwiZ3JvdXAyXCIgdHlwZT1cInJhZGlvXCIgLz4gPGxhYmVsIGZvcj1cIicgKyB1c2VyQXJyW2ldLnVzZXJfaWQgKyAnXCI+IDwvbGFiZWw+IDwvZGl2PiA8ZGl2IGNsYXNzPVwiaG9sZGVyTGlzdEltZ1wiPjxpbWcgc3JjPVwiJyArIHVzZXJBcnJbaV0ud3hfYXZhdGFyICsgJ1wiPjwvZGl2PiA8c3BhbiBjbGFzcz1cImhvbGRlckxpc3ROYW1lXCI+JyArIHVzZXJBcnJbaV0ud3hfbmlja25hbWUgKyAnPC9zcGFuPiA8L2Rpdj4nXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICQoJy5ob2xkZXJMaXN0Q29udGVudCcpLmFwcGVuZCh0ZXh0KTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3VsdFN0YXRlID09IDApe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0ZXh0PSc8cCBjbGFzcz1cInNlYXJjaE5vbmVcIj4nICArIGFsZXJ0VGV4dCArICcgPC9wPic7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICQoJy5ob2xkZXJMaXN0Q29udGVudCcpLmFwcGVuZCh0ZXh0KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0U3RhdGUgPSAxO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGVycm9yOmZ1bmN0aW9uICh4aHIsc3RhdHVzLGVycikge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyKTtcclxuICAgICAgICAgICAgICAgIGJhc2VVdGlscy5zaG93LnJlZFRpcCgn572R57uc6ZSZ6K+v77yM6K+356iN5ZCO5YaN6K+V77yBJyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KVxyXG4gICAgICAgIFxyXG4gICAgfVxyXG4gICAgXHJcbiAgICBmdW5jdGlvbiBnZXRRUkxpbmsoaWQpIHtcclxuICAgICAgICAkLmFqYXgoJ2dldENvbW11bml0eUxpbmtTZXRBZG1pbicse1xyXG4gICAgICAgICAgICB0eXBlOidQT1NUJyxcclxuICAgICAgICAgICAgdGV4dFR5cGU6J2pzb24nLFxyXG4gICAgICAgICAgICBkYXRhOntcclxuICAgICAgICAgICAgICAgIGNvbW11bml0eV9pZDppZFxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBzdWNjZXNzOmZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhkYXRhKTtcclxuICAgICAgICAgICAgICAgIGlmKGRhdGEuY29kZT09MCl7XHJcbiAgICAgICAgICAgICAgICAgICAgUVJMaW5rID0gZGF0YS5kYXRhO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBlcnJvcjpmdW5jdGlvbiAoeGhyLHN0YXR1cyxlcnIpIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycik7XHJcbiAgICAgICAgICAgICAgICBRUkxpbmsgPSAn5pyN5Yqh5Zmo5Ye66ZSZ5LqGIOivt+eojeWQjuWGjeivlSc7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KVxyXG4gICAgICAgIFxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGNoYW5nZUNvbW11bml0eVN0YXRlKGlkLGNvbW11bml0eV9zdGF0ZSl7XHJcbiAgICAgICAgJC5hamF4KCdjaGFuZ2VDb21tdW5pdHlTdGF0ZScse1xyXG4gICAgICAgICAgICB0eXBlOidQT1NUJyxcclxuICAgICAgICAgICAgdGV4dFR5cGU6J2pzb24nLFxyXG4gICAgICAgICAgICBkYXRhOntcclxuICAgICAgICAgICAgICAgIGlkOmlkLFxyXG4gICAgICAgICAgICAgICAgY29tbXVuaXR5X3N0YXRlOmNvbW11bml0eV9zdGF0ZVxyXG5cclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgc3VjY2VzczpmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgaWYoZGF0YS5jb2RlPT0wKXtcclxuICAgICAgICAgICAgICAgICAgICBpZihjb21tdW5pdHlfc3RhdGU9PTApe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBiYXNlVXRpbHMuc2hvdy5ibHVlVGlwKCflt7LkuIrmnrbvvIzlvZPliY3lsI/npL7nvqTlsIblnKjlupflhoXlsZXnpLonKTtcclxuICAgICAgICAgICAgICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYmFzZVV0aWxzLnNob3cuYmx1ZVRpcCgn5bey5LiL5p6277yM5b2T5YmN5bCP56S+576k5bCG5LiN5Zyo5bqX5YaF5bGV56S6Jyk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uLnJlbG9hZCgpO1xyXG4gICAgICAgICAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgICAgICAgICAgYmFzZVV0aWxzLnNob3cucmVkVGlwKCfmk43kvZzlpLHotKUhJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coZGF0YS5tc2cpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBlcnJvcjpmdW5jdGlvbiAoeGhyLHN0YXR1cyxlcnIpIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycik7XHJcbiAgICAgICAgICAgICAgICBiYXNlVXRpbHMuc2hvdy5yZWRUaXAoJ+e9kee7nOmUmeivr++8jOivt+eojeWQjuWGjeivle+8gScpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSlcclxuICAgIH1cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcbiAgICBjb21tdW5pdHlMaXN0LmluaXQ9ZnVuY3Rpb24gKCkge1xyXG5cclxuICAgICAgICAvLyAg5pi+56S66K6+572u576k5Li755qE5o+Q56S6XHJcbiAgICAgICAgdmFyIGlzX25ldyA9IEdldFF1ZXJ5U3RyaW5nKFwiaXNfbmV3XCIpO1xyXG4gICAgICAgIGlmIChpc19uZXcgPT0gMSl7XHJcbiAgICAgICAgICAgICQoXCIubmV3Q29tbXVuaXR5VGlwV3JhcHBlclwiKS5mYWRlSW4oMzAwKTtcclxuICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAkKFwiLm5ld0NvbW11bml0eVRpcFdyYXBwZXJcIikuZmFkZU91dCg3MDApO1xyXG4gICAgICAgICAgICB9LCA1MDAwKTtcclxuICAgICAgICB9XHJcblxyXG5cclxuXHJcblxyXG4gICAgICAgIC8v5aSN5Yi25Yiw5Ymq6LS05p2/XHJcbiAgICAgICAgKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIGNsaXBib2FyZCA9IG5ldyBDbGlwYm9hcmQoJy5jb3B5SHJlZicpO1xyXG4gICAgICAgICAgICBjbGlwYm9hcmQub24oJ3N1Y2Nlc3MnLCBmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICAgICAgICBiYXNlVXRpbHMuc2hvdy5ibHVlVGlwKFwi5aSN5Yi25oiQ5Yqf77yB6K+35Zyo5b6u5L+h5YaF5omT5byA5ZOmIOOAglwiKTtcclxuICAgICAgICAgICAgICAgIGUuY2xlYXJTZWxlY3Rpb24oKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSkoKTtcclxuXHJcblxyXG4gICAgICAgICQoXCJib2R5XCIpLm9uKCdtb3VzZWVudGVyJywnLnByb2R1Y3RDb3VudEJveCcsZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAkKHRoaXMpLm5leHQoKS5mYWRlSW4oMjAwKTtcclxuICAgICAgICB9KTtcclxuXHJcblxyXG4gICAgICAgICQoXCJib2R5XCIpLm9uKCdtb3VzZWxlYXZlJywnLnByb2R1Y3RDb3VudEJveCcsZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAkKHRoaXMpLm5leHQoKS5mYWRlT3V0KDIwMCk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICQoXCIudG9vbEJveFwiKS5vbignY2xpY2snLCcuc2V0SG9sZGVyQnRuJyxmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJlc3VsdFN0YXRlID0gMDtcclxuICAgICAgICAgICAgc3RlcCA9IDE7XHJcbiAgICAgICAgICAgIHZhciBpZCA9ICQodGhpcykuZGF0YSgnaWQnKTtcclxuICAgICAgICAgICAgJCgnI2NvbW11bml0eV9pZCcpLnZhbChpZCk7XHJcbiAgICAgICAgICAgICQoXCIuZGFya1NjcmVlblwiKS5mYWRlSW4oMzAwKTtcclxuICAgICAgICAgICAgJCgnLmhvbGRlclNlYXJjaElucHV0JykudmFsKCcnKTtcclxuICAgICAgICAgICAgJCgnLmhvbGRlckxpc3RDb250ZW50JykuZW1wdHkoKTtcclxuICAgICAgICAgICAgZ2V0VXNlckluZm8oaWQsMSk7XHJcblxyXG4gICAgICAgICAgICBob2xkZXJDaGFuZ2VTdGF0ZT0wO1xyXG4gICAgICAgICAgICAkKCcuc2V0QWRtaW4nKS5zaG93KCk7ICAvL+aYvuekuuS6jOe7tOeggVxyXG4gICAgICAgICAgICBnZXRRUkxpbmsoaWQpO1xyXG4gICAgICAgICAgICBhbGVydFRleHQgPSAn5pqC5peg57uT5p6c77yM6K+35b6u5L+h5omr5LiA5omr6K6+572u576k5Li7JztcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgJChcIi50b29sQm94XCIpLm9uKCdjbGljaycsJy5jaGFuZ2VIb2xkZXJCdG4nLGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmVzdWx0U3RhdGUgPSAwO1xyXG4gICAgICAgICAgICBzdGVwID0gMTtcclxuICAgICAgICAgICAgdmFyIGlkID0gJCh0aGlzKS5kYXRhKCdpZCcpO1xyXG4gICAgICAgICAgICAkKCcjY29tbXVuaXR5X2lkJykudmFsKGlkKTtcclxuICAgICAgICAgICAgJChcIi5kYXJrU2NyZWVuXCIpLmZhZGVJbigzMDApO1xyXG4gICAgICAgICAgICAkKCcuaG9sZGVyU2VhcmNoSW5wdXQnKS52YWwoJycpO1xyXG4gICAgICAgICAgICAkKCcuaG9sZGVyTGlzdENvbnRlbnQnKS5lbXB0eSgpO1xyXG4gICAgICAgICAgICBnZXRVc2VySW5mbyhpZCwxKTtcclxuICAgICAgICAgICAgYWxlcnRUZXh0ID0gJ+aaguaXoOe7k+aenCc7XHJcblxyXG4gICAgICAgICAgICBob2xkZXJDaGFuZ2VTdGF0ZT0xO1xyXG4gICAgICAgICAgICAkKCcuc2V0QWRtaW4nKS5oaWRlKCk7ICAvL+makOiXj+S6jOe7tOeggVxyXG4gICAgICAgICAgICBvbGRBZG1pbk5hbWUgPSAkKHRoaXMpLmRhdGEoJ29sZCcpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICAkKFwiLkdyb3VwSG9sZGVyU2V0Qm94XCIpLm9uKCdjbGljaycsJy5ob2xkZXJTZXRDbG9zZScsZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAkKFwiLmRhcmtTY3JlZW5cIikuZmFkZU91dCgzMDApO1xyXG4gICAgICAgIH0pO1xyXG5cclxuXHJcbiAgICAgICAgLy/npL7nvqTmkJzntKJcclxuICAgICAgICAkKFwiYm9keVwiKS5vbignY2xpY2snLCcuc2VhcmNoQWxsQnRuJyxmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHNlbGVjdE51bT0kKFwiI3NlbGVjdG9yXCIpLnZhbCgpO1xyXG4gICAgICAgICAgICBzZWFyY2hDb250ZW50PSQudHJpbSgkKFwiLmlucHV0U2VhcmNoQWxsXCIpLnZhbCgpKTtcclxuICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uPSdjb21tdW5pdHlMaXN0P3J1bGVyPScrc2VsZWN0TnVtK1wiJnNlYXJjaD1cIitzZWFyY2hDb250ZW50O1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICAvLyAg54K55Ye7562b6YCJ6Kem5Y+R5pCc57SiXHJcbiAgICAgICAgJChcIiNzZWxlY3RvclwiKS5vbihcImNoYW5nZVwiLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAkKFwiLnNlYXJjaEFsbEJ0blwiKS5jbGljaygpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICAvLyAg5Zue6L2m6Kem5Y+R5pCc57SiXHJcbiAgICAgICAgJChcIi5pbnB1dFNlYXJjaEFsbFwiKS5vbihcImtleXByZXNzXCIsIGZ1bmN0aW9uIChlKSB7XHJcbiAgICAgICAgICAgIGlmIChlLmtleUNvZGUgPT0gMTMpIHtcclxuICAgICAgICAgICAgICAgICQoXCIuc2VhcmNoQWxsQnRuXCIpLmNsaWNrKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgLy/nlKjmiLfmkJzntKJcclxuICAgICAgICAkKFwiLkdyb3VwSG9sZGVyU2V0Qm94XCIpLm9uKCdjbGljaycsJy5ob2xkZXJTZWFyY2hCdG4nLGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmVzdWx0U3RhdGUgPSAwO1xyXG4gICAgICAgICAgICBzdGVwID0gMTtcclxuICAgICAgICAgICAgJChcIi5sb2FkaW5nU1wiKS5mYWRlSW4oMzAwKTtcclxuICAgICAgICAgICAgJCgnLmhvbGRlckxpc3RDb250ZW50JykuZW1wdHkoKTtcclxuICAgICAgICAgICAgZ2V0VXNlckluZm8oJCgnI2NvbW11bml0eV9pZCcpLnZhbCgpLHN0ZXAsJCgnLmhvbGRlclNlYXJjaElucHV0JykudmFsKCkpO1xyXG5cclxuICAgICAgICB9KVxyXG5cclxuICAgICAgICAvL+eUqOaIt+WIl+ihqOS4i+aLieaYvuekuuS4i+S4gOmhtVxyXG4gICAgICAgICQoXCIuaG9sZGVyTGlzdFwiKS5zY3JvbGwoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgdmlld0g9JCh0aGlzKS5oZWlnaHQoKTsvL+WPr+ingemrmOW6plxyXG4gICAgICAgICAgICB2YXIgY29udGVudEggPSQodGhpcykuZ2V0KDApLnNjcm9sbEhlaWdodDsvL+WGheWuuemrmOW6plxyXG4gICAgICAgICAgICB2YXIgc2Nyb2xsVG9wID0kKHRoaXMpLnNjcm9sbFRvcCgpOy8v5rua5Yqo6auY5bqmXHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGNvbnRlbnRIKTtcclxuICAgICAgICAgICAgY29uc29sZS5sb2codmlld0gpO1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhzY3JvbGxUb3ApO1xyXG5cclxuICAgICAgICAgICAgaWYoY29udGVudEggLSB2aWV3SCAtIHNjcm9sbFRvcDw9MzUpe1xyXG5cclxuICAgICAgICAgICAgICAgIGlmKGFqYXhMaXN0PT0wKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc3RlcCsrO1xyXG4gICAgICAgICAgICAgICAgICAgIGdldFVzZXJJbmZvKCQoJyNjb21tdW5pdHlfaWQnKS52YWwoKSxzdGVwLCQoJy5ob2xkZXJTZWFyY2hJbnB1dCcpLnZhbCgpKTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygn5bey57uP5rua5Yiw5bqV6YOo5LqGJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgYWpheExpc3Q9MTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgICAgICBhamF4TGlzdD0wO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAvLyAg55So5oi35YiX6KGo5a2Q5Y2V5YWD54K55Ye75LqL5Lu25YWz6IGUXHJcbiAgICAgICAgJChcIi5ob2xkZXJMaXN0XCIpLm9uKCdjbGljaycsJy5ob2xkZXJMaXN0UGFydCcsZnVuY3Rpb24gKCkge1xyXG5cclxuICAgICAgICAgICAgJCh0aGlzKS5maW5kKFwiaW5wdXRcIikucHJvcChcImNoZWNrZWRcIiwgdHJ1ZSk7XHJcbiAgICAgICAgICAgIC8vICAgIOiOt+WPlumAieS4reeUqOaIt+eahGlk5ZCNXHJcbiAgICAgICAgICAgIGNrZWNrZWRVc2VySUQgPSAkKHRoaXMpLmRhdGEoJ3VzZXJpZCcpO1xyXG4gICAgICAgICAgICBuZXdBZG1pbk5hbWUgPSAkKHRoaXMpLmRhdGEoJ25hbWUnKTtcclxuXHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGNrZWNrZWRVc2VySUQpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICAkKCcuYm94Q29uZmlybScpLmNsaWNrKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICBpZihob2xkZXJDaGFuZ2VTdGF0ZT09MSl7XHJcbiAgICAgICAgICAgICAgICQuYWxlcnQoJ+W9k+WJjee+pOS4u+S4uicrIG9sZEFkbWluTmFtZSArJyznoa7orqTlsIbnvqTkuLvovaznp7vnu5knICsgbmV3QWRtaW5OYW1lICsgJ+WQl++8n+i9rOenu+WQju+8jOWJjee+pOS4u+abvue7j+WPkeeahOWKqOaAgeS/neeVmeWcqOe+pOS4u+WKqOaAgeS4re+8jOaWsOe+pOS4u+aWsOWPkeeahOWKqOaAgeWwhuaYvuekuuWcqOe+pOS4u+WKqOaAgeS4rScgLCAnaW5mbycse1xyXG4gICAgICAgICAgICAgICAgICAgYnRuOjMsXHJcbiAgICAgICAgICAgICAgICAgICBvbk9rOmZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgJC5hamF4KCdzZXRDb21tdW5pdHlBZG1pbicse1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOidQT1NUJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dFR5cGU6J2pzb24nLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhOntcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbW11bml0eV9pZDokKCcjY29tbXVuaXR5X2lkJykudmFsKCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2VyX2lkOmNrZWNrZWRVc2VySURcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczpmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoZGF0YS5jb2RlPT0wKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiYXNlVXRpbHMuc2hvdy5ibHVlVGlwKCfmk43kvZzmiJDlip/vvIEnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9IFwiL3NtYWxsQ29tbXVuaXR5L2NvbW11bml0eUxpc3RcIjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3I6ZnVuY3Rpb24gKHhocixzdGF0dXMsZXJyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmFzZVV0aWxzLnNob3cucmVkVGlwKCfnvZHnu5zplJnor6/vvIzor7fnqI3lkI7lho3or5XvvIEnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICB9ZWxzZSB7XHJcbiAgICAgICAgICAgICAgICQuYWpheCgnc2V0Q29tbXVuaXR5QWRtaW4nLCB7XHJcbiAgICAgICAgICAgICAgICAgICB0eXBlOiAnUE9TVCcsXHJcbiAgICAgICAgICAgICAgICAgICB0ZXh0VHlwZTogJ2pzb24nLFxyXG4gICAgICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgICAgIGNvbW11bml0eV9pZDogJCgnI2NvbW11bml0eV9pZCcpLnZhbCgpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgIHVzZXJfaWQ6IGNrZWNrZWRVc2VySURcclxuICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgIGlmIChkYXRhLmNvZGUgPT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICBiYXNlVXRpbHMuc2hvdy5ibHVlVGlwKCfmk43kvZzmiJDlip/vvIEnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSBcIi9zbWFsbENvbW11bml0eS9jb21tdW5pdHlMaXN0XCI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgIGVycm9yOiBmdW5jdGlvbiAoeGhyLCBzdGF0dXMsIGVycikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgYmFzZVV0aWxzLnNob3cucmVkVGlwKCfnvZHnu5zplJnor6/vvIzor7fnqI3lkI7lho3or5XvvIEnKTtcclxuICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgIC8vICAg6K6+572u5b6u5L+h5aW95Y+L5Li6576k5Li7XHJcbiAgICAgICAgJChcIi5Hcm91cEhvbGRlclNldEJveFwiKS5vbignbW91c2VlbnRlcicsJy5zZXRXeEZyaWVuZCcsZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAvLyDnlJ/miJDkuoznu7TnoIFcclxuXHJcbiAgICAgICAgICAgIGkgPSAwO1xyXG4gICAgICAgICAgICB2YXIgcXJjb2RlQ29uZmlybVBheURpckNvZGUgPSBuZXcgUVJDb2RlKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicXJJbWdJZFwiKSxcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICB0ZXh0OlFSTGluayxcclxuICAgICAgICAgICAgICAgICAgICB3aWR0aDogMTIwLFxyXG4gICAgICAgICAgICAgICAgICAgIGhlaWdodDogMTIwLFxyXG4gICAgICAgICAgICAgICAgICAgIGNvbG9yRGFyayA6IFwiIzAwMDAwMFwiLFxyXG4gICAgICAgICAgICAgICAgICAgIGNvbG9yTGlnaHQgOiBcIiNmZmZmZmZcIixcclxuICAgICAgICAgICAgICAgICAgICBjb3JyZWN0TGV2ZWwgOiBRUkNvZGUuQ29ycmVjdExldmVsLkxcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgJChcIi5xckNvZGVQYXBlclwiKS5mYWRlSW4oMTAwKTtcclxuICAgICAgICAgICAgcmVtYWluVGltZSgpO1xyXG5cclxuXHJcblxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICAkKFwiLkdyb3VwSG9sZGVyU2V0Qm94XCIpLm9uKCdtb3VzZWxlYXZlJywnLnNldFd4RnJpZW5kJyxmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGNsZWFyVGltZW91dChpVGltZSk7XHJcbiAgICAgICAgICAgICQoXCIjcXJJbWdJZFwiKS5lbXB0eSgpO1xyXG4gICAgICAgICAgICAkKFwiLnFyQ29kZVBhcGVyXCIpLmZhZGVPdXQoMTApO1xyXG5cclxuICAgICAgICB9KTtcclxuICAgICAgICBcclxuXHJcblxyXG4gICAgLy8gICAg5LiK5LiL5p625pON5L2cXHJcbiAgICAgICAgJChcIi50b29sQm94XCIpLm9uKCdjbGljaycsJy5jb21tdW5pdHlIaWRlJyxmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciBjb21tdW5pdHlJZD0kKHRoaXMpLmRhdGEoJ2lkJyk7XHJcbiAgICAgICAgICAgIHZhciBjb21tdW5pdHlTdGF0ZT0xO1xyXG4gICAgICAgICAgICBjaGFuZ2VDb21tdW5pdHlTdGF0ZShjb21tdW5pdHlJZCwgY29tbXVuaXR5U3RhdGUpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICAkKFwiLnRvb2xCb3hcIikub24oJ2NsaWNrJywnLmNvbW11bml0eVNob3cnLGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIGNvbW11bml0eUlkPSQodGhpcykuZGF0YSgnaWQnKTtcclxuICAgICAgICAgICAgdmFyIGNvbW11bml0eVN0YXRlPTA7XHJcbiAgICAgICAgICAgIGNoYW5nZUNvbW11bml0eVN0YXRlKGNvbW11bml0eUlkLCBjb21tdW5pdHlTdGF0ZSk7XHJcbiAgICAgICAgfSlcclxuXHJcbiAgICB9O1xyXG5cclxuICAgIHJldHVybiBjb21tdW5pdHlMaXN0O1xyXG59KCk7Il19
