$(document).ready(function(){Business.init()});var Business=function(){var e={};e.coverImgUrl="";e.page_type="";e.member_id="";e.page_origin="";e.init=function(){e.page_type=$(".admin_data").data("type");e.member_id=GetQueryString("id");e.page_origin=GetQueryString("page_origin");if(e.page_type==0||e.page_origin=="member_list"){$(".go_back").html("会员列表")}else{$(".go_back").html("会员详情")}$(".cancelBtn, .go_back").click(function(){if(e.page_type==0||e.page_origin=="member_list"){window.location.href="/member_list_page"}else{window.location.href="/member_detail_page?id="+e.member_id}});$(".memberCoverImg").click(function(){$(".uploadCoverInput").click()});$(".uploadCoverInput").on("change",function(i){if(this.files&&this.files.length>0){var a=this.files[0];var r=5;if($uploadFile.checkFileSize(a,r)){showLoading();$uploadFile.uploadPic(a,function(i){hideLoading();baseUtils.show.blueTip("上传成功！");e.coverImgUrl=i.data.access_url;if(e.coverImgUrl){$(".memberCoverImg img").attr("src",e.coverImgUrl);$("#coverImgUrl").val(e.coverImgUrl)}},function(e){hideLoading();console.log(e);baseUtils.show.redTip("上传失败！")})}else{baseUtils.show.redTip("上传图片限制在"+r+"MB内！")}}else{console.log(this.files)}});changeSaveFlag(true);$(".saveBtn").click(function(){var i=$.trim($(".memberNameInput").val());if($formCheck.emptyString(i)){baseUtils.show.redTip("会员名称不能为空！");return false}var a=$.trim($(".memberSummaryTextArea").val());if($formCheck.emptyString(a)){baseUtils.show.redTip("会员简介不能为空！");return false}var r=$("#coverImgUrl").val();if($formCheck.emptyString(r)){baseUtils.show.redTip("会员封面不能为空！");return false}var t=$.trim($(".memberPriceInput").val());if($formCheck.emptyString(t)){baseUtils.show.redTip("会员价格不能为空！");return false}if(t<=0){baseUtils.show.redTip("会员价格不能为 0 或负数！");return false}if(t>baseUtils.maxInputPrice){baseUtils.show.redTip("价格不能大于 "+baseUtils.maxInputPrice+" 元");return false}var o={};o["name"]=i;o["summary"]=a;o["img_url"]=r;o["img_url_compressed"]=r;o["price"]=t*100;var s=parseInt($(".selectValidPeriod").val());switch(s){case 1:s=2592e3;break;case 2:s=7776e3;break;case 3:s=15811200;break;case 4:s=31622400;break;default:break}o["period"]=s;var n=UE.getEditor("container");o["org_content"]=n.getContent();o["descrb"]=n.getPlainTxt();var l=[];$('input[name="category"]:checked').each(function(){l.push($(this).attr("id"))});o["state"]=$("input[name='showMember']:checked").val();o["is_member"]=1;o["id"]=GetQueryString("id");if(e.page_type==0){o["member_icon_default"]="http://wxresource-10011692.file.myqcloud.com/manual/icon_member_diamond_gray.png";o["member_icon_highlight"]="http://wxresource-10011692.file.myqcloud.com/manual/icon_member_diamond.png";memberUtils.uploadMemberInfo(o,l)}else{memberUtils.editedMemberInfo(o,l)}})};return e}();var memberUtils=function(){var e={};e.editedMemberInfo=function(e,i){showLoading();$.ajax("/goods_edit_package",{type:"POST",dataType:"json",data:{params:e,category_type:i},success:function(e){if(e.code==0){baseUtils.show.blueTip("编辑会员成功！");$(".go_back").click()}else{hideLoading();baseUtils.show.redTip("编辑失败，请稍后再试！")}},error:function(e,i,a){hideLoading();console.log(a);baseUtils.show.redTip("服务器开小差了，请稍后再试！")}})};e.uploadMemberInfo=function(e,i){showLoading();$.ajax("/goods_upload_package",{type:"POST",dataType:"json",data:{params:e,category_type:i},success:function(e){if(e.code==0){baseUtils.show.blueTip("新建会员成功！");window.location.href="/member_list_page"}else{hideLoading();baseUtils.show.redTip("新建失败，请稍后再试！")}},error:function(e,i,a){hideLoading();console.log(a);baseUtils.show.redTip("服务器开小差了，请稍后再试！")}})};return e}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFkbWluL3Jlc01hbmFnZS9tYW5hZ2VNZW1iZXIuanMiXSwibmFtZXMiOlsiJCIsImRvY3VtZW50IiwicmVhZHkiLCJCdXNpbmVzcyIsImluaXQiLCJjb3ZlckltZ1VybCIsInBhZ2VfdHlwZSIsIm1lbWJlcl9pZCIsInBhZ2Vfb3JpZ2luIiwiZGF0YSIsIkdldFF1ZXJ5U3RyaW5nIiwiaHRtbCIsImNsaWNrIiwid2luZG93IiwibG9jYXRpb24iLCJocmVmIiwib24iLCJlIiwidGhpcyIsImZpbGVzIiwibGVuZ3RoIiwiZmlsZSIsImxpbWl0U2l6ZSIsIiR1cGxvYWRGaWxlIiwiY2hlY2tGaWxlU2l6ZSIsInNob3dMb2FkaW5nIiwidXBsb2FkUGljIiwicmVzdWx0IiwiaGlkZUxvYWRpbmciLCJiYXNlVXRpbHMiLCJzaG93IiwiYmx1ZVRpcCIsImFjY2Vzc191cmwiLCJhdHRyIiwidmFsIiwiY29uc29sZSIsImxvZyIsInJlZFRpcCIsImNoYW5nZVNhdmVGbGFnIiwibWVtYmVyTmFtZSIsInRyaW0iLCIkZm9ybUNoZWNrIiwiZW1wdHlTdHJpbmciLCJtZW1iZXJTdW1tYXJ5IiwibWVtYmVyUHJpY2UiLCJtYXhJbnB1dFByaWNlIiwicGFyYW1zIiwibWVtYmVyVmFsaWRQZXJpb2QiLCJwYXJzZUludCIsInVlIiwiVUUiLCJnZXRFZGl0b3IiLCJnZXRDb250ZW50IiwiZ2V0UGxhaW5UeHQiLCJtZW1iZXJDYXRlZ29yeUFycmF5IiwiZWFjaCIsInB1c2giLCJtZW1iZXJVdGlscyIsInVwbG9hZE1lbWJlckluZm8iLCJlZGl0ZWRNZW1iZXJJbmZvIiwidXRpbHMiLCJjYXRlZ29yeVR5cGVBcnIiLCJhamF4IiwidHlwZSIsImRhdGFUeXBlIiwiY2F0ZWdvcnlfdHlwZSIsInN1Y2Nlc3MiLCJjb2RlIiwiZXJyb3IiLCJ4aHIiLCJzdGF0dXMiLCJlcnIiXSwibWFwcGluZ3MiOiJBQUtBQSxFQUFFQyxVQUFVQyxNQUFNLFdBQ2RDLFNBQVNDLFFBSWIsSUFBSUQsVUFB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QixjQUFlSixHQUVuQ0ssUUFBUyxTQUFVdkMsR0FDZixHQUFJQSxFQUFPd0MsTUFBUSxFQUFHLENBQ2xCdEMsVUFBVUMsS0FBS0MsUUFBUSxVQUN2QmxCLFFBQU9DLFNBQVNDLEtBQU8sd0JBQ3BCLENBQ0hhLGFBQ0FDLFdBQVVDLEtBQUtPLE9BQU8saUJBRzlCK0IsTUFBTyxTQUFVQyxFQUFLQyxFQUFRQyxHQUMxQjNDLGFBQ0FPLFNBQVFDLElBQUltQyxFQUNaMUMsV0FBVUMsS0FBS08sT0FBTyxxQkFPbEMsT0FBT3VCIiwiZmlsZSI6ImFkbWluL3Jlc01hbmFnZS9tYW5hZ2VNZW1iZXIuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICogQ3JlYXRlZCBieSBBZG1pbmlzdHJhdG9yIG9uIDIwMTcvMy8yMS5cclxuICovXHJcblxyXG5cclxuJChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24gKCkge1xyXG4gICAgQnVzaW5lc3MuaW5pdCgpO1xyXG5cclxufSk7XHJcblxyXG52YXIgQnVzaW5lc3MgPSAoZnVuY3Rpb24gKCkge1xyXG5cclxuICAgIHZhciBCdXNpbmVzcyA9IHt9O1xyXG5cclxuICAgIEJ1c2luZXNzLmNvdmVySW1nVXJsID0gXCJcIjtcclxuICAgIEJ1c2luZXNzLnBhZ2VfdHlwZSA9IFwiXCI7XHJcbiAgICBCdXNpbmVzcy5tZW1iZXJfaWQgPSBcIlwiO1xyXG4gICAgQnVzaW5lc3MucGFnZV9vcmlnaW4gPSBcIlwiO1xyXG5cclxuICAgIEJ1c2luZXNzLmluaXQgPSBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgICAgIEJ1c2luZXNzLnBhZ2VfdHlwZSA9ICQoXCIuYWRtaW5fZGF0YVwiKS5kYXRhKFwidHlwZVwiKTsgICAgICAvLyAg6I635Y+W5b2T5YmN6aG16Z2i57G75Z6LIO+8iDAgLT4g5paw5aKeIO+8myAxIC0+IOe8lui+ke+8iVxyXG5cclxuICAgICAgICBCdXNpbmVzcy5tZW1iZXJfaWQgPSBHZXRRdWVyeVN0cmluZyhcImlkXCIpO1xyXG4gICAgICAgIEJ1c2luZXNzLnBhZ2Vfb3JpZ2luID0gR2V0UXVlcnlTdHJpbmcoXCJwYWdlX29yaWdpblwiKTtcclxuXHJcbiAgICAgICAgLy8gIOehruWumumhtemdouadpea6kFxyXG4gICAgICAgIGlmIChCdXNpbmVzcy5wYWdlX3R5cGUgPT0gMCB8fCBCdXNpbmVzcy5wYWdlX29yaWdpbiA9PSBcIm1lbWJlcl9saXN0XCIpIHtcclxuICAgICAgICAgICAgJChcIi5nb19iYWNrXCIpLmh0bWwoXCLkvJrlkZjliJfooahcIik7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgJChcIi5nb19iYWNrXCIpLmh0bWwoXCLkvJrlkZjor6bmg4VcIik7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyDkuIrkuIDmraVcclxuICAgICAgICAkKFwiLmNhbmNlbEJ0biwgLmdvX2JhY2tcIikuY2xpY2soZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBpZiAoQnVzaW5lc3MucGFnZV90eXBlID09IDAgfHwgQnVzaW5lc3MucGFnZV9vcmlnaW4gPT0gXCJtZW1iZXJfbGlzdFwiKSB7XHJcbiAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9ICcvbWVtYmVyX2xpc3RfcGFnZSc7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9ICcvbWVtYmVyX2RldGFpbF9wYWdlP2lkPScgKyBCdXNpbmVzcy5tZW1iZXJfaWQ7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIC8vICDngrnlh7vlm77niYdcclxuICAgICAgICAkKFwiLm1lbWJlckNvdmVySW1nXCIpLmNsaWNrKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgJChcIi51cGxvYWRDb3ZlcklucHV0XCIpLmNsaWNrKCk7XHJcbiAgICAgICAgfSlcclxuXHJcbiAgICAgICAgLy8g5LiK5Lyg5Lya5ZGY5bCB6Z2iXHJcbiAgICAgICAgJChcIi51cGxvYWRDb3ZlcklucHV0XCIpLm9uKFwiY2hhbmdlXCIsZnVuY3Rpb24gKGUpIHtcclxuICAgICAgICAgICAgaWYodGhpcy5maWxlcyAmJiB0aGlzLmZpbGVzLmxlbmd0aD4wKXtcclxuICAgICAgICAgICAgICAgIHZhciBmaWxlID0gdGhpcy5maWxlc1swXTtcclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgbGltaXRTaXplID0gNTsgIC8vIOmZkOWItuS4iuS8oOWkp+Wwjy8vIOmZkOWItuWbvueJh+WcqDVNQuWGhVxyXG5cclxuICAgICAgICAgICAgICAgIGlmKCR1cGxvYWRGaWxlLmNoZWNrRmlsZVNpemUoZmlsZSxsaW1pdFNpemUpKXtcclxuICAgICAgICAgICAgICAgICAgICBzaG93TG9hZGluZygpO1xyXG4gICAgICAgICAgICAgICAgICAgICR1cGxvYWRGaWxlLnVwbG9hZFBpYyhmaWxlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyDmiJDlip/lm57osINcclxuICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKHJlc3VsdCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaGlkZUxvYWRpbmcoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhc2VVdGlscy5zaG93LmJsdWVUaXAoXCLkuIrkvKDmiJDlip/vvIFcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBCdXNpbmVzcy5jb3ZlckltZ1VybCA9IHJlc3VsdC5kYXRhLmFjY2Vzc191cmw7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihCdXNpbmVzcy5jb3ZlckltZ1VybCl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJChcIi5tZW1iZXJDb3ZlckltZyBpbWdcIikuYXR0cihcInNyY1wiLCBCdXNpbmVzcy5jb3ZlckltZ1VybCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJChcIiNjb3ZlckltZ1VybFwiKS52YWwoQnVzaW5lc3MuY292ZXJJbWdVcmwpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyDlpLHotKXlm57osINcclxuICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhpZGVMb2FkaW5nKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhkYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhc2VVdGlscy5zaG93LnJlZFRpcChcIuS4iuS8oOWksei0pe+8gVwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBiYXNlVXRpbHMuc2hvdy5yZWRUaXAoXCLkuIrkvKDlm77niYfpmZDliLblnKhcIitsaW1pdFNpemUrXCJNQuWGhe+8gVwiKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHRoaXMuZmlsZXMpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgLy/ngrnlh7vkvqfovrnmoI/nprvlvIDml7bnmoTlvLnmoYZcclxuICAgICAgICBjaGFuZ2VTYXZlRmxhZyh0cnVlKTtcclxuXHJcblxyXG4gICAgICAgIC8vICDkv53lrZjmjInpkq5cclxuICAgICAgICAkKFwiLnNhdmVCdG5cIikuY2xpY2soZnVuY3Rpb24gKCkge1xyXG5cclxuICAgICAgICAgICAgLy8gIDEgLT4g5byA5aeL5qOA5p+l5b+F6KaB6L6T5YWl5L+h5oGvXHJcblxyXG4gICAgICAgICAgICB2YXIgbWVtYmVyTmFtZSA9ICQudHJpbSgkKFwiLm1lbWJlck5hbWVJbnB1dFwiKS52YWwoKSk7XHJcbiAgICAgICAgICAgIGlmICgkZm9ybUNoZWNrLmVtcHR5U3RyaW5nKG1lbWJlck5hbWUpKSB7XHJcbiAgICAgICAgICAgICAgICBiYXNlVXRpbHMuc2hvdy5yZWRUaXAoXCLkvJrlkZjlkI3np7DkuI3og73kuLrnqbrvvIFcIik7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdmFyIG1lbWJlclN1bW1hcnkgPSAkLnRyaW0oJChcIi5tZW1iZXJTdW1tYXJ5VGV4dEFyZWFcIikudmFsKCkpO1xyXG4gICAgICAgICAgICBpZiAoJGZvcm1DaGVjay5lbXB0eVN0cmluZyhtZW1iZXJTdW1tYXJ5KSkge1xyXG4gICAgICAgICAgICAgICAgYmFzZVV0aWxzLnNob3cucmVkVGlwKFwi5Lya5ZGY566A5LuL5LiN6IO95Li656m677yBXCIpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHZhciBjb3ZlckltZ1VybCA9ICQoXCIjY292ZXJJbWdVcmxcIikudmFsKCk7XHJcbiAgICAgICAgICAgIGlmICgkZm9ybUNoZWNrLmVtcHR5U3RyaW5nKGNvdmVySW1nVXJsKSkge1xyXG4gICAgICAgICAgICAgICAgYmFzZVV0aWxzLnNob3cucmVkVGlwKFwi5Lya5ZGY5bCB6Z2i5LiN6IO95Li656m677yBXCIpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB2YXIgbWVtYmVyUHJpY2UgPSAkLnRyaW0oJChcIi5tZW1iZXJQcmljZUlucHV0XCIpLnZhbCgpKTtcclxuICAgICAgICAgICAgaWYgKCRmb3JtQ2hlY2suZW1wdHlTdHJpbmcobWVtYmVyUHJpY2UpKSB7XHJcbiAgICAgICAgICAgICAgICBiYXNlVXRpbHMuc2hvdy5yZWRUaXAoXCLkvJrlkZjku7fmoLzkuI3og73kuLrnqbrvvIFcIik7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKG1lbWJlclByaWNlIDw9IDApIHtcclxuICAgICAgICAgICAgICAgIGJhc2VVdGlscy5zaG93LnJlZFRpcChcIuS8muWRmOS7t+agvOS4jeiDveS4uiAwIOaIlui0n+aVsO+8gVwiKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAobWVtYmVyUHJpY2UgPiBiYXNlVXRpbHMubWF4SW5wdXRQcmljZSkge1xyXG4gICAgICAgICAgICAgICAgYmFzZVV0aWxzLnNob3cucmVkVGlwKFwi5Lu35qC85LiN6IO95aSn5LqOIFwiICsgYmFzZVV0aWxzLm1heElucHV0UHJpY2UgKyBcIiDlhYNcIik7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHZhciBwYXJhbXMgPSB7fTtcclxuXHJcbiAgICAgICAgICAgIHBhcmFtc1snbmFtZSddID0gbWVtYmVyTmFtZTtcclxuICAgICAgICAgICAgcGFyYW1zWydzdW1tYXJ5J10gPSBtZW1iZXJTdW1tYXJ5O1xyXG4gICAgICAgICAgICBwYXJhbXNbJ2ltZ191cmwnXSA9IGNvdmVySW1nVXJsO1xyXG5cclxuICAgICAgICAgICAgcGFyYW1zWydpbWdfdXJsX2NvbXByZXNzZWQnXSA9IGNvdmVySW1nVXJsOyAgICAgLy8g5bCB6Z2i5Y6L57yp5Zyw5Z2A6buY6K6k5Li65Y6f5Zu+5Zyw5Z2A77yM6Ziy5q2i5Y6L57yp5aSx6LSlXHJcblxyXG4gICAgICAgICAgICBwYXJhbXNbJ3ByaWNlJ10gPSBtZW1iZXJQcmljZSAqIDEwMDsgICAgLy8gIOWNleS9je+8miDliIZcclxuXHJcbiAgICAgICAgICAgIC8vICAyIC0+IOajgOafpeaXoOivr++8jOS/neWtmOWJqeS9meS/oeaBr1xyXG5cclxuICAgICAgICAgICAgLy8g5Lya5ZGY5pyJ6ZmQ5pyf77yI5Y2V5L2N77yaIOenku+8iVxyXG4gICAgICAgICAgICB2YXIgbWVtYmVyVmFsaWRQZXJpb2QgPSBwYXJzZUludCgkKFwiLnNlbGVjdFZhbGlkUGVyaW9kXCIpLnZhbCgpKTtcclxuICAgICAgICAgICAgc3dpdGNoIChtZW1iZXJWYWxpZFBlcmlvZCkge1xyXG4gICAgICAgICAgICAgICAgY2FzZSAxOlxyXG4gICAgICAgICAgICAgICAgICAgIC8vICDkuIDkuKrmnIg6MjU5MjAwMCA9IDMwICogMjQgKiA2MCAqIDYwXHJcbiAgICAgICAgICAgICAgICAgICAgbWVtYmVyVmFsaWRQZXJpb2QgPSAyNTkyMDAwO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSAyOlxyXG4gICAgICAgICAgICAgICAgICAgIC8vICDkuInkuKrmnIg6Nzg2MjQwMCAtPiA3Nzc2MDAwID0gOTAgKiAyNCAqIDYwICogNjBcclxuICAgICAgICAgICAgICAgICAgICBtZW1iZXJWYWxpZFBlcmlvZCA9IDc3NzYwMDA7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDM6XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gIOWNiuW5tDoxNTcyNDgwMCAtPiAxNTgxMTIwMCA9IDE4MyAqIDI0ICogNjAgKiA2MFxyXG4gICAgICAgICAgICAgICAgICAgIG1lbWJlclZhbGlkUGVyaW9kID0gMTU4MTEyMDA7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDQ6XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gIOS4gOW5tDozMTYyMjQwMCA9IDM2NiAqIDI0ICogNjAgKiA2MFxyXG4gICAgICAgICAgICAgICAgICAgIG1lbWJlclZhbGlkUGVyaW9kID0gMzE2MjI0MDA7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHBhcmFtc1sncGVyaW9kJ10gPSBtZW1iZXJWYWxpZFBlcmlvZDtcclxuXHJcblxyXG4gICAgICAgICAgICAvLyAg6I635Y+W5Lya5ZGY6K+m5oOFaHRtbOWGheWuue+8jOi/lOWbnjogPHA+aGVsbG88L3A+XHJcbiAgICAgICAgICAgIHZhciB1ZSA9IFVFLmdldEVkaXRvcignY29udGFpbmVyJyk7XHJcbiAgICAgICAgICAgIHBhcmFtc1snb3JnX2NvbnRlbnQnXSA9IHVlLmdldENvbnRlbnQoKTsgICAgLy8gIOWOn+Wni2h0bWzlhoXlrrlcclxuICAgICAgICAgICAgcGFyYW1zWydkZXNjcmInXSA9IHVlLmdldFBsYWluVHh0KCk7ICAgICAgICAvLyAg57qv5paH5pysXHJcblxyXG5cclxuICAgICAgICAgICAgLy8gIOiOt+WPluS8muWRmOaJgOWxnuWIhuexu1xyXG4gICAgICAgICAgICB2YXIgbWVtYmVyQ2F0ZWdvcnlBcnJheSA9IFtdO1xyXG4gICAgICAgICAgICAkKCdpbnB1dFtuYW1lPVwiY2F0ZWdvcnlcIl06Y2hlY2tlZCcpLmVhY2goZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICBtZW1iZXJDYXRlZ29yeUFycmF5LnB1c2goJCh0aGlzKS5hdHRyKCdpZCcpKTtcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAvLyAg5piv5ZCm5LiK5p62IO+8iDA6IOS4iuaetueKtuaAge+8myAx77ya5LiL5p6254q25oCB77yJXHJcbiAgICAgICAgICAgIHBhcmFtc1snc3RhdGUnXSA9ICQoXCJpbnB1dFtuYW1lPSdzaG93TWVtYmVyJ106Y2hlY2tlZFwiKS52YWwoKTtcclxuXHJcbiAgICAgICAgICAgIC8v5piv5ZCm5pi+56S66K6i6ZiF5pyf5pWwXHJcbiAgICAgICAgICAgIC8vIHBhcmFtc1snaXNfc2hvd19yZXNvdXJjZWNvdW50J10gPSAkKFwiaW5wdXRbbmFtZT0nc2hvd01lbWJlckNvdW50J106Y2hlY2tlZFwiKS52YWwoKTtcclxuXHJcbiAgICAgICAgICAgIC8vICAzIC0+IOWPkemAgeS/neWtmOivt+axgu+8iFwiL1wi77yJXHJcblxyXG5cclxuICAgICAgICAgICAgLy8gIOivpeS4k+agj+aYr+WQpuWFvOWBmuS8muWRmFxyXG4gICAgICAgICAgICBwYXJhbXNbJ2lzX21lbWJlciddID0gMTtcclxuXHJcbiAgICAgICAgICAgIC8vICDojrflj5bkvJrlkZhpZFxyXG4gICAgICAgICAgICBwYXJhbXNbJ2lkJ10gPSBHZXRRdWVyeVN0cmluZygnaWQnKTtcclxuXHJcblxyXG4gICAgICAgICAgICBpZiAoQnVzaW5lc3MucGFnZV90eXBlID09IDApIHtcclxuICAgICAgICAgICAgICAgIC8vICDpkrvnn7Plm77moIdVUkxcclxuICAgICAgICAgICAgICAgIHBhcmFtc1snbWVtYmVyX2ljb25fZGVmYXVsdCddID0gXCJodHRwOi8vd3hyZXNvdXJjZS0xMDAxMTY5Mi5maWxlLm15cWNsb3VkLmNvbS9tYW51YWwvaWNvbl9tZW1iZXJfZGlhbW9uZF9ncmF5LnBuZ1wiO1xyXG4gICAgICAgICAgICAgICAgcGFyYW1zWydtZW1iZXJfaWNvbl9oaWdobGlnaHQnXSA9IFwiaHR0cDovL3d4cmVzb3VyY2UtMTAwMTE2OTIuZmlsZS5teXFjbG91ZC5jb20vbWFudWFsL2ljb25fbWVtYmVyX2RpYW1vbmQucG5nXCI7XHJcbiAgICAgICAgICAgICAgICBtZW1iZXJVdGlscy51cGxvYWRNZW1iZXJJbmZvKHBhcmFtcywgbWVtYmVyQ2F0ZWdvcnlBcnJheSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBtZW1iZXJVdGlscy5lZGl0ZWRNZW1iZXJJbmZvKHBhcmFtcywgbWVtYmVyQ2F0ZWdvcnlBcnJheSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcblxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgIH07XHJcblxyXG4gICAgcmV0dXJuIEJ1c2luZXNzO1xyXG5cclxufSkoKTtcclxuXHJcblxyXG52YXIgbWVtYmVyVXRpbHMgPSAoZnVuY3Rpb24gKCkge1xyXG5cclxuICAgIHZhciB1dGlscyA9IHt9O1xyXG5cclxuICAgIC8vIOe8lui+keS8muWRmOS/oeaBr1xyXG4gICAgdXRpbHMuZWRpdGVkTWVtYmVySW5mbyA9IGZ1bmN0aW9uIChwYXJhbXMsIGNhdGVnb3J5VHlwZUFycikge1xyXG4gICAgICAgIHNob3dMb2FkaW5nKCk7XHJcbiAgICAgICAgJC5hamF4KFwiL2dvb2RzX2VkaXRfcGFja2FnZVwiLCB7XHJcbiAgICAgICAgICAgIHR5cGU6IFwiUE9TVFwiLFxyXG4gICAgICAgICAgICBkYXRhVHlwZTogXCJqc29uXCIsXHJcbiAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgIHBhcmFtczogcGFyYW1zLCBjYXRlZ29yeV90eXBlOiBjYXRlZ29yeVR5cGVBcnJcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24gKHJlc3VsdCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHJlc3VsdC5jb2RlID09IDApIHtcclxuICAgICAgICAgICAgICAgICAgICBiYXNlVXRpbHMuc2hvdy5ibHVlVGlwKFwi57yW6L6R5Lya5ZGY5oiQ5Yqf77yBXCIpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAkKFwiLmdvX2JhY2tcIikuY2xpY2soKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gaWYgKEJ1c2luZXNzLnBhZ2Vfb3JpZ2luID09IFwibWVtYmVyX2xpc3RcIikge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9ICcvbWVtYmVyX2xpc3RfcGFnZSc7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSAnL21lbWJlcl9kZXRhaWxfcGFnZT9pZD0nICsgQnVzaW5lc3MubWVtYmVyX2lkO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIH1cclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaGlkZUxvYWRpbmcoKTtcclxuICAgICAgICAgICAgICAgICAgICBiYXNlVXRpbHMuc2hvdy5yZWRUaXAoXCLnvJbovpHlpLHotKXvvIzor7fnqI3lkI7lho3or5XvvIFcIik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGVycm9yOiBmdW5jdGlvbiAoeGhyLCBzdGF0dXMsIGVycikge1xyXG4gICAgICAgICAgICAgICAgaGlkZUxvYWRpbmcoKTtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycik7XHJcbiAgICAgICAgICAgICAgICBiYXNlVXRpbHMuc2hvdy5yZWRUaXAoXCLmnI3liqHlmajlvIDlsI/lt67kuobvvIzor7fnqI3lkI7lho3or5XvvIFcIik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcblxyXG5cclxuICAgIH07XHJcblxyXG4gICAgLy8g5paw5bu65Lya5ZGY5L+h5oGvXHJcbiAgICB1dGlscy51cGxvYWRNZW1iZXJJbmZvID0gZnVuY3Rpb24gKHBhcmFtcywgY2F0ZWdvcnlUeXBlQXJyKSB7XHJcbiAgICAgICAgc2hvd0xvYWRpbmcoKTtcclxuICAgICAgICAkLmFqYXgoXCIvZ29vZHNfdXBsb2FkX3BhY2thZ2VcIiwge1xyXG4gICAgICAgICAgICB0eXBlOiBcIlBPU1RcIixcclxuICAgICAgICAgICAgZGF0YVR5cGU6IFwianNvblwiLFxyXG4gICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICBwYXJhbXM6IHBhcmFtcywgY2F0ZWdvcnlfdHlwZTogY2F0ZWdvcnlUeXBlQXJyXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChyZXN1bHQpIHtcclxuICAgICAgICAgICAgICAgIGlmIChyZXN1bHQuY29kZSA9PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYmFzZVV0aWxzLnNob3cuYmx1ZVRpcChcIuaWsOW7uuS8muWRmOaIkOWKn++8gVwiKTtcclxuICAgICAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9ICcvbWVtYmVyX2xpc3RfcGFnZSc7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGhpZGVMb2FkaW5nKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgYmFzZVV0aWxzLnNob3cucmVkVGlwKFwi5paw5bu65aSx6LSl77yM6K+356iN5ZCO5YaN6K+V77yBXCIpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBlcnJvcjogZnVuY3Rpb24gKHhociwgc3RhdHVzLCBlcnIpIHtcclxuICAgICAgICAgICAgICAgIGhpZGVMb2FkaW5nKCk7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xyXG4gICAgICAgICAgICAgICAgYmFzZVV0aWxzLnNob3cucmVkVGlwKFwi5pyN5Yqh5Zmo5byA5bCP5beu5LqG77yM6K+356iN5ZCO5YaN6K+V77yBXCIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG5cclxuICAgIH07XHJcblxyXG4gICAgcmV0dXJuIHV0aWxzO1xyXG5cclxufSkoKTsiXX0=
