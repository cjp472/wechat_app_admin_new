var nowChange=GetQueryString("change");var payDirRid="";var iTime=null;var i=0;$(document).ready(function(){init();authHandle();$("#editImg").click(function(){$("#wx_mchid").removeClass("disEdit");$("#wx_mchkey").removeClass("disEdit");$("#wx_mchid").attr("disabled",false);$("#wx_mchkey").attr("disabled",false);$("#saveMer").parent().removeClass("hide")});if(nowChange==1){$("#editImg").click();$("#qrcodeArea").hide();$("#showPhone").hide()}$("#saveMer").click(function(){var e=$("#wx_mchid").val();if(e.length==0){baseUtils.show.redTip("亲,请输入微信商户号哦~");return false}var o=/^[1-9][0-9]{7,9}$/;if(!o.test(e)){baseUtils.show.redTip("亲！请输入正确的微信商户号哦~");return false}var i=$("#wx_mchkey").val();if(i.length==0){baseUtils.show.redTip("亲,请输入商户API密钥哦~");return false}var t=/^[0-9A-Za-z]{32}$/;if(!t.test(i)){baseUtils.show.redTip("亲！请输入正确的商户API密钥哦~");return false}$.post("/updatemerchant",{wx_mchid:e,wx_mchkey:i,app_id:$("#xcx_app_id").val()},function(e){if(e.ret==0){if(nowChange==1){var o="您已成功切换为企业模式，您的店铺地址已变更为<br/>"+'<div style="color: #337ab7;">'+e.url+"</div>"+"(该地址可在手机预览页面查看到)请尽快完成手机端入口的地址替换。";$.alert(o,"info",{oktext:"我知道了",btn:2,onOk:function(){window.location.href="/companymodel"},onClose:function(){window.location.href="/companymodel"}})}else{baseUtils.show.blueTip("保存成功",function(){window.location.href="/companymodel"})}}else{baseUtils.show.redTip(e.msg)}})});$("#confirmButton").click(function(){$("#confirmButton").attr("disabled","disabled");createTestImageText();i=0});$("#setModal").on("hide.bs.modal",function(){clearTimeout(iTime);$("#confirmButton").removeAttr("disabled")})});function createTestImageText(){$.ajax("/make_page_url",{type:"GET",dataType:"json",data:{},success:function(e){if(e.code==0){payDirRid=e["r_id"];$("#setModal").modal({backdrop:"static"});$("#confirmPayDirCode").empty();var o=new QRCode(document.getElementById("confirmPayDirCode"),{text:e["pageurl"],width:150,height:150,colorDark:"#000000",colorLight:"#ffffff",correctLevel:QRCode.CorrectLevel.L});remainTime()}else{baseUtils.show.redTip("服务器繁忙，请稍后再试！")}},error:function(e,o,i){hideLoading();console.error(i);baseUtils.show.redTip("网络错误，请稍后再试！");submitLimt=false}})}function remainTime(){$.ajax("/confirm_order_get_paytype",{type:"GET",dataType:"json",data:{r_id:payDirRid},success:function(e){i+=1;if(i>=300){i=0;clearTimeout(iTime);$("#setModal").modal("hide");var o="您长时间未支付  请重新验证";$.alert(o,"info",{oktext:"我知道了",btn:2,onOk:function(){window.location.href="/companymodel"},onClose:function(){window.location.href="/companymodel"}})}if(e.type==0&&e.use_collection==0){clearTimeout(iTime);$("#setModal").modal("hide");$.ajax("/confirm_order",{type:"GET",dataType:"json",data:{},success:function(e){if(e.code===0){var o="恭喜您 您的公众号支付授权目录已经正确配置";$.alert(o,"success",{oktext:"我知道了",btn:2,onOk:function(){window.location.href="/companymodel"},onClose:function(){window.location.href="/companymodel"}})}else{hideLoading();console.error(err);baseUtils.show.redTip("网络错误，请稍后再试！");submitLimt=false}},error:function(e,o,i){hideLoading();console.error(i);baseUtils.show.redTip("网络错误，请稍后再试！");submitLimt=false}})}else if(e.type===1){clearTimeout(iTime);$("#setModal").modal("hide");var o="您的公众号支付授权目录配置不正确 <br>"+" 请前往微信公众平台配置正确再重新验证 <br>"+'<a style="color: #337ab7;" target="_blank" href="https://admin.xiaoe-tech.com/help#hp4">如何配置支付授权目录？</a>';$.alert(o,"error",{oktext:"重新设置",btn:2,onOk:function(){window.location.href="/companymodel#payset"},onClose:function(){window.location.href="/companymodel#payset"}})}else if(e.type==0&&e.use_collection==1){clearTimeout(iTime);$("#setModal").modal("hide");var o="您的商户信息配置不正确 <br>"+" 请前往上一步配置正确再重新验证 <br>";$.alert(o,"error",{oktext:"重新设置",btn:2,onOk:function(){window.location.href="/companymodel#payset"},onClose:function(){window.location.href="/companymodel#payset"}})}else if(e.type===null){}},error:function(e,o,i){hideLoading();console.error(i);baseUtils.show.redTip("网络错误，请稍后再试！");submitLimt=false}});iTime=setTimeout("remainTime()",2e3)}function init(){var e=new QRCode(document.getElementById("h5qrcode"),{text:$(".copyButton").eq(0).prev().html(),width:130,height:130,colorDark:"#000000",colorLight:"#ffffff",correctLevel:QRCode.CorrectLevel.H});(function(){var e=new Clipboard(".copyHref");e.on("success",function(e){baseUtils.show.blueTip("复制成功！请在微信内打开哦 。");e.clearSelection()})})();$("#wx_bus_verify_txt").uploadifive({auto:true,buttonText:"选择文件",buttonClass:"greenChooseFile",fileType:".txt",uploadScript:"/remote_uploadVerifyFile?app_id="+$("#xcx_app_id").val(),uploader:"/remote_uploadVerifyFile?app_id="+$("#xcx_app_id").val(),uploadLimit:1,itemTemplate:false,method:"post",fileSizeLimit:"50",onCancel:function(){baseUtils.show.blueTip("取消文件上传!")},onUploadComplete:function(e,o){o=JSON.parse(o);if(o.ret==0){baseUtils.show.blueTip(o.msg,function(){window.location.reload()})}else{baseUtils.show.redTip(o.msg)}},onError:function(e){baseUtils.show.redTip(e)}})}function getFormatTime(){var e=new Date;var o=e.getFullYear();var i=e.getMonth()+1;var t=e.getDate();var a=e.getHours();var n=e.getMinutes();var r=e.getSeconds();var l=o+"-"+i+"-"+t+" "+a+":"+n+":"+r;return l}function authHandle(){$("#reAuth").click(function(){var e=window.open("","_blank");var o=$("#xcx_app_id").val();$.get("/updateifauth",{app_id:o},function(i){if(i.ret==0){e.location.href=authUrl+o;$("#bindModal").modal("show")}else{baseUtils.show.redTip("系统繁忙")}})});$("#bindSuccess").click(function(){window.location.reload()});$("#bindFail").click(function(){var e=$("#xcx_app_id").val();window.open(authUrl+e);$("#bindModal").modal("show")})}
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImJpbmRjb21wYW55bW9kZWwuanMiXSwibmFtZXMiOlsibm93Q2hhbmdlIiwiR2V0UXVlcnlTdHJpbmciLCJwYXlEaXJSaWQiLCJpVGltZSIsImkiLCIkIiwiZG9jdW1lbnQiLCJyZWFkeSIsImluaXQiLCJhdXRoSGFuZGxlIiwiY2xpY2siLCJyZW1vdmVDbGFzcyIsImF0dHIiLCJwYXJlbnQiLCJoaWRlIiwid3hfbWNoaWQiLCJ2YWwiLCJsZW5ndGgiLCJiYXNlVXRpbHMiLCJzaG93IiwicmVkVGlwIiwicmVnMSIsInRlc3QiLCJ3eF9tY2hrZXkiLCJyZWcyIiwicG9zdCIsImFwcF9pZCIsImRhdGEiLCJyZXQiLCJ0ZXh0IiwidXJsIiwiYWxlcnQiLCJva3RleHQiLCJidG4iLCJvbk9rIiwid2luZG93IiwibG9jYXRpb24iLCJocmVmIiwib25DbG9zZSIsImJsdWVUaXAiLCJtc2ciLCJjcmVhdGVUZXN0SW1hZ2VUZXh0Iiwib24iLCJjbGVhclRpbWVvdXQiLCJyZW1vdmVBdHRyIiwiYWpheCIsInR5cGUiLCJkYXRhVHlwZSIsInN1Y2Nlc3MiLCJjb2RlIiwibW9kYWwiLCJiYWNrZHJvcCIsImVtcHR5IiwicXJjb2RlQ29uZmlybVBheURpckNvZGUiLCJRUkNvZGUiLCJnZXRFbGVtZW50QnlJZCIsIndpZHRoIiwiaGVpZ2h0IiwiY29sb3JEYXJrIiwiY29sb3JMaWdodCIsImNvcnJlY3RMZXZlbCIsIkNvcnJlY3RMZXZlbCIsIkwiLCJyZW1haW5UaW1lIiwiZXJyb3IiLCJ4aHIiLCJzdGF0dXMiLCJlcnIiLCJoaWRlTG9hZGluZyIsImNvbnNvbGUiLCJzdWJtaXRMaW10Iiwicl9pZCIsInVzZV9jb2xsZWN0aW9uIiwic2V0VGltZW91dCIsInFyY29kZSIsImVxIiwicHJldiIsImh0bWwiLCJIIiwiY2xpcGJvYXJkIiwiQ2xpcGJvYXJkIiwiZSIsImNsZWFyU2VsZWN0aW9uIiwidXBsb2FkaWZpdmUiLCJhdXRvIiwiYnV0dG9uVGV4dCIsImJ1dHRvbkNsYXNzIiwiZmlsZVR5cGUiLCJ1cGxvYWRTY3JpcHQiLCJ1cGxvYWRlciIsInVwbG9hZExpbWl0IiwiaXRlbVRlbXBsYXRlIiwibWV0aG9kIiwiZmlsZVNpemVMaW1pdCIsIm9uQ2FuY2VsIiwib25VcGxvYWRDb21wbGV0ZSIsImZpbGUiLCJKU09OIiwicGFyc2UiLCJyZWxvYWQiLCJvbkVycm9yIiwiZXJybXNnIiwiZ2V0Rm9ybWF0VGltZSIsImRhdGUiLCJEYXRlIiwieWVhciIsImdldEZ1bGxZZWFyIiwibW9udGgiLCJnZXRNb250aCIsImRheSIsImdldERhdGUiLCJob3VyIiwiZ2V0SG91cnMiLCJtaW51dGUiLCJnZXRNaW51dGVzIiwic2Vjb25kIiwiZ2V0U2Vjb25kcyIsInRpbWUiLCJuZXdXaW4iLCJvcGVuIiwiZ2V0IiwiYXV0aFVybCJdLCJtYXBwaW5ncyI6IkFBSUEsR0FBSUEsV0FBWUMsZUFBZSxTQUMvQixJQUFJQyxXQUFZLEVBQ2hCLElBQUlDLE9BQVEsSUFDWixJQUFJQyxHQUFJLENBQ1JDLEdBQUVDLFVBQVVDLE1BQU0sV0FFZEMsTUFDQUMsYUFHQUosR0FBRSxZQUFZSyxNQUFNLFdBRWhCTCxFQUFFLGFBQWFNLFlBQVksVUFDM0JOLEdBQUUsY0FBY00sWUFBWSxVQUM1Qk4sR0FBRSxhQUFhTyxLQUFLLFdBQVcsTUFDL0JQLEdBQUUsY0FBY08sS0FBSyxXQUFXLE1BQ2hDUCxHQUFFLFlBQVlRLFNBQVNGLFlBQVksU0FHdkMsSUFBR1gsV0FBYSxFQUFFLENBQ2RLLEVBQUUsWUFBWUssT0FDZEwsR0FBRSxlQUFlUyxNQUNqQlQsR0FBRSxjQUFjUyxPQUlwQlQsRUFBRSxZQUFZSyxNQUFNLFdBR2hCLEdBQUlLLEdBQVNWLEVBQUUsYUFBYVcsS0FDNUIsSUFBR0QsRUFBU0UsUUFBUSxFQUNwQixDQUNJQyxVQUFVQyxLQUFLQyxPQUFPLGVBQ3RCLE9BQU8sT0FFWCxHQUFJQyxHQUFLLG1CQUNULEtBQUlBLEVBQUtDLEtBQUtQLEdBQ2QsQ0FDSUcsVUFBVUMsS0FBS0MsT0FBTyxrQkFDdEIsT0FB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b0YsS0FBSyxHQUFHLFNBQzVCLElBQUk3RixHQUFPckIsRUFBRSxlQUFlVyxLQUM1QlgsR0FBRW1ILElBQUksaUJBQWlCOUYsT0FBU0EsR0FBUSxTQUFTQyxHQUU3QyxHQUFHQSxFQUFLQyxLQUFLLEVBQ2IsQ0FDSTBGLEVBQU9sRixTQUFTQyxLQUFPb0YsUUFBUS9GLENBQy9CckIsR0FBRSxjQUFjNkMsTUFBTSxZQUcxQixDQUNJaEMsVUFBVUMsS0FBS0MsT0FBTyxZQU1sQ2YsR0FBRSxnQkFBZ0JLLE1BQU0sV0FFcEJ5QixPQUFPQyxTQUFTK0QsVUFJcEI5RixHQUFFLGFBQWFLLE1BQU0sV0FFakIsR0FBSWdCLEdBQU9yQixFQUFFLGVBQWVXLEtBQzVCbUIsUUFBT29GLEtBQUtFLFFBQVEvRixFQUNwQnJCLEdBQUUsY0FBYzZDLE1BQU0iLCJmaWxlIjoiYmluZGNvbXBhbnltb2RlbC5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBDcmVhdGVkIGJ5IFN0dXBoaW4gb24gMjAxNi85LzI2LlxyXG4gKi9cclxuXHJcbnZhciBub3dDaGFuZ2UgPSBHZXRRdWVyeVN0cmluZygnY2hhbmdlJyk7IC8v6I635Y+W5b2T5YmN54q25oCBXHJcbnZhciBwYXlEaXJSaWQgPSAnJztcclxudmFyIGlUaW1lID0gbnVsbDtcclxudmFyIGkgPSAwO1xyXG4kKGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbigpXHJcbntcclxuICAgIGluaXQoKTtcclxuICAgIGF1dGhIYW5kbGUoKTtcclxuXHJcbiAgICAvL+e8lui+keWbvueJh+eCueWHu1xyXG4gICAgJChcIiNlZGl0SW1nXCIpLmNsaWNrKGZ1bmN0aW9uKClcclxuICAgIHtcclxuICAgICAgICAkKFwiI3d4X21jaGlkXCIpLnJlbW92ZUNsYXNzKFwiZGlzRWRpdFwiKTtcclxuICAgICAgICAkKFwiI3d4X21jaGtleVwiKS5yZW1vdmVDbGFzcyhcImRpc0VkaXRcIik7XHJcbiAgICAgICAgJChcIiN3eF9tY2hpZFwiKS5hdHRyKFwiZGlzYWJsZWRcIixmYWxzZSk7XHJcbiAgICAgICAgJChcIiN3eF9tY2hrZXlcIikuYXR0cihcImRpc2FibGVkXCIsZmFsc2UpO1xyXG4gICAgICAgICQoXCIjc2F2ZU1lclwiKS5wYXJlbnQoKS5yZW1vdmVDbGFzcyhcImhpZGVcIik7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpZihub3dDaGFuZ2UgPT0gMSl7XHJcbiAgICAgICAgJChcIiNlZGl0SW1nXCIpLmNsaWNrKCk7XHJcbiAgICAgICAgJCgnI3FyY29kZUFyZWEnKS5oaWRlKCk7XHJcbiAgICAgICAgJCgnI3Nob3dQaG9uZScpLmhpZGUoKTtcclxuICAgIH1cclxuXHJcbiAgICAvL+WVhuaIt+mFjee9ruS/neWtmOaMiemSrueCueWHu1xyXG4gICAgJChcIiNzYXZlTWVyXCIpLmNsaWNrKGZ1bmN0aW9uKClcclxuICAgIHtcclxuICAgICAgICAvL+WVhuaIt+WPt1xyXG4gICAgICAgIHZhciB3eF9tY2hpZD0kKFwiI3d4X21jaGlkXCIpLnZhbCgpO1xyXG4gICAgICAgIGlmKHd4X21jaGlkLmxlbmd0aD09MClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGJhc2VVdGlscy5zaG93LnJlZFRpcChcIuS6sizor7fovpPlhaXlvq7kv6HllYbmiLflj7flk6Z+XCIpO1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciByZWcxPS9eWzEtOV1bMC05XXs3LDl9JC87XHJcbiAgICAgICAgaWYoIXJlZzEudGVzdCh3eF9tY2hpZCkpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBiYXNlVXRpbHMuc2hvdy5yZWRUaXAoJ+S6su+8geivt+i+k+WFpeato+ehrueahOW+ruS/oeWVhuaIt+WPt+WTpn4nKTtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy/llYbmiLdBUEnlr4bpkqVcclxuICAgICAgICB2YXIgd3hfbWNoa2V5PSQoXCIjd3hfbWNoa2V5XCIpLnZhbCgpO1xyXG4gICAgICAgIGlmKHd4X21jaGtleS5sZW5ndGg9PTApXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBiYXNlVXRpbHMuc2hvdy5yZWRUaXAoXCLkurIs6K+36L6T5YWl5ZWG5oi3QVBJ5a+G6ZKl5ZOmflwiKTtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgcmVnMj0vXlswLTlBLVphLXpdezMyfSQvO1xyXG4gICAgICAgIGlmKCFyZWcyLnRlc3Qod3hfbWNoa2V5KSlcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGJhc2VVdGlscy5zaG93LnJlZFRpcChcIuS6su+8geivt+i+k+WFpeato+ehrueahOWVhuaIt0FQSeWvhumSpeWTpn5cIik7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8v6aqM6K+B5pSv5LuY6YWN572u5piv5ZCm5q2j56GuXHJcbiAgICAgICAgLy/lj5HpgIHor7fmsYJodHRwczovL2FwcC5pbnNpZGUueGlhb2UtdGVjaC5jb20vcGxhdGZvcm0vY2hlY2tfbWVyY2hhbnQve2FwcF9pZH0ve2FwcF90eXBlfVxyXG4gICAgICAgIC8qJC5wb3N0KFwiXCIsXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICdhcHBfaWQnOiAkKFwiI3hjeF9hcHBfaWRcIikudmFsKCksXHJcbiAgICAgICAgICAgICAgICAnXHJcbiAgICAgICAgICAgIH0sZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgIGlmKGRhdGEuY29kZSA9PSAwKXtcclxuICAgICAgICAgICAgICAgICAgICAkLnBvc3QoXCIvdXBkYXRlbWVyY2hhbnRcIix7XCJ3eF9tY2hpZFwiOnd4X21jaGlkLFwid3hfbWNoa2V5XCI6d3hfbWNoa2V5LFwiYXBwX2lkXCI6JChcIiN4Y3hfYXBwX2lkXCIpLnZhbCgpfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24oZGF0YSlcclxuICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoZGF0YS5yZXQ9PTApXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmFzZVV0aWxzLnNob3cuYmx1ZVRpcChcIuS/neWtmOaIkOWKn1wiLGZ1bmN0aW9uKClcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5yZWxvYWQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiYXNlVXRpbHMuc2hvdy5yZWRUaXAoXCLkv53lrZjlpLHotKVcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgICAgICAgICAgYmFzZVV0aWxzLnNob3cucmVkVGlwKFwi5pSv5LuY6YWN572u5L+h5oGv5pyJ6K+vLOivt+aguOWvueWQjumHjeaWsOaPkOS6pFwiKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7Ki9cclxuXHJcbiAgICAgICAgJC5wb3N0KFwiL3VwZGF0ZW1lcmNoYW50XCIse1wid3hfbWNoaWRcIjp3eF9tY2hpZCxcInd4X21jaGtleVwiOnd4X21jaGtleSxcImFwcF9pZFwiOiQoXCIjeGN4X2FwcF9pZFwiKS52YWwoKX0sXHJcbiAgICAgICAgZnVuY3Rpb24oZGF0YSl7XHJcbiAgICAgICAgICAgIGlmKGRhdGEucmV0PT0wKXtcclxuICAgICAgICAgICAgICAgIGlmKG5vd0NoYW5nZSA9PSAxKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHZhciB0ZXh0ID0gJ+aCqOW3suaIkOWKn+WIh+aNouS4uuS8geS4muaooeW8j++8jOaCqOeahOW6l+mTuuWcsOWdgOW3suWPmOabtOS4ujxici8+JytcclxuICAgICAgICAgICAgICAgICAgICAgICAgJzxkaXYgc3R5bGU9XCJjb2xvcjogIzMzN2FiNztcIj4nK2RhdGEudXJsKyc8L2Rpdj4nK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAnKOivpeWcsOWdgOWPr+WcqOaJi+acuumihOiniOmhtemdouafpeeci+WIsCnor7flsL3lv6vlrozmiJDmiYvmnLrnq6/lhaXlj6PnmoTlnLDlnYDmm7/mjaLjgIInO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIHZhciB0ZXh0ID0gJ+esrOS6jOatpeW3suaIkOWKnyzor7fov5vooYzmlK/ku5jnm67lvZXmjojmnYPpqozor4EnO1xyXG4gICAgICAgICAgICAgICAgICAgICQuYWxlcnQodGV4dCwnaW5mbycse1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBva3RleHQ6ICfmiJHnn6XpgZPkuoYnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBidG46IDIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG9uT2s6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWY9Jy9jb21wYW55bW9kZWwnO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBvbkNsb3NlOmZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24uaHJlZj0nL2NvbXBhbnltb2RlbCc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYmFzZVV0aWxzLnNob3cuYmx1ZVRpcChcIuS/neWtmOaIkOWKn1wiLGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmPScvY29tcGFueW1vZGVsJztcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGJhc2VVdGlscy5zaG93LnJlZFRpcChkYXRhLm1zZyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuXHJcbiAgICAvLyDngrnlh7sg6aqM6K+B5pSv5LuY5L+h5oGvIOaMiemSrlxyXG4gICAgJChcIiNjb25maXJtQnV0dG9uXCIpLmNsaWNrKGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgLy/nlJ/miJDkuIDmnaEwLjA15YWD55qEIOWbvuaWhyDotYTmupDlj4LmlbBcclxuICAgICAgICAkKFwiI2NvbmZpcm1CdXR0b25cIikuYXR0cihcImRpc2FibGVkXCIsXCJkaXNhYmxlZFwiKTtcclxuICAgICAgICBjcmVhdGVUZXN0SW1hZ2VUZXh0KCk7XHJcbiAgICAgICAgaSA9IDA7XHJcblxyXG4gICAgfSk7XHJcblxyXG4gICAgJChcIiNzZXRNb2RhbFwiKS5vbignaGlkZS5icy5tb2RhbCcsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBjbGVhclRpbWVvdXQoaVRpbWUpO1xyXG4gICAgICAgICQoXCIjY29uZmlybUJ1dHRvblwiKS5yZW1vdmVBdHRyKFwiZGlzYWJsZWRcIik7XHJcbiAgICB9KTtcclxuXHJcbn0pO1xyXG5cclxuXHJcbi8v55Sf5oiQIOa1i+ivleWbvuaWh+i1hOa6kCDlj4LmlbBcclxuZnVuY3Rpb24gY3JlYXRlVGVzdEltYWdlVGV4dCgpIHtcclxuXHJcbiAgICAvLyDnlJ/miJDotYTmupB1cmzlkozkuoznu7TnoIFcclxuICAgICQuYWpheCgnL21ha2VfcGFnZV91cmwnLCB7XHJcbiAgICAgICAgdHlwZTogJ0dFVCcsXHJcbiAgICAgICAgZGF0YVR5cGU6ICdqc29uJyxcclxuICAgICAgICBkYXRhOnsgfSxcclxuICAgICAgICBzdWNjZXNzOmZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgIGlmKGRhdGEuY29kZSA9PSAwKXtcclxuICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCctLS3otYTmupDpk77mjqUtLS3vvJonKTtcclxuICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKGRhdGFbJ3BhZ2V1cmwnXSk7XHJcbiAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZygnLS0t6LWE5rqQaWQtLS3vvJonKTtcclxuICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKGRhdGFbJ3JfaWQnXSk7XHJcbiAgICAgICAgICAgICAgICBwYXlEaXJSaWQgPSBkYXRhWydyX2lkJ107XHJcbiAgICAgICAgICAgICAgICAkKFwiI3NldE1vZGFsXCIpLm1vZGFsKHtiYWNrZHJvcDonc3RhdGljJ30pOy8v5by556qXXHJcblxyXG4gICAgICAgICAgICAgICAgJChcIiNjb25maXJtUGF5RGlyQ29kZVwiKS5lbXB0eSgpO1xyXG5cclxuICAgICAgICAgICAgICAgIC8vIOeUn+aIkOS6jOe7tOeggVxyXG4gICAgICAgICAgICAgICAgdmFyIHFyY29kZUNvbmZpcm1QYXlEaXJDb2RlID0gbmV3IFFSQ29kZShkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImNvbmZpcm1QYXlEaXJDb2RlXCIpLFxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGV4dDpkYXRhWydwYWdldXJsJ10sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoOiAxNTAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGhlaWdodDogMTUwLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb2xvckRhcmsgOiBcIiMwMDAwMDBcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29sb3JMaWdodCA6IFwiI2ZmZmZmZlwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb3JyZWN0TGV2ZWwgOiBRUkNvZGUuQ29ycmVjdExldmVsLkxcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIC8vYWpheOivt+axgueUqOaIt+aYr+WQpumFjee9riAg5a6e6ZmF5piv5p+l55yL55So5oi355qE5pSv5LuY5pa55byPXHJcbiAgICAgICAgICAgICAgICByZW1haW5UaW1lKCk7XHJcblxyXG4gICAgICAgICAgICB9IGVsc2UgIHtcclxuICAgICAgICAgICAgICAgIGJhc2VVdGlscy5zaG93LnJlZFRpcCgn5pyN5Yqh5Zmo57mB5b+Z77yM6K+356iN5ZCO5YaN6K+V77yBJyk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcblxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZXJyb3I6IGZ1bmN0aW9uKHhocixzdGF0dXMsZXJyKSB7XHJcbiAgICAgICAgICAgIGhpZGVMb2FkaW5nKCk7XHJcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcclxuICAgICAgICAgICAgYmFzZVV0aWxzLnNob3cucmVkVGlwKCfnvZHnu5zplJnor6/vvIzor7fnqI3lkI7lho3or5XvvIEnKTtcclxuICAgICAgICAgICAgc3VibWl0TGltdCA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG5cclxufVxyXG5cclxuXHJcblxyXG5mdW5jdGlvbiAgcmVtYWluVGltZSgpIHtcclxuXHJcbiAgICAvL+ajgOa1i+aUr+S7mOaWueW8j1xyXG5cclxuICAgICQuYWpheCgnL2NvbmZpcm1fb3JkZXJfZ2V0X3BheXR5cGUnLCB7XHJcbiAgICAgICAgdHlwZTogJ0dFVCcsXHJcbiAgICAgICAgZGF0YVR5cGU6ICdqc29uJyxcclxuICAgICAgICBkYXRhOnsncl9pZCc6cGF5RGlyUmlkfSxcclxuICAgICAgICBzdWNjZXNzOmZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgIGkgKz0gMTtcclxuICAgICAgICAgICAgLy8gY29uc29sZS5sb2coJy0tLeivt+axguasoeaVsC0tLe+8micpO1xyXG4gICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhpKTtcclxuICAgICAgICAgICAgLy9cclxuICAgICAgICAgICAgLy8gY29uc29sZS5sb2coJy0tLeajgOa1i+aUr+S7mOaWueW8j+i/lOWbnuWAvC0tLTonKTtcclxuICAgICAgICAgICAgLy8gY29uc29sZS5sb2coZGF0YSk7XHJcblxyXG5cclxuICAgICAgICAgICAgaWYoaSA+PSAzMDApe1xyXG4gICAgICAgICAgICAgICAgaSA9IDA7XHJcbiAgICAgICAgICAgICAgICBjbGVhclRpbWVvdXQoaVRpbWUpO1xyXG4gICAgICAgICAgICAgICAgJChcIiNzZXRNb2RhbFwiKS5tb2RhbChcImhpZGVcIik7Ly/lvLnnqpfpmpDol49cclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgdGV4dCA9ICfmgqjplb/ml7bpl7TmnKrmlK/ku5ggIOivt+mHjeaWsOmqjOivgSc7XHJcblxyXG4gICAgICAgICAgICAgICAgJC5hbGVydCh0ZXh0LCdpbmZvJyx7XHJcbiAgICAgICAgICAgICAgICAgICAgb2t0ZXh0OiAn5oiR55+l6YGT5LqGJyxcclxuICAgICAgICAgICAgICAgICAgICBidG46IDIsXHJcbiAgICAgICAgICAgICAgICAgICAgb25PazogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmPScvY29tcGFueW1vZGVsJztcclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIG9uQ2xvc2U6ZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24uaHJlZj0nL2NvbXBhbnltb2RlbCc7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICB9XHJcblxyXG5cclxuICAgICAgICAgICAgaWYoKGRhdGEudHlwZSA9PSAwKSAmJiAoZGF0YS51c2VfY29sbGVjdGlvbiA9PSAwKSl7XHJcbiAgICAgICAgICAgICAgICBjbGVhclRpbWVvdXQoaVRpbWUpO1xyXG4gICAgICAgICAgICAgICAgJChcIiNzZXRNb2RhbFwiKS5tb2RhbChcImhpZGVcIik7Ly/lvLnnqpfpmpDol49cclxuXHJcbiAgICAgICAgICAgICAgICAvL+mqjOivgeaIkOWKnyDmm7TmlLnor7fmsYLlsIbmlK/ku5jmjojmnYPnm67lvZXlrZfmrrVcclxuXHJcbiAgICAgICAgICAgICAgICAkLmFqYXgoJy9jb25maXJtX29yZGVyJywge1xyXG4gICAgICAgICAgICAgICAgICAgIHR5cGU6ICdHRVQnLFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGFUeXBlOiAnanNvbicsXHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YTp7fSxcclxuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOmZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkYXRhLmNvZGUgPT09IDApe1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0ZXh0ID0gJ+aBreWWnOaCqCDmgqjnmoTlhazkvJflj7fmlK/ku5jmjojmnYPnm67lvZXlt7Lnu4/mraPnoa7phY3nva4nO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJC5hbGVydCh0ZXh0LCdzdWNjZXNzJyx7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2t0ZXh0OiAn5oiR55+l6YGT5LqGJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBidG46IDIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25PazogZnVuY3Rpb24oKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24uaHJlZj0nL2NvbXBhbnltb2RlbCc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNsb3NlOmZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmPScvY29tcGFueW1vZGVsJztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhpZGVMb2FkaW5nKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGVycik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiYXNlVXRpbHMuc2hvdy5yZWRUaXAoJ+e9kee7nOmUmeivr++8jOivt+eojeWQjuWGjeivle+8gScpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3VibWl0TGltdCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogZnVuY3Rpb24oeGhyLHN0YXR1cyxlcnIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaGlkZUxvYWRpbmcoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihlcnIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBiYXNlVXRpbHMuc2hvdy5yZWRUaXAoJ+e9kee7nOmUmeivr++8jOivt+eojeWQjuWGjeivle+8gScpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzdWJtaXRMaW10ID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcblxyXG5cclxuICAgICAgICAgICAgfSBlbHNlIGlmKGRhdGEudHlwZSA9PT0gMSl7XHJcblxyXG4gICAgICAgICAgICAgICAgY2xlYXJUaW1lb3V0KGlUaW1lKTtcclxuICAgICAgICAgICAgICAgICQoXCIjc2V0TW9kYWxcIikubW9kYWwoXCJoaWRlXCIpOy8v5by556qX6ZqQ6JePXHJcblxyXG4gICAgICAgICAgICAgICAgdmFyIHRleHQgPSAn5oKo55qE5YWs5LyX5Y+35pSv5LuY5o6I5p2D55uu5b2V6YWN572u5LiN5q2j56GuIDxicj4nK1xyXG4gICAgICAgICAgICAgICAgICAgICcg6K+35YmN5b6A5b6u5L+h5YWs5LyX5bmz5Y+w6YWN572u5q2j56Gu5YaN6YeN5paw6aqM6K+BIDxicj4nICtcclxuICAgICAgICAgICAgICAgICAgICAnPGEgc3R5bGU9XCJjb2xvcjogIzMzN2FiNztcIiB0YXJnZXQ9XCJfYmxhbmtcIiBocmVmPVwiaHR0cHM6Ly9hZG1pbi54aWFvZS10ZWNoLmNvbS9oZWxwI2hwNFwiPuWmguS9lemFjee9ruaUr+S7mOaOiOadg+ebruW9le+8nzwvYT4nO1xyXG4gICAgICAgICAgICAgICAgJC5hbGVydCh0ZXh0LCdlcnJvcicsIHtcclxuICAgICAgICAgICAgICAgICAgICBva3RleHQ6ICfph43mlrDorr7nva4nLFxyXG4gICAgICAgICAgICAgICAgICAgIGJ0bjogMixcclxuICAgICAgICAgICAgICAgICAgICBvbk9rOiBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9ICcvY29tcGFueW1vZGVsI3BheXNldCc7XHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICBvbkNsb3NlOmZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmPScvY29tcGFueW1vZGVsI3BheXNldCc7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKChkYXRhLnR5cGUgPT0gMCkgJiYgKGRhdGEudXNlX2NvbGxlY3Rpb24gPT0gMSkpe1xyXG5cclxuXHJcbiAgICAgICAgICAgICAgICBjbGVhclRpbWVvdXQoaVRpbWUpO1xyXG4gICAgICAgICAgICAgICAgJChcIiNzZXRNb2RhbFwiKS5tb2RhbChcImhpZGVcIik7Ly/lvLnnqpfpmpDol49cclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgdGV4dCA9ICfmgqjnmoTllYbmiLfkv6Hmga/phY3nva7kuI3mraPnoa4gPGJyPicrXHJcbiAgICAgICAgICAgICAgICAgICAgJyDor7fliY3lvoDkuIrkuIDmraXphY3nva7mraPnoa7lho3ph43mlrDpqozor4EgPGJyPic7XHJcbiAgICAgICAgICAgICAgICAkLmFsZXJ0KHRleHQsJ2Vycm9yJywge1xyXG4gICAgICAgICAgICAgICAgICAgIG9rdGV4dDogJ+mHjeaWsOiuvue9ricsXHJcbiAgICAgICAgICAgICAgICAgICAgYnRuOiAyLFxyXG4gICAgICAgICAgICAgICAgICAgIG9uT2s6IGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gJy9jb21wYW55bW9kZWwjcGF5c2V0JztcclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIG9uQ2xvc2U6ZnVuY3Rpb24gKCkge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWY9Jy9jb21wYW55bW9kZWwjcGF5c2V0JztcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIH0gZWxzZSBpZihkYXRhLnR5cGUgPT09IG51bGwpe1xyXG4gICAgICAgICAgICAgICAgLy/nlKjmiLfmnKrov5vooYzmlK/ku5gg5LiN6L+b6KGM5pON5L2cXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG4gICAgICAgIGVycm9yOiBmdW5jdGlvbih4aHIsc3RhdHVzLGVycikge1xyXG4gICAgICAgICAgICBoaWRlTG9hZGluZygpO1xyXG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKGVycik7XHJcbiAgICAgICAgICAgIGJhc2VVdGlscy5zaG93LnJlZFRpcCgn572R57uc6ZSZ6K+v77yM6K+356iN5ZCO5YaN6K+V77yBJyk7XHJcbiAgICAgICAgICAgIHN1Ym1pdExpbXQgPSBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICBpVGltZSA9IHNldFRpbWVvdXQoXCJyZW1haW5UaW1lKClcIiwyMDAwKTtcclxufVxyXG5cclxuXHJcbi8v5Yid5aeL5YyWXHJcbmZ1bmN0aW9uIGluaXQoKVxyXG57XHJcbiAgICAvLyAgQ29udGVudOWMuuWfn+Wwj+agh+mimFxyXG4gICAgLypzaG93Q29udGVudFRpdGxlKCk7XHJcbiAgICBpZiAoaXNfaHVpZHUgPT0gMSkge1xyXG4gICAgICAgIGFwcGVuZENvbnRlbnRIZWFkZXIoXCLotKbmiLfkuIDop4hcIiwgXCIvYWNjb3VudHZpZXdcIiwgZmFsc2UpO1xyXG4gICAgfVxyXG4gICAgYXBwZW5kQ29udGVudEhlYWRlcihcIui0puWPt+euoeeQhlwiLCBcIi9hY2NvdW50bWFuYWdlXCIsIGZhbHNlKTtcclxuICAgIGFwcGVuZENvbnRlbnRIZWFkZXIoXCLov5DokKXmqKHlvI/orr7nva5cIiwgXCIvY29tcGFueW1vZGVsXCIsIHRydWUpOyovXHJcbiAgICAvLyBhcHBlbmRDb250ZW50SGVhZGVyKFwi5bCP56iL5bqP6K6+572uXCIsIFwiL3NtYWxscHJvZ3JhbXNldHRpbmdcIiwgZmFsc2UpO1xyXG5cclxuICAgIC8v55Sf5oiQ5LqM57u056CBXHJcbiAgICB2YXIgcXJjb2RlID0gbmV3IFFSQ29kZShkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImg1cXJjb2RlXCIpLFxyXG4gICAge1xyXG4gICAgICAgIHRleHQ6ICQoXCIuY29weUJ1dHRvblwiKS5lcSgwKS5wcmV2KCkuaHRtbCgpLFxyXG4gICAgICAgIHdpZHRoOiAxMzAsXHJcbiAgICAgICAgaGVpZ2h0OiAxMzAsXHJcbiAgICAgICAgY29sb3JEYXJrIDogXCIjMDAwMDAwXCIsXHJcbiAgICAgICAgY29sb3JMaWdodCA6IFwiI2ZmZmZmZlwiLFxyXG4gICAgICAgIGNvcnJlY3RMZXZlbCA6IFFSQ29kZS5Db3JyZWN0TGV2ZWwuSFxyXG4gICAgfSk7XHJcblxyXG5cclxuXHJcbiAgICAvL+WkjeWItuaMiemSrlxyXG4gICAgLy/lpI3liLbliLDliarotLTmnb9cclxuICAgIChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIGNsaXBib2FyZCA9IG5ldyBDbGlwYm9hcmQoJy5jb3B5SHJlZicpO1xyXG4gICAgICAgIGNsaXBib2FyZC5vbignc3VjY2VzcycsIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICAgYmFzZVV0aWxzLnNob3cuYmx1ZVRpcChcIuWkjeWItuaIkOWKn++8geivt+WcqOW+ruS/oeWGheaJk+W8gOWTpiDjgIJcIik7XHJcbiAgICAgICAgICAgIGUuY2xlYXJTZWxlY3Rpb24oKTtcclxuICAgICAgICB9KTtcclxuICAgIH0pKCk7XHJcbiAgICAvLyAkKFwiLmNvcHlCdXR0b25cIikuemNsaXBcclxuICAgIC8vICh7XHJcbiAgICAvLyAgICAgcGF0aDogXCJqcy9leHRlcm5hbC9aZXJvQ2xpcGJvYXJkLnN3ZlwiLFxyXG4gICAgLy8gICAgIGNvcHk6IGZ1bmN0aW9uKClcclxuICAgIC8vICAgICB7XHJcbiAgICAvLyAgICAgICAgIHJldHVybiAkKHRoaXMpLnByZXYoKS5odG1sKCk7XHJcbiAgICAvLyAgICAgfSxcclxuICAgIC8vICAgICBiZWZvcmVDb3B5OmZ1bmN0aW9uKClcclxuICAgIC8vICAgICB7fSxcclxuICAgIC8vICAgICBhZnRlckNvcHk6ZnVuY3Rpb24oKVxyXG4gICAgLy8gICAgIHtcclxuICAgIC8vICAgICAgICAgYmFzZVV0aWxzLnNob3cuYmx1ZVRpcChcIuWkjeWItuaIkOWKn1wiKTtcclxuICAgIC8vICAgICB9XHJcbiAgICAvLyB9KTtcclxuXHJcbiAgICAvL+S4iuS8oOaMiemSrlxyXG4gICAgJCgnI3d4X2J1c192ZXJpZnlfdHh0JykudXBsb2FkaWZpdmVcclxuICAgICh7XHJcbiAgICAgICAgJ2F1dG8nICAgICAgICAgOiB0cnVlLFxyXG4gICAgICAgICdidXR0b25UZXh0JyAgIDogJ+mAieaLqeaWh+S7ticsXHJcbiAgICAgICAgJ2J1dHRvbkNsYXNzJyAgOiAnZ3JlZW5DaG9vc2VGaWxlJyxcclxuICAgICAgICAnZmlsZVR5cGUnOiAnLnR4dCcsXHJcbiAgICAgICAgJ3VwbG9hZFNjcmlwdCcgOiAnL3JlbW90ZV91cGxvYWRWZXJpZnlGaWxlP2FwcF9pZD0nKyQoXCIjeGN4X2FwcF9pZFwiKS52YWwoKSxcclxuICAgICAgICAndXBsb2FkZXInIDogJy9yZW1vdGVfdXBsb2FkVmVyaWZ5RmlsZT9hcHBfaWQ9JyskKFwiI3hjeF9hcHBfaWRcIikudmFsKCksXHJcbiAgICAgICAgJ3VwbG9hZExpbWl0JyA6IDEsXHJcbiAgICAgICAgJ2l0ZW1UZW1wbGF0ZScgOiBmYWxzZSxcclxuICAgICAgICAnbWV0aG9kJyAgIDogJ3Bvc3QnLFxyXG4gICAgICAgICdmaWxlU2l6ZUxpbWl0JyA6ICc1MCcsXHJcbiAgICAgICAgJ29uQ2FuY2VsJyAgICAgOiBmdW5jdGlvbigpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBiYXNlVXRpbHMuc2hvdy5ibHVlVGlwKFwi5Y+W5raI5paH5Lu25LiK5LygIVwiKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgICdvblVwbG9hZENvbXBsZXRlJyA6IGZ1bmN0aW9uKGZpbGUsIGRhdGEpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBkYXRhID0gSlNPTi5wYXJzZShkYXRhKTtcclxuICAgICAgICAgICAgaWYgKGRhdGEucmV0ID09IDApXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGJhc2VVdGlscy5zaG93LmJsdWVUaXAoZGF0YS5tc2csZnVuY3Rpb24oKVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5yZWxvYWQoKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgYmFzZVV0aWxzLnNob3cucmVkVGlwKGRhdGEubXNnKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgJ29uRXJyb3InIDogZnVuY3Rpb24oZXJybXNnKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgYmFzZVV0aWxzLnNob3cucmVkVGlwKGVycm1zZyk7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGdldEZvcm1hdFRpbWUoKSB7XHJcbiAgICB2YXIgZGF0ZSA9IG5ldyBEYXRlKCk7XHJcbiAgICB2YXIgeWVhciA9IGRhdGUuZ2V0RnVsbFllYXIoKTtcclxuICAgIHZhciBtb250aCA9IGRhdGUuZ2V0TW9udGgoKSsxO1xyXG4gICAgdmFyIGRheSA9IGRhdGUuZ2V0RGF0ZSgpO1xyXG4gICAgdmFyIGhvdXIgPSBkYXRlLmdldEhvdXJzKCk7XHJcbiAgICB2YXIgbWludXRlID0gZGF0ZS5nZXRNaW51dGVzKCk7XHJcbiAgICB2YXIgc2Vjb25kID0gZGF0ZS5nZXRTZWNvbmRzKCk7XHJcbiAgICB2YXIgdGltZSA9IHllYXIgKyAnLScgKyBtb250aCArICctJyArIGRheSArICcgJysgaG91ciArICc6JyArIG1pbnV0ZSArICc6JyArIHNlY29uZDtcclxuICAgIHJldHVybiB0aW1lO1xyXG5cclxufVxyXG4vL+aOiOadg+ebuOWFs1xyXG5mdW5jdGlvbiBhdXRoSGFuZGxlKClcclxue1xyXG4gICAgLy/ph43mlrDmjojmnYPngrnlh7tcclxuICAgICQoXCIjcmVBdXRoXCIpLmNsaWNrKGZ1bmN0aW9uKClcclxuICAgIHtcclxuICAgICAgICB2YXIgbmV3V2luID0gd2luZG93Lm9wZW4oJycsJ19ibGFuaycpO1xyXG4gICAgICAgIHZhciBhcHBfaWQ9JChcIiN4Y3hfYXBwX2lkXCIpLnZhbCgpO1xyXG4gICAgICAgICQuZ2V0KFwiL3VwZGF0ZWlmYXV0aFwiLHtcImFwcF9pZFwiOmFwcF9pZH0sZnVuY3Rpb24oZGF0YSlcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGlmKGRhdGEucmV0PT0wKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBuZXdXaW4ubG9jYXRpb24uaHJlZiA9IGF1dGhVcmwrYXBwX2lkO1xyXG4gICAgICAgICAgICAgICAgJChcIiNiaW5kTW9kYWxcIikubW9kYWwoXCJzaG93XCIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgYmFzZVV0aWxzLnNob3cucmVkVGlwKFwi57O757uf57mB5b+ZXCIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICAvL+aOiOadg+aIkOWKn+aMiemSrueCueWHu+WIt+aWsFxyXG4gICAgJChcIiNiaW5kU3VjY2Vzc1wiKS5jbGljayhmdW5jdGlvbigpXHJcbiAgICB7XHJcbiAgICAgICAgd2luZG93LmxvY2F0aW9uLnJlbG9hZCgpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgLy/mjojmnYPlpLHotKXvvIznu6fnu63lvLnlh7pcclxuICAgICQoXCIjYmluZEZhaWxcIikuY2xpY2soZnVuY3Rpb24oKVxyXG4gICAge1xyXG4gICAgICAgIHZhciBhcHBfaWQ9JChcIiN4Y3hfYXBwX2lkXCIpLnZhbCgpO1xyXG4gICAgICAgIHdpbmRvdy5vcGVuKGF1dGhVcmwrYXBwX2lkKTtcclxuICAgICAgICAkKFwiI2JpbmRNb2RhbFwiKS5tb2RhbChcInNob3dcIik7XHJcbiAgICB9KTtcclxufVxyXG5cclxuXHJcblxyXG5cclxuIl19
