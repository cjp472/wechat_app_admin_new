$(document).ready(function(){Business.init()});var Business=function(){var e={};var i=false;e.submitLimit=false;e.communityId=-1;e.type=-1;e.dynamicId=-1;e.init=function(){changeSaveFlag(true);e.type=$("#admin_data").data("type");e.communityId=$("#admin_data").data("community_id");if(e.type==1){e.dynamicId=GetQueryString("id")}$("#uploadFile").click(function(){$("#selectPdfFile").click()});$("#deleteUploadedPdfFile").click(function(){$("#uploadedFileUrl").data("file_url","");$("#selectPdfFile").val("");$(".uploadBoxPdf").fadeOut(100)});$(".uploadFileBtnWrapper").on("change","#selectPdfFile",function(){if(!i){d(this.files,"pdf","Pdf",20)}else{baseUtils.show.redTip("文件正在上传中，请稍后再试")}});$("#releaseDynamic").click(function(){if(e.submitLimit==true){baseUtils.show.redTip("正在提交中，请稍后再试");return false}if(i){baseUtils.show.redTip("文件正在上传中，请稍后再提交");return false}var t={};var l=$("#dynamicTitle").val();if(l==""||l==undefined){baseUtils.show.redTip("请输入动态标题");return false}t["title"]=l;var a=UE.getEditor("container");var d=a.getContent();var n=a.getPlainTxt();if(d==""||d==undefined){baseUtils.show.redTip("请输入动态内容");return false}t["org_content"]=d;t["content"]=n;t["community_id"]=e.communityId;var o=$(".selectItem input:checked").val();var s=$("#uploadedFileUrl").data("file_url");var u=$("#uploadedFileUrl").data("file_name");var c=$("#uploadedFileUrl").data("file_size");if(s!=""&&s!=undefined){t["file_url"]=s;t["file_name"]=u;t["file_size"]=c}else{t["file_url"]="";t["file_name"]="";t["file_size"]=""}var r="";if(e.type==1){t["id"]=e.dynamicId;r="/smallCommunity/updateDynamic"}else{r="/smallCommunity/uploadDynamic"}e.submitLimit=true;$.ajax(r,{type:"POST",dataType:"json",data:{params:t,push_state:o},success:function(i){if(i.code==0){if(e.type==1){baseUtils.show.blueTip("保存编辑成功")}else{baseUtils.show.blueTip("发布动态成功")}setTimeout(function(){window.location.href="/smallCommunity/dynamicList?community_id="+e.communityId},700)}else{baseUtils.show.redTip("发布出现问题，请稍后再试");e.submitLimit=false}},error:function(i,t,l){e.submitLimit=false;console.log(l);baseUtils.show.redTip("网络错误，请稍后再试！")}})});$(".selectItem label").on("click",function(){var e=$(this).attr("value");if(e==1){t(e)}})};function t(i){console.count("ajax方法");$.ajax("/smallCommunity/communityFeedPersonModelPush",{type:"POST",data:{data:i},dataType:"JSON",success:function(e){console.log(e);if(e.code==0){baseUtils.show.blueTip(i==1?"服务号通知已开启":"服务号已关闭")}else if(e.code==-1){$.alert(e.msg,{});$("#closeItem").prop("checked",true)}else{baseUtils.show.redTip(i==1?"服务号通开启失败":"服务号通关闭失败")}},error:function(i,t,l){e.submitLimit=false;console.log(l);baseUtils.show.redTip("网络错误，请稍后再试！")}})}function l(e){var i=null;if(window.createObjectURL!=undefined){i=window.createObjectURL(e)}else if(window.URL!=undefined){i=window.URL.createObjectURL(e)}else if(window.webkitURL!=undefined){i=window.webkitURL.createObjectURL(e)}return i}function a(e){if(window.revokeObjectURL!=undefined){window.revokeObjectURL(e)}else if(window.URL!=undefined){window.URL.revokeObjectURL(e)}else if(window.webkitURL!=undefined){window.webkitURL.revokeObjectURL(e)}}function d(e,t,l,a){if(e&&e.length>0){var d=e[0];var o=d.name;if(!o.toLowerCase().endsWith("pdf")){baseUtils.show.redTip("请选择 pdf 格式的文件");$("#selectPdfFile").remove();$("#uploadedFileUrl").before('<input class="selectPdfFileInput" id="selectPdfFile" type="file" accept="application/pdf"/>');return false}if($uploadFile.checkFileSize(d,a)){var s=(d.size/(1024*1024)).toFixed(2);$("#uploadedFileUrl").data("file_size",s);$("#audioURL"+l).hide();$(".uploadBox"+l).fadeIn(300);n(o,s);$("#uploadedFileUrl").data("file_name",o);i=true;$uploadFile.uploadRes(d,t,function(e){var i=parseInt(e*100);$(".uploadPLineActive"+l).css("width",i+"%");$(".uploadPercent"+l).text(i+"%")},function(e){i=false;console.log(e);baseUtils.show.blueTip("上传成功！");$(".uploadPLine"+l).hide();$(".upload"+l+"Name").show();$(".uploadPercent"+l).text("删除");var t=e.data.access_url;$("#uploadedFileUrl").data("file_url",t)},function(e){i=false;console.error("上传失败!!!");console.log(e);baseUtils.show.redTip("上传失败！")})}else{baseUtils.show.redTip("上传失败，请勿上传超过 "+a+"Mb 的PDF文件");$(".upLoad"+l).val("")}}else{console.log("网络错误，请稍后再试！")}}function n(e,i){$(".uploadPdfName").html(e).hide();$(".uploadPdfSize span").html(i);$(".uploadPLinePdf").show().find(".uploadPLineActivePdf").css("width","0");$(".uploadPercentPdf").html("")}return e}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1hbmFnZUR5bmFtaWMuanMiXSwibmFtZXMiOlsiJCIsImRvY3VtZW50IiwicmVhZHkiLCJCdXNpbmVzcyIsImluaXQiLCJpc1BkZkZpbGVVcGxvYWRpbmciLCJzdWJtaXRMaW1pdCIsImNvbW11bml0eUlkIiwidHlwZSIsImR5bmFtaWNJZCIsImNoYW5nZVNhdmVGbGFnIiwiZGF0YSIsIkdldFF1ZXJ5U3RyaW5nIiwiY2xpY2siLCJ2YWwiLCJmYWRlT3V0Iiwib24iLCJyZXNVcGxvYWQiLCJ0aGlzIiwiZmlsZXMiLCJiYXNlVXRpbHMiLCJzaG93IiwicmVkVGlwIiwicGFyYW1zIiwiZHluYW1pY1RpdGxlIiwidW5kZWZpbmVkIiwidWUiLCJVRSIsImdldEVkaXRvciIsIm9yZ19jb250ZW50IiwiZ2V0Q29udGVudCIsImRlc2NyYiIsImdldFBsYWluVHh0IiwicHVzaF9zdGF0ZSIsInBkZkZpbGVVcmwiLCJwZGZGaWxlTmFtZSIsInBkZkZpbGVTaXplIiwicG9zdFVybCIsImFqYXgiLCJkYXRhVHlwZSIsInN1Y2Nlc3MiLCJyZXN1bHQiLCJjb2RlIiwiYmx1ZVRpcCIsInNldFRpbWVvdXQiLCJ3aW5kb3ciLCJsb2NhdGlvbiIsImhyZWYiLCJlcnJvciIsInhociIsInN0YXR1cyIsImVyciIsImNvbnNvbGUiLCJsb2ciLCJrZXkiLCJhdHRyIiwic2V0U2VydmljZSIsImNvdW50IiwiYWxlcnQiLCJtc2ciLCJwcm9wIiwiZ2V0T2JqZWN0VVJMIiwiZmlsZSIsInVybCIsImNyZWF0ZU9iamVjdFVSTCIsIlVSTCIsIndlYmtpdFVSTCIsInJlbW92ZU9iamVjdFVSTCIsInJldm9rZU9iamVjdFVSTCIsInJlc1R5cGUiLCJyZXNUeXBlQ2xhc3MiLCJyZXNMaW1pdFNpemUiLCJsZW5ndGgiLCJuYW1lIiwidG9Mb3dlckNhc2UiLCJlbmRzV2l0aCIsInJlbW92ZSIsImJlZm9yZSIsIiR1cGxvYWRGaWxlIiwiY2hlY2tGaWxlU2l6ZSIsImZpbGVTaXplIiwic2l6ZSIsInRvRml4ZWQiLCJoaWRlIiwiZmFkZUluIiwiaW5pdEZpbGVBbmRQcm9ncmVzc0JhciIsInVwbG9hZFJlcyIsInByb2dyZXNzIiwicGFyc2VJbnQiLCJjc3MiLCJ0ZXh0IiwicmVzVXJsIiwiYWNjZXNzX3VybCIsImZpbGVOYW1lIiwiaHRtbCIsImZpbmQiXSwibWFwcGluZ3MiOiJBQUlBQSxFQUFFQyxVQUFVQyxNQUFNLFdBRWRDLFNBQVNDLFFBR2IsSUFBSUQsVUFBVyxXQUVYLEdBQUlBLEtBRUosSUFBSUUsR0FBcUIsS0FFekJGLEdBQVNHLFlBQWMsS0FDdkJILEdBQVNJLGFBQWUsQ0FDeEJKLEdBQVNLLE1BQVEsQ0FDakJMLEdBQVNNLFdBQWEsQ0FFdEJOLEdBQVNDLEtBQU8sV0FHWk0sZUFBZSxLQUVmUCxHQUFTSyxLQUFPUixFQUFFLGVBQWVXLEtBQUssT0FDdENSLEdBQVNJLFlBQWNQLEVBQUUsZUFBZVcsS0FBSyxlQUM3QyxJQUFJUixFQUFTSyxNQUFRLEVBQUcsQ0FDcEJMLEVBQVNNLFVBQVlHLGVBQWUsTUFJeENaLEVBQUUsZUFBZWEsTUFBTSxXQUNuQmIsRUFBRSxrQkFBa0JhLFNBSXhCYixHQUFFLDBCQUEwQmEsTUFBTSxXQUM5QmIsRUFBRSxvQkFBb0JXLEtBQUssV0FBWSxHQUN2Q1gsR0FBRSxrQkFBa0JjLElBQUksR0FDeEJkLEdBQUUsaUJBQWlCZSxRQUFRLE1BSS9CZixHQUFFLHlCQUF5QmdCLEdBQUcsU0FBVSxpQkFBa0IsV0FDdEQsSUFBS1gsRUFBb0IsQ0FDckJZLEVBQVVDLEtBQUtDLE1BQU8sTUFBTyxNQUFPLFFBQ2pDLENBQ0hDLFVBQVVDLEtBQUtDLE9BQU8sbUJBSzlCdEIsR0FBRSxtQkFBbUJhLE1BQU0sV0FHdkIsR0FBSVYsRUFBU0csYUFBZSxLQUFNLENBQzlCYyxVQUFVQyxLQUFLQyxPQUFPLGNBQ3RCLE9BQU8sT0FJWCxHQUFJakIsRUFBb0IsQ0FDcEJlLFVBQVVDLEtBQUtDLE9BQU8saUJBQ3RCLE9BQU8sT0FNWCxHQUFJQyxLQUVKLElBQUlDLEdBQWV4QixF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RixFQUFXLElBQy9EdkYsR0FBRSxpQkFBbUJzRSxHQUFjb0IsS0FBS0gsRUFBVyxNQUd2RCxTQUFVNUUsR0FDTk4sRUFBcUIsS0FDckIrQyxTQUFRQyxJQUFJMUMsRUFDWlMsV0FBVUMsS0FBS3NCLFFBQVEsUUFDdkIzQyxHQUFFLGVBQWlCc0UsR0FBY2EsTUFDakNuRixHQUFFLFVBQVlzRSxFQUFlLFFBQVFqRCxNQUNyQ3JCLEdBQUUsaUJBQW1Cc0UsR0FBY29CLEtBQUssS0FDeEMsSUFBSUMsR0FBU2hGLEVBQUtBLEtBQUtpRixVQUN2QjVGLEdBQUUsb0JBQW9CVyxLQUFLLFdBQVlnRixJQUkzQyxTQUFVaEYsR0FDTk4sRUFBc0IsS0FDdEIrQyxTQUFRSixNQUFNLFVBQ2RJLFNBQVFDLElBQUkxQyxFQUNaUyxXQUFVQyxLQUFLQyxPQUFPLGVBRTNCLENBQ0hGLFVBQVVDLEtBQUtDLE9BQU8sZUFBaUJpRCxFQUFlLFlBQ3REdkUsR0FBRSxVQUFVc0UsR0FBY3hELElBQUksU0FFL0IsQ0FDSHNDLFFBQVFDLElBQUksZ0JBS3BCLFFBQVNnQyxHQUF1QlEsRUFBVWIsR0FFdENoRixFQUFFLGtCQUFrQjhGLEtBQUtELEdBQVVWLE1BQ25DbkYsR0FBRSx1QkFBdUI4RixLQUFLZCxFQUM5QmhGLEdBQUUsbUJBQW1CcUIsT0FDaEIwRSxLQUFLLHlCQUF5Qk4sSUFBSSxRQUFTLElBQ2hEekYsR0FBRSxxQkFBcUI4RixLQUFLLElBSWhDLE1BQU8zRiIsImZpbGUiOiJtYW5hZ2VEeW5hbWljLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIENyZWF0ZWQgYnkgQWRtaW5pc3RyYXRvciBvbiAyMDE3LzUvMi5cclxuICovXHJcblxyXG4kKGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgQnVzaW5lc3MuaW5pdCgpO1xyXG59KVxyXG5cclxudmFyIEJ1c2luZXNzID0gKGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICB2YXIgQnVzaW5lc3MgPSB7fTtcclxuXHJcbiAgICB2YXIgaXNQZGZGaWxlVXBsb2FkaW5nID0gZmFsc2U7XHJcblxyXG4gICAgQnVzaW5lc3Muc3VibWl0TGltaXQgPSBmYWxzZTsgICAvL+aPkOS6pOmZkOWItlxyXG4gICAgQnVzaW5lc3MuY29tbXVuaXR5SWQgPSAtMTtcclxuICAgIEJ1c2luZXNzLnR5cGUgPSAtMTsgICAgICAgICAgICAgLy8gIDEgLSDnvJbovpEg77ybIDAgLSDmlrDlu7pcclxuICAgIEJ1c2luZXNzLmR5bmFtaWNJZCA9IC0xO1xyXG5cclxuICAgIEJ1c2luZXNzLmluaXQgPSBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgICAgIC8v54K55Ye75L6n6L655qCP56a75byA5pe255qE5by55qGGXHJcbiAgICAgICAgY2hhbmdlU2F2ZUZsYWcodHJ1ZSk7XHJcblxyXG4gICAgICAgIEJ1c2luZXNzLnR5cGUgPSAkKFwiI2FkbWluX2RhdGFcIikuZGF0YShcInR5cGVcIik7XHJcbiAgICAgICAgQnVzaW5lc3MuY29tbXVuaXR5SWQgPSAkKFwiI2FkbWluX2RhdGFcIikuZGF0YShcImNvbW11bml0eV9pZFwiKTtcclxuICAgICAgICBpZiAoQnVzaW5lc3MudHlwZSA9PSAxKSB7XHJcbiAgICAgICAgICAgIEJ1c2luZXNzLmR5bmFtaWNJZCA9IEdldFF1ZXJ5U3RyaW5nKFwiaWRcIik7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvL+mAieaLqemcgOimgeS4iuS8oOeahOaWh+S7tlxyXG4gICAgICAgICQoXCIjdXBsb2FkRmlsZVwiKS5jbGljayhmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICQoXCIjc2VsZWN0UGRmRmlsZVwiKS5jbGljaygpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICAvL+WIoOmZpOW3sue7j+S4iuS8oOeahHBkZuaWh+S7tlxyXG4gICAgICAgICQoXCIjZGVsZXRlVXBsb2FkZWRQZGZGaWxlXCIpLmNsaWNrKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgJChcIiN1cGxvYWRlZEZpbGVVcmxcIikuZGF0YShcImZpbGVfdXJsXCIsIFwiXCIpO1xyXG4gICAgICAgICAgICAkKFwiI3NlbGVjdFBkZkZpbGVcIikudmFsKFwiXCIpO1xyXG4gICAgICAgICAgICAkKFwiLnVwbG9hZEJveFBkZlwiKS5mYWRlT3V0KDEwMCk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIC8v5aSE55CG6YCJ5oup5paH5Lu25ZCO55qE5LiK5LygXHJcbiAgICAgICAgJChcIi51cGxvYWRGaWxlQnRuV3JhcHBlclwiKS5vbihcImNoYW5nZVwiLCBcIiNzZWxlY3RQZGZGaWxlXCIsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgaWYgKCFpc1BkZkZpbGVVcGxvYWRpbmcpIHtcclxuICAgICAgICAgICAgICAgIHJlc1VwbG9hZCh0aGlzLmZpbGVzLCBcInBkZlwiLCBcIlBkZlwiLCAyMCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBiYXNlVXRpbHMuc2hvdy5yZWRUaXAoXCLmlofku7bmraPlnKjkuIrkvKDkuK3vvIzor7fnqI3lkI7lho3or5VcIik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgLy/lj5HluIPliqjmgIFcclxuICAgICAgICAkKFwiI3JlbGVhc2VEeW5hbWljXCIpLmNsaWNrKGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICAgICAgICAgIC8vICDpmLLmraLph43lpI3mj5DkuqRcclxuICAgICAgICAgICAgaWYgKEJ1c2luZXNzLnN1Ym1pdExpbWl0ID09IHRydWUpIHtcclxuICAgICAgICAgICAgICAgIGJhc2VVdGlscy5zaG93LnJlZFRpcChcIuato+WcqOaPkOS6pOS4re+8jOivt+eojeWQjuWGjeivlVwiKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgLy8gIOaWh+S7tuato+WcqOS4iuS8oOS4rVxyXG4gICAgICAgICAgICBpZiAoaXNQZGZGaWxlVXBsb2FkaW5nKSB7XHJcbiAgICAgICAgICAgICAgICBiYXNlVXRpbHMuc2hvdy5yZWRUaXAoXCLmlofku7bmraPlnKjkuIrkvKDkuK3vvIzor7fnqI3lkI7lho3mj5DkuqRcIik7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIC8qKlxyXG4gICAgICAgICAgICAgKiDpnIDopoHnmoTlj4LmlbAg77yaIGNvbW11bml0eV9pZCAtIHRpdGxlIC0gb3JnX2NvbnRlbnQgLSBjb250ZW50IC0gZmlsZV91cmwgLSBmaWxlX25hbWUgLSBmaWxlX3NpemVcclxuICAgICAgICAgICAgICovXHJcbiAgICAgICAgICAgIHZhciBwYXJhbXMgPSB7fTtcclxuXHJcbiAgICAgICAgICAgIHZhciBkeW5hbWljVGl0bGUgPSAkKFwiI2R5bmFtaWNUaXRsZVwiKS52YWwoKTtcclxuICAgICAgICAgICAgaWYgKGR5bmFtaWNUaXRsZSA9PSAnJyB8fCBkeW5hbWljVGl0bGUgPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgICAgICBiYXNlVXRpbHMuc2hvdy5yZWRUaXAoXCLor7fovpPlhaXliqjmgIHmoIfpophcIik7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcGFyYW1zWyd0aXRsZSddID0gZHluYW1pY1RpdGxlO1xyXG5cclxuICAgICAgICAgICAgLy8gIOiOt+WPluWKqOaAgSBodG1s5YaF5a6577yM6L+U5ZueOiA8cD5oZWxsbzwvcD5cclxuICAgICAgICAgICAgdmFyIHVlID0gVUUuZ2V0RWRpdG9yKCdjb250YWluZXInKTtcclxuICAgICAgICAgICAgdmFyIG9yZ19jb250ZW50ID0gdWUuZ2V0Q29udGVudCgpOyAgICAvLyAg5Y6f5aeLaHRtbOWGheWuuVxyXG4gICAgICAgICAgICB2YXIgZGVzY3JiID0gdWUuZ2V0UGxhaW5UeHQoKTsgICAgICAgIC8vICDnuq/mlofmnKxcclxuXHJcbiAgICAgICAgICAgIGlmIChvcmdfY29udGVudCA9PSAnJyB8fCBvcmdfY29udGVudCA9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgIGJhc2VVdGlscy5zaG93LnJlZFRpcChcIuivt+i+k+WFpeWKqOaAgeWGheWuuVwiKTtcclxuXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcGFyYW1zWydvcmdfY29udGVudCddID0gb3JnX2NvbnRlbnQ7XHJcbiAgICAgICAgICAgIHBhcmFtc1snY29udGVudCddID0gZGVzY3JiO1xyXG5cclxuICAgICAgICAgICAgcGFyYW1zWydjb21tdW5pdHlfaWQnXSA9IEJ1c2luZXNzLmNvbW11bml0eUlkO1xyXG5cclxuICAgICAgICAgICAgLy/ojrflj5bmnIDlkI7mnI3liqHlj7fpgJrnn6XlgLxcclxuICAgICAgICAgICAgdmFyIHB1c2hfc3RhdGUgPSAkKCcuc2VsZWN0SXRlbSBpbnB1dDpjaGVja2VkJykudmFsKCk7XHJcbiAgICAgICAgICAgIC8v5paH5Lu25bGe5oCnXHJcbiAgICAgICAgICAgIHZhciBwZGZGaWxlVXJsID0gJChcIiN1cGxvYWRlZEZpbGVVcmxcIikuZGF0YShcImZpbGVfdXJsXCIpO1xyXG4gICAgICAgICAgICB2YXIgcGRmRmlsZU5hbWUgPSAkKFwiI3VwbG9hZGVkRmlsZVVybFwiKS5kYXRhKFwiZmlsZV9uYW1lXCIpO1xyXG4gICAgICAgICAgICB2YXIgcGRmRmlsZVNpemUgPSAkKFwiI3VwbG9hZGVkRmlsZVVybFwiKS5kYXRhKFwiZmlsZV9zaXplXCIpO1xyXG5cclxuICAgICAgICAgICAgaWYgKHBkZkZpbGVVcmwgIT0gXCJcIiAmJiBwZGZGaWxlVXJsICE9IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgcGFyYW1zWydmaWxlX3VybCddID0gcGRmRmlsZVVybDtcclxuICAgICAgICAgICAgICAgIHBhcmFtc1snZmlsZV9uYW1lJ10gPSBwZGZGaWxlTmFtZTtcclxuICAgICAgICAgICAgICAgIHBhcmFtc1snZmlsZV9zaXplJ10gPSBwZGZGaWxlU2l6ZTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHBhcmFtc1snZmlsZV91cmwnXSA9IFwiXCI7XHJcbiAgICAgICAgICAgICAgICBwYXJhbXNbJ2ZpbGVfbmFtZSddID0gXCJcIjtcclxuICAgICAgICAgICAgICAgIHBhcmFtc1snZmlsZV9zaXplJ10gPSBcIlwiO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB2YXIgcG9zdFVybCA9IFwiXCI7XHJcbiAgICAgICAgICAgIGlmIChCdXNpbmVzcy50eXBlID09IDEpIHsgICAvLyAg57yW6L6RXHJcbiAgICAgICAgICAgICAgICBwYXJhbXNbJ2lkJ10gPSBCdXNpbmVzcy5keW5hbWljSWQ7XHJcbiAgICAgICAgICAgICAgICBwb3N0VXJsID0gXCIvc21hbGxDb21tdW5pdHkvdXBkYXRlRHluYW1pY1wiO1xyXG4gICAgICAgICAgICB9IGVsc2UgeyAgICAvLyAg5paw5bu6XHJcbiAgICAgICAgICAgICAgICBwb3N0VXJsID0gXCIvc21hbGxDb21tdW5pdHkvdXBsb2FkRHluYW1pY1wiO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBCdXNpbmVzcy5zdWJtaXRMaW1pdCA9IHRydWU7XHJcblxyXG4gICAgICAgICAgICAkLmFqYXgocG9zdFVybCwge1xyXG4gICAgICAgICAgICAgICAgdHlwZTogXCJQT1NUXCIsXHJcbiAgICAgICAgICAgICAgICBkYXRhVHlwZTogXCJqc29uXCIsXHJcbiAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgcGFyYW1zOiBwYXJhbXMsXHJcbiAgICAgICAgICAgICAgICAgICAgcHVzaF9zdGF0ZTpwdXNoX3N0YXRlXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24gKHJlc3VsdCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChyZXN1bHQuY29kZSA9PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChCdXNpbmVzcy50eXBlID09IDEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhc2VVdGlscy5zaG93LmJsdWVUaXAoXCLkv53lrZjnvJbovpHmiJDlip9cIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiYXNlVXRpbHMuc2hvdy5ibHVlVGlwKFwi5Y+R5biD5Yqo5oCB5oiQ5YqfXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWY9XCIvc21hbGxDb21tdW5pdHkvZHluYW1pY0xpc3Q/Y29tbXVuaXR5X2lkPVwiICsgQnVzaW5lc3MuY29tbXVuaXR5SWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sIDcwMCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYmFzZVV0aWxzLnNob3cucmVkVGlwKFwi5Y+R5biD5Ye6546w6Zeu6aKY77yM6K+356iN5ZCO5YaN6K+VXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBCdXNpbmVzcy5zdWJtaXRMaW1pdCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICBlcnJvcjogZnVuY3Rpb24gKHhociwgc3RhdHVzLCBlcnIpIHtcclxuICAgICAgICAgICAgICAgICAgICBCdXNpbmVzcy5zdWJtaXRMaW1pdCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycik7XHJcbiAgICAgICAgICAgICAgICAgICAgYmFzZVV0aWxzLnNob3cucmVkVGlwKFwi572R57uc6ZSZ6K+v77yM6K+356iN5ZCO5YaN6K+V77yBXCIpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICQoJy5zZWxlY3RJdGVtIGxhYmVsJykub24oJ2NsaWNrJyxmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICB2YXIga2V5PSQodGhpcykuYXR0cigndmFsdWUnKTtcclxuICAgICAgICAgICAgLy8gY29uc29sZS5sb2coa2V5KTtcclxuICAgICAgICAgICAgaWYoa2V5ID09IDEpe1xyXG4gICAgICAgICAgICAgICAgc2V0U2VydmljZShrZXkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSlcclxuXHJcbiAgICB9O1xyXG5cclxuICAgIC8v5pyN5Yqh5Y+35raI5oGv6YCa55+lYWpheOaWueazlVxyXG4gICAgZnVuY3Rpb24gc2V0U2VydmljZShrZXkpe1xyXG4gICAgICAgIGNvbnNvbGUuY291bnQoJ2FqYXjmlrnms5UnKVxyXG4gICAgICAgICQuYWpheCgnL3NtYWxsQ29tbXVuaXR5L2NvbW11bml0eUZlZWRQZXJzb25Nb2RlbFB1c2gnLHtcclxuICAgICAgICAgICAgdHlwZTonUE9TVCcsXHJcbiAgICAgICAgICAgIGRhdGE6e1xyXG4gICAgICAgICAgICAgICAgZGF0YTprZXlcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgZGF0YVR5cGU6J0pTT04nLFxyXG4gICAgICAgICAgICBzdWNjZXNzOmZ1bmN0aW9uKGRhdGEpe1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coZGF0YSk7XHJcbiAgICAgICAgICAgICAgICBpZihkYXRhLmNvZGUgPT0gMCl7XHJcbiAgICAgICAgICAgICAgICAgICAgYmFzZVV0aWxzLnNob3cuYmx1ZVRpcChrZXkgPT0gMT8n5pyN5Yqh5Y+36YCa55+l5bey5byA5ZCvJzon5pyN5Yqh5Y+35bey5YWz6ZetJyk7XHJcbiAgICAgICAgICAgICAgICB9ZWxzZSBpZihkYXRhLmNvZGUgPT0gLTEpe1xyXG4gICAgICAgICAgICAgICAgICAgICQuYWxlcnQoZGF0YS5tc2cse30pO1xyXG4gICAgICAgICAgICAgICAgICAgICQoJyNjbG9zZUl0ZW0nKS5wcm9wKCdjaGVja2VkJyx0cnVlKTtcclxuICAgICAgICAgICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICAgICAgICAgIGJhc2VVdGlscy5zaG93LnJlZFRpcChrZXkgPT0gMT8n5pyN5Yqh5Y+36YCa5byA5ZCv5aSx6LSlJzon5pyN5Yqh5Y+36YCa5YWz6Zet5aSx6LSlJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgLy/lpLHotKXliqDlhaXpgInpobnov5Tlm55cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgZXJyb3I6IGZ1bmN0aW9uICh4aHIsIHN0YXR1cywgZXJyKSB7XHJcbiAgICAgICAgICAgICAgICBCdXNpbmVzcy5zdWJtaXRMaW1pdCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyKTtcclxuICAgICAgICAgICAgICAgIGJhc2VVdGlscy5zaG93LnJlZFRpcChcIue9kee7nOmUmeivr++8jOivt+eojeWQjuWGjeivle+8gVwiKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICB9KVxyXG4gICAgfVxyXG4gICAgLy/lj5bmtojkuIrkvKDliKTmlq3lj4LmlbBcclxuICAgIC8vIHZhciB1cGxvYWRDYW5jZWw9MDtcclxuICAgIGZ1bmN0aW9uIGdldE9iamVjdFVSTChmaWxlKSB7XHJcbiAgICAgICAgdmFyIHVybCA9IG51bGw7XHJcbiAgICAgICAgaWYgKHdpbmRvdy5jcmVhdGVPYmplY3RVUkwgIT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIHVybCA9IHdpbmRvdy5jcmVhdGVPYmplY3RVUkwoZmlsZSk7XHJcbiAgICAgICAgfSBlbHNlIGlmICh3aW5kb3cuVVJMICE9IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICB1cmwgPSB3aW5kb3cuVVJMLmNyZWF0ZU9iamVjdFVSTChmaWxlKTtcclxuICAgICAgICB9IGVsc2UgaWYgKHdpbmRvdy53ZWJraXRVUkwgIT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIHVybCA9IHdpbmRvdy53ZWJraXRVUkwuY3JlYXRlT2JqZWN0VVJMKGZpbGUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdXJsO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIHJlbW92ZU9iamVjdFVSTCh1cmwpIHsvL+mHiuaUvui1hOa6kFVSTFxyXG4gICAgICAgIGlmICh3aW5kb3cucmV2b2tlT2JqZWN0VVJMICE9IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICB3aW5kb3cucmV2b2tlT2JqZWN0VVJMKHVybCk7XHJcbiAgICAgICAgfSBlbHNlIGlmICh3aW5kb3cuVVJMICE9IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICB3aW5kb3cuVVJMLnJldm9rZU9iamVjdFVSTCh1cmwpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAod2luZG93LndlYmtpdFVSTCAhPSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgd2luZG93LndlYmtpdFVSTC5yZXZva2VPYmplY3RVUkwodXJsKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG5cclxuICAgIC8v6LWE5rqQ5LiK5Lyg5Ye95pWwKOWPguaVsO+8mnJlc1R5cGU66LWE5rqQ57G75Z6LLHJlc1R5cGVDbGFzczrotYTmupDnsbvlnovkuK3nu4bliIbnmoTnp43nsbsscmVzTGltaXRTaXplOui1hOa6kOmZkOWItuWkp+WwjylcclxuICAgIGZ1bmN0aW9uIHJlc1VwbG9hZChmaWxlcywgcmVzVHlwZSwgcmVzVHlwZUNsYXNzLCByZXNMaW1pdFNpemUpIHtcclxuICAgICAgICBpZiAoZmlsZXMgJiYgZmlsZXMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICB2YXIgZmlsZSA9IGZpbGVzWzBdO1xyXG4gICAgICAgICAgICB2YXIgcGRmRmlsZU5hbWUgPSBmaWxlLm5hbWU7XHJcbiAgICAgICAgICAgIGlmICghcGRmRmlsZU5hbWUudG9Mb3dlckNhc2UoKS5lbmRzV2l0aChcInBkZlwiKSkge1xyXG4gICAgICAgICAgICAgICAgYmFzZVV0aWxzLnNob3cucmVkVGlwKFwi6K+36YCJ5oupIHBkZiDmoLzlvI/nmoTmlofku7ZcIik7XHJcbiAgICAgICAgICAgICAgICAkKFwiI3NlbGVjdFBkZkZpbGVcIikucmVtb3ZlKCk7XHJcbiAgICAgICAgICAgICAgICAkKFwiI3VwbG9hZGVkRmlsZVVybFwiKS5iZWZvcmUoJzxpbnB1dCBjbGFzcz1cInNlbGVjdFBkZkZpbGVJbnB1dFwiIGlkPVwic2VsZWN0UGRmRmlsZVwiIHR5cGU9XCJmaWxlXCIgYWNjZXB0PVwiYXBwbGljYXRpb24vcGRmXCIvPicpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvLyDpmZDliLbotYTmupDlnKgqTULlhoVcclxuICAgICAgICAgICAgaWYgKCR1cGxvYWRGaWxlLmNoZWNrRmlsZVNpemUoZmlsZSwgcmVzTGltaXRTaXplKSkge1xyXG5cclxuICAgICAgICAgICAgICAgIHZhciBmaWxlU2l6ZSA9IChmaWxlLnNpemUgLyAoMTAyNCAqIDEwMjQpKS50b0ZpeGVkKDIpO1xyXG4gICAgICAgICAgICAgICAgJChcIiN1cGxvYWRlZEZpbGVVcmxcIikuZGF0YShcImZpbGVfc2l6ZVwiLCBmaWxlU2l6ZSk7XHJcbiAgICAgICAgICAgICAgICAkKCcjYXVkaW9VUkwnK3Jlc1R5cGVDbGFzcykuaGlkZSgpO1xyXG4gICAgICAgICAgICAgICAgJChcIi51cGxvYWRCb3hcIityZXNUeXBlQ2xhc3MpLmZhZGVJbigzMDApO1xyXG4gICAgICAgICAgICAgICAgLy8g5Yid5aeL5YyW5paH5Lu25Lul5Y+K6L+b5bqm5p2hXHJcbiAgICAgICAgICAgICAgICBpbml0RmlsZUFuZFByb2dyZXNzQmFyKHBkZkZpbGVOYW1lLCBmaWxlU2l6ZSk7XHJcblxyXG4gICAgICAgICAgICAgICAgJChcIiN1cGxvYWRlZEZpbGVVcmxcIikuZGF0YShcImZpbGVfbmFtZVwiLCBwZGZGaWxlTmFtZSk7XHJcblxyXG4gICAgICAgICAgICAgICAgaXNQZGZGaWxlVXBsb2FkaW5nID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICR1cGxvYWRGaWxlLnVwbG9hZFJlcyhmaWxlLCByZXNUeXBlLCBmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcHJvZ3Jlc3MgPSBwYXJzZUludChkYXRhICogMTAwKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhwcm9ncmVzcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICQoXCIudXBsb2FkUExpbmVBY3RpdmVcIiArIHJlc1R5cGVDbGFzcykuY3NzKFwid2lkdGhcIiwgcHJvZ3Jlc3MgKyAnJScpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkKFwiLnVwbG9hZFBlcmNlbnRcIiArIHJlc1R5cGVDbGFzcykudGV4dChwcm9ncmVzcyArIFwiJVwiKTtcclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIC8vIOS4iuS8oOaIkOWKn+Wbnuiwg1xyXG4gICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlzUGRmRmlsZVVwbG9hZGluZyA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhkYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYmFzZVV0aWxzLnNob3cuYmx1ZVRpcChcIuS4iuS8oOaIkOWKn++8gVwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJChcIi51cGxvYWRQTGluZVwiICsgcmVzVHlwZUNsYXNzKS5oaWRlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICQoXCIudXBsb2FkXCIgKyByZXNUeXBlQ2xhc3MgKyBcIk5hbWVcIikuc2hvdygpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkKFwiLnVwbG9hZFBlcmNlbnRcIiArIHJlc1R5cGVDbGFzcykudGV4dChcIuWIoOmZpFwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlc1VybCA9IGRhdGEuZGF0YS5hY2Nlc3NfdXJsO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkKFwiI3VwbG9hZGVkRmlsZVVybFwiKS5kYXRhKFwiZmlsZV91cmxcIiwgcmVzVXJsKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAvLyDkuIrkvKDlpLHotKXlm57osINcclxuICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpc1BkZkZpbGVVcGxvYWRpbmcgID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCLkuIrkvKDlpLHotKUhISFcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBiYXNlVXRpbHMuc2hvdy5yZWRUaXAoXCLkuIrkvKDlpLHotKXvvIFcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBiYXNlVXRpbHMuc2hvdy5yZWRUaXAoXCLkuIrkvKDlpLHotKXvvIzor7fli7/kuIrkvKDotoXov4cgXCIgKyByZXNMaW1pdFNpemUgKyBcIk1iIOeahFBERuaWh+S7tlwiKTtcclxuICAgICAgICAgICAgICAgICQoXCIudXBMb2FkXCIrcmVzVHlwZUNsYXNzKS52YWwoXCJcIik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIue9kee7nOmUmeivr++8jOivt+eojeWQjuWGjeivle+8gVwiKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIC8vIOWIneWni+WMluaWh+S7tuS7peWPiui/m+W6puadoVxyXG4gICAgZnVuY3Rpb24gaW5pdEZpbGVBbmRQcm9ncmVzc0JhcihmaWxlTmFtZSwgZmlsZVNpemUpIHtcclxuXHJcbiAgICAgICAgJChcIi51cGxvYWRQZGZOYW1lXCIpLmh0bWwoZmlsZU5hbWUpLmhpZGUoKTtcclxuICAgICAgICAkKFwiLnVwbG9hZFBkZlNpemUgc3BhblwiKS5odG1sKGZpbGVTaXplKTtcclxuICAgICAgICAkKFwiLnVwbG9hZFBMaW5lUGRmXCIpLnNob3coKVxyXG4gICAgICAgICAgICAuZmluZChcIi51cGxvYWRQTGluZUFjdGl2ZVBkZlwiKS5jc3MoXCJ3aWR0aFwiLCAnMCcpO1xyXG4gICAgICAgICQoXCIudXBsb2FkUGVyY2VudFBkZlwiKS5odG1sKCcnKTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIEJ1c2luZXNzO1xyXG5cclxufSkoKTtcclxuXHJcbiJdfQ==
