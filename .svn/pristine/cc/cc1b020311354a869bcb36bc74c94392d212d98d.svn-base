$(document).ready(function(){$goodsList.init()});var $goodsList=function(){var e=$("#_mainContentPart"),i={},o="edit",t=new Array;var s={goodsCount:$("#addDistributeGoods").data("count"),init:function(){e.on("click","#addDistributeGoods",function(){var e=$("._switchOperateArea").data("switch_state");if(!e){$chosenShop.showOpenChosenTip();return false}if(s.goodsCount>=20){baseUtils.show.redTip("添加的推广商品数量已达到20个，不能再添加");return false}baseUtils.showWindow("_addDistributeGoodsWindow");s.getDistributeGoodsContent()});$("#_addDistributeGoodsWindow").on("click","._HeaderIcon, #_cancelAddDistributeGoods",function(){baseUtils.hideWindow("_addDistributeGoodsWindow")});$("#_addDistributeGoodsWindow").on("click","._addGoodsWindowTableItem",function(){var e=$(this).children("._selectSingleDistributeGoods"),i=e.prop("checked");if(!i){var o=s.goodsCount+$("#_addGoodsWindowTableBody").find("._selectSingleDistributeGoods:checked").length;if(o>=20){baseUtils.show.redTip("添加的推广商品数量已达到20个，不能再添加");return false}}e.prop("checked",!i)});$("#_addDistributeGoodsWindow").on("click","#_searchDistributeGoods",function(){var e=$.trim($("#_searchDistributeGoodsInput").val());s.getDistributeGoodsContent(e)});$("#_searchDistributeGoodsInput").on("keypress",function(e){if(e.keyCode==13){$("#_searchDistributeGoods").click()}});$("#_confirmAddDistributeGoods").click(function(){$("#_addGoodsWindowTableBody").find("._selectSingleDistributeGoods:checked").each(function(){var e={id:$(this).data("resource_id"),type:$(this).data("resource_type")};t.push(e)});if(s.goodsCount+t.length>20){baseUtils.show.redTip("添加的推广商品数量不能超过20个");return false}baseUtils.showLoading("addDistributeGoodsLoading");$.ajax("/chosen/add_resource_chosen",{type:"POST",dataType:"json",data:{params:t},success:function(e){baseUtils.hideLoading("addDistributeGoodsLoading");if(e.code==0){baseUtils.hideWindow("_addDistributeGoodsWindow");baseUtils.show.blueTip("保存成功");$chosenShop.getNewPage("goods")}else{baseUtils.show.redTip("操作失败，请稍后再试")}},error:function(e,i,o){baseUtils.hideLoading("addDistributeGoodsLoading");console.log(o);alert("服务器出小差了，请稍后再试！")}})});e.on("click",".setGradient",function(){var e=$(this).parents(".tableBodyItem").data("resource_id"),t=$(this).parents(".tableBodyItem").data("resource_type"),s=$(this).data("type");i={resId:e,resType:t};if(s=="set"){$("#_setGoodsGradientWindow ._windowEditableValue").val("");o="set"}else if(s=="edit"){o="edit";var d=$(this).data("distribute_data");$("#_windowValue1").val(d.end1);$("#_windowValue2").val(d.start2);$("#_windowValue3").val(d.end2);$("#_windowValue4").val(d.start3);$("#_windowRatio1").val(d.percent1);$("#_windowRatio2").val(d.percent2);$("#_windowRatio3").val(d.percent3)}baseUtils.showWindow("_setGoodsGradientWindow")});$("#_setGoodsGradientWindow").on("click","._HeaderIcon, #_windowCancelBtn",function(){baseUtils.hideWindow("_setGoodsGradientWindow")});$("#_setGoodsGradientWindow").on("keyup","._windowEditableValue",function(){var e=$(this).attr("id");if(e=="_windowValue1"){$("#_windowValue2").val(+$.trim($("#_windowValue1").val())+1)}else if(e=="_windowValue3"){$("#_windowValue4").val(+$.trim($("#_windowValue3").val())+1)}});$("#_setGoodsGradientWindow").on("click","#_windowConfirmBtn",function(){var e=parseInt($("#_windowValue1").val()),t=parseInt($("#_windowValue2").val()),s=parseInt($("#_windowValue3").val()),d=parseInt($("#_windowValue4").val()),a=parseInt($("#_windowRatio1").val()),n=parseInt($("#_windowRatio2").val()),r=parseInt($("#_windowRatio3").val());if(!e||!t||!s||!d||!a||!n||!r){baseUtils.show.redTip("数据没有填写完整哦");return false}if(e+1!=t||s+1!=d||t>=s||e<=1){baseUtils.show.redTip("区间填写有误，请检查后重试");return false}if(a<=0||a>n||n>r){baseUtils.show.redTip("分成比例填写有误，请参考示例");return false}if(a>99||n>99||r>99){baseUtils.show.redTip("分成比例不能超过99%");return false}var l={data1:{end_order_num:e,distribute_percent:a},data2:{start_order_num:t,end_order_num:s,distribute_percent:n},data3:{start_order_num:d,distribute_percent:r},resource_id:i.resId,resource_type:i.resType,edit:o=="edit"?"edit":"set"};$.ajax("/chosen/set_xiaoe_distribute",{type:"POST",dataType:"json",data:l,success:function(e){if(e.code==0){baseUtils.show.blueTip("梯度设置成功");baseUtils.hideWindow("_setGoodsGradientWindow");$chosenShop.getNewPage("goods")}else{baseUtils.show.redTip("梯度设置失败，请稍后再试")}},error:function(e,i,o){console.log(o);baseUtils.show.redTip("服务器出小差了，请稍后再试！")}})});e.on("change",".selectChosenGoodsClass",function(){var e=$(this),i=e.children("option:selected"),o=i.val(),t=i.text();if(o==-1){console.log(o+" - "+t);return false}var s=e.parents(".tableBodyItem"),d=s.data("resource_id"),a=s.data("resource_type"),n=s.data("old_class_id")||-1;$.ajax("/chosen/set_classify",{type:"POST",dataType:"json",data:{class_id:o,resource_id:d,resource_type:a},success:function(i){if(i.code==0){baseUtils.show.blueTip("设置分类成功。")}else{baseUtils.show.redTip("设置分类失败。");e.val(n)}},error:function(e,i,o){console.log(o);alert("服务器出小差了，请稍后再试！")}})});e.find(".qrCodeImage").each(function(){var e=$(this).data("url"),i=$(this).attr("id");createQrCode(i,e,160,160)})},getDistributeGoodsContent:function(e){baseUtils.showLoading("addDistributeGoodsLoading");$.ajax("/chosen/search_resource",{type:"POST",dataType:"json",data:{search:e||""},success:function(e){var i="";$.each(e,function(e,o){i+='<div class="_addGoodsWindowTableItem clearfix">'+'<input type="checkbox" class="_selectSingleDistributeGoods" '+'data-resource_id="'+o.id+'" data-resource_type="'+o.type+'">'+'<div class="_singleDistributeGoodsCover">'+'<img src="'+o.img_url_compressed+'">'+"</div>"+'<div class="_singleDistributeGoodsTitle" title="'+o.name+'">'+o.name+"</div>"+'<div class="_singleDistributeGoodsTime">'+o.created_at+"</div>"+"</div>"});if(i.length==0){i="<div class='contentNoData'>暂无数据</div>"}$("#_addGoodsWindowTableBody").html(i);$("#_addGoodsWindowTableBody").scrollTop(0);baseUtils.hideLoading("addDistributeGoodsLoading")},error:function(e,i,o){console.log(o);alert("服务器出小差了，请稍后再试！")}})},checkInputValue:function(e){var i=$(e).val();i=i.replace(/[^\d]/g,"");i=i.replace(/^0[\d]+/g,"0");$(e).val(i)}};return s}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImdvb2RzTGlzdC5qcyJdLCJuYW1lcyI6WyIkIiwiZG9jdW1lbnQiLCJyZWFkeSIsIiRnb29kc0xpc3QiLCJpbml0IiwiJGhvbWVQYWdlIiwic2V0R3JhZGllbnRJbmZvIiwic2V0R3JhZGllbnRXaW5kb3dTdGF0ZSIsImFkZFJlc291cmNlUGFyYW1zIiwiQXJyYXkiLCJnb29kc0NvdW50IiwiZGF0YSIsIm9uIiwic3dpdGNoU3RhdGUiLCIkY2hvc2VuU2hvcCIsInNob3dPcGVuQ2hvc2VuVGlwIiwiYmFzZVV0aWxzIiwic2hvdyIsInJlZFRpcCIsInNob3dXaW5kb3ciLCJnZXREaXN0cmlidXRlR29vZHNDb250ZW50IiwiaGlkZVdpbmRvdyIsIiR0YXJnZXQiLCJ0aGlzIiwiY2hpbGRyZW4iLCJjdXJyZW50U3RhdGUiLCJwcm9wIiwiYWxsQ291bnQiLCJmaW5kIiwibGVuZ3RoIiwic2VhcmNoQ29udGVudCIsInRyaW0iLCJ2YWwiLCJlIiwia2V5Q29kZSIsImNsaWNrIiwiZWFjaCIsIm9iaiIsImlkIiwidHlwZSIsInB1c2giLCJzaG93TG9hZGluZyIsImFqYXgiLCJkYXRhVHlwZSIsInBhcmFtcyIsInN1Y2Nlc3MiLCJyZXN1bHQiLCJoaWRlTG9hZGluZyIsImNvZGUiLCJibHVlVGlwIiwiZ2V0TmV3UGFnZSIsImVycm9yIiwieGhyIiwic3RhdHVzIiwiZXJyIiwiY29uc29sZSIsImxvZyIsImFsZXJ0IiwicmVzSWQiLCJwYXJlbnRzIiwicmVzVHlwZSIsImRpc3RyaWJ1dGVEYXRhIiwiZW5kMSIsInN0YXJ0MiIsImVuZDIiLCJzdGFydDMiLCJwZXJjZW50MSIsInBlcmNlbnQyIiwicGVyY2VudDMiLCJhdHRyIiwidmFsdWUxIiwicGFyc2VJbnQiLCJ2YWx1ZTIiLCJ2YWx1ZTMiLCJ2YWx1ZTQiLCJyYXRpbzEiLCJyYXRpbzIiLCJyYXRpbzMiLCJkYXRhMSIsImVuZF9vcmRlcl9udW0iLCJkaXN0cmlidXRlX3BlcmNlbnQiLCJkYXRhMiIsInN0YXJ0X29yZGVyX251bSIsImRhdGEzIiwicmVzb3VyY2VfaWQiLCJyZXNvdXJjZV90eXBlIiwiZWRpdCIsIiRzZWxlY3QiLCIkb3B0aW9uIiwiY2xhc3NJZCIsImNsYXNzTmFtZSIsInRleHQiLCIkZGVsZWdhdGUiLCJvbGRDbGFzc0lkIiwiY2xhc3NfaWQiLCJxckNvZGVVcmwiLCJjcmVhdGVRckNvZGUiLCJzZWFyY2giLCJodG1sU3RyIiwiayIsInYiLCJpbWdfdXJsX2NvbXByZXNzZWQiLCJuYW1lIiwiY3JlYXRlZF9hdCIsImh0bWwiLCJzY3JvbGxUb3AiLCJjaGVja0lucHV0VmFsdWUiLCJjdXJyZW50RG9tIiwidmFsdWUiLCJyZXBsYWNlIl0sIm1hcHBpbmdzIjoiQUFDQUEsRUFBRUMsVUFBVUMsTUFBTSxXQUNmQyxXQUFXQyxRQUdkLElBQUlELFlBQWEsV0FFYixHQUFJRSxHQUFZTCxFQUFFLHFCQUNkTSxLQUNBQyxFQUF5QixPQUN6QkMsRUFBb0IsR0FBSUMsTUFFNUIsSUFBSU4sSUFFQU8sV0FBWVYsRUFBRSx1QkFBdUJXLEtBQUssU0FFMUNQLEtBQU0sV0FLRkMsRUFBVU8sR0FBRyxRQUFTLHNCQUF1QixXQUV6QyxHQUFJQyxHQUFjYixFQUFFLHVCQUF1QlcsS0FBSyxlQUNoRCxLQUFLRSxFQUFhLENBQ2RDLFlBQVlDLG1CQUNaLE9BQU8sT0FFWCxHQUFJWixFQUFXTyxZQUFjLEdBQUksQ0FDN0JNLFVBQVVDLEtBQUtDLE9BQU8sd0JBQ3RCLE9BQU8sT0FFWEYsVUFBVUcsV0FBVyw0QkFDckJoQixHQUFXaUIsNkJBR2ZwQixHQUFFLDhCQUE4QlksR0FBRyxRQUFTLDJDQUE0QyxXQUNwRkksVUFBVUssV0FBVyw4QkFFekJyQixHQUFFLDhCQUE4QlksR0FBRyxRQUFTLDRCQUE2QixXQUNyRSxHQUFJVSxHQUFVdEIsRUFBRXVCLE1BQU1DLFNBQVMsaUNBQzNCQyxFQUFlSCxFQUFRSSxLQUFLLFVBQ2hDLEtBQUtELEVBQWMsQ0FDZixHQUFJRSxHQUFXeEIsRUFBV08sV0FBYVYsRUFBRSw2QkFBNkI0QixL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QVcsSUFBSyxRQU16QzNFLDBCQUEyQixTQUFVVSxHQUNqQ2QsVUFBVXlCLFlBQVksNEJBQ3RCekMsR0FBRTBDLEtBQUssMkJBQ0hILEtBQU0sT0FDTkksU0FBVSxPQUNWaEMsTUFDSXNGLE9BQVFuRSxHQUFpQixJQUU3QmUsUUFBUyxTQUFVQyxHQUVmLEdBQUlvRCxHQUFVLEVBQ2RsRyxHQUFFb0MsS0FBS1UsRUFBUSxTQUFVcUQsRUFBR0MsR0FDeEJGLEdBQ0ksa0RBQ0ksK0RBQ0kscUJBQXFCRSxFQUFFOUQsR0FBRyx5QkFBeUI4RCxFQUFFN0QsS0FBSyxLQUM5RCw0Q0FDSSxhQUFlNkQsRUFBRUMsbUJBQXFCLEtBQzFDLFNBQ0EsbURBQW1ERCxFQUFFRSxLQUFLLEtBQUtGLEVBQUVFLEtBQUssU0FDdEUsMkNBQTJDRixFQUFFRyxXQUFXLFNBQzVELFVBRVIsSUFBSUwsRUFBUXJFLFFBQVUsRUFBRyxDQUNyQnFFLEVBQVUsd0NBRWRsRyxFQUFFLDZCQUE2QndHLEtBQUtOLEVBQ3BDbEcsR0FBRSw2QkFBNkJ5RyxVQUFVLEVBQ3pDekYsV0FBVStCLFlBQVksOEJBRTFCSSxNQUFPLFNBQVVDLEVBQUtDLEVBQVFDLEdBQzFCQyxRQUFRQyxJQUFJRixFQUNaRyxPQUFNLHNCQUtsQmlELGdCQUFpQixTQUFVQyxHQUV2QixHQUFJQyxHQUFRNUcsRUFBRTJHLEdBQVkzRSxLQUcxQjRFLEdBQVFBLEVBQU1DLFFBQVEsU0FBVSxHQUVoQ0QsR0FBUUEsRUFBTUMsUUFBUSxXQUFZLElBRWxDN0csR0FBRTJHLEdBQVkzRSxJQUFJNEUsSUFRMUIsT0FBT3pHIiwiZmlsZSI6Imdvb2RzTGlzdC5qcyIsInNvdXJjZXNDb250ZW50IjpbIlxyXG4kKGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbiAoKSB7XHJcbiAgICRnb29kc0xpc3QuaW5pdCgpO1xyXG59KTtcclxuXHJcbnZhciAkZ29vZHNMaXN0ID0gKGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICB2YXIgJGhvbWVQYWdlID0gJChcIiNfbWFpbkNvbnRlbnRQYXJ0XCIpLFxyXG4gICAgICAgIHNldEdyYWRpZW50SW5mbyA9IHt9LFxyXG4gICAgICAgIHNldEdyYWRpZW50V2luZG93U3RhdGUgPSBcImVkaXRcIiwgICAgICAgICAvL1wiZWRpdFwiLCBcInNldFwiXHJcbiAgICAgICAgYWRkUmVzb3VyY2VQYXJhbXMgPSBuZXcgQXJyYXk7ICAgICAgICAgLy/mt7vliqDnsr7pgInllYblk4HnmoTmjqXlj6Plj4LmlbBcclxuXHJcbiAgICB2YXIgJGdvb2RzTGlzdCA9IHtcclxuXHJcbiAgICAgICAgZ29vZHNDb3VudDogJChcIiNhZGREaXN0cmlidXRlR29vZHNcIikuZGF0YShcImNvdW50XCIpLFxyXG5cclxuICAgICAgICBpbml0OiBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgICAgICAgICAvKioqKioqKioqKioqKioqKioqKioqKiog5re75Yqg5o6o5bm/5ZWG5ZOB56qX5Y+jICoqKioqKioqKioqKioqKioqKioqKioqKiovXHJcblxyXG4gICAgICAgICAgICAvL+aJk+W8gOa3u+WKoOaOqOW5v+WVhuWTgeeql+WPo1xyXG4gICAgICAgICAgICAkaG9tZVBhZ2Uub24oXCJjbGlja1wiLCBcIiNhZGREaXN0cmlidXRlR29vZHNcIiwgZnVuY3Rpb24gKCkge1xyXG5cclxuICAgICAgICAgICAgICAgIHZhciBzd2l0Y2hTdGF0ZSA9ICQoXCIuX3N3aXRjaE9wZXJhdGVBcmVhXCIpLmRhdGEoXCJzd2l0Y2hfc3RhdGVcIik7Ly/lvZPliY3nirbmgIFcclxuICAgICAgICAgICAgICAgIGlmICghc3dpdGNoU3RhdGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAkY2hvc2VuU2hvcC5zaG93T3BlbkNob3NlblRpcCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmICgkZ29vZHNMaXN0Lmdvb2RzQ291bnQgPj0gMjApIHtcclxuICAgICAgICAgICAgICAgICAgICBiYXNlVXRpbHMuc2hvdy5yZWRUaXAoXCLmt7vliqDnmoTmjqjlub/llYblk4HmlbDph4/lt7Lovr7liLAyMOS4qu+8jOS4jeiDveWGjea3u+WKoFwiKTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBiYXNlVXRpbHMuc2hvd1dpbmRvdyhcIl9hZGREaXN0cmlidXRlR29vZHNXaW5kb3dcIik7XHJcbiAgICAgICAgICAgICAgICAkZ29vZHNMaXN0LmdldERpc3RyaWJ1dGVHb29kc0NvbnRlbnQoKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIC8v5YWz6Zet5re75Yqg5o6o5bm/5ZWG5ZOB56qX5Y+jXHJcbiAgICAgICAgICAgICQoXCIjX2FkZERpc3RyaWJ1dGVHb29kc1dpbmRvd1wiKS5vbihcImNsaWNrXCIsIFwiLl9IZWFkZXJJY29uLCAjX2NhbmNlbEFkZERpc3RyaWJ1dGVHb29kc1wiLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBiYXNlVXRpbHMuaGlkZVdpbmRvdyhcIl9hZGREaXN0cmlidXRlR29vZHNXaW5kb3dcIik7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAkKFwiI19hZGREaXN0cmlidXRlR29vZHNXaW5kb3dcIikub24oXCJjbGlja1wiLCBcIi5fYWRkR29vZHNXaW5kb3dUYWJsZUl0ZW1cIiwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgdmFyICR0YXJnZXQgPSAkKHRoaXMpLmNoaWxkcmVuKFwiLl9zZWxlY3RTaW5nbGVEaXN0cmlidXRlR29vZHNcIiksXHJcbiAgICAgICAgICAgICAgICAgICAgY3VycmVudFN0YXRlID0gJHRhcmdldC5wcm9wKFwiY2hlY2tlZFwiKTtcclxuICAgICAgICAgICAgICAgIGlmICghY3VycmVudFN0YXRlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGFsbENvdW50ID0gJGdvb2RzTGlzdC5nb29kc0NvdW50ICsgJChcIiNfYWRkR29vZHNXaW5kb3dUYWJsZUJvZHlcIikuZmluZChcIi5fc2VsZWN0U2luZ2xlRGlzdHJpYnV0ZUdvb2RzOmNoZWNrZWRcIikubGVuZ3RoO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChhbGxDb3VudCA+PSAyMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBiYXNlVXRpbHMuc2hvdy5yZWRUaXAoXCLmt7vliqDnmoTmjqjlub/llYblk4HmlbDph4/lt7Lovr7liLAyMOS4qu+8jOS4jeiDveWGjea3u+WKoFwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICR0YXJnZXQucHJvcChcImNoZWNrZWRcIiwgIWN1cnJlbnRTdGF0ZSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAvL+a3u+WKoOaOqOW5v+WVhuWTgeeql+WPo+aQnOe0ouWVhuWTgVxyXG4gICAgICAgICAgICAkKFwiI19hZGREaXN0cmlidXRlR29vZHNXaW5kb3dcIikub24oXCJjbGlja1wiLCBcIiNfc2VhcmNoRGlzdHJpYnV0ZUdvb2RzXCIsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHZhciBzZWFyY2hDb250ZW50ID0gJC50cmltKCQoXCIjX3NlYXJjaERpc3RyaWJ1dGVHb29kc0lucHV0XCIpLnZhbCgpKTtcclxuICAgICAgICAgICAgICAgICRnb29kc0xpc3QuZ2V0RGlzdHJpYnV0ZUdvb2RzQ29udGVudChzZWFyY2hDb250ZW50KTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICQoXCIjX3NlYXJjaERpc3RyaWJ1dGVHb29kc0lucHV0XCIpLm9uKFwia2V5cHJlc3NcIiwgZnVuY3Rpb24gKGUpIHtcclxuICAgICAgICAgICAgICAgIGlmIChlLmtleUNvZGUgPT0gMTMpIHtcclxuICAgICAgICAgICAgICAgICAgICAkKFwiI19zZWFyY2hEaXN0cmlidXRlR29vZHNcIikuY2xpY2soKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIC8v5L+d5a2Y5o6o5bm/5ZWG5ZOB56qX5Y+j5YaF5a65XHJcbiAgICAgICAgICAgICQoXCIjX2NvbmZpcm1BZGREaXN0cmlidXRlR29vZHNcIikuY2xpY2soZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgJChcIiNfYWRkR29vZHNXaW5kb3dUYWJsZUJvZHlcIikuZmluZChcIi5fc2VsZWN0U2luZ2xlRGlzdHJpYnV0ZUdvb2RzOmNoZWNrZWRcIikuZWFjaChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIG9iaiA9IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWQ6ICQodGhpcykuZGF0YShcInJlc291cmNlX2lkXCIpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAkKHRoaXMpLmRhdGEoXCJyZXNvdXJjZV90eXBlXCIpXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGFkZFJlc291cmNlUGFyYW1zLnB1c2gob2JqKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgaWYgKCRnb29kc0xpc3QuZ29vZHNDb3VudCArIGFkZFJlc291cmNlUGFyYW1zLmxlbmd0aCA+IDIwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYmFzZVV0aWxzLnNob3cucmVkVGlwKFwi5re75Yqg55qE5o6o5bm/5ZWG5ZOB5pWw6YeP5LiN6IO96LaF6L+HMjDkuKpcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgYmFzZVV0aWxzLnNob3dMb2FkaW5nKFwiYWRkRGlzdHJpYnV0ZUdvb2RzTG9hZGluZ1wiKTtcclxuICAgICAgICAgICAgICAgICQuYWpheChcIi9jaG9zZW4vYWRkX3Jlc291cmNlX2Nob3NlblwiLCB7XHJcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJQT1NUXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YVR5cGU6IFwianNvblwiLFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGFyYW1zOiBhZGRSZXNvdXJjZVBhcmFtcyxcclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChyZXN1bHQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYmFzZVV0aWxzLmhpZGVMb2FkaW5nKFwiYWRkRGlzdHJpYnV0ZUdvb2RzTG9hZGluZ1wiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3VsdC5jb2RlID09IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhc2VVdGlscy5oaWRlV2luZG93KFwiX2FkZERpc3RyaWJ1dGVHb29kc1dpbmRvd1wiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhc2VVdGlscy5zaG93LmJsdWVUaXAoXCLkv53lrZjmiJDlip9cIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkY2hvc2VuU2hvcC5nZXROZXdQYWdlKFwiZ29vZHNcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiYXNlVXRpbHMuc2hvdy5yZWRUaXAoXCLmk43kvZzlpLHotKXvvIzor7fnqI3lkI7lho3or5VcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiBmdW5jdGlvbiAoeGhyLCBzdGF0dXMsIGVycikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBiYXNlVXRpbHMuaGlkZUxvYWRpbmcoXCJhZGREaXN0cmlidXRlR29vZHNMb2FkaW5nXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhbGVydChcIuacjeWKoeWZqOWHuuWwj+W3ruS6hu+8jOivt+eojeWQjuWGjeivle+8gVwiKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICB9KTtcclxuXHJcblxyXG4gICAgICAgICAgICAvKioqKioqKioqKioqKioqKioqKioqKiog6K6+572u5qKv5bqm56qX5Y+jICoqKioqKioqKioqKioqKioqKioqKioqKiovXHJcblxyXG4gICAgICAgICAgICAvL+aJk+W8gOiuvue9ruair+W6pueql+WPo1xyXG4gICAgICAgICAgICAkaG9tZVBhZ2Uub24oXCJjbGlja1wiLCBcIi5zZXRHcmFkaWVudFwiLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgcmVzSWQgPSAkKHRoaXMpLnBhcmVudHMoXCIudGFibGVCb2R5SXRlbVwiKS5kYXRhKFwicmVzb3VyY2VfaWRcIiksXHJcbiAgICAgICAgICAgICAgICAgICAgcmVzVHlwZSA9ICQodGhpcykucGFyZW50cyhcIi50YWJsZUJvZHlJdGVtXCIpLmRhdGEoXCJyZXNvdXJjZV90eXBlXCIpLFxyXG4gICAgICAgICAgICAgICAgICAgIHR5cGUgPSAkKHRoaXMpLmRhdGEoXCJ0eXBlXCIpO1xyXG4gICAgICAgICAgICAgICAgc2V0R3JhZGllbnRJbmZvID0ge1xyXG4gICAgICAgICAgICAgICAgICAgIHJlc0lkIDogcmVzSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgcmVzVHlwZTogcmVzVHlwZVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKHR5cGUgPT0gXCJzZXRcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICQoXCIjX3NldEdvb2RzR3JhZGllbnRXaW5kb3cgLl93aW5kb3dFZGl0YWJsZVZhbHVlXCIpLnZhbChcIlwiKTtcclxuICAgICAgICAgICAgICAgICAgICBzZXRHcmFkaWVudFdpbmRvd1N0YXRlID0gXCJzZXRcIjtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodHlwZSA9PSBcImVkaXRcIikge1xyXG4gICAgICAgICAgICAgICAgICAgIHNldEdyYWRpZW50V2luZG93U3RhdGUgPSBcImVkaXRcIjtcclxuICAgICAgICAgICAgICAgICAgICAvL+WbnuaYvuWOn+adpeeahOaVsOaNrlxyXG4gICAgICAgICAgICAgICAgICAgIHZhciBkaXN0cmlidXRlRGF0YSA9ICQodGhpcykuZGF0YShcImRpc3RyaWJ1dGVfZGF0YVwiKTtcclxuICAgICAgICAgICAgICAgICAgICAkKFwiI193aW5kb3dWYWx1ZTFcIikudmFsKGRpc3RyaWJ1dGVEYXRhLmVuZDEpO1xyXG4gICAgICAgICAgICAgICAgICAgICQoXCIjX3dpbmRvd1ZhbHVlMlwiKS52YWwoZGlzdHJpYnV0ZURhdGEuc3RhcnQyKTtcclxuICAgICAgICAgICAgICAgICAgICAkKFwiI193aW5kb3dWYWx1ZTNcIikudmFsKGRpc3RyaWJ1dGVEYXRhLmVuZDIpO1xyXG4gICAgICAgICAgICAgICAgICAgICQoXCIjX3dpbmRvd1ZhbHVlNFwiKS52YWwoZGlzdHJpYnV0ZURhdGEuc3RhcnQzKTtcclxuICAgICAgICAgICAgICAgICAgICAkKFwiI193aW5kb3dSYXRpbzFcIikudmFsKGRpc3RyaWJ1dGVEYXRhLnBlcmNlbnQxKTtcclxuICAgICAgICAgICAgICAgICAgICAkKFwiI193aW5kb3dSYXRpbzJcIikudmFsKGRpc3RyaWJ1dGVEYXRhLnBlcmNlbnQyKTtcclxuICAgICAgICAgICAgICAgICAgICAkKFwiI193aW5kb3dSYXRpbzNcIikudmFsKGRpc3RyaWJ1dGVEYXRhLnBlcmNlbnQzKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGJhc2VVdGlscy5zaG93V2luZG93KFwiX3NldEdvb2RzR3JhZGllbnRXaW5kb3dcIik7XHJcblxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIC8v5YWz6Zet6K6+572u5qKv5bqm56qX5Y+jXHJcbiAgICAgICAgICAgICQoXCIjX3NldEdvb2RzR3JhZGllbnRXaW5kb3dcIikub24oXCJjbGlja1wiLCBcIi5fSGVhZGVySWNvbiwgI193aW5kb3dDYW5jZWxCdG5cIiwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgYmFzZVV0aWxzLmhpZGVXaW5kb3coXCJfc2V0R29vZHNHcmFkaWVudFdpbmRvd1wiKTtcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAvL+WFs+iBlOiuvue9ruair+W6pueql+WPo2lucHV05YC8XHJcbiAgICAgICAgICAgICQoXCIjX3NldEdvb2RzR3JhZGllbnRXaW5kb3dcIikub24oXCJrZXl1cFwiLCBcIi5fd2luZG93RWRpdGFibGVWYWx1ZVwiLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgaWQgPSAkKHRoaXMpLmF0dHIoXCJpZFwiKTtcclxuICAgICAgICAgICAgICAgIGlmIChpZCA9PSBcIl93aW5kb3dWYWx1ZTFcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICQoXCIjX3dpbmRvd1ZhbHVlMlwiKS52YWwoKyQudHJpbSgkKFwiI193aW5kb3dWYWx1ZTFcIikudmFsKCkpKzEpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChpZCA9PSBcIl93aW5kb3dWYWx1ZTNcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICQoXCIjX3dpbmRvd1ZhbHVlNFwiKS52YWwoKyQudHJpbSgkKFwiI193aW5kb3dWYWx1ZTNcIikudmFsKCkpKzEpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIC8v5L+d5a2Y6K6+572u5qKv5bqmXHJcbiAgICAgICAgICAgICQoXCIjX3NldEdvb2RzR3JhZGllbnRXaW5kb3dcIikub24oXCJjbGlja1wiLCBcIiNfd2luZG93Q29uZmlybUJ0blwiLCBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgdmFyIHZhbHVlMSA9IHBhcnNlSW50KCQoXCIjX3dpbmRvd1ZhbHVlMVwiKS52YWwoKSksXHJcbiAgICAgICAgICAgICAgICAgICAgdmFsdWUyID0gcGFyc2VJbnQoJChcIiNfd2luZG93VmFsdWUyXCIpLnZhbCgpKSxcclxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTMgPSBwYXJzZUludCgkKFwiI193aW5kb3dWYWx1ZTNcIikudmFsKCkpLFxyXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlNCA9IHBhcnNlSW50KCQoXCIjX3dpbmRvd1ZhbHVlNFwiKS52YWwoKSksXHJcbiAgICAgICAgICAgICAgICAgICAgcmF0aW8xID0gcGFyc2VJbnQoJChcIiNfd2luZG93UmF0aW8xXCIpLnZhbCgpKSxcclxuICAgICAgICAgICAgICAgICAgICByYXRpbzIgPSBwYXJzZUludCgkKFwiI193aW5kb3dSYXRpbzJcIikudmFsKCkpLFxyXG4gICAgICAgICAgICAgICAgICAgIHJhdGlvMyA9IHBhcnNlSW50KCQoXCIjX3dpbmRvd1JhdGlvM1wiKS52YWwoKSk7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKCF2YWx1ZTEgfHwgIXZhbHVlMiB8fCAhdmFsdWUzIHx8ICF2YWx1ZTQgfHwgIXJhdGlvMSB8fCAhcmF0aW8yIHx8ICFyYXRpbzMpIHtcclxuICAgICAgICAgICAgICAgICAgICBiYXNlVXRpbHMuc2hvdy5yZWRUaXAoXCLmlbDmja7msqHmnInloavlhpnlrozmlbTlk6ZcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYoKCggdmFsdWUxICsgMSkgIT0gdmFsdWUyKSB8fCAoKCB2YWx1ZTMgKyAxKSAhPSB2YWx1ZTQpIHx8ICh2YWx1ZTIgPj0gdmFsdWUzKSB8fCAodmFsdWUxIDw9IDEpKXtcclxuICAgICAgICAgICAgICAgICAgICBiYXNlVXRpbHMuc2hvdy5yZWRUaXAoJ+WMuumXtOWhq+WGmeacieivr++8jOivt+ajgOafpeWQjumHjeivlScpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmKChyYXRpbzEgPD0gMCkgfHwgKHJhdGlvMSA+IHJhdGlvMikgfHwgKHJhdGlvMiA+IHJhdGlvMykpe1xyXG4gICAgICAgICAgICAgICAgICAgIGJhc2VVdGlscy5zaG93LnJlZFRpcCgn5YiG5oiQ5q+U5L6L5aGr5YaZ5pyJ6K+v77yM6K+35Y+C6ICD56S65L6LJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKHJhdGlvMT45OSB8fCByYXRpbzIgPiA5OSB8fCByYXRpbzMgPiA5OSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGJhc2VVdGlscy5zaG93LnJlZFRpcChcIuWIhuaIkOavlOS+i+S4jeiDvei2hei/hzk5JVwiKTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB2YXIgcGFyYW1zID0ge1xyXG4gICAgICAgICAgICAgICAgICAgIGRhdGExOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGVuZF9vcmRlcl9udW06IHZhbHVlMSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGlzdHJpYnV0ZV9wZXJjZW50OiByYXRpbzEsXHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICBkYXRhMjoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzdGFydF9vcmRlcl9udW06IHZhbHVlMixcclxuICAgICAgICAgICAgICAgICAgICAgICAgZW5kX29yZGVyX251bTogdmFsdWUzLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkaXN0cmlidXRlX3BlcmNlbnQ6IHJhdGlvMixcclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGEzOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXJ0X29yZGVyX251bTogdmFsdWU0LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkaXN0cmlidXRlX3BlcmNlbnQ6IHJhdGlvMyxcclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIHJlc291cmNlX2lkOiBzZXRHcmFkaWVudEluZm8ucmVzSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgcmVzb3VyY2VfdHlwZTogc2V0R3JhZGllbnRJbmZvLnJlc1R5cGUsXHJcbiAgICAgICAgICAgICAgICAgICAgZWRpdDogc2V0R3JhZGllbnRXaW5kb3dTdGF0ZSA9PSBcImVkaXRcIiA/IFwiZWRpdFwiIDogXCJzZXRcIixcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAkLmFqYXgoXCIvY2hvc2VuL3NldF94aWFvZV9kaXN0cmlidXRlXCIsIHtcclxuICAgICAgICAgICAgICAgICAgICB0eXBlOiBcIlBPU1RcIixcclxuICAgICAgICAgICAgICAgICAgICBkYXRhVHlwZTogXCJqc29uXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YTogcGFyYW1zLFxyXG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChyZXN1bHQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3VsdC5jb2RlID09IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhc2VVdGlscy5zaG93LmJsdWVUaXAoXCLmoq/luqborr7nva7miJDlip9cIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiYXNlVXRpbHMuaGlkZVdpbmRvdyhcIl9zZXRHb29kc0dyYWRpZW50V2luZG93XCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJGNob3NlblNob3AuZ2V0TmV3UGFnZShcImdvb2RzXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYmFzZVV0aWxzLnNob3cucmVkVGlwKFwi5qKv5bqm6K6+572u5aSx6LSl77yM6K+356iN5ZCO5YaN6K+VXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogZnVuY3Rpb24gKHhociwgc3RhdHVzLCBlcnIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYmFzZVV0aWxzLnNob3cucmVkVGlwKFwi5pyN5Yqh5Zmo5Ye65bCP5beu5LqG77yM6K+356iN5ZCO5YaN6K+V77yBXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgLyoqKioqKioqKioqKioqKioqKioqKioqIOiuvue9ruWIhuexuyAqKioqKioqKioqKioqKioqKioqKioqKioqL1xyXG5cclxuICAgICAgICAgICAgJGhvbWVQYWdlLm9uKFwiY2hhbmdlXCIsIFwiLnNlbGVjdENob3Nlbkdvb2RzQ2xhc3NcIiwgZnVuY3Rpb24gKCkge1xyXG5cclxuICAgICAgICAgICAgICAgIHZhciAkc2VsZWN0ID0gJCh0aGlzKSxcclxuICAgICAgICAgICAgICAgICAgICAkb3B0aW9uID0gJHNlbGVjdC5jaGlsZHJlbihcIm9wdGlvbjpzZWxlY3RlZFwiKSxcclxuICAgICAgICAgICAgICAgICAgICBjbGFzc0lkID0gJG9wdGlvbi52YWwoKSxcclxuICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWUgPSAkb3B0aW9uLnRleHQoKTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoY2xhc3NJZCA9PSAtMSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGNsYXNzSWQgKyBcIiAtIFwiICsgY2xhc3NOYW1lKTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB2YXIgJGRlbGVnYXRlID0gJHNlbGVjdC5wYXJlbnRzKFwiLnRhYmxlQm9keUl0ZW1cIiksXHJcbiAgICAgICAgICAgICAgICAgICAgcmVzSWQgPSAkZGVsZWdhdGUuZGF0YShcInJlc291cmNlX2lkXCIpLFxyXG4gICAgICAgICAgICAgICAgICAgIHJlc1R5cGUgPSAkZGVsZWdhdGUuZGF0YShcInJlc291cmNlX3R5cGVcIiksXHJcbiAgICAgICAgICAgICAgICAgICAgb2xkQ2xhc3NJZCA9ICRkZWxlZ2F0ZS5kYXRhKFwib2xkX2NsYXNzX2lkXCIpIHx8IC0xO1xyXG5cclxuICAgICAgICAgICAgICAgICQuYWpheChcIi9jaG9zZW4vc2V0X2NsYXNzaWZ5XCIsIHtcclxuICAgICAgICAgICAgICAgICAgICB0eXBlOiBcIlBPU1RcIixcclxuICAgICAgICAgICAgICAgICAgICBkYXRhVHlwZTogXCJqc29uXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjbGFzc19pZDogY2xhc3NJZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb3VyY2VfaWQ6IHJlc0lkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvdXJjZV90eXBlOiByZXNUeXBlLFxyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24gKHJlc3VsdCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzdWx0LmNvZGUgPT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYmFzZVV0aWxzLnNob3cuYmx1ZVRpcChcIuiuvue9ruWIhuexu+aIkOWKn+OAglwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhc2VVdGlscy5zaG93LnJlZFRpcChcIuiuvue9ruWIhuexu+Wksei0peOAglwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzZWxlY3QudmFsKG9sZENsYXNzSWQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogZnVuY3Rpb24gKHhociwgc3RhdHVzLCBlcnIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYWxlcnQoXCLmnI3liqHlmajlh7rlsI/lt67kuobvvIzor7fnqI3lkI7lho3or5XvvIFcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAvKioqKioqKioqKioqKioqKioqKioqKiog55Sf5oiQ6aKE6KeI5LqM57u056CBICoqKioqKioqKioqKioqKioqKioqKioqKiovXHJcblxyXG4gICAgICAgICAgICAkaG9tZVBhZ2UuZmluZChcIi5xckNvZGVJbWFnZVwiKS5lYWNoKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHZhciBxckNvZGVVcmwgPSAkKHRoaXMpLmRhdGEoXCJ1cmxcIiksXHJcbiAgICAgICAgICAgICAgICAgICAgaWQgPSAkKHRoaXMpLmF0dHIoXCJpZFwiKTtcclxuXHJcbiAgICAgICAgICAgICAgICBjcmVhdGVRckNvZGUoaWQsIHFyQ29kZVVybCwgMTYwLCAxNjApO1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcblxyXG5cclxuICAgICAgICB9LFxyXG4gICAgICAgIGdldERpc3RyaWJ1dGVHb29kc0NvbnRlbnQ6IGZ1bmN0aW9uIChzZWFyY2hDb250ZW50KSB7XHJcbiAgICAgICAgICAgIGJhc2VVdGlscy5zaG93TG9hZGluZyhcImFkZERpc3RyaWJ1dGVHb29kc0xvYWRpbmdcIik7XHJcbiAgICAgICAgICAgICQuYWpheChcIi9jaG9zZW4vc2VhcmNoX3Jlc291cmNlXCIsIHtcclxuICAgICAgICAgICAgICAgIHR5cGU6IFwiUE9TVFwiLFxyXG4gICAgICAgICAgICAgICAgZGF0YVR5cGU6IFwianNvblwiLFxyXG4gICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgIHNlYXJjaDogc2VhcmNoQ29udGVudCB8fCBcIlwiLFxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChyZXN1bHQpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGh0bWxTdHIgPSBcIlwiO1xyXG4gICAgICAgICAgICAgICAgICAgICQuZWFjaChyZXN1bHQsIGZ1bmN0aW9uIChrLCB2KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxTdHIgKz1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwiX2FkZEdvb2RzV2luZG93VGFibGVJdGVtIGNsZWFyZml4XCI+JyArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJzxpbnB1dCB0eXBlPVwiY2hlY2tib3hcIiBjbGFzcz1cIl9zZWxlY3RTaW5nbGVEaXN0cmlidXRlR29vZHNcIiAnICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2RhdGEtcmVzb3VyY2VfaWQ9XCInK3YuaWQrJ1wiIGRhdGEtcmVzb3VyY2VfdHlwZT1cIicrdi50eXBlKydcIj4nICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnPGRpdiBjbGFzcz1cIl9zaW5nbGVEaXN0cmlidXRlR29vZHNDb3ZlclwiPicgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnPGltZyBzcmM9XCInICsgdi5pbWdfdXJsX2NvbXByZXNzZWQgKyAnXCI+JyArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJzwvZGl2PicgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwiX3NpbmdsZURpc3RyaWJ1dGVHb29kc1RpdGxlXCIgdGl0bGU9XCInK3YubmFtZSsnXCI+Jyt2Lm5hbWUrJzwvZGl2PicgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwiX3NpbmdsZURpc3RyaWJ1dGVHb29kc1RpbWVcIj4nK3YuY3JlYXRlZF9hdCsnPC9kaXY+JyArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnPC9kaXY+JztcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoaHRtbFN0ci5sZW5ndGggPT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBodG1sU3RyID0gXCI8ZGl2IGNsYXNzPSdjb250ZW50Tm9EYXRhJz7mmoLml6DmlbDmja48L2Rpdj5cIjtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgJChcIiNfYWRkR29vZHNXaW5kb3dUYWJsZUJvZHlcIikuaHRtbChodG1sU3RyKTtcclxuICAgICAgICAgICAgICAgICAgICAkKFwiI19hZGRHb29kc1dpbmRvd1RhYmxlQm9keVwiKS5zY3JvbGxUb3AoMCk7XHJcbiAgICAgICAgICAgICAgICAgICAgYmFzZVV0aWxzLmhpZGVMb2FkaW5nKFwiYWRkRGlzdHJpYnV0ZUdvb2RzTG9hZGluZ1wiKTtcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICBlcnJvcjogZnVuY3Rpb24gKHhociwgc3RhdHVzLCBlcnIpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xyXG4gICAgICAgICAgICAgICAgICAgIGFsZXJ0KFwi5pyN5Yqh5Zmo5Ye65bCP5beu5LqG77yM6K+356iN5ZCO5YaN6K+V77yBXCIpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgfSxcclxuICAgICAgICBjaGVja0lucHV0VmFsdWU6IGZ1bmN0aW9uIChjdXJyZW50RG9tKSB7XHJcblxyXG4gICAgICAgICAgICB2YXIgdmFsdWUgPSAkKGN1cnJlbnREb20pLnZhbCgpO1xyXG5cclxuICAgICAgICAgICAgLy/muIXpmaRcIuaVsOWtl1wi5ZKMXCIuXCLku6XlpJbnmoTlrZfnrKZcclxuICAgICAgICAgICAgdmFsdWUgPSB2YWx1ZS5yZXBsYWNlKC9bXlxcZF0vZywgXCJcIik7XHJcbiAgICAgICAgICAgIC8v5riF6ZmkMOWQjumdoueahOaVsOWtl1xyXG4gICAgICAgICAgICB2YWx1ZSA9IHZhbHVlLnJlcGxhY2UoL14wW1xcZF0rL2csIFwiMFwiKTtcclxuXHJcbiAgICAgICAgICAgICQoY3VycmVudERvbSkudmFsKHZhbHVlKTtcclxuXHJcbiAgICAgICAgfSxcclxuXHJcblxyXG5cclxuICAgIH07XHJcblxyXG4gICAgcmV0dXJuICRnb29kc0xpc3Q7XHJcblxyXG59KSgpOyJdfQ==
