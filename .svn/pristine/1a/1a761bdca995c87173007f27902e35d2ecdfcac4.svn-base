$(document).ready(function(){Business.init()});var Business=function(){var e={};var i=false;e.submitLimit=false;e.communityId=-1;e.type=-1;e.dynamicId=-1;e.init=function(){changeSaveFlag(true);e.type=$("#admin_data").data("type");e.communityId=$("#admin_data").data("community_id");if(e.type==1){e.dynamicId=GetQueryString("id")}$("#uploadFile").click(function(){$("#selectPdfFile").click()});$("#preview").on("click",function(){var e=ue.getContent();document.getElementById("preview_content").innerHTML=e;$(".preview_con").addClass("active");$(".preview_box").addClass("active");document.documentElement.style.overflow="hidden"});$(".preview_con").on("click",function(){$(this).removeClass("active");$("#preview_content").html("");$(".preview_box").removeClass("active");document.documentElement.style.overflow="auto"});$("#deleteUploadedPdfFile").click(function(){$("#uploadedFileUrl").data("file_url","");$("#selectPdfFile").val("");$(".uploadBoxPdf").fadeOut(100)});$(".uploadFileBtnWrapper").on("change","#selectPdfFile",function(){if(!i){o(this.files,"pdf","Pdf",20)}else{baseUtils.show.redTip("文件正在上传中，请稍后再试")}});$("#releaseDynamic").click(function(){var a=$(".selectContent input:checked").attr("value");if(e.submitLimit==true){baseUtils.show.redTip("正在提交中，请稍后再试");return false}if(i){baseUtils.show.redTip("文件正在上传中，请稍后再提交");return false}var n={};var o=$("#dynamicTitle").val();if(o==""||o==undefined){baseUtils.show.redTip("请输入动态标题");return false}n["title"]=o;var s=UE.getEditor("container");var d=s.getContent();var c=s.getPlainTxt();if(d==""||d==undefined){baseUtils.show.redTip("请输入动态内容");return false}n["org_content"]=d;n["content"]=c;n["community_id"]=e.communityId;var u=$(".selectItem input:checked").val();var r=$("#uploadedFileUrl").data("file_url");var f=$("#uploadedFileUrl").data("file_name");var m=$("#uploadedFileUrl").data("file_size");if(r!=""&&r!=undefined){n["file_url"]=r;n["file_name"]=f;n["file_size"]=m}else{n["file_url"]="";n["file_name"]="";n["file_size"]=""}var p="";if(e.type==1){n["id"]=e.dynamicId;p="/smallCommunity/updateDynamic"}else{p="/smallCommunity/uploadDynamic"}e.submitLimit=true;console.log(a);if(a==1){l(e.communityId,p,n,u)}else{t(p,n,u,a)}})};function t(i,t,l){$.ajax(i,{type:"POST",dataType:"json",data:{params:t,push_state:l},success:function(i){if(i.code==0){if(e.type==1){baseUtils.show.blueTip("保存编辑成功")}else{baseUtils.show.blueTip("发布动态成功")}setTimeout(function(){window.location.href="/smallCommunity/dynamicList?community_id="+e.communityId},700)}else{baseUtils.show.redTip("发布出现问题，请稍后再试");e.submitLimit=false}},error:function(i,t,l){e.submitLimit=false;console.log(l);baseUtils.show.redTip("网络错误，请稍后再试！")}})}function l(i,l,a,n){console.log(i);$.ajax("/smallCommunity/checkFeedsMessagePush/"+i,{type:"POST",dataType:"JSON",async:false,success:function(i){console.log(i);if(i.code==0){baseUtils.show.blueTip(i.msg);t(l,a,n)}else if(i.code==-1){baseUtils.show.redTip(i.msg);e.submitLimit=false;return false}else{baseUtils.show.redTip(i.msg);e.submitLimit=false;return false}},error:function(i,t,l){e.submitLimit=false;console.log(l);baseUtils.show.redTip("网络错误，请稍后再试！")}})}function a(e){var i=null;if(window.createObjectURL!=undefined){i=window.createObjectURL(e)}else if(window.URL!=undefined){i=window.URL.createObjectURL(e)}else if(window.webkitURL!=undefined){i=window.webkitURL.createObjectURL(e)}return i}function n(e){if(window.revokeObjectURL!=undefined){window.revokeObjectURL(e)}else if(window.URL!=undefined){window.URL.revokeObjectURL(e)}else if(window.webkitURL!=undefined){window.webkitURL.revokeObjectURL(e)}}function o(e,t,l,a){if(e&&e.length>0){var n=e[0];var o=n.name;if(!o.toLowerCase().endsWith("pdf")){baseUtils.show.redTip("请选择 pdf 格式的文件");$("#selectPdfFile").remove();$("#uploadedFileUrl").before('<input class="selectPdfFileInput" id="selectPdfFile" type="file" accept="application/pdf"/>');return false}if($uploadFile.checkFileSize(n,a)){var d=(n.size/(1024*1024)).toFixed(2);$("#uploadedFileUrl").data("file_size",d);$("#audioURL"+l).hide();$(".uploadBox"+l).fadeIn(300);s(o,d);$("#uploadedFileUrl").data("file_name",o);i=true;$uploadFile.uploadRes(n,t,function(e){var i=parseInt(e*100);$(".uploadPLineActive"+l).css("width",i+"%");$(".uploadPercent"+l).text(i+"%")},function(e){i=false;console.log(e);baseUtils.show.blueTip("上传成功！");$(".uploadPLine"+l).hide();$(".upload"+l+"Name").show();$(".uploadPercent"+l).text("删除");var t=e.data.access_url;$("#uploadedFileUrl").data("file_url",t)},function(e){i=false;console.error("上传失败!!!");console.log(e);baseUtils.show.redTip("上传失败！")})}else{baseUtils.show.redTip("上传失败，请勿上传超过 "+a+"Mb 的PDF文件");$(".upLoad"+l).val("")}}else{console.log("网络错误，请稍后再试！")}}function s(e,i){$(".uploadPdfName").html(e).hide();$(".uploadPdfSize span").html(i);$(".uploadPLinePdf").show().find(".uploadPLineActivePdf").css("width","0");$(".uploadPercentPdf").html("")}return e}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1hbmFnZUR5bmFtaWMuanMiXSwibmFtZXMiOlsiJCIsImRvY3VtZW50IiwicmVhZHkiLCJCdXNpbmVzcyIsImluaXQiLCJpc1BkZkZpbGVVcGxvYWRpbmciLCJzdWJtaXRMaW1pdCIsImNvbW11bml0eUlkIiwidHlwZSIsImR5bmFtaWNJZCIsImNoYW5nZVNhdmVGbGFnIiwiZGF0YSIsIkdldFF1ZXJ5U3RyaW5nIiwiY2xpY2siLCJvbiIsImh0bWwiLCJ1ZSIsImdldENvbnRlbnQiLCJnZXRFbGVtZW50QnlJZCIsImlubmVySFRNTCIsImFkZENsYXNzIiwiZG9jdW1lbnRFbGVtZW50Iiwic3R5bGUiLCJvdmVyZmxvdyIsInRoaXMiLCJyZW1vdmVDbGFzcyIsInZhbCIsImZhZGVPdXQiLCJyZXNVcGxvYWQiLCJmaWxlcyIsImJhc2VVdGlscyIsInNob3ciLCJyZWRUaXAiLCJrZXkiLCJhdHRyIiwicGFyYW1zIiwiZHluYW1pY1RpdGxlIiwidW5kZWZpbmVkIiwiVUUiLCJnZXRFZGl0b3IiLCJvcmdfY29udGVudCIsImRlc2NyYiIsImdldFBsYWluVHh0IiwicHVzaF9zdGF0ZSIsInBkZkZpbGVVcmwiLCJwZGZGaWxlTmFtZSIsInBkZkZpbGVTaXplIiwicG9zdFVybCIsImNvbnNvbGUiLCJsb2ciLCJzZXRTZXJ2aWNlIiwicHVibGlzaCIsImFqYXgiLCJkYXRhVHlwZSIsInN1Y2Nlc3MiLCJyZXN1bHQiLCJjb2RlIiwiYmx1ZVRpcCIsInNldFRpbWVvdXQiLCJ3aW5kb3ciLCJsb2NhdGlvbiIsImhyZWYiLCJlcnJvciIsInhociIsInN0YXR1cyIsImVyciIsImNfaWQiLCJhc3luYyIsIm1zZyIsImdldE9iamVjdFVSTCIsImZpbGUiLCJ1cmwiLCJjcmVhdGVPYmplY3RVUkwiLCJVUkwiLCJ3ZWJraXRVUkwiLCJyZW1vdmVPYmplY3RVUkwiLCJyZXZva2VPYmplY3RVUkwiLCJyZXNUeXBlIiwicmVzVHlwZUNsYXNzIiwicmVzTGltaXRTaXplIiwibGVuZ3RoIiwibmFtZSIsInRvTG93ZXJDYXNlIiwiZW5kc1dpdGgiLCJyZW1vdmUiLCJiZWZvcmUiLCIkdXBsb2FkRmlsZSIsImNoZWNrRmlsZVNpemUiLCJmaWxlU2l6ZSIsInNpemUiLCJ0b0ZpeGVkIiwiaGlkZSIsImZhZGVJbiIsImluaXRGaWxlQW5kUHJvZ3Jlc3NCYXIiLCJ1cGxvYWRSZXMiLCJwcm9ncmVzcyIsInBhcnNlSW50IiwiY3NzIiwidGV4dCIsInJlc1VybCIsImFjY2Vzc191cmwiLCJmaWxlTmFtZSIsImZpbmQiXSwibWFwcGluZ3MiOiJBQUlBQSxFQUFFQyxVQUFVQyxNQUFNLFdBRWRDLFNBQVNDLFFBR2IsSUFBSUQsVUFBVyxXQUVYLEdBQUlBLEtBRUosSUFBSUUsR0FBcUIsS0FFekJGLEdBQVNHLFlBQWMsS0FDdkJILEdBQVNJLGFBQWUsQ0FDeEJKLEdBQVNLLE1BQVEsQ0FDakJMLEdBQVNNLFdBQWEsQ0FFdEJOLEdBQVNDLEtBQU8sV0FHWk0sZUFBZSxLQUVmUCxHQUFTSyxLQUFPUixFQUFFLGVBQWVXLEtBQUssT0FDdENSLEdBQVNJLFlBQWNQLEVBQUUsZUFBZVcsS0FBSyxlQUM3QyxJQUFJUixFQUFTSyxNQUFRLEVBQUcsQ0FDcEJMLEVBQVNNLFVBQVlHLGVBQWUsTUFJeENaLEVBQUUsZUFBZWEsTUFBTSxXQUNuQmIsRUFBRSxrQkFBa0JhLFNBR3hCYixHQUFFLFlBQVljLEdBQUcsUUFBUSxXQUNyQixHQUFJQyxHQUFPQyxHQUFHQyxZQUNkaEIsVUFBU2lCLGVBQWUsbUJBQW1CQyxVQUFZSixDQUN2RGYsR0FBRSxnQkFBZ0JvQixTQUFTLFNBQzNCcEIsR0FBRSxnQkFBZ0JvQixTQUFTLFNBQzNCbkIsVUFBU29CLGdCQUFnQkMsTUFBTUMsU0FBVyxVQUU5Q3ZCLEdBQUUsZ0JBQWdCYyxHQUFHLFFBQVEsV0FDekJkLEVBQUV3QixNQUFNQyxZQUFZLFNBQ3BCekIsR0FBRSxvQkFBb0JlLEtBQUssR0FDM0JmLEdBQUUsZ0JBQWdCeUIsWUFBWSxTQUM5QnhCLFVBQVNvQixnQkFBZ0JDLE1B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SXRDLEVBQ1ptQixXQUFVQyxLQUFLQyxPQUFPLGVBRTNCLENBQ0hGLFVBQVVDLEtBQUtDLE9BQU8sZUFBaUIrQyxFQUFlLFlBQ3REL0UsR0FBRSxVQUFVOEUsR0FBY3BELElBQUksU0FFL0IsQ0FDSHNCLFFBQVFDLElBQUksZ0JBS3BCLFFBQVM0QyxHQUF1QlEsRUFBVWIsR0FFdEN4RixFQUFFLGtCQUFrQmUsS0FBS3NGLEdBQVVWLE1BQ25DM0YsR0FBRSx1QkFBdUJlLEtBQUt5RSxFQUM5QnhGLEdBQUUsbUJBQW1CK0IsT0FDaEJ1RSxLQUFLLHlCQUF5QkwsSUFBSSxRQUFTLElBQ2hEakcsR0FBRSxxQkFBcUJlLEtBQUssSUFJaEMsTUFBT1oiLCJmaWxlIjoibWFuYWdlRHluYW1pYy5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBDcmVhdGVkIGJ5IEFkbWluaXN0cmF0b3Igb24gMjAxNy81LzIuXHJcbiAqL1xyXG5cclxuJChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24gKCkge1xyXG5cclxuICAgIEJ1c2luZXNzLmluaXQoKTtcclxufSlcclxuXHJcbnZhciBCdXNpbmVzcyA9IChmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgdmFyIEJ1c2luZXNzID0ge307XHJcblxyXG4gICAgdmFyIGlzUGRmRmlsZVVwbG9hZGluZyA9IGZhbHNlO1xyXG5cclxuICAgIEJ1c2luZXNzLnN1Ym1pdExpbWl0ID0gZmFsc2U7ICAgLy/mj5DkuqTpmZDliLZcclxuICAgIEJ1c2luZXNzLmNvbW11bml0eUlkID0gLTE7XHJcbiAgICBCdXNpbmVzcy50eXBlID0gLTE7ICAgICAgICAgICAgIC8vICAxIC0g57yW6L6RIO+8myAwIC0g5paw5bu6XHJcbiAgICBCdXNpbmVzcy5keW5hbWljSWQgPSAtMTtcclxuXHJcbiAgICBCdXNpbmVzcy5pbml0ID0gZnVuY3Rpb24gKCkge1xyXG5cclxuICAgICAgICAvL+eCueWHu+S+p+i+ueagj+emu+W8gOaXtueahOW8ueahhlxyXG4gICAgICAgIGNoYW5nZVNhdmVGbGFnKHRydWUpO1xyXG5cclxuICAgICAgICBCdXNpbmVzcy50eXBlID0gJChcIiNhZG1pbl9kYXRhXCIpLmRhdGEoXCJ0eXBlXCIpO1xyXG4gICAgICAgIEJ1c2luZXNzLmNvbW11bml0eUlkID0gJChcIiNhZG1pbl9kYXRhXCIpLmRhdGEoXCJjb21tdW5pdHlfaWRcIik7XHJcbiAgICAgICAgaWYgKEJ1c2luZXNzLnR5cGUgPT0gMSkge1xyXG4gICAgICAgICAgICBCdXNpbmVzcy5keW5hbWljSWQgPSBHZXRRdWVyeVN0cmluZyhcImlkXCIpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy/pgInmi6npnIDopoHkuIrkvKDnmoTmlofku7ZcclxuICAgICAgICAkKFwiI3VwbG9hZEZpbGVcIikuY2xpY2soZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAkKFwiI3NlbGVjdFBkZkZpbGVcIikuY2xpY2soKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICAvL+e8lui+keWZqOmihOiniFxyXG4gICAgICAgICQoJyNwcmV2aWV3Jykub24oJ2NsaWNrJyxmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICB2YXIgaHRtbCA9IHVlLmdldENvbnRlbnQoKTtcclxuICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3ByZXZpZXdfY29udGVudCcpLmlubmVySFRNTCA9IGh0bWw7XHJcbiAgICAgICAgICAgICQoJy5wcmV2aWV3X2NvbicpLmFkZENsYXNzKCdhY3RpdmUnKTtcclxuICAgICAgICAgICAgJCgnLnByZXZpZXdfYm94JykuYWRkQ2xhc3MoJ2FjdGl2ZScpO1xyXG4gICAgICAgICAgICBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc3R5bGUub3ZlcmZsb3cgPSBcImhpZGRlblwiO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgICQoJy5wcmV2aWV3X2NvbicpLm9uKCdjbGljaycsZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgJCh0aGlzKS5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XHJcbiAgICAgICAgICAgICQoJyNwcmV2aWV3X2NvbnRlbnQnKS5odG1sKCcnKTtcclxuICAgICAgICAgICAgJCgnLnByZXZpZXdfYm94JykucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xyXG4gICAgICAgICAgICBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc3R5bGUub3ZlcmZsb3cgPSBcImF1dG9cIjtcclxuICAgICAgICB9KTtcclxuICAgICAgICAvL+WIoOmZpOW3sue7j+S4iuS8oOeahHBkZuaWh+S7tlxyXG4gICAgICAgICQoXCIjZGVsZXRlVXBsb2FkZWRQZGZGaWxlXCIpLmNsaWNrKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgJChcIiN1cGxvYWRlZEZpbGVVcmxcIikuZGF0YShcImZpbGVfdXJsXCIsIFwiXCIpO1xyXG4gICAgICAgICAgICAkKFwiI3NlbGVjdFBkZkZpbGVcIikudmFsKFwiXCIpO1xyXG4gICAgICAgICAgICAkKFwiLnVwbG9hZEJveFBkZlwiKS5mYWRlT3V0KDEwMCk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIC8v5aSE55CG6YCJ5oup5paH5Lu25ZCO55qE5LiK5LygXHJcbiAgICAgICAgJChcIi51cGxvYWRGaWxlQnRuV3JhcHBlclwiKS5vbihcImNoYW5nZVwiLCBcIiNzZWxlY3RQZGZGaWxlXCIsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgaWYgKCFpc1BkZkZpbGVVcGxvYWRpbmcpIHtcclxuICAgICAgICAgICAgICAgIHJlc1VwbG9hZCh0aGlzLmZpbGVzLCBcInBkZlwiLCBcIlBkZlwiLCAyMCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBiYXNlVXRpbHMuc2hvdy5yZWRUaXAoXCLmlofku7bmraPlnKjkuIrkvKDkuK3vvIzor7fnqI3lkI7lho3or5VcIik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgLy/lj5HluIPliqjmgIFcclxuICAgICAgICAkKFwiI3JlbGVhc2VEeW5hbWljXCIpLmNsaWNrKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIGtleT0kKCcuc2VsZWN0Q29udGVudCBpbnB1dDpjaGVja2VkJykuYXR0cigndmFsdWUnKTsvL+WPkeW4g+WKqOaAgeaMiemSrumAieS4reeKtuaAge+8m1xyXG4gICAgICAgICAgICAvLyAg6Ziy5q2i6YeN5aSN5o+Q5LqkXHJcbiAgICAgICAgICAgIGlmIChCdXNpbmVzcy5zdWJtaXRMaW1pdCA9PSB0cnVlKSB7XHJcbiAgICAgICAgICAgICAgICBiYXNlVXRpbHMuc2hvdy5yZWRUaXAoXCLmraPlnKjmj5DkuqTkuK3vvIzor7fnqI3lkI7lho3or5VcIik7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIC8vICDmlofku7bmraPlnKjkuIrkvKDkuK1cclxuICAgICAgICAgICAgaWYgKGlzUGRmRmlsZVVwbG9hZGluZykge1xyXG4gICAgICAgICAgICAgICAgYmFzZVV0aWxzLnNob3cucmVkVGlwKFwi5paH5Lu25q2j5Zyo5LiK5Lyg5Lit77yM6K+356iN5ZCO5YaN5o+Q5LqkXCIpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvKipcclxuICAgICAgICAgICAgICog6ZyA6KaB55qE5Y+C5pWwIO+8miBjb21tdW5pdHlfaWQgLSB0aXRsZSAtIG9yZ19jb250ZW50IC0gY29udGVudCAtIGZpbGVfdXJsIC0gZmlsZV9uYW1lIC0gZmlsZV9zaXplXHJcbiAgICAgICAgICAgICAqL1xyXG4gICAgICAgICAgICB2YXIgcGFyYW1zID0ge307XHJcblxyXG4gICAgICAgICAgICB2YXIgZHluYW1pY1RpdGxlID0gJChcIiNkeW5hbWljVGl0bGVcIikudmFsKCk7XHJcbiAgICAgICAgICAgIGlmIChkeW5hbWljVGl0bGUgPT0gJycgfHwgZHluYW1pY1RpdGxlID09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgYmFzZVV0aWxzLnNob3cucmVkVGlwKFwi6K+36L6T5YWl5Yqo5oCB5qCH6aKYXCIpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHBhcmFtc1sndGl0bGUnXSA9IGR5bmFtaWNUaXRsZTtcclxuXHJcbiAgICAgICAgICAgIC8vICDojrflj5bliqjmgIEgaHRtbOWGheWuue+8jOi/lOWbnjogPHA+aGVsbG88L3A+XHJcbiAgICAgICAgICAgIHZhciB1ZSA9IFVFLmdldEVkaXRvcignY29udGFpbmVyJyk7XHJcbiAgICAgICAgICAgIHZhciBvcmdfY29udGVudCA9IHVlLmdldENvbnRlbnQoKTsgICAgLy8gIOWOn+Wni2h0bWzlhoXlrrlcclxuICAgICAgICAgICAgdmFyIGRlc2NyYiA9IHVlLmdldFBsYWluVHh0KCk7ICAgICAgICAvLyAg57qv5paH5pysXHJcblxyXG4gICAgICAgICAgICBpZiAob3JnX2NvbnRlbnQgPT0gJycgfHwgb3JnX2NvbnRlbnQgPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgICAgICBiYXNlVXRpbHMuc2hvdy5yZWRUaXAoXCLor7fovpPlhaXliqjmgIHlhoXlrrlcIik7XHJcblxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHBhcmFtc1snb3JnX2NvbnRlbnQnXSA9IG9yZ19jb250ZW50O1xyXG4gICAgICAgICAgICBwYXJhbXNbJ2NvbnRlbnQnXSA9IGRlc2NyYjtcclxuXHJcbiAgICAgICAgICAgIHBhcmFtc1snY29tbXVuaXR5X2lkJ10gPSBCdXNpbmVzcy5jb21tdW5pdHlJZDtcclxuXHJcbiAgICAgICAgICAgIC8v6I635Y+W5pyA5ZCO5pyN5Yqh5Y+36YCa55+l5YC8XHJcbiAgICAgICAgICAgIHZhciBwdXNoX3N0YXRlID0gJCgnLnNlbGVjdEl0ZW0gaW5wdXQ6Y2hlY2tlZCcpLnZhbCgpO1xyXG4gICAgICAgICAgICAvL+aWh+S7tuWxnuaAp1xyXG4gICAgICAgICAgICB2YXIgcGRmRmlsZVVybCA9ICQoXCIjdXBsb2FkZWRGaWxlVXJsXCIpLmRhdGEoXCJmaWxlX3VybFwiKTtcclxuICAgICAgICAgICAgdmFyIHBkZkZpbGVOYW1lID0gJChcIiN1cGxvYWRlZEZpbGVVcmxcIikuZGF0YShcImZpbGVfbmFtZVwiKTtcclxuICAgICAgICAgICAgdmFyIHBkZkZpbGVTaXplID0gJChcIiN1cGxvYWRlZEZpbGVVcmxcIikuZGF0YShcImZpbGVfc2l6ZVwiKTtcclxuXHJcblxyXG5cclxuICAgICAgICAgICAgaWYgKHBkZkZpbGVVcmwgIT0gXCJcIiAmJiBwZGZGaWxlVXJsICE9IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgcGFyYW1zWydmaWxlX3VybCddID0gcGRmRmlsZVVybDtcclxuICAgICAgICAgICAgICAgIHBhcmFtc1snZmlsZV9uYW1lJ10gPSBwZGZGaWxlTmFtZTtcclxuICAgICAgICAgICAgICAgIHBhcmFtc1snZmlsZV9zaXplJ10gPSBwZGZGaWxlU2l6ZTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHBhcmFtc1snZmlsZV91cmwnXSA9IFwiXCI7XHJcbiAgICAgICAgICAgICAgICBwYXJhbXNbJ2ZpbGVfbmFtZSddID0gXCJcIjtcclxuICAgICAgICAgICAgICAgIHBhcmFtc1snZmlsZV9zaXplJ10gPSBcIlwiO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB2YXIgcG9zdFVybCA9IFwiXCI7XHJcbiAgICAgICAgICAgIGlmIChCdXNpbmVzcy50eXBlID09IDEpIHsgICAvLyAg57yW6L6RXHJcbiAgICAgICAgICAgICAgICBwYXJhbXNbJ2lkJ10gPSBCdXNpbmVzcy5keW5hbWljSWQ7XHJcbiAgICAgICAgICAgICAgICBwb3N0VXJsID0gXCIvc21hbGxDb21tdW5pdHkvdXBkYXRlRHluYW1pY1wiO1xyXG4gICAgICAgICAgICB9IGVsc2UgeyAgICAvLyAg5paw5bu6XHJcbiAgICAgICAgICAgICAgICBwb3N0VXJsID0gXCIvc21hbGxDb21tdW5pdHkvdXBsb2FkRHluYW1pY1wiO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBCdXNpbmVzcy5zdWJtaXRMaW1pdCA9IHRydWU7XHJcblxyXG5cclxuICAgICAgICAgICAgY29uc29sZS5sb2coa2V5KTtcclxuICAgICAgICAgICAgaWYoa2V5ID09IDEpe1xyXG4gICAgICAgICAgICAgICAgc2V0U2VydmljZShCdXNpbmVzcy5jb21tdW5pdHlJZCxwb3N0VXJsLHBhcmFtcyxwdXNoX3N0YXRlKTtcclxuICAgICAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgICAgICBwdWJsaXNoKHBvc3RVcmwscGFyYW1zLHB1c2hfc3RhdGUsa2V5KTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICB9KTtcclxuXHJcblxyXG5cclxuICAgIH07XHJcblxyXG4gICAgZnVuY3Rpb24gcHVibGlzaChwb3N0VXJsLHBhcmFtcyxwdXNoX3N0YXRlKSB7XHJcbiAgICAgICAgJC5hamF4KHBvc3RVcmwsIHtcclxuICAgICAgICAgICAgdHlwZTogXCJQT1NUXCIsXHJcbiAgICAgICAgICAgIGRhdGFUeXBlOiBcImpzb25cIixcclxuICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgcGFyYW1zOiBwYXJhbXMsXHJcbiAgICAgICAgICAgICAgICBwdXNoX3N0YXRlOiBwdXNoX3N0YXRlXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChyZXN1bHQpIHtcclxuICAgICAgICAgICAgICAgIGlmIChyZXN1bHQuY29kZSA9PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKEJ1c2luZXNzLnR5cGUgPT0gMSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBiYXNlVXRpbHMuc2hvdy5ibHVlVGlwKFwi5L+d5a2Y57yW6L6R5oiQ5YqfXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJhc2VVdGlscy5zaG93LmJsdWVUaXAoXCLlj5HluIPliqjmgIHmiJDlip9cIik7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9IFwiL3NtYWxsQ29tbXVuaXR5L2R5bmFtaWNMaXN0P2NvbW11bml0eV9pZD1cIiArIEJ1c2luZXNzLmNvbW11bml0eUlkO1xyXG4gICAgICAgICAgICAgICAgICAgIH0sIDcwMCk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGJhc2VVdGlscy5zaG93LnJlZFRpcChcIuWPkeW4g+WHuueOsOmXrumimO+8jOivt+eojeWQjuWGjeivlVwiKTtcclxuICAgICAgICAgICAgICAgICAgICBCdXNpbmVzcy5zdWJtaXRMaW1pdCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBlcnJvcjogZnVuY3Rpb24gKHhociwgc3RhdHVzLCBlcnIpIHtcclxuICAgICAgICAgICAgICAgIEJ1c2luZXNzLnN1Ym1pdExpbWl0ID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xyXG4gICAgICAgICAgICAgICAgYmFzZVV0aWxzLnNob3cucmVkVGlwKFwi572R57uc6ZSZ6K+v77yM6K+356iN5ZCO5YaN6K+V77yBXCIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICAvL+acjeWKoeWPt+a2iOaBr+mAmuefpWFqYXjmlrnms5VcclxuICAgIGZ1bmN0aW9uIHNldFNlcnZpY2UoY19pZCxwb3N0VXJsLHBhcmFtcyxwdXNoX3N0YXRlKXtcclxuICAgICAgICBjb25zb2xlLmxvZyhjX2lkKTtcclxuICAgICAgICAkLmFqYXgoJy9zbWFsbENvbW11bml0eS9jaGVja0ZlZWRzTWVzc2FnZVB1c2gvJytjX2lkLHtcclxuICAgICAgICAgICAgdHlwZTonUE9TVCcsXHJcbiAgICAgICAgICAgIGRhdGFUeXBlOidKU09OJyxcclxuICAgICAgICAgICAgYXN5bmM6ZmFsc2UsXHJcbiAgICAgICAgICAgIHN1Y2Nlc3M6ZnVuY3Rpb24oZGF0YSl7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhkYXRhKTtcclxuICAgICAgICAgICAgICAgIGlmKGRhdGEuY29kZSA9PSAwKXtcclxuICAgICAgICAgICAgICAgICAgICBiYXNlVXRpbHMuc2hvdy5ibHVlVGlwKGRhdGEubXNnKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgcHVibGlzaChwb3N0VXJsLHBhcmFtcyxwdXNoX3N0YXRlKTtcclxuICAgICAgICAgICAgICAgIH1lbHNlIGlmKGRhdGEuY29kZSA9PSAtMSl7XHJcbiAgICAgICAgICAgICAgICAgICAgYmFzZVV0aWxzLnNob3cucmVkVGlwKGRhdGEubXNnKTtcclxuICAgICAgICAgICAgICAgICAgICBCdXNpbmVzcy5zdWJtaXRMaW1pdCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vICQoJyNjbG9zZUl0ZW0nKS5hdHRyKCdjaGVja2VkJywndHJ1ZScpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAvLyAkLmFsZXJ0KFwi5oKo6ZyA5YWI6KGM5ZCv55SoIOWKn+iDveeuoeeQhuKAlOKAlOacjeWKoeWPt+mAmuefpSDlip/og73vvIzmlrnlj6/miJDlip/lvIDlkK9cIix7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgIGxpbms6J+S4quS6uuaooeW8j+acjeWKoeWPt+mAmuefpeivtOaYjicsXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgIGhyZWY6JyMnLFxyXG4gICAgICAgICAgICAgICAgICAgIC8vICAgICBva3RleHQ6J+eri+WNs+W8gOWQrycsXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgIG9uT2s6ZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgICAgICAgICAvLyAgICAgICAgICQuYWpheChcIi9zZXRfc2VydmljZV9ub3RpZmljYXRpb25cIiwge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgIHR5cGU6IFwiUE9TVFwiLFxyXG4gICAgICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgIGRhdGFUeXBlOiBcImpzb25cIixcclxuICAgICAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICBkYXRhOiB7c3RhdHVzOjF9LFxyXG4gICAgICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChyZXN1bHQpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICAgICAgaWYgKHJlc3VsdC5jb2RlID09IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICAgICAgICAgIGJhc2VVdGlscy5zaG93LmJsdWVUaXAoXCLlvIDlkK/miJDlip/vvIzmgqjnjrDlnKjlj6/mraPluLjkvb/nlKjmnI3liqHlj7fpgJrnn6Xlip/og71cIik7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICBiYXNlVXRpbHMuc2hvdy5yZWRUaXAoXCLmk43kvZzlpLHotKXvvIzor7fnqI3lkI7lho3or5XjgIJcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgIGVycm9yOiBmdW5jdGlvbiAoeGhyLCBzdGF0dXMsIGVycikge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgICAgICBiYXNlVXRpbHMuc2hvdy5yZWRUaXAoXCLmnI3liqHlmajlh7rlsI/lt67kuobvvIzor7fnqI3lkI7lho3or5XvvIFcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIC8vICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAvLyB9KTtcclxuICAgICAgICAgICAgICAgICAgICAvLyAkKCcjY2xvc2VJdGVtJykucHJvcCgnY2hlY2tlZCcsdHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgICAgICAgICBiYXNlVXRpbHMuc2hvdy5yZWRUaXAoZGF0YS5tc2cpO1xyXG4gICAgICAgICAgICAgICAgICAgIEJ1c2luZXNzLnN1Ym1pdExpbWl0ID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIC8v5aSx6LSl5Yqg5YWl6YCJ6aG56L+U5ZueXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGVycm9yOiBmdW5jdGlvbiAoeGhyLCBzdGF0dXMsIGVycikge1xyXG4gICAgICAgICAgICAgICAgQnVzaW5lc3Muc3VibWl0TGltaXQgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycik7XHJcbiAgICAgICAgICAgICAgICBiYXNlVXRpbHMuc2hvdy5yZWRUaXAoXCLnvZHnu5zplJnor6/vvIzor7fnqI3lkI7lho3or5XvvIFcIik7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgfSlcclxuICAgIH1cclxuICAgIC8v5Y+W5raI5LiK5Lyg5Yik5pat5Y+C5pWwXHJcbiAgICAvLyB2YXIgdXBsb2FkQ2FuY2VsPTA7XHJcbiAgICBmdW5jdGlvbiBnZXRPYmplY3RVUkwoZmlsZSkge1xyXG4gICAgICAgIHZhciB1cmwgPSBudWxsO1xyXG4gICAgICAgIGlmICh3aW5kb3cuY3JlYXRlT2JqZWN0VVJMICE9IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICB1cmwgPSB3aW5kb3cuY3JlYXRlT2JqZWN0VVJMKGZpbGUpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAod2luZG93LlVSTCAhPSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgdXJsID0gd2luZG93LlVSTC5jcmVhdGVPYmplY3RVUkwoZmlsZSk7XHJcbiAgICAgICAgfSBlbHNlIGlmICh3aW5kb3cud2Via2l0VVJMICE9IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICB1cmwgPSB3aW5kb3cud2Via2l0VVJMLmNyZWF0ZU9iamVjdFVSTChmaWxlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHVybDtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiByZW1vdmVPYmplY3RVUkwodXJsKSB7Ly/ph4rmlL7otYTmupBVUkxcclxuICAgICAgICBpZiAod2luZG93LnJldm9rZU9iamVjdFVSTCAhPSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgd2luZG93LnJldm9rZU9iamVjdFVSTCh1cmwpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAod2luZG93LlVSTCAhPSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgd2luZG93LlVSTC5yZXZva2VPYmplY3RVUkwodXJsKTtcclxuICAgICAgICB9IGVsc2UgaWYgKHdpbmRvdy53ZWJraXRVUkwgIT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIHdpbmRvdy53ZWJraXRVUkwucmV2b2tlT2JqZWN0VVJMKHVybCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuXHJcbiAgICAvL+i1hOa6kOS4iuS8oOWHveaVsCjlj4LmlbDvvJpyZXNUeXBlOui1hOa6kOexu+WeiyxyZXNUeXBlQ2xhc3M66LWE5rqQ57G75Z6L5Lit57uG5YiG55qE56eN57G7LHJlc0xpbWl0U2l6ZTrotYTmupDpmZDliLblpKflsI8pXHJcbiAgICBmdW5jdGlvbiByZXNVcGxvYWQoZmlsZXMsIHJlc1R5cGUsIHJlc1R5cGVDbGFzcywgcmVzTGltaXRTaXplKSB7XHJcbiAgICAgICAgaWYgKGZpbGVzICYmIGZpbGVzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgdmFyIGZpbGUgPSBmaWxlc1swXTtcclxuICAgICAgICAgICAgdmFyIHBkZkZpbGVOYW1lID0gZmlsZS5uYW1lO1xyXG4gICAgICAgICAgICBpZiAoIXBkZkZpbGVOYW1lLnRvTG93ZXJDYXNlKCkuZW5kc1dpdGgoXCJwZGZcIikpIHtcclxuICAgICAgICAgICAgICAgIGJhc2VVdGlscy5zaG93LnJlZFRpcChcIuivt+mAieaLqSBwZGYg5qC85byP55qE5paH5Lu2XCIpO1xyXG4gICAgICAgICAgICAgICAgJChcIiNzZWxlY3RQZGZGaWxlXCIpLnJlbW92ZSgpO1xyXG4gICAgICAgICAgICAgICAgJChcIiN1cGxvYWRlZEZpbGVVcmxcIikuYmVmb3JlKCc8aW5wdXQgY2xhc3M9XCJzZWxlY3RQZGZGaWxlSW5wdXRcIiBpZD1cInNlbGVjdFBkZkZpbGVcIiB0eXBlPVwiZmlsZVwiIGFjY2VwdD1cImFwcGxpY2F0aW9uL3BkZlwiLz4nKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgLy8g6ZmQ5Yi26LWE5rqQ5ZyoKk1C5YaFXHJcbiAgICAgICAgICAgIGlmICgkdXBsb2FkRmlsZS5jaGVja0ZpbGVTaXplKGZpbGUsIHJlc0xpbWl0U2l6ZSkpIHtcclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgZmlsZVNpemUgPSAoZmlsZS5zaXplIC8gKDEwMjQgKiAxMDI0KSkudG9GaXhlZCgyKTtcclxuICAgICAgICAgICAgICAgICQoXCIjdXBsb2FkZWRGaWxlVXJsXCIpLmRhdGEoXCJmaWxlX3NpemVcIiwgZmlsZVNpemUpO1xyXG4gICAgICAgICAgICAgICAgJCgnI2F1ZGlvVVJMJytyZXNUeXBlQ2xhc3MpLmhpZGUoKTtcclxuICAgICAgICAgICAgICAgICQoXCIudXBsb2FkQm94XCIrcmVzVHlwZUNsYXNzKS5mYWRlSW4oMzAwKTtcclxuICAgICAgICAgICAgICAgIC8vIOWIneWni+WMluaWh+S7tuS7peWPiui/m+W6puadoVxyXG4gICAgICAgICAgICAgICAgaW5pdEZpbGVBbmRQcm9ncmVzc0JhcihwZGZGaWxlTmFtZSwgZmlsZVNpemUpO1xyXG5cclxuICAgICAgICAgICAgICAgICQoXCIjdXBsb2FkZWRGaWxlVXJsXCIpLmRhdGEoXCJmaWxlX25hbWVcIiwgcGRmRmlsZU5hbWUpO1xyXG5cclxuICAgICAgICAgICAgICAgIGlzUGRmRmlsZVVwbG9hZGluZyA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAkdXBsb2FkRmlsZS51cGxvYWRSZXMoZmlsZSwgcmVzVHlwZSwgZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHByb2dyZXNzID0gcGFyc2VJbnQoZGF0YSAqIDEwMCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2cocHJvZ3Jlc3MpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkKFwiLnVwbG9hZFBMaW5lQWN0aXZlXCIgKyByZXNUeXBlQ2xhc3MpLmNzcyhcIndpZHRoXCIsIHByb2dyZXNzICsgJyUnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJChcIi51cGxvYWRQZXJjZW50XCIgKyByZXNUeXBlQ2xhc3MpLnRleHQocHJvZ3Jlc3MgKyBcIiVcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAvLyDkuIrkvKDmiJDlip/lm57osINcclxuICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpc1BkZkZpbGVVcGxvYWRpbmcgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJhc2VVdGlscy5zaG93LmJsdWVUaXAoXCLkuIrkvKDmiJDlip/vvIFcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICQoXCIudXBsb2FkUExpbmVcIiArIHJlc1R5cGVDbGFzcykuaGlkZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkKFwiLnVwbG9hZFwiICsgcmVzVHlwZUNsYXNzICsgXCJOYW1lXCIpLnNob3coKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJChcIi51cGxvYWRQZXJjZW50XCIgKyByZXNUeXBlQ2xhc3MpLnRleHQoXCLliKDpmaRcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZXNVcmwgPSBkYXRhLmRhdGEuYWNjZXNzX3VybDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJChcIiN1cGxvYWRlZEZpbGVVcmxcIikuZGF0YShcImZpbGVfdXJsXCIsIHJlc1VybCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgLy8g5LiK5Lyg5aSx6LSl5Zue6LCDXHJcbiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaXNQZGZGaWxlVXBsb2FkaW5nICA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKFwi5LiK5Lyg5aSx6LSlISEhXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhkYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYmFzZVV0aWxzLnNob3cucmVkVGlwKFwi5LiK5Lyg5aSx6LSl77yBXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgYmFzZVV0aWxzLnNob3cucmVkVGlwKFwi5LiK5Lyg5aSx6LSl77yM6K+35Yu/5LiK5Lyg6LaF6L+HIFwiICsgcmVzTGltaXRTaXplICsgXCJNYiDnmoRQREbmlofku7ZcIik7XHJcbiAgICAgICAgICAgICAgICAkKFwiLnVwTG9hZFwiK3Jlc1R5cGVDbGFzcykudmFsKFwiXCIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCLnvZHnu5zplJnor6/vvIzor7fnqI3lkI7lho3or5XvvIFcIik7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICAvLyDliJ3lp4vljJbmlofku7bku6Xlj4rov5vluqbmnaFcclxuICAgIGZ1bmN0aW9uIGluaXRGaWxlQW5kUHJvZ3Jlc3NCYXIoZmlsZU5hbWUsIGZpbGVTaXplKSB7XHJcblxyXG4gICAgICAgICQoXCIudXBsb2FkUGRmTmFtZVwiKS5odG1sKGZpbGVOYW1lKS5oaWRlKCk7XHJcbiAgICAgICAgJChcIi51cGxvYWRQZGZTaXplIHNwYW5cIikuaHRtbChmaWxlU2l6ZSk7XHJcbiAgICAgICAgJChcIi51cGxvYWRQTGluZVBkZlwiKS5zaG93KClcclxuICAgICAgICAgICAgLmZpbmQoXCIudXBsb2FkUExpbmVBY3RpdmVQZGZcIikuY3NzKFwid2lkdGhcIiwgJzAnKTtcclxuICAgICAgICAkKFwiLnVwbG9hZFBlcmNlbnRQZGZcIikuaHRtbCgnJyk7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBCdXNpbmVzcztcclxuXHJcbn0pKCk7XHJcblxyXG4iXX0=
