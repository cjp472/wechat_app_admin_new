$(function(){videoUpload.init();$(".videoUploadCancle").hide()});var is_edit=false;var fileId;var videoGsize;var transcodeNotifyUrl;var videoTypes=["WMV","WM","ASF","ASX","RM","RMVB","RA","RAM","MPG","MPEG","MPE","VOB","DAT","MOV","3GP","MP4","MP4V","M4V","MKV","AVI","FLV","F4V","wmv","wm","asf","asx","rm","rmvb","ra","ram","mpg","mpeg","mpe","vob","dat","mov","3gp","mp4","mp4v","m4v","mkv","avi","flv","f4v"];var videoUpload=function(){var e={};var o=function(e){$.ajax({url:"/getsigv4",data:JSON.stringify({Action:"GetVodSignatureV2"}),type:"POST",dataType:"json",success:function(o){console.log(o);if(o.result){console.log("成功");e(o.result)}else{console.log("获取签名失败");return"获取签名失败"}}})};e.init=function(){$("#video_file").click(function(){$("#uploadVideoNow-file").click()});function e(e,o){var i=e.length;while(i--){if(e[i]===o){return true}}console.log("找不到");return false}var i=function(e,o){var i={};return i.type=e.name.slice(e.name.match(/\.[^\.]+$/).index+1),i.name=o||e.name.slice(0,e.name.match(/\.[^\.]+$/).index),i.size=e.size,i.error="",(void 0==i.name||""==i.name||/[:*?,<>\'\"\\]/g.test(i.name))&&(i.error='文件名不得包含 / : * ? "  < > 等字符'),i};$("#uploadVideoNow-file").on("change",function(t){var a=this.files[0];var r=i(a,a.name);console.log(r);console.log(r.error);if(r.error!=""){baseUtils.show.redTip(r.error);$("#uploadVideoNow-file").val("");return false}if(!e(videoTypes,r.type)){baseUtils.show.redTip("上传的文件必须为视频文件哦~");$("#uploadVideoNow-file").val("");return false}var n=a.size;videoGsize=Number(n/(1024*1024)).toFixed(2);if(videoGsize>1e3){baseUtils.show.redTip("请将视频文件压缩到 1G 以内");return false}var s=qcVideo.ugcUploader.start({videoFile:a,getSignature:o,allowAudio:0,isTranscode:true,transcodeNotifyUrl:transcodeNotifyUrl,success:function(e){console.log("上传成功");console.log(e);is_edit=false;$(".videoUploadLineA").css("width","100%");$(".videoPercent").text("已完成");$(".uploadRatio span:nth-of-type(1)").text(videoGsize+"M");$(".uploadRatio span:nth-of-type(2)").text(videoGsize+"M")},error:function(e){console.log("上传失败");console.log(e)},progress:function(e){is_edit=true;$("#videoName").hide();$(".videoUploadBox").fadeIn(300);$(".videoBoxTitle").text(e.name);$(".videoSize").text(videoGsize+"M");if(e.shacurr<1){$(".videoPercent").text("视频正在解析中");$(".uploadRatio span").text("");$(".videoUploadLineA").css("width","0%")}else if(e.shacurr==1){var o=parseFloat(videoGsize)*parseFloat(e.curr);o=o.toFixed(2);var i=Number(e.curr*100).toFixed(2);$(".videoUploadLineA").css("width",i+"%");$(".videoPercent").text(i+"%");$(".uploadRatio span:nth-of-type(1)").text(o+"M");$(".uploadRatio span:nth-of-type(2)").text(videoGsize+"M")}if(e.type=="video"){console.log(e)}},finish:function(e){console.log("finish");console.log(e);fileId=e.fileId;VideoName=e.videoName}})})};return e}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFkbWluL3Jlc01hbmFnZS92aWRlb1VwbG9hZFVnYy5qcyJdLCJuYW1lcyI6WyIkIiwidmlkZW9VcGxvYWQiLCJpbml0IiwiaGlkZSIsImlzX2VkaXQiLCJmaWxlSWQiLCJ2aWRlb0dzaXplIiwidHJhbnNjb2RlTm90aWZ5VXJsIiwidmlkZW9UeXBlcyIsImdldFNpZ25hdHVyZSIsImNhbGxiYWNrIiwiYWpheCIsInVybCIsImRhdGEiLCJKU09OIiwic3RyaW5naWZ5IiwiQWN0aW9uIiwidHlwZSIsImRhdGFUeXBlIiwic3VjY2VzcyIsInJlcyIsImNvbnNvbGUiLCJsb2ciLCJyZXN1bHQiLCJjbGljayIsImNvbnRhaW5zIiwiYXJyIiwib2JqIiwiaSIsImxlbmd0aCIsImdldEZpbGVNZXNzYWdlIiwiZmlsZSIsIm5ld25hbWUiLCJmaWxlTXNnIiwibmFtZSIsInNsaWNlIiwibWF0Y2giLCJpbmRleCIsInNpemUiLCJlcnJvciIsInRlc3QiLCJvbiIsImUiLCJ2aWRlb0ZpbGUiLCJ0aGlzIiwiZmlsZXMiLCJiYXNlVXRpbHMiLCJzaG93IiwicmVkVGlwIiwidmFsIiwidmlkZW9TaXplIiwiTnVtYmVyIiwidG9GaXhlZCIsInJlc3VsdE1zZyIsInFjVmlkZW8iLCJ1Z2NVcGxvYWRlciIsInN0YXJ0IiwiYWxsb3dBdWRpbyIsImlzVHJhbnNjb2RlIiwiY3NzIiwidGV4dCIsInByb2dyZXNzIiwiZmFkZUluIiwic2hhY3VyciIsInVwbG9hZENvbXBsZXRlU2l6ZSIsInBhcnNlRmxvYXQiLCJjdXJyIiwiY3VyclBlcmNlbnQiLCJmaW5pc2giLCJWaWRlb05hbWUiLCJ2aWRlb05hbWUiXSwibWFwcGluZ3MiOiJBQUFBQSxFQUFFLFdBQ0VDLFlBQVlDLE1BRVpGLEdBQUUsc0JBQXNCRyxRQUc1QixJQUFJQyxTQUFVLEtBQ2QsSUFBSUMsT0FDSixJQUFJQyxXQUNKLElBQUlDLG1CQUNKLElBQUlDLGFBQWMsTUFBTyxLQUFNLE1BQU8sTUFBTyxLQUFNLE9BQVEsS0FB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RSxtQkFBbUI4RCxPQUFPLElBQzVCOUQsR0FBRSxrQkFBa0I0RCxLQUFLckMsRUFBT1csS0FDaENsQyxHQUFFLGNBQWM0RCxLQUFLdEQsV0FBVyxJQUVoQyxJQUFHaUIsRUFBT3dDLFFBQVEsRUFBRSxDQUNoQi9ELEVBQUUsaUJBQWlCNEQsS0FBSyxVQUN4QjVELEdBQUUscUJBQXFCNEQsS0FBSyxHQUM1QjVELEdBQUUscUJBQXFCMkQsSUFBSSxRQUFRLFVBQ2pDLElBQUdwQyxFQUFPd0MsU0FBUyxFQUFHLENBQ3hCLEdBQUlDLEdBQW1CQyxXQUFXM0QsWUFBWTJELFdBQVcxQyxFQUFPMkMsS0FDaEVGLEdBQW1CQSxFQUFtQlosUUFBUSxFQUU5QyxJQUFJZSxHQUFZaEIsT0FBTzVCLEVBQU8yQyxLQUFLLEtBQUtkLFFBQVEsRUFDaERwRCxHQUFFLHFCQUFxQjJELElBQUksUUFBUVEsRUFBWSxJQUMvQ25FLEdBQUUsaUJBQWlCNEQsS0FBS08sRUFBWSxJQUNwQ25FLEdBQUUsb0NBQW9DNEQsS0FBS0ksRUFBbUIsSUFDOURoRSxHQUFFLG9DQUFvQzRELEtBQUt0RCxXQUFXLEtBRTFELEdBQUdpQixFQUFPTixNQUFRLFFBQVMsQ0FDdkJJLFFBQVFDLElBQUlDLEtBR3BCNkMsT0FBUSxTQUFTN0MsR0FDYkYsUUFBUUMsSUFBSSxTQUNaRCxTQUFRQyxJQUFJQyxFQUNabEIsUUFBT2tCLEVBQU9sQixNQUNkZ0UsV0FBWTlDLEVBQU8rQyxlQU1uQyxPQUFPckUiLCJmaWxlIjoiYWRtaW4vcmVzTWFuYWdlL3ZpZGVvVXBsb2FkVWdjLmpzIiwic291cmNlc0NvbnRlbnQiOlsiJChmdW5jdGlvbiAoKSB7XG4gICAgdmlkZW9VcGxvYWQuaW5pdCgpO1xuXG4gICAgJChcIi52aWRlb1VwbG9hZENhbmNsZVwiKS5oaWRlKCk7XG59KTtcblxudmFyIGlzX2VkaXQgPSBmYWxzZTtcbnZhciBmaWxlSWQ7XG52YXIgdmlkZW9Hc2l6ZTtcbnZhciB0cmFuc2NvZGVOb3RpZnlVcmw7IC8vIOi9rOeggeaIkOWKn+Wbnuiwg+WcsOWdgFxudmFyIHZpZGVvVHlwZXMgPSBbXCJXTVZcIiwgXCJXTVwiLCBcIkFTRlwiLCBcIkFTWFwiLCBcIlJNXCIsIFwiUk1WQlwiLCBcIlJBXCIsIFwiUkFNXCIsIFwiTVBHXCIsIFwiTVBFR1wiLCBcIk1QRVwiLCBcIlZPQlwiLCBcIkRBVFwiLCBcIk1PVlwiLCBcIjNHUFwiLCBcIk1QNFwiLCBcIk1QNFZcIiwgXCJNNFZcIiwgXCJNS1ZcIiwgXCJBVklcIiwgXCJGTFZcIiwgXCJGNFZcIixcIndtdlwiLCBcIndtXCIsIFwiYXNmXCIsIFwiYXN4XCIsIFwicm1cIiwgXCJybXZiXCIsIFwicmFcIiwgXCJyYW1cIiwgXCJtcGdcIiwgXCJtcGVnXCIsIFwibXBlXCIsIFwidm9iXCIsIFwiZGF0XCIsIFwibW92XCIsIFwiM2dwXCIsIFwibXA0XCIsIFwibXA0dlwiLCBcIm00dlwiLCBcIm1rdlwiLCBcImF2aVwiLCBcImZsdlwiLCBcImY0dlwiXVxudmFyIHZpZGVvVXBsb2FkPWZ1bmN0aW9uICgpIHtcbiAgICB2YXIgdmlkZW9VcGxvYWQ9e307XG5cbiAgICAvKipcbiAgICAgKiDorqHnrpfnrb7lkI1cbiAgICAgKiovXG4gICAgICAgIC8vIGh0dHA6Ly8xMjMuMjA2LjgzLjEyMDo4MC9pbnRlcmZhY2UucGhwXG4gICAgdmFyIGdldFNpZ25hdHVyZSA9IGZ1bmN0aW9uKGNhbGxiYWNrKXtcbiAgICAgICAgICAgICQuYWpheCh7XG4gICAgICAgICAgICAgICAgdXJsOiAnL2dldHNpZ3Y0JyxcbiAgICAgICAgICAgICAgICBkYXRhOiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgICAgICAgICAgIFwiQWN0aW9uXCI6XCJHZXRWb2RTaWduYXR1cmVWMlwiXG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgdHlwZTogJ1BPU1QnLFxuICAgICAgICAgICAgICAgIGRhdGFUeXBlOiAnanNvbicsXG4gICAgICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24ocmVzKXtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmVzKTtcbiAgICAgICAgICAgICAgICAgICAgaWYocmVzLnJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCLmiJDlip9cIik7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYWxsYmFjayhyZXMucmVzdWx0KTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwi6I635Y+W562+5ZCN5aSx6LSlXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICfojrflj5bnrb7lkI3lpLHotKUnO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcblxuICAgIHZpZGVvVXBsb2FkLmluaXQ9ZnVuY3Rpb24gKCkge1xuICAgICAgICAkKFwiI3ZpZGVvX2ZpbGVcIikuY2xpY2soZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgJChcIiN1cGxvYWRWaWRlb05vdy1maWxlXCIpLmNsaWNrKCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGZ1bmN0aW9uIGNvbnRhaW5zKGFyciwgb2JqKSB7XG4gICAgICAgICAgICB2YXIgaSA9IGFyci5sZW5ndGg7XG4gICAgICAgICAgICB3aGlsZSAoaS0tKSB7XG4gICAgICAgICAgICAgICAgaWYgKGFycltpXSA9PT0gb2JqKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCfmib7kuI3liLAnKTtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfTtcblxuICAgICAgICB2YXIgZ2V0RmlsZU1lc3NhZ2UgPSBmdW5jdGlvbihmaWxlLCBuZXduYW1lKSB7XG4gICAgICAgICAgICB2YXIgZmlsZU1zZyA9IHt9O1xuICAgICAgICAgICAgcmV0dXJuIGZpbGVNc2cudHlwZSA9IGZpbGUubmFtZS5zbGljZShmaWxlLm5hbWUubWF0Y2goL1xcLlteXFwuXSskLykuaW5kZXggKyAxKSxcbiAgICAgICAgICAgICAgICBmaWxlTXNnLm5hbWUgPSBuZXduYW1lIHx8IGZpbGUubmFtZS5zbGljZSgwLCBmaWxlLm5hbWUubWF0Y2goL1xcLlteXFwuXSskLykuaW5kZXgpLFxuICAgICAgICAgICAgICAgIGZpbGVNc2cuc2l6ZSA9IGZpbGUuc2l6ZSxcbiAgICAgICAgICAgICAgICBmaWxlTXNnLmVycm9yID0gXCJcIixcbiAgICAgICAgICAgICh2b2lkIDAgPT0gZmlsZU1zZy5uYW1lIHx8IFwiXCIgPT0gZmlsZU1zZy5uYW1lIHx8IC9bOio/LDw+XFwnXFxcIlxcXFxdL2cudGVzdChmaWxlTXNnLm5hbWUpKSAmJiAoZmlsZU1zZy5lcnJvciA9ICfmlofku7blkI3kuI3lvpfljIXlkKsgLyA6ICogPyBcIiAgPCA+IOetieWtl+espicpLFxuICAgICAgICAgICAgICAgIGZpbGVNc2dcbiAgICAgICAgfVxuICAgICAgICAkKCcjdXBsb2FkVmlkZW9Ob3ctZmlsZScpLm9uKCdjaGFuZ2UnLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgdmFyIHZpZGVvRmlsZSA9IHRoaXMuZmlsZXNbMF07XG4gICAgICAgICAgICB2YXIgZmlsZU1zZyA9IGdldEZpbGVNZXNzYWdlKHZpZGVvRmlsZSx2aWRlb0ZpbGUubmFtZSk7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhmaWxlTXNnKTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGZpbGVNc2cuZXJyb3IpO1xuICAgICAgICAgICAgLy/pmZDliLbop4bpopHmlofku7blkI3kuI3og73ljIXlkKvnibnmrornrKblj7dcbiAgICAgICAgICAgIGlmKGZpbGVNc2cuZXJyb3IhPScnKXtcbiAgICAgICAgICAgICAgICBiYXNlVXRpbHMuc2hvdy5yZWRUaXAoZmlsZU1zZy5lcnJvcik7XG4gICAgICAgICAgICAgICAgJCgnI3VwbG9hZFZpZGVvTm93LWZpbGUnKS52YWwoJycpO1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8v6ZmQ5Yi26KeG6aKR5paH5Lu257G75Z6L5Li6bXA05paH5Lu2XG4gICAgICAgICAgICBpZighY29udGFpbnModmlkZW9UeXBlcyxmaWxlTXNnLnR5cGUpKXtcbiAgICAgICAgICAgICAgICBiYXNlVXRpbHMuc2hvdy5yZWRUaXAoJ+S4iuS8oOeahOaWh+S7tuW/hemhu+S4uuinhumikeaWh+S7tuWTpn4nKTtcbiAgICAgICAgICAgICAgICAkKCcjdXBsb2FkVmlkZW9Ob3ctZmlsZScpLnZhbCgnJyk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy/ojrflj5bmlofku7blpKflsI9cbiAgICAgICAgICAgIHZhciB2aWRlb1NpemUgPSB2aWRlb0ZpbGUuc2l6ZTtcbiAgICAgICAgICAgIHZpZGVvR3NpemUgPSBOdW1iZXIodmlkZW9TaXplLygxMDI0KjEwMjQpKS50b0ZpeGVkKDIpO1xuICAgICAgICAgICAgaWYodmlkZW9Hc2l6ZT4xMDAwKXtcbiAgICAgICAgICAgICAgICBiYXNlVXRpbHMuc2hvdy5yZWRUaXAoXCLor7flsIbop4bpopHmlofku7bljovnvKnliLAgMUcg5Lul5YaFXCIpO1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIHZpZGVvRmlsZS5uYW1lXG4gICAgICAgICAgICB2YXIgcmVzdWx0TXNnID0gcWNWaWRlby51Z2NVcGxvYWRlci5zdGFydCh7XG4gICAgICAgICAgICAgICAgdmlkZW9GaWxlOiB2aWRlb0ZpbGUsXG4gICAgICAgICAgICAgICAgZ2V0U2lnbmF0dXJlOiBnZXRTaWduYXR1cmUsXG4gICAgICAgICAgICAgICAgYWxsb3dBdWRpbzogMCxcbiAgICAgICAgICAgICAgICBpc1RyYW5zY29kZTogdHJ1ZSwvL+aYr+WQpui9rOeggVxuICAgICAgICAgICAgICAgIHRyYW5zY29kZU5vdGlmeVVybDogdHJhbnNjb2RlTm90aWZ5VXJsLCAvLyjovaznoIHmiJDlip/lkI7nmoTlm57osIPlnLDlnYApaXNUcmFuc2NvZGU9PXRydWUs5pe25byA5ZCv77ybIOWbnuiwg3VybOeahOi/lOWbnuaVsOaNruagvOW8j+WPguiAgyAgaHR0cDovL3d3dy5xY2xvdWQuY29tL3dpa2kvdjIvTXVsdGlwYXJ0VXBsb2FkVm9kRmlsZVxuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlc3VsdCl7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCfkuIrkvKDmiJDlip8nKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmVzdWx0KTtcbiAgICAgICAgICAgICAgICAgICAgaXNfZWRpdCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAkKFwiLnZpZGVvVXBsb2FkTGluZUFcIikuY3NzKCd3aWR0aCcsIFwiMTAwJVwiKTtcbiAgICAgICAgICAgICAgICAgICAgJChcIi52aWRlb1BlcmNlbnRcIikudGV4dChcIuW3suWujOaIkFwiKTtcbiAgICAgICAgICAgICAgICAgICAgJChcIi51cGxvYWRSYXRpbyBzcGFuOm50aC1vZi10eXBlKDEpXCIpLnRleHQodmlkZW9Hc2l6ZStcIk1cIik7XG4gICAgICAgICAgICAgICAgICAgICQoXCIudXBsb2FkUmF0aW8gc3BhbjpudGgtb2YtdHlwZSgyKVwiKS50ZXh0KHZpZGVvR3NpemUrXCJNXCIpO1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgZXJyb3I6IGZ1bmN0aW9uKHJlc3VsdCl7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCfkuIrkvKDlpLHotKUnKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmVzdWx0KTtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHByb2dyZXNzOiBmdW5jdGlvbihyZXN1bHQpe1xuICAgICAgICAgICAgICAgICAgICBpc19lZGl0ID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgJCgnI3ZpZGVvTmFtZScpLmhpZGUoKTtcbiAgICAgICAgICAgICAgICAgICAgJChcIi52aWRlb1VwbG9hZEJveFwiKS5mYWRlSW4oMzAwKTtcbiAgICAgICAgICAgICAgICAgICAgJChcIi52aWRlb0JveFRpdGxlXCIpLnRleHQocmVzdWx0Lm5hbWUpO1xuICAgICAgICAgICAgICAgICAgICAkKFwiLnZpZGVvU2l6ZVwiKS50ZXh0KHZpZGVvR3NpemUrJ00nKTtcbiAgICAgICAgICAgICAgICAgICAgLy/op4bpopHmraPlnKjop6PmnpDkuK1cbiAgICAgICAgICAgICAgICAgICAgaWYocmVzdWx0LnNoYWN1cnI8MSl7XG4gICAgICAgICAgICAgICAgICAgICAgICAkKFwiLnZpZGVvUGVyY2VudFwiKS50ZXh0KFwi6KeG6aKR5q2j5Zyo6Kej5p6Q5LitXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgJChcIi51cGxvYWRSYXRpbyBzcGFuXCIpLnRleHQoXCJcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAkKFwiLnZpZGVvVXBsb2FkTGluZUFcIikuY3NzKFwid2lkdGhcIixcIjAlXCIpO1xuICAgICAgICAgICAgICAgICAgICB9ZWxzZSBpZihyZXN1bHQuc2hhY3Vycj09MSkgeyAgIC8v6KeG6aKR6Kej5p6Q5a6M5oiQ77yM5byA5aeL5LiK5LygXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdXBsb2FkQ29tcGxldGVTaXplPXBhcnNlRmxvYXQodmlkZW9Hc2l6ZSkqcGFyc2VGbG9hdChyZXN1bHQuY3Vycik7XG4gICAgICAgICAgICAgICAgICAgICAgICB1cGxvYWRDb21wbGV0ZVNpemU9dXBsb2FkQ29tcGxldGVTaXplLnRvRml4ZWQoMik7XG4gICAgICAgICAgICAgICAgICAgICAgICAvL+W9k+WJjeeZvuWIhuavlFxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGN1cnJQZXJjZW50PU51bWJlcihyZXN1bHQuY3VycioxMDApLnRvRml4ZWQoMik7XG4gICAgICAgICAgICAgICAgICAgICAgICAkKFwiLnZpZGVvVXBsb2FkTGluZUFcIikuY3NzKFwid2lkdGhcIixjdXJyUGVyY2VudCtcIiVcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAkKFwiLnZpZGVvUGVyY2VudFwiKS50ZXh0KGN1cnJQZXJjZW50K1wiJVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICQoXCIudXBsb2FkUmF0aW8gc3BhbjpudGgtb2YtdHlwZSgxKVwiKS50ZXh0KHVwbG9hZENvbXBsZXRlU2l6ZStcIk1cIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAkKFwiLnVwbG9hZFJhdGlvIHNwYW46bnRoLW9mLXR5cGUoMilcIikudGV4dCh2aWRlb0dzaXplK1wiTVwiKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZihyZXN1bHQudHlwZSA9PSAndmlkZW8nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZXN1bHQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBmaW5pc2g6IGZ1bmN0aW9uKHJlc3VsdCl7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdmaW5pc2gnKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmVzdWx0KTtcbiAgICAgICAgICAgICAgICAgICAgZmlsZUlkPXJlc3VsdC5maWxlSWQ7XG4gICAgICAgICAgICAgICAgICAgIFZpZGVvTmFtZSA9IHJlc3VsdC52aWRlb05hbWU7XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICByZXR1cm4gdmlkZW9VcGxvYWQ7XG59KCk7XG5cblxuIl19
