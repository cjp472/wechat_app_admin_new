var isEditPicture=false;var params={};var allParams={};var cos=new InitCosCloud;$(document).ready(function(){bindElement();$.cookie("content_create")?setTopUrlInfo("content_create"):setTopUrlInfo("banner_listop");datetimepickerconfig("#stop_time")});function bindElement(){$("#stop_time").on("change",function(){setMsgDim("#stop_time")});$("#type_selector").on("change",function(){var e=$(this).find("option:selected").val();if(e=="h5"){$("#sub_selector").empty();$("#sub_selector").addClass("hide");$("#sub_input").removeClass("hide");return}else if(e=="no_jump"){$("#sub_selector").empty();$("#sub_selector").removeClass("hide");$("#sub_input").addClass("hide");return}else{$("#sub_selector").empty();$("#sub_selector").removeClass("hide");$("#sub_input").addClass("hide")}$.get("/banner/getResourceList?type="+e,function(e){$("#sub_selector").empty();e=JSON.parse(e);var s=e.length;var a="";for(var t=0;t<s;t++){a+="<option value='"+e[t].id+"'>"+e[t].title+"</option>"}$("#sub_selector").append(a)})})}function uploadBanner(){showLoading();if(!checkBannerForm()){hideLoading();return}sliceUpload(".pic_input",get_cos_image_path(),pic_successCallBack,pic_errorCallBack)}function saveBanner(){showLoading();if(!checkBannerForm()){hideLoading();return}if(isEditPicture){sliceUpload(".pic_input",get_cos_image_path(),pic_successCallBack,pic_errorCallBack)}else{doUpLoad()}}function checkBannerForm(){params={};allParams={};var e=$(".pic_input").val();if(e.length!=0){isEditPicture=true}else{baseUtils.show.blueTip("请上传图片");$(".pic_input").focus();return false}var s=$("#resource_title").val().trim();if(s.length!=0){params["title"]=s}else{baseUtils.show.blueTip("请输入图片名称");$("#resource_title").focus();return false}var a=$("#start_time").val().trim();if(a.length!=0){params["start_at"]=a}else{baseUtils.show.blueTip("请设置上架时间");$("#start_time").focus();return false}var t=$("#stop_time").val().trim();if(t.length!=0){if(a>t){baseUtils.show.blueTip("下架时间不可早于上架时间哦！");$("#stop_time").focus();return false}params["stop_at"]=t}else{}params["skip_target"]=$("#sub_selector").find("option:selected").val();params["skip_title"]=$("#sub_selector").find("option:selected").text();var i=$("#type_selector").find("option:selected").val();if(i=="audio"){i=2}else if(i=="video"){i=3}else if(i=="image_text"){i=1}else if(i=="alive"){i=4}else if(i=="package"){i=6}else if(i=="h5"){i=5;params["skip_target"]=$("#sub_input").val().trim()}else{i=0}params["skip_type"]=i;if(i==2||i==3||i==1||i==4||i==6){if(params["skip_title"]==""){baseUtils.show.blueTip("请选择跳转资源链接!");return false}}var r=$("#view_order").find("option:selected").val();if(r=="first"){r=10}else if(r=="second"){r=9}else if(r=="third"){r=8}else{r=0}params["weight"]=r;allParams["params"]=params;allParams["id"]=$("#data").data("id");return true}function sliceUpload(e,s,a,t){var i=$(e).prop("files");if(i&&i.length==1){browserMD5File(i[0],function(e,r){console.log("MD5:"+r);var o=i[0]["name"];var l=o.split(".");var n=l[l.length-1];console.log("suffix:"+n);s=s+r+"."+n;console.log("remotePath:"+s);cos.uploadFileWithoutPro(a,t,s,i[0],0)})}else{baseUtils.show.redTip("请选择一个文件!")}}var pic_successCallBack=function(e){console.log("图片上传成功!");var s=e.data.access_url;console.log("图片链接!"+s);params["image_url"]=s;allParams["params"]=params;doUpLoad()};var pic_errorCallBack=function(e){hideLoading();baseUtils.show.redTip("配图上传失败!请重新上传!");uploadErrorShow(e.responseText)};function doUpLoad(){$.post("/upload_banner",allParams,function(e){hideLoading();var s=e.code;var a=e.msg;if(s==0){baseUtils.show.blueTip("新增成功",function(){window.location.href="/getBannerList"})}else{baseUtils.show.redTip("新增失败")}})}
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFkbWluL2Jhbm5lckFkbWluLmpzIl0sIm5hbWVzIjpbImlzRWRpdFBpY3R1cmUiLCJwYXJhbXMiLCJhbGxQYXJhbXMiLCJjb3MiLCJJbml0Q29zQ2xvdWQiLCIkIiwiZG9jdW1lbnQiLCJyZWFkeSIsImJpbmRFbGVtZW50IiwiY29va2llIiwic2V0VG9wVXJsSW5mbyIsImRhdGV0aW1lcGlja2VyY29uZmlnIiwib24iLCJzZXRNc2dEaW0iLCJ0eXBlIiwidGhpcyIsImZpbmQiLCJ2YWwiLCJlbXB0eSIsImFkZENsYXNzIiwicmVtb3ZlQ2xhc3MiLCJnZXQiLCJyZXN1bHQiLCJKU09OIiwicGFyc2UiLCJjb3VudCIsImxlbmd0aCIsImh0bWxTdHIiLCJpIiwiaWQiLCJ0aXRsZSIsImFwcGVuZCIsInVwbG9hZEJhbm5lciIsInNob3dMb2FkaW5nIiwiY2hlY2tCYW5uZXJGb3JtIiwiaGlkZUxvYWRpbmciLCJzbGljZVVwbG9hZCIsImdldF9jb3NfaW1hZ2VfcGF0aCIsInBpY19zdWNjZXNzQ2FsbEJhY2siLCJwaWNfZXJyb3JDYWxsQmFjayIsInNhdmVCYW5uZXIiLCJkb1VwTG9hZCIsInBpY19pbnB1dCIsImJhc2VVdGlscyIsInNob3ciLCJibHVlVGlwIiwiZm9jdXMiLCJyZXNvdXJjZV90aXRsZSIsInRyaW0iLCJzdGFydF90aW1lIiwic3RvcF90aW1lIiwidGV4dCIsInNraXBfdHlwZSIsInZpZXdfb3JkZXIiLCJkYXRhIiwiaWRlbnRpdHkiLCJyZW1vdGVQYXRoIiwic3VjY2Vzc0NhbGxCYWNrIiwiZXJyb3JDYWxsQmFjayIsImZpbGVzIiwicHJvcCIsImJyb3dzZXJNRDVGaWxlIiwiZXJyIiwibWQ1IiwiY29uc29sZSIsImxvZyIsImZpbGVfbmFtZSIsIm5hbWVzIiwic3BsaXQiLCJzdWZmaXgiLCJ1cGxvYWRGaWxlV2l0aG91dFBybyIsInJlZFRpcCIsInBpY191cmwiLCJhY2Nlc3NfdXJsIiwidXBsb2FkRXJyb3JTaG93IiwicmVzcG9uc2VUZXh0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RixFQUFNQSxFQUFNekMsT0FBUyxFQUNsQ3NDLFNBQVFDLElBQUksVUFBWUksRUFDeEJiLEdBQWFBLEVBQWFPLEVBQU0sSUFBTU0sQ0FDdENMLFNBQVFDLElBQUksY0FBZ0JULEVBRTVCckQsS0FBSW1FLHFCQUFxQmIsRUFBaUJDLEVBQWVGLEVBQVlHLEVBQU0sR0FBSSxTQUlsRixDQUNEaEIsVUFBVUMsS0FBSzJCLE9BQU8sYUFNOUIsR0FBSWpDLHFCQUFzQixTQUFVaEIsR0FHaEMwQyxRQUFRQyxJQUFJLFVBR1osSUFBSU8sR0FBVWxELEVBQU9nQyxLQUFLbUIsVUFDMUJULFNBQVFDLElBQUksUUFBVU8sRUFFdEJ2RSxRQUFPLGFBQWV1RSxDQUV0QnRFLFdBQVUsVUFBWUQsTUFFdEJ3QyxZQUlKLElBQUlGLG1CQUFvQixTQUFVakIsR0FFOUJhLGFBQ0FRLFdBQVVDLEtBQUsyQixPQUFPLGdCQUN0QkcsaUJBQWdCcEQsRUFBT3FELGNBSTNCLFNBQVNsQyxZQUdMcEMsRUFBRXVFLEtBQUssaUJBQWtCMUUsVUFBVyxTQUFVb0IsR0FDMUNhLGFBQ0EsSUFBSTBDLEdBQU92RCxFQUFPdUQsSUFDbEIsSUFBSUMsR0FBTXhELEVBQU93RCxHQUNqQixJQUFJRCxHQUFRLEVBQUcsQ0FDWGxDLFVBQVVDLEtBQUtDLFFBQVEsT0FBUSxXQUMzQmtDLE9BQU9DLFNBQVNDLEtBQU8sdUJBRXhCLENBQ0h0QyxVQUFVQyxLQUFLMkIsT0FBTyIsImZpbGUiOiJhZG1pbi9iYW5uZXJBZG1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogQ3JlYXRlZCBieSBicmVlemUgb24gOS8yOS8xNi5cbiAqL1xuXG52YXIgaXNFZGl0UGljdHVyZSA9IGZhbHNlO1xuXG52YXIgcGFyYW1zID0ge307XG52YXIgYWxsUGFyYW1zID0ge307XG5cbi8v6IW+6K6v5LqR6LWE5rqQXG4vL3ZhciBidWNrZXROYW1lID0gd2luZG93LmNvc19idWNrZXRfbmFtZTtcbi8vdmFyIGNvcyA9IG5ldyBDb3NDbG91ZCh3aW5kb3cuY29zX2FwcF9pZCk7XG52YXIgY29zID0gbmV3IEluaXRDb3NDbG91ZCgpO1xuXG4kKGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbiAoKSB7XG4gICAgYmluZEVsZW1lbnQoKTtcbiAgICAkLmNvb2tpZSgnY29udGVudF9jcmVhdGUnKT8gc2V0VG9wVXJsSW5mbygnY29udGVudF9jcmVhdGUnKSA6IHNldFRvcFVybEluZm8oJ2Jhbm5lcl9saXN0b3AnKTtcblxuICAgIC8v5Yid5aeL5YyW5pe26Ze06YCJ5oup5ZmoXG4gICAgZGF0ZXRpbWVwaWNrZXJjb25maWcoJyNzdG9wX3RpbWUnKTtcbn0pO1xuXG5mdW5jdGlvbiBiaW5kRWxlbWVudCgpIHtcblxuICAgICQoJyNzdG9wX3RpbWUnKS5vbignY2hhbmdlJywgZnVuY3Rpb24oKXtcbiAgICAgICAgc2V0TXNnRGltKCcjc3RvcF90aW1lJyk7XG4gICAgfSk7XG5cbiAgICAkKFwiI3R5cGVfc2VsZWN0b3JcIikub24oJ2NoYW5nZScsIGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgdHlwZSA9ICQodGhpcykuZmluZCgnb3B0aW9uOnNlbGVjdGVkJykudmFsKCk7XG5cbiAgICAgICAgaWYgKHR5cGUgPT0gJ2g1Jykge1xuICAgICAgICAgICAgJCgnI3N1Yl9zZWxlY3RvcicpLmVtcHR5KCk7XG4gICAgICAgICAgICAkKCcjc3ViX3NlbGVjdG9yJykuYWRkQ2xhc3MoJ2hpZGUnKTtcbiAgICAgICAgICAgICQoJyNzdWJfaW5wdXQnKS5yZW1vdmVDbGFzcygnaGlkZScpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9IGVsc2UgaWYgKHR5cGUgPT0gJ25vX2p1bXAnKSB7XG4gICAgICAgICAgICAkKCcjc3ViX3NlbGVjdG9yJykuZW1wdHkoKTtcbiAgICAgICAgICAgICQoJyNzdWJfc2VsZWN0b3InKS5yZW1vdmVDbGFzcygnaGlkZScpO1xuICAgICAgICAgICAgJCgnI3N1Yl9pbnB1dCcpLmFkZENsYXNzKCdoaWRlJyk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAkKCcjc3ViX3NlbGVjdG9yJykuZW1wdHkoKTtcbiAgICAgICAgICAgICQoJyNzdWJfc2VsZWN0b3InKS5yZW1vdmVDbGFzcygnaGlkZScpO1xuICAgICAgICAgICAgJCgnI3N1Yl9pbnB1dCcpLmFkZENsYXNzKCdoaWRlJyk7XG4gICAgICAgIH1cblxuICAgICAgICAkLmdldCgnL2Jhbm5lci9nZXRSZXNvdXJjZUxpc3Q/dHlwZT0nICsgdHlwZSAsIGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICAgICAgICAgICQoJyNzdWJfc2VsZWN0b3InKS5lbXB0eSgpO1xuICAgICAgICAgICAgcmVzdWx0ID0gSlNPTi5wYXJzZShyZXN1bHQpO1xuXG4gICAgICAgICAgICB2YXIgY291bnQgPSByZXN1bHQubGVuZ3RoO1xuXG4gICAgICAgICAgICB2YXIgaHRtbFN0ciA9IFwiXCI7XG5cbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY291bnQ7IGkrKykge1xuICAgICAgICAgICAgICAgIGh0bWxTdHIrPVwiPG9wdGlvbiB2YWx1ZT0nXCIrcmVzdWx0W2ldLmlkK1wiJz5cIityZXN1bHRbaV0udGl0bGUrXCI8L29wdGlvbj5cIjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgICQoJyNzdWJfc2VsZWN0b3InKS5hcHBlbmQoaHRtbFN0cik7XG4gICAgICAgIH0pO1xuICAgIH0pO1xufVxuXG5cbmZ1bmN0aW9uIHVwbG9hZEJhbm5lcigpIHtcbiAgICBzaG93TG9hZGluZygpO1xuICAgIGlmICghY2hlY2tCYW5uZXJGb3JtKCkpIHtcbiAgICAgICAgaGlkZUxvYWRpbmcoKTtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8v5o6l552A5LiK5Lyg5Zu+54mHXG4gICAgc2xpY2VVcGxvYWQoJy5waWNfaW5wdXQnLCBnZXRfY29zX2ltYWdlX3BhdGgoKSwgcGljX3N1Y2Nlc3NDYWxsQmFjaywgcGljX2Vycm9yQ2FsbEJhY2spO1xufVxuXG5mdW5jdGlvbiBzYXZlQmFubmVyKCkge1xuICAgIHNob3dMb2FkaW5nKCk7XG4gICAgaWYgKCFjaGVja0Jhbm5lckZvcm0oKSkge1xuICAgICAgICBoaWRlTG9hZGluZygpO1xuICAgICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgaWYgKGlzRWRpdFBpY3R1cmUpIHtcbiAgICAgICAgLy/mjqXnnYDkuIrkvKDlm77niYdcbiAgICAgICAgc2xpY2VVcGxvYWQoJy5waWNfaW5wdXQnLCBnZXRfY29zX2ltYWdlX3BhdGgoKSwgcGljX3N1Y2Nlc3NDYWxsQmFjaywgcGljX2Vycm9yQ2FsbEJhY2spO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGRvVXBMb2FkKCk7XG4gICAgfVxufVxuXG4vL+aguOWvueihqOWNlVxuZnVuY3Rpb24gY2hlY2tCYW5uZXJGb3JtKCkge1xuXG4gICAgcGFyYW1zID0ge307IC8v5riF56m65LmL5YmN55qE5pWw5o2uXG4gICAgYWxsUGFyYW1zID0ge307XG5cbiAgICAvL+i9ruaSreWbvlxuICAgIHZhciBwaWNfaW5wdXQgPSAkKCcucGljX2lucHV0JykudmFsKCk7XG4gICAgaWYgKHBpY19pbnB1dC5sZW5ndGggIT0gMCkge1xuICAgICAgICBpc0VkaXRQaWN0dXJlID0gdHJ1ZTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBiYXNlVXRpbHMuc2hvdy5ibHVlVGlwKFwi6K+35LiK5Lyg5Zu+54mHXCIpO1xuICAgICAgICAkKCcucGljX2lucHV0JykuZm9jdXMoKTtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIC8v5Zu+54mH5ZCN56ewXG4gICAgdmFyIHJlc291cmNlX3RpdGxlID0gJCgnI3Jlc291cmNlX3RpdGxlJykudmFsKCkudHJpbSgpO1xuICAgIGlmIChyZXNvdXJjZV90aXRsZS5sZW5ndGggIT0gMCkge1xuICAgICAgICBwYXJhbXNbJ3RpdGxlJ10gPSByZXNvdXJjZV90aXRsZTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBiYXNlVXRpbHMuc2hvdy5ibHVlVGlwKCfor7fovpPlhaXlm77niYflkI3np7AnKTtcbiAgICAgICAgJCgnI3Jlc291cmNlX3RpdGxlJykuZm9jdXMoKTtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIC8v5LiK5p625pe26Ze0XG4gICAgdmFyIHN0YXJ0X3RpbWUgPSAkKCcjc3RhcnRfdGltZScpLnZhbCgpLnRyaW0oKTtcbiAgICBpZiAoc3RhcnRfdGltZS5sZW5ndGggIT0gMCkge1xuICAgICAgICBwYXJhbXNbJ3N0YXJ0X2F0J10gPSBzdGFydF90aW1lO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGJhc2VVdGlscy5zaG93LmJsdWVUaXAoJ+ivt+iuvue9ruS4iuaetuaXtumXtCcpO1xuICAgICAgICAkKCcjc3RhcnRfdGltZScpLmZvY3VzKCk7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgLy/kuIvmnrbml7bpl7RcbiAgICB2YXIgc3RvcF90aW1lID0gJCgnI3N0b3BfdGltZScpLnZhbCgpLnRyaW0oKTtcbiAgICBpZiAoc3RvcF90aW1lLmxlbmd0aCAhPSAwKSB7XG4gICAgICAgIGlmKHN0YXJ0X3RpbWU+c3RvcF90aW1lKXtcbiAgICAgICAgICAgIGJhc2VVdGlscy5zaG93LmJsdWVUaXAoJ+S4i+aetuaXtumXtOS4jeWPr+aXqeS6juS4iuaetuaXtumXtOWTpu+8gScpO1xuICAgICAgICAgICAgJCgnI3N0b3BfdGltZScpLmZvY3VzKCk7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgcGFyYW1zWydzdG9wX2F0J10gPSBzdG9wX3RpbWU7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgLy9iYXNlVXRpbHMuc2hvdy5ibHVlVGlwKCfor7forr7nva7kuIrmnrbml7bpl7QnKTtcbiAgICAgICAgLy8kKCcjc3RvcF90aW1lJykuZm9jdXMoKTtcbiAgICAgICAgLy9yZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgLy/ot7Povazpk77mjqVcbiAgICBwYXJhbXNbJ3NraXBfdGFyZ2V0J10gPSAkKCcjc3ViX3NlbGVjdG9yJykuZmluZCgnb3B0aW9uOnNlbGVjdGVkJykudmFsKCk7XG4gICAgcGFyYW1zWydza2lwX3RpdGxlJ10gPSAkKCcjc3ViX3NlbGVjdG9yJykuZmluZCgnb3B0aW9uOnNlbGVjdGVkJykudGV4dCgpO1xuICAgIHZhciBza2lwX3R5cGUgPSAkKCcjdHlwZV9zZWxlY3RvcicpLmZpbmQoJ29wdGlvbjpzZWxlY3RlZCcpLnZhbCgpO1xuICAgIGlmIChza2lwX3R5cGUgPT0gXCJhdWRpb1wiKSB7XG4gICAgICAgIHNraXBfdHlwZSA9IDI7XG4gICAgfSBlbHNlIGlmIChza2lwX3R5cGUgPT0gXCJ2aWRlb1wiKSB7XG4gICAgICAgIHNraXBfdHlwZSA9IDM7XG4gICAgfSBlbHNlIGlmIChza2lwX3R5cGUgPT0gXCJpbWFnZV90ZXh0XCIpIHtcbiAgICAgICAgc2tpcF90eXBlID0gMTtcbiAgICB9IGVsc2UgaWYgKHNraXBfdHlwZSA9PSBcImFsaXZlXCIpIHtcbiAgICAgICAgc2tpcF90eXBlID0gNDtcbiAgICB9IGVsc2UgaWYgKHNraXBfdHlwZSA9PSBcInBhY2thZ2VcIikge1xuICAgICAgICBza2lwX3R5cGUgPSA2O1xuICAgIH1lbHNlIGlmIChza2lwX3R5cGUgPT0gXCJoNVwiKSB7XG4gICAgICAgIHNraXBfdHlwZSA9IDU7XG4gICAgICAgIHBhcmFtc1snc2tpcF90YXJnZXQnXSA9ICQoJyNzdWJfaW5wdXQnKS52YWwoKS50cmltKCk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgc2tpcF90eXBlID0gMDtcbiAgICB9XG4gICAgcGFyYW1zWydza2lwX3R5cGUnXSA9IHNraXBfdHlwZTtcblxuICAgIGlmIChza2lwX3R5cGUgPT0gMiB8fCBza2lwX3R5cGUgPT0gMyB8fCBza2lwX3R5cGUgPT0gMSB8fCBza2lwX3R5cGUgPT0gNCB8fCBza2lwX3R5cGUgPT02KSB7XG4gICAgICAgIGlmIChwYXJhbXNbJ3NraXBfdGl0bGUnXSA9PSBcIlwiKSB7XG4gICAgICAgICAgICBiYXNlVXRpbHMuc2hvdy5ibHVlVGlwKFwi6K+36YCJ5oup6Lez6L2s6LWE5rqQ6ZO+5o6lIVwiKTtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8v5pi+56S66aG65bqPXG4gICAgdmFyIHZpZXdfb3JkZXIgPSAkKCcjdmlld19vcmRlcicpLmZpbmQoJ29wdGlvbjpzZWxlY3RlZCcpLnZhbCgpO1xuICAgIGlmICh2aWV3X29yZGVyID09IFwiZmlyc3RcIikge1xuICAgICAgICB2aWV3X29yZGVyID0gMTA7XG4gICAgfSBlbHNlIGlmICh2aWV3X29yZGVyID09IFwic2Vjb25kXCIpIHtcbiAgICAgICAgdmlld19vcmRlciA9IDk7XG4gICAgfSBlbHNlIGlmICh2aWV3X29yZGVyID09IFwidGhpcmRcIikge1xuICAgICAgICB2aWV3X29yZGVyID0gODtcbiAgICB9IGVsc2Uge1xuICAgICAgICB2aWV3X29yZGVyID0gMDtcbiAgICB9XG4gICAgcGFyYW1zWyd3ZWlnaHQnXSA9IHZpZXdfb3JkZXI7XG5cbiAgICBhbGxQYXJhbXNbJ3BhcmFtcyddID0gcGFyYW1zO1xuXG4gICAgLy/otYTmupBpZFxuICAgIGFsbFBhcmFtc1snaWQnXT0gJCgnI2RhdGEnKS5kYXRhKCdpZCcpO1xuXG4gICAgcmV0dXJuIHRydWU7XG5cbn1cblxuZnVuY3Rpb24gc2xpY2VVcGxvYWQoaWRlbnRpdHksIHJlbW90ZVBhdGgsIHN1Y2Nlc3NDYWxsQmFjaywgZXJyb3JDYWxsQmFjaykge1xuXG4gICAgLy/kuIrkvKAo55u05o6l6YCa6L+HanPkuIrkvKBjZG4pXG4gICAgdmFyIGZpbGVzID0gJChpZGVudGl0eSkucHJvcCgnZmlsZXMnKTtcbiAgICBpZiAoZmlsZXMgJiYgZmlsZXMubGVuZ3RoID09IDEpIHtcblxuICAgICAgICAvL+iOt+WPluaWh+S7tueahE1ENeWAvFxuICAgICAgICBicm93c2VyTUQ1RmlsZShmaWxlc1swXSwgZnVuY3Rpb24gKGVyciwgbWQ1KSB7XG4gICAgICAgICAgICAvL+iOt+WPluaWh+S7tuWGheWuueeahE1ENVxuICAgICAgICAgICAgY29uc29sZS5sb2coJ01ENTonICsgbWQ1KTtcbiAgICAgICAgICAgIC8v5Y+W5paH5Lu25ZCN5ZCO57yAXG4gICAgICAgICAgICB2YXIgZmlsZV9uYW1lID0gZmlsZXNbMF1bJ25hbWUnXTtcbiAgICAgICAgICAgIHZhciBuYW1lcyA9IGZpbGVfbmFtZS5zcGxpdCgnLicpO1xuICAgICAgICAgICAgdmFyIHN1ZmZpeCA9IG5hbWVzW25hbWVzLmxlbmd0aCAtIDFdO1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ3N1ZmZpeDonICsgc3VmZml4KTtcbiAgICAgICAgICAgIHJlbW90ZVBhdGggPSByZW1vdGVQYXRoICsgbWQ1ICsgXCIuXCIgKyBzdWZmaXg7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygncmVtb3RlUGF0aDonICsgcmVtb3RlUGF0aCk7XG4gICAgICAgICAgICAvL2Nvcy5vdXRfdXBsb2FkRmlsZShzdWNjZXNzQ2FsbEJhY2ssIGVycm9yQ2FsbEJhY2ssIGJ1Y2tldE5hbWUsIHJlbW90ZVBhdGgsIGZpbGVzWzBdLCAwKTtcbiAgICAgICAgICAgIGNvcy51cGxvYWRGaWxlV2l0aG91dFBybyhzdWNjZXNzQ2FsbEJhY2ssIGVycm9yQ2FsbEJhY2ssIHJlbW90ZVBhdGgsIGZpbGVzWzBdLCAwKTtcbiAgICAgICAgfSk7XG5cbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIGJhc2VVdGlscy5zaG93LnJlZFRpcChcIuivt+mAieaLqeS4gOS4quaWh+S7tiFcIik7XG4gICAgfVxuXG59XG5cbi8v6YWN5Zu+5oiQ5Yqf5LiK5Lyg5Zue6LCDXG52YXIgcGljX3N1Y2Nlc3NDYWxsQmFjayA9IGZ1bmN0aW9uIChyZXN1bHQpIHtcblxuICAgIC8vdmFyIGpzb25SZXN1bHQgPSAkLnBhcnNlSlNPTihyZXN1bHQpO1xuICAgIGNvbnNvbGUubG9nKCflm77niYfkuIrkvKDmiJDlip8hJyk7XG5cbiAgICAvL+iOt+WPluWIsOi1hOa6kGNkbuiuv+mXrui/nuaOpVxuICAgIHZhciBwaWNfdXJsID0gcmVzdWx0LmRhdGEuYWNjZXNzX3VybDtcbiAgICBjb25zb2xlLmxvZygn5Zu+54mH6ZO+5o6lIScgKyBwaWNfdXJsKTtcblxuICAgIHBhcmFtc1snaW1hZ2VfdXJsJ10gPSBwaWNfdXJsO1xuXG4gICAgYWxsUGFyYW1zWydwYXJhbXMnXSA9IHBhcmFtcztcblxuICAgIGRvVXBMb2FkKCk7XG59O1xuXG4vL+i1hOa6kOmFjeWbvuWksei0peS4iuS8oOWbnuiwg1xudmFyIHBpY19lcnJvckNhbGxCYWNrID0gZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgIC8vdmFyIGpzb25SZXN1bHQgPSAkLnBhcnNlSlNPTihyZXN1bHQpO1xuICAgIGhpZGVMb2FkaW5nKCk7XG4gICAgYmFzZVV0aWxzLnNob3cucmVkVGlwKFwi6YWN5Zu+5LiK5Lyg5aSx6LSlIeivt+mHjeaWsOS4iuS8oCFcIik7XG4gICAgdXBsb2FkRXJyb3JTaG93KHJlc3VsdC5yZXNwb25zZVRleHQpO1xufTtcblxuLy/kuIrkvKDmlbDmja7liLDoh6rlt7HlkI7lj7BcbmZ1bmN0aW9uIGRvVXBMb2FkKCl7XG5cbiAgICAvL+S4iuS8oOiHs+acjeWKoeWZqFxuICAgICQucG9zdCgnL3VwbG9hZF9iYW5uZXInLCBhbGxQYXJhbXMsIGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICAgICAgaGlkZUxvYWRpbmcoKTtcbiAgICAgICAgdmFyIGNvZGUgPSByZXN1bHQuY29kZTtcbiAgICAgICAgdmFyIG1zZyA9IHJlc3VsdC5tc2c7XG4gICAgICAgIGlmIChjb2RlID09IDApIHtcbiAgICAgICAgICAgIGJhc2VVdGlscy5zaG93LmJsdWVUaXAoXCLmlrDlop7miJDlip9cIiwgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSAnL2dldEJhbm5lckxpc3QnO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBiYXNlVXRpbHMuc2hvdy5yZWRUaXAoXCLmlrDlop7lpLHotKVcIik7XG5cbiAgICAgICAgfVxuICAgIH0pO1xufVxuIl19
